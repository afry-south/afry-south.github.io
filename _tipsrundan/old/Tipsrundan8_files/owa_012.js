self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GetItemManager.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[254],{13443:function(e,t,r){"use strict";r.r(t);var n=r(6426),i=r(8190),a=r(8189),o=r(838),s=r(207),u=r(826),c={featureId:"rp-omeRevocation",propertyPaths:[Object(s.a)({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})],isPropertyExistedOnItem:function(e){return!1},shouldGetItemPropertiesFromServer:function(e){var t=o.a.items.get(e);return t&&t.ParentFolderId.Id===Object(u.a)("sentitems")}},d=r(5092),l=r(833),m=r(2553),f=r(54),p=r(5329);function g(e,t){var r=Object(l.j)(),n=r.items.get(e);if(n)if(0===t){var i=r.conversations.get(n.ConversationId.Id);if(i){var a=Object(p.a)(i.conversationId);return n&&a&&a.Id===e}}else if(1===t)return Object(f.f)("mc-smartPillsMessageView");return!1}var P={featureId:m.a.LanguageAndLocale,propertyPaths:[d.f],isPropertyExistedOnItem:function(e){var t=l.x.items.get(e);return t&&!!t.stampedLanguage},shouldGetItemPropertiesFromServer:g},I={featureId:m.a.SmartDoc,propertyPaths:[d.g],isPropertyExistedOnItem:function(e){var t=l.x.items.get(e);return t&&!!t.SmartDocData},shouldGetItemPropertiesFromServer:g},S={featureId:m.a.SmartReply,propertyPaths:[d.h],isPropertyExistedOnItem:function(e){var t=l.x.items.get(e);return t&&!!t.SmartReplyData},shouldGetItemPropertiesFromServer:g},v={featureId:m.a.SmartTask,propertyPaths:[d.j],isPropertyExistedOnItem:function(e){var t=l.x.items.get(e);return t&&!!t.SmartTaskData},shouldGetItemPropertiesFromServer:g},y={featureId:m.a.SmartTime,propertyPaths:[d.i],isPropertyExistedOnItem:function(e){var t=l.x.items.get(e);return t&&!!t.SmartTimeData},shouldGetItemPropertiesFromServer:g},h=r(7532),O=r(8178),b=r(8179),j=r(8182);function E(){Object(n.d)([i.c,a.c,O.a,b.b,P,I,S,y,v,h.a,c,j.b])}r.d(t,"initializeGetItemManagerForRP",(function(){return E}))},1920:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(19);function i(){var e=Object(n.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},2553:function(e,t,r){"use strict";var n,i,a=r(86),o=r(4517),s=r(4),u=r(833);Object(s.mutator)(o.a,(function(e){var t=e.itemId,r=e.isSmartSuggestionsRendered,n=e.suggestionTypesRendered,i=e.suggestionsRendered,a=e.extractionId,o=Object(u.j)().items.get(t);(null==o?void 0:o.SIGSData)&&(o.SIGSData.SmartPillData={IsSmartSuggestionsRendered:r,SuggestionTypesRendered:n,SuggestionsRendered:i,ExtractionId:a})}));function c(e){return{smartReplyComposeSIGSData:{isSmartSuggestionsClicked:!1,suggestionsClickedTime:null,clickIndex:-1},smartDocOption:e||n.None}}!function(e){e[e.None=0]="None",e[e.FileSuggestion=1]="FileSuggestion",e[e.LocalFiles=2]="LocalFiles",e[e.CloudFiles=3]="CloudFiles",e[e.UploadAndShare=4]="UploadAndShare"}(n||(n={})),function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(i||(i={})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return c}));var d=new a.c((function(){return r.e(484).then(r.bind(null,13287))})),l=new a.a(d,(function(e){return e.logToSIGSOnMessageSent}))},3783:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"c",(function(){return u})),r.d(t,"e",(function(){return c}));var n=r(207),i="userHighlightEvent",a="existingHighlight",o="newHighlight",s=Object(n.a)({PropertyName:"UserNoteData",PropertyType:"String",DistinguishedPropertySetId:"Common"}),u=500,c=10},4517:function(e,t,r){"use strict";var n=r(4);t.a=Object(n.action)("initializeSIGSDataAction",(function(e,t,r,n,i){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:r,suggestionsRendered:n,extractionId:i}}))},5092:function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return m})),r.d(t,"g",(function(){return f}));var n=r(207),i="Language",a="Locale",o="LanguageScores",s="@EntityId",u="EntityExtraction/ExtractLanguage1.0",c=Object(n.a)({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=Object(n.a)({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),l=Object(n.a)({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=Object(n.a)({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=Object(n.a)({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},5329:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(838),i=r(932),a=r(1920);function o(e){var t=n.a.conversations.get(e.Id),r=t?t.conversationNodeIds:[],o=r.length;if(0==o||!i.a.conversationReadingPaneViewState)return null;for(var s=i.a.conversationReadingPaneViewState.itemPartsMap,u=Object(a.a)()?o-1:0,c=Object(a.a)()?-1:1;u>=0&&u<o;){var d=s.get(r[u]),l=d?n.a.items.get(d.itemId):null;if(l&&!l.IsDraft&&!d.isInRollUp)return{mailboxInfo:e.mailboxInfo,Id:l.ItemId.Id};u+=c}return null}},6036:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(54),i="ExplicitMessageCard";function a(e){if(!Object(n.f)("rp-actionableMessages"))return!1;var t=function(e,t){if(e){var r=e.ExtendedProperty;if(r)for(var n=r.length,i=0;i<n;i++){var a=r[i];if(a.ExtendedFieldURI.PropertyName===t)return a}}return null}(e,i);return!(null==t||!t.Value||"true"!==t.Value.toLowerCase())}},6212:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(87);function i(e){return(null==e?void 0:e.MailboxInfo)&&e.MailboxInfo.type==n.a.GroupMailbox}},6426:function(e,t,r){"use strict";var n=r(0);var i=r(4),a=r(833),o=Object(i.mutatorAction)("updateItemInStore",(function(e,t){var r=a.x.items.get(e);r&&Object.keys(t).forEach((function(e){"ExtendedProperty"==e?r.ExtendedProperty=Object(n.__spread)(t.ExtendedProperty,r.ExtendedProperty):"ItemId"!=e&&(r[e]=t[e])}))})),s=r(191),u=r(1089),c=r(1083),d=r(838),l=r(387),m=r(48);r.d(t,"d",(function(){return P})),r.d(t,"b",(function(){return I})),r.d(t,"c",(function(){return S})),r.d(t,"a",(function(){return v}));var f={},p={},g="GetItemManagerFailure";function P(e){e.forEach((function(e){p[e.featureId]=e}))}function I(e,t){var r;if(!f[e]||"Pending"!=f[e].requestStatus){var i=function(e,t){var r=[];if(Object.keys(p).forEach((function(i){var a=p[i],o=a.isPropertyExistedOnItem,s=a.shouldGetItemPropertiesFromServer,u=a.propertyPaths;!o(e)&&s(e,t)&&r.push.apply(r,Object(n.__spread)(u))})),r.length>0)return Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:r});return null}(e,t);if(i){var a=d.a.items.get(e);if(a){var P={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};f[e]=P;var I=null===(r=a.MailboxInfo)||void 0===r?void 0:r.requestOptions;P.pendingPromise=Object(u.a)([e],i,null,null,I).then((function(t){if(t&&Object(c.a)(t[0])){P.requestStatus="Success";var r=t[0];return o(e,r.Items[0]),Promise.resolve(d.a.items.get(e))}var i=Object(n.__read)(function(e){return e&&"Success"!=e.ResponseClass?[e.ResponseCode,e.StackTrace]:[null,null]}(t[0]),2),a=i[0],s=i[1];return P.requestStatus="Error",Promise.reject(new Error("GetItem failed ErrorResponseCode="+a+", StackTrace="+s))})).catch((function(e){return P.requestStatus="Error",Object(s.o)(g,{errorMessage:e.message}),m.d.warn("[GetItemManager_getAdditionalPropertiesFromServer] Error: "+e.message),Promise.reject(e)}))}}}}function S(e,t){var r=p[t];if(!r)return Promise.reject("GetItemManager: The featureId is not registered in GetItemManager.");if(r.isPropertyExistedOnItem(e))return Promise.resolve(d.a.items.get(e));if(!f[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");var n=f[e];switch(n.requestStatus){case"Success":return Promise.resolve(d.a.items.get(e));case"Pending":case"Error":return n.pendingPromise;default:return Promise.reject("GetItemManager: The request status is unknown.")}}function v(e){delete f[e]}},7532:function(e,t,r){"use strict";r.d(t,"b",(function(){return o}));var n=r(1655),i=r(838),a=r(834),o="MeetingConflicts",s=Object(a.a)({FieldURI:"ConflictingMeetings"}),u=Object(a.a)({FieldURI:"AdjacentMeetings"}),c={featureId:o,propertyPaths:[u,s],isPropertyExistedOnItem:function(e){return!1},shouldGetItemPropertiesFromServer:function(e){var t=i.a.items.get(e);return!(!t||!Object(n.a)(t.ItemClass))}};t.a=c},8159:function(e,t,r){"use strict";r.r(t);var n=r(6426);r.d(t,"getAdditionalPropertiesFromServer",(function(){return n.b})),r.d(t,"getItemProperties",(function(){return n.c})),r.d(t,"cleanUpByItemId",(function(){return n.a}))},8178:function(e,t,r){"use strict";r.d(t,"b",(function(){return s}));var n=r(6212),i=r(54),a=r(838),o=r(834),s="UserHighlight",u=Object(o.a)({FieldURI:"UserHighlightData"}),c={featureId:s,propertyPaths:[u],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userHighlightData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.f)("rp-userMarkup"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.a=c},8179:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return u}));var n=r(6212),i=r(54),a=r(838),o=r(3783),s="UserNote",u="UserNoteData",c={featureId:s,propertyPaths:[o.f],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userNoteData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.f)("rp-userMarkup"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.b=c},8182:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return u}));var n=r(54),i=r(838),a=r(327),o=r(6036),s="MessageCard",u="IOpenTypedFacet.Com.Microsoft.Graph.MessageCard",c=Object(a.a)("E550B918-9859-47B9-8095-97E4E72F1926",u,"String"),d={featureId:s,propertyPaths:[c],isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return!!(null==t?void 0:t.adaptiveCardDetails)},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(n.f)("rp-actionableMessages"))return!1;var r=i.a.items.get(e);return Object(o.a)(r)}};t.b=d},8189:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return u}));var n=r(54),i=r(838),a=r(207),o="EntityExtraction/ExtractLanguage1.0",s="EntityExtraction/ExtractQuotedTextLanguages1.0",u="InlineTranslationLocale",c=[Object(a.a)({PropertyName:o,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(a.a)({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"})],d={featureId:u,propertyPaths:c,isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return(null==t?void 0:t.TranslationData)&&null!=t.TranslationData.itemLocale},shouldGetItemPropertiesFromServer:function(e,t){if(!(Object(n.f)("rp-inlineTranslation")&&0==t||Object(n.f)("rp-inlineTranslation-conversationViewOff")))return!1;var r=i.a.items.get(e);return!!r&&!r.RightsManagementLicenseData}};t.c=d},8190:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return u}));var n=r(54),i=r(838),a=r(207),o="TranslationData",s="TranslationStatus",u="InlineTranslationDataAndStatus",c=[Object(a.a)({PropertyName:o,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(a.a)({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"})],d={featureId:u,propertyPaths:c,isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return(null==t?void 0:t.TranslationData)&&null!=t.TranslationData.translationText},shouldGetItemPropertiesFromServer:function(e,t){return!!(Object(n.f)("rp-inlineTranslation")&&Object(n.f)("tra-cacheTranslation")&&0==t||Object(n.f)("rp-inlineTranslation-conversationViewOff")&&Object(n.f)("tra-cacheTranslation"))}};t.c=d},932:function(e,t,r){"use strict";r.d(t,"b",(function(){return a}));var n=r(1168),i=r(4),a=Object(i.createStore)("readingpane",{conversationReadingPaneViewState:null,itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1}),o=a();n.a.registerReference((function(){return o.conversationReadingPaneViewState&&o.conversationReadingPaneViewState.conversationId.Id})),t.a=o}}]);
//# sourceMappingURL=owa.GetItemManager.js.map
self.scriptsLoaded['owa.GetItemManager.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GetItemManager.js'] = (new Date()).getTime();