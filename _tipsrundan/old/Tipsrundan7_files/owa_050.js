self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFunctionalBoot~PostMailDeeplinkBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[68],{1127:function(e,n,t){"use strict";var r=t(0);function i(e){return e>0}var o=t(4),u=t(74),c=Object(o.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(e,n,t,r,i,o){return Object(u.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpAddress:n,smtpIdentifier:t,unsubscribeSilentUris:r,unsubscribeHttpUri:i,completedCallback:o})})),a=Object(o.action)("AFTER_UNSUBSCRIBE",(function(e,n,t,r,i){return{smtpIdentifier:e,unsubscribeSourceType:n,responseType:t,debugMessage:r,completedCallback:i}})),s=t(8),d=t(198),f="ows/api/beta/subscriptions/{0}/unsubscribe";var l,b=function(e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(d.c)(Object(s.b)(f,e),{unsubscribeSilentUris:n},null,!0)];case 1:return[2,t.sent()]}}))}))};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(l||(l={}));var p=l,v=t(12),O=Object(o.createStore)("BrandSubscription",{subscriptions:new v.ObservableMap({}),unsubscribedSubscriptions:new v.ObservableMap({})})();function m(e){return e&&O.subscriptions.has(e.toLowerCase())?O.subscriptions.get(e.toLowerCase()):null}var j=Object(o.mutatorAction)("unsubscribeFromCache",(function(e){var n=Object(r.__assign)({},m(e));n?(O.subscriptions.delete(e.toLowerCase()),O.unsubscribedSubscriptions.set(e.toLowerCase(),n)):S()})),w=t(190);Object(o.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n,t,o,u,c,s,d,f,l,v,O,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=e.unsubscribeSourceType,t=e.smtpAddress,o=e.smtpIdentifier,u=e.unsubscribeSilentUris,c=e.unsubscribeHttpUri,s=e.completedCallback,c&&0!==c.length||u&&0!==u.length?(u&&i(u.length)||!c?d="No unsubscribe URIs provided":(window.open(c,"_blank"),d="Opened unsubscribe URI in new tab"),[4,b(o,u)]):(d="No unsubscribe URIs or SilentURIs provided",f=p.Fail,a(o,n,f,d,s),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return l=r.sent(),v=null,Object(w.a)(l.status)?(d="Unsubscribe service called successfully. "+d,f=p.Success,j(t),[3,4]):[3,2];case 2:return d="Unsubscribe service failed. "+d,f=p.Fail,[4,l.text().then((function(e){return e?JSON.parse(e):{}}))];case 3:O=r.sent(),(v=new Error("ResponseCode="+l.status+", ErrorMessage="+(null===(m=null==O?void 0:O.error)||void 0===m?void 0:m.message))).fetchErrorType="ServerFailure",r.label=4;case 4:return a(o,n,f,d,s),v?[2,Promise.reject(v)]:[2,Promise.resolve()]}}))}))}));Object(o.mutator)(a,(function(e){var n=e.unsubscribeSourceType,t=e.responseType,r=e.debugMessage,i=e.completedCallback;"BrandCard"===n&&i&&i(t===p.Success,r)}));var g=Object(o.mutatorAction)("populateSubscriptionStore",(function(e){e.subscriptions.forEach((function(e){var n;(null===(n=null==e?void 0:e.smtpInfo)||void 0===n?void 0:n.smtpAddress)&&O.subscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)})),e.unsubscribedSubscriptions.forEach((function(e){var n;(null===(n=null==e?void 0:e.smtpInfo)||void 0===n?void 0:n.smtpAddress)&&O.unsubscribedSubscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)}))})),h="ows/api/beta/subscriptions?orderBy=name, asc";var S=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.b)(e?h+"&noResolveBrand=true":h,void 0,!0)];case 1:return n=r.sent(),Object(w.a)(n.status)?[4,n.json()]:[3,3];case 2:return t=r.sent(),g(t),[2,t];case 3:return[2,null]}}))}))};t.d(n,"b",(function(){return S})),t.d(n,"e",(function(){return c})),t.d(n,"d",(function(){return a})),t.d(n,"a",(function(){return p})),t.d(n,"c",(function(){return m})),t.d(n,"f",(function(){return i}))},1164:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(37),i=t(942),o=t(65);function u(){return(Object(r.f)("grp-shareable-crud-integrationv2")||Object(i.a)().isSensitivityLabelsEnabled)&&!Object(o.t)()}},1182:function(e,n,t){"use strict";t.d(n,"b",(function(){return u})),t.d(n,"a",(function(){return c}));var r=t(0),i=void 0,o=new Promise((function(e){i=e}));function u(e){null==i||i(e)}function c(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2,Promise.race([o,new Promise((function(e,n){setTimeout((function(){return n()}),45e3)}))])]}))}))}},1351:function(e,n,t){"use strict";t.d(n,"b",(function(){return i}));var r=t(4),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),o=i();n.a=o},1766:function(e,n,t){"use strict";var r=t(4),i=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();n.a=i},1817:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(1818),i=t(1342),o=t(893),u=t(37);function c(e){if(Object(u.f)("fwk-skypeBusinessV2")&&e){var n=Object(r.b)(e),t=function(e){switch(e){case"Offline":return o.b.offline;case"Away":case"BeRightBack":return o.b.away;case"Busy":case"IdleBusy":return o.b.busy;case"DoNotDisturb":return o.b.dnd;case"Online":case"IdleOnline":return o.b.online;case"None":return o.b.none}}(i.a.presences.get(n));return t||void 0}}},1818:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i}));var r="sip:";function i(e){if(!e)return null;var n=e.toLowerCase();return 0!=n.indexOf(r)&&(n=r+n),n}},1950:function(e,n,t){"use strict";var r=t(73),i=t(0),o=t(1351),u=t(93),c=Object(u.action)("addSessionMaskedRecipient")((function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(n){return o.a.sessionMaskedRecipients[e]=!0,[2]}))}))}));t.d(n,"b",(function(){return s})),t.d(n,"a",(function(){return c}));var a=new r.c((function(){return t.e(489).then(t.bind(null,14141))})),s=new r.a(a,(function(e){return e.execute3SPrimeCall}))},1979:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(37);function i(){return Object(r.f)("rp-peopleSuggestionsCacheFirst")||Object(r.f)("rp-cacheFirstPeopleTrieSize300")||Object(r.f)("rp-cacheFirstPeopleTrieSize500")||Object(r.f)("rp-cacheFirstPeopleTrieSize700")}},2813:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(4),i=Object(r.createStore)("linkedInStore",{status:null})},2943:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(0),i=t(391),o=t(37),u=t(860);function c(e,n,t,c){var a=Object(i.e)(t,e,null,n),s=Object(r.__assign)(Object(r.__assign)({},c),{includeBohemiaOnPopout:Object(u.d)(u.a.Bohemia).bohemiaEnabled&&Object(o.f)("rp-prague")});Object(i.c)("mail",a,s,{resizable:!0})}},2990:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(73),i=t(37),o=new r.c((function(){return Promise.all([t.e(7),t.e(221)]).then(t.bind(null,4507))})),u=new r.a(o,(function(e){return e.initializeErrorHandlerDevtools}));function c(){Object(i.f)("fwk-devTools")&&Object(i.f)("fwk-errorpopup")&&u.importAndExecute()}},3324:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return t.e(440).then(t.bind(null,5328))})),o=new r.a(i,(function(e){return e.initializeCache}))},3397:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(4),i=Object(r.createStore)("chatStore",{isChatCalloutShown:!1,chatProvider:0});i()},3730:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(4),i=Object(r.createStore)("allowedOptions",{allowedOptions:[]})},3780:function(e,n,t){"use strict";var r=t(73),i=t(3730),o=t(208);function u(e){return Object(o.a)()||e.every((function(e){return Object(i.a)().allowedOptions.includes(e)}))}t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return u}));var c=new r.c((function(){return t.e(113).then(t.bind(null,14041))})),a=new r.a(c,(function(e){return e.loadAllowedOptions}))},3916:function(e,n,t){"use strict";t.d(n,"b",(function(){return i}));var r=t(4),i=Object(r.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),o=i();n.a=o},4208:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return u}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(0),t.e(2),t.e(3),t.e(4),t.e(145)]).then(t.bind(null,7165))})),o=new r.a(i,(function(e){return e.initializeAccountAndCalendars})),u=new r.a(i,(function(e){return e.initializeCalendarsDataForModule}))},4335:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(27),t.e(748),t.e(92),t.e(813)]).then(t.bind(null,6613))})),o=new r.a(i,(function(e){return e.registerAndInitializeSharedABT}))},4336:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return t.e(528).then(t.bind(null,6652))})),o=new r.a(i,(function(e){return e.validateCache}))},4406:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(38),i=t(4407);n.default=function(e,n){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("SetFocusedInboxConfiguration",e,n)}},4407:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"SetFocusedInboxConfigurationRequest:#Exchange"},e)}},5012:function(e,n,t){"use strict";t.d(n,"e",(function(){return o})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return a})),t.d(n,"d",(function(){return s}));var r=t(73),i=new r.c((function(){return t.e(273).then(t.bind(null,8665))})),o=new r.a(i,(function(e){return e.setGroupHeaderCallbacks})),u=new r.b(i,(function(e){return e.groupHeaderCommandBarStore})),c=new r.b(i,(function(e){return e.groupHeaderNavigationButton})),a=new r.a(i,(function(e){return e.groupHeaderCommandBarAction})),s=new r.b(i,(function(e){return e.isGroupHeaderNavigationOnEmail}))},5013:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(38);n.default=function(e){return r.makeServiceRequest("GetFolderMruConfiguration",{},e)}},5014:function(e,n,t){"use strict";var r=t(4),i=Object(r.createStore)("TrustedSenders",{trustedSendersAndDomains:null})();n.a=i},5332:function(e,n,t){"use strict";var r=t(73),i=t(5435),o=t(193);var u=t(2813);function c(){var e=Object(u.a)();return null==e.status||"OptOut"==e.status||"OptOutBound"==e.status||"DisabledBound"==e.status}function a(){return"Bound"===Object(u.a)().status}t.d(n,"a",(function(){return d})),t.d(n,"c",(function(){return c})),t.d(n,"b",(function(){return a}));var s=new r.c((function(){return Promise.all([t.e(7),t.e(321)]).then(t.bind(null,14021))})),d=(new r.a(s,(function(e){return e.connectToLinkedIn})),new r.a(s,(function(e){return e.initializeBindStatus})));"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.completeLinkedInBind=function(e){Object(o.o)("linkedInBindComplete",[e]),Object(i.a)(e?"Unbound":"Bound")})},5340:function(e,n,t){"use strict";var r="shortcut icon",i="image/x-icon";function o(e){if(document){var n=document.querySelector('link[rel="'+r+'"]');n||((n=document.createElement("link")).rel=r,n.type=i,document.head.appendChild(n)),n.href=e}}var u,c=t(12);function a(e){u&&u(),u=Object(c.autorun)((function(){o(e.get())}))}t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return a}))},5342:function(e,n,t){"use strict";var r=t(73),i=t(5013),o=t.n(i);var u=t(3916),c=t(839),a=t(93),s=Object(a.action)("getMoveToMruList")((function(){o()().then((function(e){return e})).then((function(e){return function(e){if(null==e.FolderMruEntries||0==e.FolderMruEntries.length)u.a.mruFolders.push(Object(c.a)("inbox")),u.a.mruFolders.push(Object(c.a)("deleteditems")),u.a.mruFolders.push(Object(c.a)("archive"));else for(var n=0;n<e.FolderMruEntries.length;n++){var t=e.FolderMruEntries[n].EwsFolderIdEntry;u.a.mruFolders.push(t)}u.a.isInitialized=!0}(e)}))}));t.d(n,"b",(function(){return f})),t.d(n,"c",(function(){return l})),t.d(n,"a",(function(){return s}));var d=new r.c((function(){return t.e(369).then(t.bind(null,14044))})),f=new r.a(d,(function(e){return e.addFolderIdToMoveToMruList})),l=new r.a(d,(function(e){return e.removeFolderIdFromMoveToMruList}))},5435:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(4),i=t(2813),o=Object(r.mutatorAction)("updateBindStatus",(function(e){Object(i.a)().status=e}))},5502:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(4406),i=t.n(r),o=t(155);function u(){var e={Header:Object(o.getJsonRequestHeader)(),IsFocusedInboxCapable:!0};return i()({request:e}).then((function(e){return e}))}},5519:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(4),i=Object(r.action)("turnOffFocusedInbox")},5640:function(e,n,t){"use strict";var r=t(972),i=t(4),o=Object(i.action)("REMINDER_NOTIFICATION",(function(e){return{notification:e}})),u=Object(i.action)("NEW_MAIL_NOTIFICATION",(function(e){return{notification:e}})),c=Object(i.action)("SOCIAL_ACTIVITY_NOTIFICATION",(function(e){return{notification:e}})),a=t(208),s=!1;function d(){s||(s=!0,r.g.importAndExecute(f("ReminderNotification","ReminderNotifications"),o),r.g.importAndExecute(f("NewMailNotification"),u),Object(a.a)()||r.g.importAndExecute(f("SocialActivityNotification"),c))}function f(e,n){return{subscriptionId:n||e,requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:e}}}t.d(n,"d",(function(){return d})),t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c}))},5991:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(38);n.default=function(e){return r.makeServiceRequest("GetMailboxJunkEmailConfiguration",{},e)}},6162:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"c",(function(){return u})),t.d(n,"b",(function(){return c})),t.d(n,"e",(function(){return a})),t.d(n,"d",(function(){return s}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(48),t.e(278)]).then(t.bind(null,8696))})),o=new r.a(i,(function(e){return e.loadGroupAction})),u=new r.a(i,(function(e){return e.onAfterNewGroupSelectedAction})),c=new r.a(i,(function(e){return e.onAfterGroupDetailsSucceededAction})),a=new r.a(i,(function(e){return e.setGroupIsSubscribedAction})),s=new r.a(i,(function(e){return e.setGroupIsMemberAction}))},6256:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(5),t.e(6),t.e(265)]).then(t.bind(null,8681))})),o=new r.b(i,(function(e){return e.editGroup}))},6257:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(5),t.e(6),t.e(266)]).then(t.bind(null,8682))})),o=new r.a(i,(function(e){return e.editGroup}))},6651:function(e,n,t){"use strict";var r=t(73),i=t(1753),o=t(18),u=t(93),c=t(224),a=t(223),s=t.n(a),d=t(194),f=t.n(d),l=t(5502),b=Object(u.action)("initializeFocusedInboxConfig")((function(){if(Object(o.a)().UserOptions.IsFocusedInboxFeatureSupported){var e=Object(o.a)().UserOptions,n=null!=e.IsFocusedInboxEnabled,t=null!=e.IsFocusedInboxOnLastUpdateTime?new Date(e.IsFocusedInboxOnLastUpdateTime).getTime():null,r=null!=e.IsFocusedInboxOnLastUpdateTime?new Date(e.IsFocusedInboxOnAdminLastUpdateTime).getTime():null;(!n||null!=t&&null!=r&&r>t)&&(Object(o.a)().UserOptions.IsFocusedInboxEnabled=e.FocusedInboxServerOverride,Object(o.a)().UserOptions.IsFocusedInboxOnLastUpdateTime=e.IsFocusedInboxOnAdminLastUpdateTime,Object(c.a)("OWA.UserOptions",[s()({DictionaryKey:f()({Type:"String",Value:["IsFocusedInboxEnabled"]}),DictionaryValue:f()({Type:"Boolean",Value:[String(e.FocusedInboxServerOverride)]})}),s()({DictionaryKey:f()({Type:"String",Value:["IsFocusedInboxOnLastUpdateTime"]}),DictionaryValue:f()({Type:"String",Value:[e.IsFocusedInboxOnAdminLastUpdateTime]})})]),Object(o.a)().UserOptions.IsFocusedInboxEnabled&&Object(l.a)())}}));t.d(n,"b",(function(){return v})),t.d(n,"c",(function(){return O})),t.d(n,"a",(function(){return b}));var p=new r.c((function(){return t.e(247).then(t.bind(null,14146))})),v=new r.a(p,(function(e){return e.setFocusedInboxOnOff}));function O(){Object(i.subscribe)("saveFocusInboxOptionStitchName",(function(e){return v.importAndExecute(e,!0)}))}},7738:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return t.e(478).then(t.bind(null,9465))})),o=new r.a(i,(function(e){return e.loadSignature}))},8040:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(1),t.e(5),t.e(11),t.e(15),t.e(258)]).then(t.bind(null,9466))})),o=new r.b(i,(function(e){return e.addGroupMember}))},8041:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(5),t.e(6),t.e(259)]).then(t.bind(null,9467))})),o=new r.a(i,(function(e){return e.addGroupMember}))},8053:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(884);function i(e,n){var t=Object(r.getPersonaFromPersonIdOrEmailAddress)(e,n),i=t;if(null==i?void 0:i.favoriteId)return i.favoriteId;var o=t;return(null==o?void 0:o.id)?o.id:void 0}},8095:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var r=t(0),i=t(8096),o=t(972),u=t(2159),c=t(456),a=t(32),s=t(19);function d(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.a.import()];case 1:return e=t.sent(),n=(null===window||void 0===window?void 0:window.location)?window.location.pathname:null,[4,e()];case 2:return t.sent(),[4,o.e.importAndExecute({channelEndpoint:Object(c.r)("/owa",n)+"/notificationchannel",pingInterval:3e5,backoffMaximum:64e3,minimumReconnectInterval:1e3,readyCheckTimeout:6e4,handleSessionTimeout:function(){Object(u.b)(Object(a.a)(),Object(s.g)())}})];case 3:return t.sent(),[2]}}))}))}},8096:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return t.e(376).then(t.bind(null,9433))})),o=new r.b(i,(function(e){return e.initializeNotificationDiagnostics}))},8097:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(0),t.e(2),t.e(3),t.e(635),t.e(354)]).then(t.bind(null,9463))})),o=new r.a(i,(function(e){return e.initializeMailOptinService}))},8098:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(73),i=t(5519);t.d(n,"b",(function(){return i.a}));var o=new r.c((function(){return t.e(558).then(t.bind(null,9458))})),u=new r.b(o,(function(e){return e.getActionByFilter}))},841:function(e,n,t){"use strict";t.d(n,"s",(function(){return o})),t.d(n,"A",(function(){return u})),t.d(n,"d",(function(){return c})),t.d(n,"v",(function(){return a})),t.d(n,"y",(function(){return s})),t.d(n,"z",(function(){return d})),t.d(n,"x",(function(){return f})),t.d(n,"w",(function(){return l})),t.d(n,"e",(function(){return b})),t.d(n,"f",(function(){return p})),t.d(n,"h",(function(){return v})),t.d(n,"l",(function(){return O})),t.d(n,"B",(function(){return m})),t.d(n,"j",(function(){return j})),t.d(n,"t",(function(){return w})),t.d(n,"u",(function(){return g})),t.d(n,"a",(function(){return h})),t.d(n,"k",(function(){return S})),t.d(n,"r",(function(){return I})),t.d(n,"i",(function(){return A})),t.d(n,"b",(function(){return y})),t.d(n,"m",(function(){return C})),t.d(n,"c",(function(){return E})),t.d(n,"g",(function(){return _})),t.d(n,"q",(function(){return P})),t.d(n,"n",(function(){return T})),t.d(n,"p",(function(){return F})),t.d(n,"o",(function(){return x}));var r=t(73),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(5),t.e(75),t.e(108)]).then(t.bind(null,3299))})),o=new r.b(i,(function(e){return e.removeExtensibilityNotification})),u=new r.b(i,(function(e){return e.updatePersistentNotifications})),c=new r.b(i,(function(e){return e.closeTaskPaneAddinCommand})),a=new r.b(i,(function(e){return e.triggerAppointmentTimeChangedEvent})),s=new r.b(i,(function(e){return e.triggerRecipientsChangedEvent})),d=new r.b(i,(function(e){return e.triggerRecurrenceChangedEvent})),f=new r.b(i,(function(e){return e.triggerLocationsChangedEvent})),l=new r.b(i,(function(e){return e.triggerAttachmentsChangedEvent})),b=new r.b(i,(function(e){return e.deinitializeAddinsForItem})),p=new r.b(i,(function(e){return e.initializeAddinsForItem})),v=new r.a(i,(function(e){return e.initializeExtensibilityContext})),O=new r.b(i,(function(e){return e.onHostItemChanged})),m=new r.b(i,(function(e){return e.whenItemHasContextualAddinKeywords})),j=new r.b(i,(function(e){return e.launchTranslateCommand})),w=new r.b(i,(function(e){return e.setPersistedAddin})),g=new r.b(i,(function(e){return e.shouldForceOnSendCompliantBehavior})),h=(Object(r.d)(i,(function(e){return e.AddinBarView})),Object(r.d)(i,(function(e){return e.TaskPaneCollection}))),S=new r.b(i,(function(e){return e.onComposeClose})),I=new r.b(i,(function(e){return e.openContextualCallout})),A=new r.b(i,(function(e){return e.launchAddinCommand})),y=new r.b(i,(function(e){return e.observeAddinCommandSurfaceItems})),C=new r.b(i,(function(e){return e.onItemNavigation})),E=new r.b(i,(function(e){return e.allowItemSendEvent})),_=new r.a(i,(function(e){return e.ExecuteEntryPoint})),P=new r.a(i,(function(e){return e.onNewMessageCompose})),T=new r.a(i,(function(e){return e.onNewAppointmentOrganizer})),F=new r.a(i,(function(e){return e.onNewAttachmentOnMessageCompose})),x=new r.a(i,(function(e){return e.onNewAttachmentOnAppointmentOrganizer}))},8635:function(e,n,t){"use strict";var r=t(841),i=t(8095),o=t(0),u=t(37),c=t(8040),a=t(8041),s=t(208),d=t(983),f=t(6256),l=t(6257),b=t(5012),p=t(6162),v=t(915),O=t(1567),m=t(8053),j=t(1430),w=t(999),g=t(833),h=t(2365),S=t(1182),I=t(2943),A=t(1444),y=t(1817),C=t(44),E=t(3397);function _(){var e=Object(E.a)().chatProvider;return 3==e||4==e?P:null}function P(e,n){var t=e.imAddressUrl;A.e.import().then((function(e){var r=e([t],void 0,4);n(r,void 0)}))}var T,F,x,k,N=t(884),R=t(4),U=t(1455),G=function(e){T=e},M=function(e){F=e},L=function(e){x=e},B=function(e){k=e};function V(e){k&&k(e)}Object(R.orchestrator)(U.l,(function(e){T&&T({Smtp:e.groupSmtp,AadObjectId:"",PersonaType:"Group",OlsPersonaId:"",photoUrl:e.photoUrl})})),Object(R.orchestrator)(U.j,(function(e){F&&F({Smtp:e.groupSmtp,AadObjectId:"",PersonaType:"Group",OlsPersonaId:""})})),Object(R.orchestrator)(U.k,(function(e){x&&x({Smtp:e.groupSmtp,AadObjectId:"",PersonaType:"Group",OlsPersonaId:""})})),Object(R.orchestrator)(U.p,(function(e){V(e)})),Object(R.orchestrator)(U.o,(function(e){V(e)}));var D=t(1164);function z(e,n,t){"Group"===e.PersonaType&&Object(u.f)("tri-favorites-roaming")?function(e,n){var t=Object(v.a)().groups.get(e.Smtp.toLowerCase());if(!t)return;Object(N.isGroupInFavorites)(e.Smtp)?n(!1,"Group is already favorited"):N.lazyAddFavoriteGroup.import().then((function(n){return n(e.Smtp,t.basicInformation.DisplayName,"GroupNodeFavoriteButton")})).then((function(){return n(!0,void 0)}))}(e,n):function(e,n,t){if(Object(O.isFavoritingInProgress)(e.Smtp))return void n(!1,void 0);Object(O.addFavoritePersona)(void 0,e.Smtp,t.personaDisplayName,"LivePersonaCard").then((function(){return n(!0,void 0)})).catch((function(e){n(!1,e),O.lazyHandleToggleFavoritePersonaError.importAndExecute(e)}))}(e,n,t)}function q(e,n){"Group"===e.PersonaType&&Object(u.f)("tri-favorites-roaming")?function(e,n){if(!Object(v.a)().groups.get(e.Smtp.toLowerCase()))return;if(Object(N.isGroupInFavorites)(e.Smtp)){var t=Object(w.c)();t.id&&t.id.toLowerCase()==e.Smtp.toLowerCase()&&j.h.importAndExecute(e.Smtp,"groups"),N.lazyRemoveFavoriteGroup.import().then((function(n){return n(e.Smtp,"GroupNodeFavoriteButton")})).then((function(){return n(!0,void 0)}))}else n(!1,"Group is already unfavorited")}(e,n):function(e,n){if(Object(O.isFavoritingInProgress)(e.Smtp))return void n(!1,void 0);var t=Object(m.a)(void 0,e.Smtp);O.lazyRemoveFavoritePersona.importAndExecute(t,"LivePersonaCard").then((function(){return n(!0,void 0)})).catch((function(e){n(!1,e),O.lazyHandleToggleFavoritePersonaError.importAndExecute(e)}))}(e,n)}var H=t(3780),K=t(4336),J=t(1127),W=t(2990),Q=t(5332),$=t(2796),Y=4194304,X=t(839);function Z(e){if(Object(s.a)()){var n=e.ViewStateConfiguration.GlobalFolderViewState;return n&&!JSON.parse(n).IsConversationView?1:0}var t=e.ViewStateConfiguration.FolderViewState,r=Object(X.a)("inbox");if(!r||!t||!t.length)return 0;var i=t.filter((function(e){return JSON.parse(e).FolderId.Id===r}));return 1===((null==i?void 0:i.length)&&i[0]?JSON.parse(i[0]).View:1)?0:1}var ee=t(193),ne=t(913);function te(e){if(function(e){var n,t=e.UserOptions;return Object(s.a)()?!(null===(n=t.ReactOptinSettings)||void 0===n?void 0:n.MailGraduatedFromBeta)||2===t.ClientTypeOptInState||0==(t.NewEnabledPonts&Y):Object(ne.a)(32)}(e))return null;Object(ee.o)("settingUpdate");var n=e.UserOptions;return{GlobalReadingPanePositionReact:n.GlobalReadingPanePosition,ConversationSortOrderReact:n.ConversationSortOrder,GlobalListViewTypeReact:Z(e)}}var re=t(18),ie=t(224),oe=t(223),ue=t.n(oe),ce=t(194),ae=t.n(ce);function se(e){var n;switch(e.UserOptions.ConversationSortOrderReact){case"Chronological":n=1;break;case"Tree":n=2;break;case"NewestOnTop":n=4;break;case"NewestOnBottom":n=8;break;case"ChronologicalNewestOnTop":n=5;break;case"ChronologicalNewestOnBottom":n=9;break;case"TreeNewestOnBottom":n=10}return n}var de=Object(R.mutatorAction)("updateDefaultSettings",(function(e){var n=Object(re.a)();n.UserOptions.GlobalReadingPanePositionReact=e.GlobalReadingPanePositionReact,n.UserOptions.ConversationSortOrderReact=e.ConversationSortOrderReact,n.UserOptions.GlobalListViewTypeReact=e.GlobalListViewTypeReact}));function fe(){var e,n=te(Object(re.a)());n&&(de(n),e=Object(re.a)(),Object(ie.a)("OWA.UserOptions",[ue()({DictionaryKey:ae()({Type:"String",Value:["GlobalReadingPanePositionReact"]}),DictionaryValue:ae()({Type:"Integer32",Value:[""+e.UserOptions.GlobalReadingPanePositionReact]})}),ue()({DictionaryKey:ae()({Type:"String",Value:["ConversationSortOrderReact"]}),DictionaryValue:ae()({Type:"Integer32",Value:[""+se(e)]})}),ue()({DictionaryKey:ae()({Type:"String",Value:["GlobalListViewTypeReact"]}),DictionaryValue:ae()({Type:"Integer32",Value:[""+e.UserOptions.GlobalListViewTypeReact]})}),ue()({DictionaryKey:ae()({Type:"String",Value:["NewEnabledPonts"]}),DictionaryValue:ae()({Type:"Integer32",Value:[""+(e.UserOptions.NewEnabledPonts&~Y)]})})]).then((function(n){"Success"!==n.Body.ResponseMessages.Items[0].ResponseClass||Object(s.a)()||Object(ne.a)(32)||(Object(ne.b)(!0,32),Object(ie.a)("OWA.ViewStateConfiguration",[ue()({DictionaryKey:ae()({Type:"String",Value:["ListViewBitFlags"]}),DictionaryValue:ae()({Type:"Integer32",Value:[""+e.ViewStateConfiguration.ListViewBitFlags]})})]))})))}var le=t(5340),be=t(12),pe=t(2),ve=t(199),Oe=Object(R.createStore)("mailFaviconStore",{unseenMessages:0}),me=Object(be.computed)((function(){return 0===Oe().unseenMessages||Object(g.O)(Object(X.a)("inbox"))?je("resources/images/favicons/mail-seen.ico"):je("resources/images/favicons/mail-unseen.ico")}));function je(e){return Object(ve.resolve)(Object(pe.q)(),e)}var we=t(3512),ge=t(1268),he=t(836),Se=Object(R.mutatorAction)("SET_UNSEEN_COUNT",(function(e){Oe().unseenMessages=e}));Object(R.orchestrator)(we.a,(function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return Object(ge.a)()===Object(he.m)("inbox")&&Se(0),[2]}))}))}));var Ie=t(5640),Ae=t(65);Object(R.orchestrator)(Ie.a,(function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){return(Object(ge.a)()!==Object(he.m)("inbox")||document.hidden)&&("Focused"!==e.notification.InferenceClassification&&Object(Ae.h)().UserOptions.IsFocusedInboxEnabled||Se(Oe().unseenMessages+1)),[2]}))}))})),document&&document.addEventListener("visibilitychange",(function(){Object(ge.a)()!==Object(he.m)("inbox")||document.hidden||Se(0)}));var ye=t(8097),Ce=t(972),Ee=t(7738),_e=t(860),Pe=t(927),Te=t(4335),Fe=t(1950),xe=t(6702),ke=t(5991),Ne=t.n(ke);var Re=t(5014),Ue=t(93),Ge=Object(Ue.action)("getTrustedSendersAndDomains")((function(){Re.a.trustedSendersAndDomains||function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return[2,Ne()().then((function(e){return function(e){return null!=e&&null==e.ErrorMessage?e.Options.TrustedSendersAndDomains:null}(e)}))]}))}))}().then(Object(Ue.action)("updateTrustedSendersAndDomains")((function(e){e&&(Re.a.trustedSendersAndDomains=e)})))})),Me=t(2063),Le=t(1979),Be=t(3324),Ve=t(229);function De(e){!function(){var e=this,n={actionCallbacks:{composeMail:function(n,t,r){return Object(o.__awaiter)(e,void 0,void 0,(function(){var e,i,u,c,a,s;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return e=null,i=!1,u=n?[{EmailAddress:n,Name:n}]:void 0,c=Object(g.C)(),(a=c&&Object(d.b)(c.tableQuery))&&n&&n.toLowerCase()===a.toLowerCase()?[4,b.d.import()]:[3,2];case 1:s=o.sent(),i=!s(),e=a,u=void 0,o.label=2;case 2:return h.c.importAndExecute("LivePersonaCard",e,u,t,r,i),[2]}}))}))},readMail:function(e,n){C.d.info("Persona action callback: readMail"),Object(I.a)(e)},toggleSubscribeToGroup:function(e,n){e.Smtp&&p.e.importAndExecute(e.Smtp,n)},editGroup:function(n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return Object(D.a)()?[4,l.a.importAndExecute(n,"OWA_GroupCard")]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,f.a.import()];case 3:e.sent()(n),e.label=4;case 4:return[2]}}))}))},addGroupMembers:function(n){return Object(o.__awaiter)(e,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return!Object(u.f)("grp-shareable-crud")||Object(s.a)()?[3,2]:[4,a.a.importAndExecute(n,"OWA_GroupCard")];case 1:return e.sent(),[3,4];case 2:return[4,c.a.import()];case 3:e.sent()(n),e.label=4;case 4:return[2]}}))}))},updateMembership:function(n,t,r,i,u){return Object(o.__awaiter)(e,void 0,void 0,(function(){var e,t,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return!n.Smtp||r<=0?[2]:(e=n.Smtp.toLowerCase(),t=Object(g.C)(),i=t&&Object(d.b)(t.tableQuery),e!==i?[2]:[4,p.a.import()]);case 1:return o.sent()(e),[2]}}))}))},getStartChatCallback:_},dataCallbacks:{},dataUpdateBroadcaster:{setGroupUpdateListener:G,setGroupMembersUpdateListener:M,setGroupDeleteListener:L,updatePopupStateListener:B}};n.actionCallbacks.favoritePersona=Object(u.f)("tri-favorites-roaming")?z:void 0,n.actionCallbacks.unfavoritePersona=Object(u.f)("tri-favorites-roaming")?q:void 0,n.dataCallbacks.getIsPersonaFavorited=function(e,n){"Group"===e.PersonaType?n({isFavorited:Object(N.isGroupInFavorites)(e.Smtp)},void 0):n({isFavorited:Object(N.isPersonaInFavorites)(e.OlsPersonaId,e.Smtp)},void 0)},n.dataCallbacks.getPresence=function(e,n){Object(u.f)("fwk-skypeBusinessV2")&&A.f.import().then((function(n){n(e)})),n(Object(y.a)(e),void 0)},Object(S.b)(n)}(),Object(le.b)(me),Me.b.importAndExecute(W.a,{condition:!Object(Le.a)(),task:function(){return Be.a.importAndExecute()}},(function(){return Ee.a.importAndExecute()}),{condition:Object(u.f)("cmp-clp")&&!Object(s.a)(),task:function(){return $.b.importAndExecute()}},{condition:Object(Pe.a)(),task:function(){return Fe.b.importAndExecute()}},{condition:!Object(s.a)(),task:function(){return H.b.importAndExecute()}},(function(){return Ce.f.importAndExecute()}),(function(){return _e.g.importAndExecute()}),{condition:Object(u.f)("rp-linkedInViewProfile"),task:function(){return Q.a.importAndExecute()}},{task:function(){return Te.a.importAndExecute()},condition:Object(Ve.a)()&&Object(u.f)("auth-sharedActivityBasedTimeout")&&Object(re.a)().PolicySettings.IsSharedActivityBasedTimeoutEnabled,idle:e},{task:function(){return r.h.importAndExecute()},condition:Object(u.f)("rp-addins"),idle:e},{task:i.a,idle:e},{task:Ge,idle:e},{condition:Object(u.f)("rp-infoBarBrandSubscription")||Object(u.f)("tri-unsubscribeLV"),task:function(){return Object(J.b)(!0)},idle:e},{task:function(){return xe.c.importAndExecute()},idle:e},{task:function(){return ye.a.importAndExecute()},idle:e},{task:function(){return K.a.importAndExecute()},idle:e},{task:fe,idle:e})}t.d(n,"a",(function(){return De}))},8673:function(e,n,t){"use strict";var r=t(8635),i=t(4208),o=t(37),u=t(1015),c=t(73),a=t(0),s=t(4),d=t(8098),f=t(6651),l=(Object(s.orchestrator)(d.b,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){return f.b.importAndExecute(!1,!1),[2]}))}))})),new c.c((function(){return Promise.all([t.e(1),t.e(35),t.e(318)]).then(t.bind(null,13856))}))),b=new c.a(l,(function(e){return e.loadLightningPrimaryView})),p=t(1567),v=t(1430),O=t(4002),m=t(2602),j=t(3660),w=t(2441),g=t(2935),h=t(5342),S=t(1243),I=t(1448),A=t(7242),y=t(5640),C=t(2063),E=t(1979),_=t(3324),P=t(351),T=t(884);function F(e){Object(r.a)(e),j.c.importAndExecute(g.b(0)),Object(f.c)(),Object(w.h)(),C.b.importAndExecute({condition:Object(E.a)(),task:function(){return _.a.importAndExecute()}},(function(){return p.lazyModule.import()}),h.a,(function(){return S.p.import()}),y.d,{condition:Object(u.d)(),task:function(){O.d.import().then((function(e){e()}))}},(function(){return b.importAndExecute()}),(function(){P.t.importAndExecute().then((function(){(Object(o.f)("tri-favorites-roaming")?Object(a.__spread)(T.favoritesStore.outlookFavorites.values()).some((function(e){return"category"===e.type})):T.favoritesStore.favoriteCategories.size>0)&&P.z.importAndExecute()}))}),(function(){Object(o.d)("tri-upNextV2",(function(){A.b.importAndExecute()}))}),(function(){return i.b.importAndExecute()}),{task:f.a,idle:e},{task:function(){return v.d.importAndExecute()},idle:e},{task:function(){return I.M.importAndExecute()},idle:e},{condition:Object(u.a)(),task:m.b,idle:e})}t.d(n,"a",(function(){return F}))},915:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(4),i=t(12),o=Object(r.createStore)("groupsStore",{groups:new i.ObservableMap})},927:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(18),i=t(37),o=t(1766);function u(){var e=Object(r.a)(),n=null==e?void 0:e.SessionSettings,t=null==n?void 0:n.IsExplicitLogon,u=null==n?void 0:n.IsSubstrateSearchServiceAvailable;return!(o.a.fallbackToFindPeople||!Object(i.f)("rp-3SPeopleSuggestions")||t||!u)}},942:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(4),i=t(982),o=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:i.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},982:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Private=0]="Private",e[e.Public=1]="Public"}(r||(r={}))}}]);
//# sourceMappingURL=owa.MailFunctionalBoot~PostMailDeeplinkBoot.js.map
self.scriptsLoaded['owa.MailFunctionalBoot~PostMailDeeplinkBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFunctionalBoot~PostMailDeeplinkBoot.js'] = (new Date()).getTime();