self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.InlineImageLoader.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[305],{1102:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},1148:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(240);function o(e){return{headers:Object(r.f)(e,"GroupMailbox")}}},1185:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1148),o=n(78),i=n(65),a={};function u(e){var t=e.toLocaleLowerCase();if(!a[t]){var n={type:o.a.GroupMailbox,deprecatedMailboxId:e,userIdentity:Object(i.e)(),mailboxSmtpAddress:e,routingKey:Object(o.c)()+e,returnModernConversationItems:!1,requestOptions:Object(r.a)(e)};a[t]=n}return a[t]}},1187:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return g}));var r=n(0),o=n(8),i=n(418),a=n(1822),u=n.n(a),c=n(18),s=n(193),d=n(44),f=Object(i.b)({timeBetweenRetryInMS:function(){return 3e4}}),l=function(){function e(e,t,n){var i=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.d.warn("Unable to get the download token "+e),e;case 3:return[2]}}))}))}var t,n,o,i,a=this;return Object(r.__generator)(this,(function(u){switch(u.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=f((function(){return Object(r.__awaiter)(a,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}}))}))})).retriableFunc,o=new s.b("AttachmentRefreshDownloadToken"),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,n()];case 2:return u.sent(),o.addCustomData([t]),o.end(),[3,4];case 3:return i=u.sent(),d.d.warn("Retry to refresh token failed: "+i),o.addCustomData([t]),o.endWithError("ServerError",i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}}))}))},this.useDownloadUrlBase=!Object(o.f)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(c.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function m(){return l.getInstance().getDownloadToken()}function h(){return l.getInstance().getUseDownloadUrlBase()}function g(){return l.getInstance().getDownloadUrlBase()}},1238:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"b",(function(){return l})),n.d(t,"h",(function(){return m}));var r="SwitchGroup",o="NavigateFromMeToWe",i="GroupHeader_SendEmail_Button_Clicked",a="GroupHeader_Email_Button_Clicked",u="GroupHeader_Files_Button_Clicked",c="GroupHeader_Calendar_Button_Clicked",s="GroupHeader_Notebook_Button_Clicked",d="GroupHeader_Planner_Button_Clicked",f="GroupHeader_Site_Button_Clicked",l="GroupHeader_CustomLeaveGroup_Button_Clicked",m="GroupHeader_Settings_Button_Clicked"},1379:function(e,t,n){"use strict";var r=n(221),o=n(8),i=n(36),a="/owa/",u="service.svc/s/GetFileAttachment?id={0}",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",l="pdfprint.aspx?id={0}",m="pdfprint.aspx?id={0}&location={1}",h=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var g=n(1187),p=n(208),b=n(48),v=n(2);function w(e,t,n,u,s,f,l,g,p){var b;switch(void 0===s&&(s=0),void 0===f&&(f=0),void 0===l&&(l=!0),void 0===g&&(g=null),void 0===p&&(p=null),n){case 0:b=c;break;case 3:b=m;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&h.indexOf(t.toLowerCase())>=0}(g))return null;b=d;break;default:Object(r.a)(n)}var v=u?f:s;!v&&s&&(v=s);var w=Object(o.b)("{0}{1}{2}&permissionLevel={3}",a,p,Object(o.b)(b,encodeURIComponent(e.Id),encodeURIComponent(t)),v);l&&(w=w+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return w}function O(e,t,n,c,d){var m;switch(void 0===c&&(c=!1),void 0===d&&(d=!0),n){case 0:m=u;break;case 1:m=s;break;case 2:m=f;break;case 3:m=l;break;default:return Object(r.a)(n)}return Object(o.f)(m)?null:Object(o.b)("{0}{1}{2}",function(e,t,n,r,u){if(void 0===u&&(u=!1),!t||!t.Id)return null;var c=Object(o.b)(n,encodeURIComponent(t.Id));if(!Object(g.c)()||u&&"Firefox"===Object(b.a)().browser)return a+c+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var s="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(p.a)()&&(s+="&isc=1");var d=Object(o.b)(s,Object(g.b)(),e,c,window.location.hostname,Object(v.g)()||"unofficial");return r&&(d+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),d+="&token="+Object(g.a)()),d}(e,t,m,d,3===n),c?"&isDownload=true":"","&animation=true")}n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return O}))},13849:function(e,t,n){"use strict";n.r(t);var r=n(1401),o=n(93),i=Object(o.action)("clearInlineImageStore")((function(){r.a.inlineImages={}})),a=n(3407),u=n(3608),c=n(3560),s=Object(o.action)("addInlineImageToStore")((function(e,t){r.a.inlineImages[e]=t})),d=n(1102);function f(e){var t=Object(u.a)(e,a.f),n=Object(u.a)(e,d.c);if(t.length>0&&n.length>0){var r=Object(c.a)(e);r&&s(n,r)}}function l(e,t,n,r,o,i,a){void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a=""),e.addCustomData([t,n,r,o,i,a]),r&&r.length>0?e.endWithError("ClientError"):e.end()}var m="RequestError",h="RequestTimeout",g="RequestAbort",p="ImageZeroBytes",b="ImageInvalidLength",v=[{format:"JPEG",signature:new Uint8Array([255,216,255,224]),mime:/^image\/p?jpe?g$/i,expectedMime:"image/jpeg"},{format:"EXIF",signature:new Uint8Array([255,216,255,225]),mime:/^image\/p?jpe?g$/i},{format:"SPIFF",signature:new Uint8Array([255,216,255,232]),mime:/^image\/p?jpe?g$/i},{format:"CannonEOS",signature:new Uint8Array([255,216,255,226]),mime:/^image\/p?jpe?g$/i},{format:"SamsungD500",signature:new Uint8Array([255,216,255,227]),mime:/^image\/p?jpe?g$/i},{format:"PNG",signature:new Uint8Array([137,80,78,71,13,10,26,10]),mime:/^image\/png$/i,expectedMime:"image/png"},{format:"GIF",signature:new Uint8Array([71,73,70,56]),mime:/^image\/gif$/i,expectedMime:"image/gif"},{format:"TIFF1",signature:new Uint8Array([73,32,73]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF2",signature:new Uint8Array([73,73,42,0]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF3",signature:new Uint8Array([77,77,0,42]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF4",signature:new Uint8Array([77,77,0,43]),mime:/^image\/(x-)?tiff$/i},{format:"BMP",signature:new Uint8Array([66,77]),mime:/^image\/bmp$/i}];function w(e,t){return void 0===t&&(t=!1),new Promise((function(n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){var e=r.status,t=r.getResponseHeader("Content-Type")||"";if(t.length>0){var o=t.indexOf(";");o>0&&(t=t.substr(0,o))}var i="",u=null,c="",s=!1,d="";if(200==e){var f=r.response;if(f&&0!=f.byteLength)if(f.byteLength<10)i=b;else{var l=function(e){for(var t=0;t<v.length;t++)for(var n=v[t],r=0;r<n.signature.length&&n.signature[r]==e[r];r++)if(r==n.signature.length-1)return n;return null}(u=new Uint8Array(r.response,0,10));l&&(c=l.format,(s=t&&l.mime.test(t))||(i=a.l,d=l.expectedMime))}else i=p}n({status:i,responseCode:e,contentType:t,detectedFormat:c,first10BytesBase64:u?O(u):"",mimeMatched:s,expectedMime:d})}},r.ontimeout=function(){n({status:h})},r.onerror=function(){n({status:m})},r.onabort=function(){n({status:g})},t&&(r.withCredentials=!0),r.open("GET",e,!0),r.responseType="arraybuffer",r.send()}))}function O(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var y=new RegExp("^https?://([^/]*)/.*","i"),j=window.location.hostname.toLowerCase();function A(e){if(e){var t=e.ownerDocument||document;return t&&t.documentElement.contains(e)}return!1}var C="onload";function k(e,t,n,r){e.onload=function(e){var t=e.target;_(t),n&&n(t)},e.onerror=function(e){var t=e.target;_(t),r&&r(t)},e.setAttribute(d.b,d.d),e.src=t}function _(e){e.removeAttribute(C),e.removeAttribute(d.b),e.onload=null,e.onerror=null}var T=n(456),I=n(44),D="deeplink/read/",R="/owa/?debugJS=true&viewmodel=ReadMessageItem&InternetMessageID=";function S(e,t,n,r){var o="Please engage nickhu@microsoft.com with below data:\n",i=Object(u.a)(e,a.e);i&&(o+="Deeplink (React): "+x(i,!0)+"\n");var c=Object(u.a)(e,a.d);c&&(o+="Deeplink (MVVM): "+x(c,!1)+"\n");var s=e.src;s&&(o+="Src: "+s+"\n");var f=Object(u.a)(e,d.c);if(f&&(o+="OriginalSrc: "+f+"\n"),n){var l=n.status,m=n.contentType,h=n.detectedFormat,g=n.first10BytesBase64;l&&(o+="Status: "+l+"\n"),m&&(o+="ContentType: "+m+"\n"),h&&(o+="DetectedFormat: "+h+"\n"),g&&(o+="First10Bytes: "+g+"\n"),o+="MimeMatch: "+n.mimeMatched}r&&r>0&&(o+="Retried: "+r),I.d.error("Error loading inline image: "+t+".\n"+o)}function x(e,t){void 0===t&&(t=!0);var n=Object(T.m)();return t?n+Object(T.k)()+D+e:n+R+e}var E=n(193),M=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}","i");function P(e,t,n,r,o,i,a,u,c,s,d,f,l,m){void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a=""),void 0===u&&(u=""),void 0===c&&(c=""),void 0===s&&(s=""),void 0===d&&(d=""),void 0===f&&(f=""),void 0===l&&(l=""),void 0===m&&(m="");var h=[e,t,n,r,o,i,a=function(e){if(!e)return"";var t="",n=e,r=e.indexOf(":");return r>=0&&(t=e.slice(0,r+1),n=e.slice(r+1)),t+(n=n.match(M)?"<GUID>":"<PII>")}(a),u,c,s,d,f,l,m];Object(E.o)("InlineImageLoadError",h),I.d.info("InlineImageLoadError: "+h)}var U,B=n(37),F="DataUri_Success",L="DataUri_RequestFailed",N="DataUri_OnError",G=new RegExp("^data:[a-z]+\\/[a-z-]+;","i");function W(e,t,n,r,o,i){n?r&&r(e):o&&o(e);var a=t.imageType,u=t.perfDataPoint,c=t.howLoad,s=t.context,d=t.loaderCode,f=t.originalSrc,m=t.owaDomain,h=t.downloadDomain,g=t.responseData,p=g.responseCode,b=g.status,v=g.contentType,w=g.detectedFormat,O=g.first10BytesBase64,y=g.mimeMatched,j=n?"":i||b||p.toString();u&&l(u,a,c,j,s,d,n?F:""),n||(P(a,c,j,p.toString(),s,d,f,v,m,h,w,O,y.toString()),Object(B.f)("mc-imageDiagnostics")&&S(e,j,g))}!function(e){e[e.NotStarted=0]="NotStarted",e[e.Pending=1]="Pending",e[e.Completed=2]="Completed"}(U||(U={}));var q=4,H=3,$=1e3,z=2e4,J="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7",V="RetryTimedOut",X=[],Q=null;function Z(e,t,n,r,o){var i={image:e,url:t,retryContext:n,currentRetry:0,status:U.NotStarted,whenQueued:Date.now(),onSuccessCallback:r,onErrorCallback:o};Y(i),X.push(i),Q||(Q=setTimeout((function(){return function e(){if(X.length>0){var t=Date.now(),n=[],r=[],o=[];X.forEach((function(e){e.status!=U.Completed&&(t-e.whenQueued>z?K(e,!1,V):e.status==U.Pending?(o.push(e),n.push(e)):e.status==U.NotStarted&&(r.push(e),n.push(e)))}));var i=q-o.length;i>0&&r.length>0&&(u=r.slice(0,Math.min(i,r.length)))&&u.length>0&&u.forEach((function(e){e.currentRetry++,e.status=U.Pending,A(e.image)?k(e.image,e.url,(function(t){K(e,!0)}),(function(t){e.currentRetry>=H?K(e,!1):Y(e)})):K(e,!1,a.k+"_R"+e.currentRetry)})),X=n}var u;Q=X.length>0?setTimeout((function(){return e()}),$):null}()}),$))}function Y(e){e.status=U.NotStarted,e.image.src=J}function K(e,t,n){if(void 0===n&&(n=""),e.status!=U.Completed){var r=e.image,o=e.onSuccessCallback,i=e.onErrorCallback,a=e.currentRetry;t?o&&o(r):i&&i(r);var u=e.retryContext,c=u.imageType,s=u.perfDataPoint,d=u.howLoad,f=u.context,m=u.loaderCode,h=u.originalSrc,g=u.owaDomain,p=u.downloadDomain,b=u.responseData,v=b.responseCode,w=b.status,O=b.contentType,y=b.detectedFormat,j=b.first10BytesBase64,A=b.mimeMatched,C=t?"":n||w||v.toString();s&&l(s,c,d,C,f,m,a.toString()),t||(P(c,d,C,v.toString(),f,m,h,O,g,p,y,j,A.toString(),a.toString()),Object(B.f)("mc-imageDiagnostics")&&200==v&&S(r,C,b)),e.status=U.Completed}}var ee="InlineImageLoad";function te(){return new E.a(ee,{logEvery:Object(B.f)("ring-dogfood")?1:20,isQos:!0})}var ne="ZeroNaturalWidth";function re(e,t,n,r,o,i){void 0===i&&(i=!1);var c,s=te(),f=null!=(c=t.match(y))&&c.length>1&&c[1].toLowerCase()!=j,m=f?a.o:a.q,h=Object(u.a)(e,d.c),g=Object(u.a)(e,a.c);0==g.length&&(g=a.r);var p="";f&&(e.setAttribute(a.a,a.g),p=a.g),I.d.info("InlineImage: Load attachment, Url: "+t+", crossDomain: "+f+", crossOrigin: "+p);var b=f?j:"",v=f?function(e){var t=e.match(y);return null!=t&&t.length>1?t[1].toLowerCase():j}(t):"";k(e,t,(function(e){r&&r(e);var t=e.naturalWidth>0;l(s,g,m,t?"":ne,n,p),t||P(g,m,ne,"",n,p,h,"",b,v)}),(function(u){var c=a.n;n!=a.h||A(u)?w(t,f).then((function(d){if(i&&200==d.responseCode&&d.mimeMatched)Z(u,t,{imageType:g,howLoad:m,context:n,loaderCode:p,originalSrc:h,owaDomain:b,downloadDomain:v,responseData:d,perfDataPoint:s},r,o);else if(d.status==a.l&&d.expectedMime)!function(e,t,n,r,o){var i=new XMLHttpRequest;i.onload=function(){var t=new FileReader;t.onloadend=function(){if(t.result){var i=t.result.replace(G,"data:"+n.responseData.expectedMime+";");k(e,i,(function(){return W(e,n,!0,r,o)}),(function(){return W(e,n,!1,r,o,N)}))}},t.readAsDataURL(i.response)},i.ontimeout=i.onerror=function(){W(e,n,!1,r,o,L)},e.crossOrigin==a.g&&(i.withCredentials=!0),i.open("GET",t,!0),i.responseType="blob",i.send()}(u,t,{imageType:g,howLoad:m,context:n,loaderCode:p,originalSrc:h,owaDomain:b,downloadDomain:v,responseData:d,perfDataPoint:s},r,o);else{o&&o(u);var f=d.status,w=d.responseCode,O=d.contentType,y=d.detectedFormat,j=d.first10BytesBase64,A=d.mimeMatched;c=f||w.toString(),l(s,g,m,c,n,p),P(g,m,c,w.toString(),n,p,h,O,b,v,y,j,A.toString()),Object(B.f)("mc-imageDiagnostics")&&(404!=w&&0!=w&&200!=w||S(e,c,200==w?d:null))}})):(o&&o(u),c=a.k,l(s,g,m,c,n,p),P(g,m,c,"",n,p,h,"",b,v))}))}var oe=n(119),ie=n(7722),ae=n(1410),ue="naturalwidth",ce="naturalheight",se="width",de="height",fe="px";function le(e,t,n){void 0===n&&(n=!0);var o=Object(u.a)(e,d.a),i=Object(u.a)(e,a.c),c=Object(u.a)(e,d.c),s=c.length>0?r.a.inlineImages[c]:null;if(0==o.length&&!s)return!1;if(s){var f=te();k(e,s,(function(e){he(e),l(f,i,a.p,"",t)}),(function(e){l(f,i,a.p,a.n,t),P(i,a.p,a.n,"",t,"",c,"")}))}else{var m={Id:decodeURIComponent(o),mailboxInfo:Object(ie.a)(e)},h=Object(ae.a)(m.mailboxInfo.routingKey,m,1);if(null!=h&&h.length>0){var g=e.style.display,p=n?function(e){var t="50px",n="50px";e.style.width&&e.style.height?(t=e.style.width,n=e.style.height):e.getAttribute(se)&&e.getAttribute(de)?(t=e.getAttribute(se)+fe,n=e.getAttribute(de)+fe):e.getAttribute(ue)&&e.getAttribute(ce)&&(t=e.getAttribute(ue)+fe,n=e.getAttribute(ce)+fe);var r=Object(oe.g)(),o=document.createElement("div");if(o.style.display="inline-block",o.style.width=t,o.style.height=n,o.style.maxWidth="100%",o.style.maxHeight=e.style.maxHeight,o.style.borderWidth="1px",o.style.borderStyle="dashed",o.style.borderColor=r.themePrimary,o.style.boxSizing="border-box",e.style.display="none",e.parentNode.insertBefore(o,e),e.getAttribute(ue)&&e.getAttribute(ce)){var i=Math.min(parseInt(o.style.width),o.offsetWidth);o.style.height=Math.ceil(i/parseInt(e.getAttribute(ue))*parseInt(e.getAttribute(ce))).toString()}return o}(e):null;re(e,h,t,(function(e){me(p),he(e),e.style.display=g}),(function(e){me(p),e.style.display="inline"}),!0)}else P(i,"",a.m,"",t,"",c,""),e.removeAttribute("src")}return!0}function me(e){(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)}function he(e){var t=e.style;e.hasAttribute("width")||t.width||e.hasAttribute("height")||t.height||(t.maxWidth="100%",t.height="auto")}var ge=n(1628);var pe=n(0),be=n(7723);function ve(e,t){return new Promise((function(n){e.onload=function(t){we(e),n(!0)},e.onerror=function(t){we(e),n(!1)},e.src=t}))}function we(e){e.onload=null,e.onerror=null}var Oe,ye=n(558),je="loadFromImageProxy";function Ae(e,t){if(t.proxyCount%t.logEvery!=0){var n=function(){return Promise.resolve()};return{endWithSuccess:n,endWithFailure:n,addCustomProperty:n}}var r=(new Date).getTime(),o=new E.a(je,{sessionSampleRate:10});return o.addCustomData(Object.values(e)),{endWithSuccess:function(){o.end(void 0,Object(ye.a)(r)?"BackgroundSuccess":"Success")},endWithFailure:o.endWithError,addCustomProperty:o.addCustomProperty}}function Ce(e,t){return Object(pe.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(pe.__generator)(this,(function(o){switch(o.label){case 0:return n=Ae({endpoint:Oe.ModelB},t),[4,Object(be.a)(e)];case 1:return(r=o.sent())?[4,ve(e,r)]:[3,3];case 2:return o.sent()?(n.endWithSuccess(),[2,!0]):(n.endWithFailure("ServerError"),[3,4]);case 3:n.endWithFailure("ClientError"),o.label=4;case 4:return[2,!1]}}))}))}!function(e){e.ModelD="ModelD",e.ModelB="ModelB"}(Oe||(Oe={}));var ke=n(593),_e=n(70),Te=n(65),Ie=n(2),De="p",Re="s",Se="c",xe="b",Ee="https://{0}.services.web.outlook.com/proxy/?u={1}&t={2}&r={3}&s={4}",Me="https://outlookimageproxy.azurewebsites.net",Pe="clientErrorReason";function Ue(e,t,n){return Object(pe.__awaiter)(this,void 0,void 0,(function(){var r,o,i,a,c,s,f;return Object(pe.__generator)(this,(function(l){switch(l.label){case 0:return r=e,t?[4,Ce(e,n)]:[3,2];case 1:l.sent(),r=document.createElement("img"),l.label=2;case 2:if(!(o=Object(u.a)(e,d.c)))return[2,!1];if((i=Ae({endpoint:Oe.ModelD},n)).addCustomProperty("isShadowTraffic",t),a=Object(pe.__read)(Object(ke.getAccessTokenforResourceAsLazy)(Me),2),c=a[0],s=a[1],i.addCustomProperty("tokenCache",c?"warm":"cold"),c)return[3,6];l.label=3;case 3:return l.trys.push([3,5,,6]),[4,s];case 4:return c=l.sent(),[3,6];case 5:return l.sent(),i.addCustomProperty(Pe,1),i.endWithFailure("ClientError"),[2,!1];case 6:return(c?c.length:0)>0?(f=Object(_e.a)(Ee,function(){if(!Object(B.f)("rp-imageProxyOnModelD-sdfSubdomain"))return"imgproxy";switch(Object(Ie.o)()){case"Dogfood":return"imgproxy-sdf";default:return"imgproxy-prod"}}(),encodeURIComponent(o),encodeURIComponent(c),t?Re:De,Object(Te.t)()?Se:xe),[4,ve(r,f)]):[3,8];case 7:return l.sent()?(i.endWithSuccess(),[2,!0]):(i.endWithFailure("ServerError"),[3,9]);case 8:i.addCustomProperty(Pe,2),i.endWithFailure("ClientError"),l.label=9;case 9:return[2,!1]}}))}))}var Be=0,Fe=100;function Le(){var e={proxyCount:Be,logEvery:Fe};return Be++,e}function Ne(e){return t=e,n=Object(u.a)(t,d.c),r=Object(u.a)(t,a.b),!(!n||!r)&&(Object(ge.a)()?Object(B.f)("rp-imageProxyOnModelD")?Ue(e,!1,Le()):Object(B.f)("rp-imageProxyOnModelDShadowing")?Ue(e,!0,Le()):Ce(e,Le()):e.src="",!0);var t,n,r}var Ge="data-imageerror",We="data-outlook-trace",qe="CidTildeWrd",He="AttNotFound",$e=new RegExp("^cid:\\s?~WRD","i"),ze=new RegExp("^cid:","i"),Je=new RegExp("f:([0-9]+)","i"),Ve=new RegExp("t:([0-9]+)","i");function Xe(e,t){var n=Object(u.a)(e,Ge),r=Object(u.a)(e,a.c),o=Object(u.a)(e,d.c);if(n&&n.length>0){var i=n;if(o&&$e.test(o))i=qe;else if(n==He){var c=function(e){var t="";if(e){var n=Je.exec(e),r=Ve.exec(e);if(n&&2==n.length&&r&&2==r.length){var o=parseInt(n[1]),i=parseInt(r[1]);isNaN(o)||isNaN(i)||(0==o?t="PreEWS":o>0&&(o<i?t="MidEWS":o==i&&(t="PostEWS")))}}else t="NoTrace";return t}(Object(u.a)(e,We));c&&(i=He+"_"+c)}!function(e,t,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i="");var a=te(),u=[e,t,n,r,o,i];a.addCustomData(u),n&&n.length>0?a.endWithError("ClientError"):a.end()}(r,"",i,t),P(r,"",i,"",t,"",o,""),e.onload=null,e.removeAttribute("src"),Object(B.f)("mc-imageDiagnostics")&&(n!=He&&0!=n.indexOf("NotImage")||S(e,n))}else if(o&&!ze.test(o)){var s=te();k(e,o,(function(e){l(s,r,"","",t)}),(function(e){l(s,r,"",a.n,t),w(o).then((function(e){var n=e.status,i=e.responseCode,a=e.contentType,u=n||i.toString();P(r,"",u,i.toString(),t,"",o,a)}))}))}}function Qe(e,t,n){var r=t||"";le(e,r,!!n)||Ne(e)||Xe(e,r)}function Ze(e){var t=[e];Object(E.o)("InlineImageAttachmentUpload",t),I.d.info("InlineImageAttachmentUpload: "+t)}n.d(t,"clearInlineImageStore",(function(){return i})),n.d(t,"cacheInlineImage",(function(){return f})),n.d(t,"loadFromAttachmentServiceUrl",(function(){return re})),n.d(t,"loadFromAttachment",(function(){return le})),n.d(t,"loadFromProxy",(function(){return Ne})),n.d(t,"loadFromImageTag",(function(){return Qe})),n.d(t,"logImageLoadError",(function(){return P})),n.d(t,"logImageUpload",(function(){return Ze})),n.d(t,"tryCreateDataURIFromImage",(function(){return c.a}))},1410:function(e,t,n){"use strict";var r=n(1379);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var o=n(1187);n.d(t,"c",(function(){return o.a}))},1422:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(2304);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetClientAccessToken",e,t)}},1423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},1455:function(e,t,n){"use strict";var r=n(1148),o=n(1185),i=n(4),a=Object(i.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),u=Object(i.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(i.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(i.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(i.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),f=n(1238);n.d(t,"n",(function(){return r.a})),n.d(t,"m",(function(){return o.a})),n.d(t,"l",(function(){return a})),n.d(t,"j",(function(){return u})),n.d(t,"p",(function(){return c})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return f.g})),n.d(t,"c",(function(){return f.c})),n.d(t,"d",(function(){return f.d})),n.d(t,"a",(function(){return f.a})),n.d(t,"e",(function(){return f.e})),n.d(t,"f",(function(){return f.f})),n.d(t,"i",(function(){return f.i})),n.d(t,"b",(function(){return f.b})),n.d(t,"h",(function(){return f.h}))},150:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),o)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&t++,a.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(i)if(e[a])continue;var u=r[a],c=u.expire-o;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,u.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},1822:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},2304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},e)}},331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(292),o=n(293),i=n(291),a=n(287);t.getJsonRequestHeader=function(e){return r.default({RequestServerVersion:"Exchange2015",TimeZoneContext:o.default({TimeZoneDefinition:i.default({Id:null!=e?e:"Pacific Standard Time"})})})},t.getExtendedPropertyUri=function(e,t,n){return a.default({PropertySetId:e,PropertyName:t,PropertyType:n})}},3407:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"r",(function(){return d})),n.d(t,"n",(function(){return f})),n.d(t,"m",(function(){return l})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"p",(function(){return p})),n.d(t,"o",(function(){return b})),n.d(t,"q",(function(){return v})),n.d(t,"j",(function(){return w})),n.d(t,"i",(function(){return O}));var r="src",o="data-imagetype",i="crossorigin",a="data-itemid",u="data-inetid",c="data-imageproxyendpoint",s="use-credentials",d="AttachmentByCid",f="OnError",l="NullAttachmentUrl",m="DOMDetached",h="ImageMismatch",g="RP",p="DataUri",b="CrossDomain",v="SameDomain",w="ImageProxySkipForConsumerChild",O="ImageProxyConnectorsAuthTokenFalse"},3560:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(193),o="2d",i="canvas",a="image/png";function u(e){try{var t=document.createElement(i),n=e.naturalWidth,u=e.naturalHeight;if(n>0&&u>0||(Object(r.o)("CreateDataURIMissingNaturalDimensions"),n=e.width,u=e.height),n>0&&u>0)return t.width=n,t.height=u,t.getContext(o).drawImage(e,0,0),t.toDataURL(a)}catch(e){}return null}},3608:function(e,t,n){"use strict";function r(e,t){return e.hasAttribute(t)?e.getAttribute(t):""}n.d(t,"a",(function(){return r}))},389:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},412:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},418:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,o=!1,i=function(a,u){o?u(new Error("The function retry was cancelled")):(r++,e().then((function(e){return a(e)})).catch((function(e){t&&r>=t?u(e):setTimeout((function(){return i(a,u)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return o=!0}}}}function o(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},467:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(412);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},4790:function(e,t,n){"use strict";var r,o,i,a=n(0),u=n(193),c=n(1423),s=n.n(c),d=n(1422),f=n.n(d),l=n(331),m=n(71),h="GetConnectorsLTITokenFailure",g="GetConnectorsLTITokenException",p="GetConnectorsLTITokenNull",b="ConnectorsLtiToken",v="40B852DF-9693-420D-AA7D-10072C9CE077",w=5;function O(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return(e=function(){if(r){if(Date.now()-o<1e3*(r.TTL-w)*60)return r.TokenValue}return null}())?[3,2]:[4,y()];case 1:e=t.sent(),t.label=2;case 2:return[2,e]}}))}))}function y(){return i||(i=new Promise((function(e,t){var n={Header:Object(l.getJsonRequestHeader)(),Body:s()({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:v,TokenType:"Connectors"}]})};f()(n).then((function(n){i=null,n&&"Success"===n.Body.ResponseMessages.Items[0].ResponseClass?(r=n.Body.ResponseMessages.Items[0].Token,o=Date.now(),function(e){if(!e)throw j(p),new Error("getClientAuthToken null");m.set(b,e,{path:"/actions/"})}(r.TokenValue),e(r.TokenValue)):(j(h),t(new Error("getClientAuthToken failed")))})).catch((function(e){i=null,j(g),t(new Error("getClientAuthToken exception: "+e))}))}))),i}function j(e){Object(u.o)(e),r=void 0}var A=n(37),C=n(208),k=n(593),_="https://outlook.office365.com/connectors",T="User.Read";function I(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return!Object(A.f)("rp-actionableMessages-aad-token")||Object(C.a)()?[3,2]:[4,R()];case 1:return[2,e.sent()];case 2:return Object(A.f)("rp-actionableMessages-msa-token")&&Object(C.a)()?[4,D()]:[3,4];case 3:return[2,e.sent()];case 4:return[4,O()];case 5:return[2,e.sent()]}}))}))}function D(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(k.getDelegationTokenForOwa)(T)];case 1:return[2,e.sent()]}}))}))}function R(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(a.__read)(Object(k.getAccessTokenforResourceAsLazy)(_),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}}))}))}n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return I}))},7722:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(8),o=n(1455),i=n(78),a=n(3608),u="explicitlogon";function c(e){var t=Object(a.a)(e,u);return Object(r.f)(t)?Object(i.e)():Object(o.m)(t)}},7723:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),o=n(3407),i=n(4790),a=n(49),u=n(18),c=n(193),s=n(3608),d=n(1102),f="data-connectorsauthtoken",l="u",m="i",h="d",g="ClientId";function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(s.a)(e,d.c),n=Object(s.a)(e,o.b),i=Object(s.a)(e,f),t&&n?Object(u.a)().IsConsumerChild?(Object(c.o)(o.j),[2,t]):"1"!=i?[3,2]:[4,b(n,t)]:[2,""];case 1:return h=r.sent(),[3,3];case 2:h=function(e,t){var n=Object(a.getCookie)(g);if(!n)return null;if("/actions/ei"==e.toLowerCase())return Object(c.o)(o.i),null;return e+"?"+l+"="+encodeURIComponent(t)+"&"+m+"="+encodeURIComponent(n)}(n,t),r.label=3;case 3:return[2,h]}}))}))}function b(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(i.b)()];case 1:return n.sent(),[3,3];case 2:return n.sent(),[2,null];case 3:return[2,e+"?"+l+"="+encodeURIComponent(t)+"&"+h+"="+encodeURIComponent((new Date).toISOString())]}}))}))}}}]);
//# sourceMappingURL=owa.InlineImageLoader.js.map
self.scriptsLoaded['owa.InlineImageLoader.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.InlineImageLoader.js'] = (new Date()).getTime();