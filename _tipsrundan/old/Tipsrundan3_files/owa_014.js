self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Attachments.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[126,13,25,33,46,49],{1004:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1081),a=n(852);function i(e,t){var n=Object(r.a)(e,t);return a.a.tableViewConversationRelations.get(n)}},1005:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1170),a=n(852);function i(){return a.a.tableViews.get(Object(r.a)())}},1008:function(e,t,n){"use strict";var r=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)},a=n(8),i=n(883);function o(e){switch(e.__type){case i.e:return 0;case i.n:return e.IsLink?3:1;case i.i:return 3;case i.g:return 2;case i.h:var t=e;return r(e.EmbeddedItemClass)||Object(a.f)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}n.d(t,"a",(function(){return o}))},1009:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},1014:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return s}));var r=n(5),a=Object(r.Qb)("UTC",4500,8,1),i=Object(r.tb)(a).slice(0,-1);function o(e){return u(e.lastDeliveryOrRenewTimeStamp)}function c(e){return u(e.ReceivedOrRenewTime)}function u(e){return e===s()||new Date(e).getTime()==Object(r.zb)(a)}function s(){try{return new Date(Object(r.zb)(a)).toLocaleString(),Object(r.lc)(a).toString()}catch(e){return null}}},1015:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(65),a=n(37);function i(){return c()&&null!==Object(r.h)().UserOptions.InboxPlusTabs}function o(){return Object(a.f)("tri-inboxPlusDefaultTabs")||Object(a.f)("tri-inboxPlusDefaultTabsControl")||Object(a.f)("tri-inboxPlusEasyOnFocusedExclusion")||Object(a.f)("tri-inboxPlusEasyOnFocusedExclusionControl")}function c(){return Object(a.f)("tri-inboxPlusDefaultTabs")||Object(a.f)("tri-inboxPlusEasyOnFocusedExclusion")}function u(){return Object(a.f)("tri-inboxPlusEasyOnFocusedExclusion")||Object(a.f)("tri-inboxPlusEasyOnFocusedExclusionControl")}},1019:function(e,t,n){"use strict";var r,a=n(73),i=n(1057),o=n(1058),c=n(1909);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.Unknown="Unknown"}(r||(r={}));var u=n(1223),s=n(1199),l=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function d(e){var t=Object(s.a)(e);return t&&-1!==l.indexOf(t.source)}var f=n(1740);function h(e){var t=Object(s.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:d(e)?"newLink":"oldLink"}:null}var m=n(1910);function b(){return Object(m.a)().sharingLinks.size}n.d(t,"o",(function(){return v})),n.d(t,"s",(function(){return g})),n.d(t,"w",(function(){return O})),n.d(t,"u",(function(){return I})),n.d(t,"t",(function(){return w})),n.d(t,"r",(function(){return S})),n.d(t,"v",(function(){return j})),n.d(t,"q",(function(){return y})),n.d(t,"p",(function(){return _})),n.d(t,"y",(function(){return p})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return i.b})),n.d(t,"e",(function(){return i.c})),n.d(t,"g",(function(){return i.d})),n.d(t,"B",(function(){return i.f})),n.d(t,"x",(function(){return i.e})),n.d(t,"C",(function(){return o.e})),n.d(t,"D",(function(){return o.f})),n.d(t,"E",(function(){return o.g})),n.d(t,"A",(function(){return o.c})),n.d(t,"f",(function(){return o.b})),n.d(t,"z",(function(){return c.b})),n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"n",(function(){return u.c})),n.d(t,"m",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"k",(function(){return h})),n.d(t,"j",(function(){return b}));var p=new a.c((function(){return Promise.all([n.e(7),n.e(13),n.e(47),n.e(319)]).then(n.bind(null,13836))})),v=new a.b(p,(function(e){return e.addRecipientsIntoLink})),g=new a.b(p,(function(e){return e.removeRecipientsFromLink})),O=new a.b(p,(function(e){return e.updateRecipientPermissionInfos})),I=new a.b(p,(function(e){return e.setGetPermissionInfoFailure})),w=new a.b(p,(function(e){return e.resetSharingRecipientsInfo})),S=new a.b(p,(function(e){return e.ignoreSharingTip})),j=new a.b(p,(function(e){return e.setLinkActionStatus})),y=new a.b(p,(function(e){return e.getSharingTipRecipientInfo})),_=new a.b(p,(function(e){return e.createCloudFileFromSharingLink}))},1021:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&a(e.AttachmentId.Id)}function a(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},1024:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(937),a=function(e,t){var n="string"==typeof e?Object(r.a)(e):e;if(!n||!n.GroupResources)return null;var a=n.GroupResources.filter((function(e){return e.Name===t}));return!a||a.length<1?null:a},i=function(e,t){var n=a(e,t);return n&&0!=n.length?n[0].Url:null}},1026:function(e,t,n){"use strict";var r=n(2423),a=n(1745),i=n(2593),o=n(93);t.a=Object(o.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(i.a)(e)?Object(a.a)(e,!0):Object(a.a)(e,!1)}))},1032:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(r||(r={}))},1036:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("SET_LOADING_STATE_FOR_FOLDER_TREE",(function(e,t){return{folderTreeId:e,loadingState:t}}))},1037:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("ON_FIND_FOLDER_RESPONSE",(function(e,t,n,r,a,i){return{rootFolder:e,distinguishedFolderId:t,treeType:n,principalSMTPAddress:r,displayName:a,folderTreeIdentifier:i}}))},1038:function(e,t,n){"use strict";n.d(t,"n",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"p",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"t",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return p})),n.d(t,"j",(function(){return v})),n.d(t,"i",(function(){return g})),n.d(t,"l",(function(){return O})),n.d(t,"k",(function(){return I})),n.d(t,"c",(function(){return w})),n.d(t,"o",(function(){return S})),n.d(t,"s",(function(){return j})),n.d(t,"b",(function(){return y})),n.d(t,"m",(function(){return _})),n.d(t,"h",(function(){return C}));var r=n(73),a=n(1227);n.d(t,"u",(function(){return a.a}));var i=n(1228);n.d(t,"v",(function(){return i.a}));n(907),n(977);var o=new r.c((function(){return Promise.all([n.e(12),n.e(76),n.e(603),n.e(7),n.e(126)]).then(n.bind(null,2436))})),c=new r.a(o,(function(e){return e.initializeAttachments})),u=new r.a(o,(function(e){return e.reinitializeAttachments})),s=new r.a(o,(function(e){return e.setInlineAttachmentStatus})),l=new r.a(o,(function(e){return e.addAttachmentIntoWellBeforeUpload})),d=new r.b(o,(function(e){return e.refreshSharingTipsAttachmentWell})),f=new r.b(o,(function(e){return e.createAttachmentsViaQueueManager})),h=new r.b(o,(function(e){return e.createAttachmentsFromRecentAttachments})),m=new r.a(o,(function(e){return e.deleteAttachmentViaQueueManager})),b=new r.b(o,(function(e){return e.createAttachmentFullViewStateAndStoreBackingModel})),p=new r.b(o,(function(e){return e.createAttachmentFullViewState})),v=new r.b(o,(function(e){return e.getAttachmentWellInitialValue})),g=new r.b(o,(function(e){return e.getAttachmentWellForCompose})),O=new r.b(o,(function(e){return e.getConversationAttachmentWellInitialValue})),I=(new r.b(o,(function(e){return e.getMaxClassicAttachmentsSize})),new r.b(o,(function(e){return e.getAvailableLocalAttachmentSize}))),w=new r.b(o,(function(e){return e.createAttachmentFileFromExistingMailboxAttachment})),S=new r.a(o,(function(e){return e.mergeToConversationAttachmentWell})),j=new r.a(o,(function(e){return e.sortConversationAttachmentWell})),y=new r.a(o,(function(e){return e.convertImageViewAttachmentToInlineAttachment})),_=new r.b(o,(function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),C=new r.b(o,(function(e){return e.getAllValidAttachments}))},1042:function(e,t,n){"use strict";var r=n(93),a=n(839),i=n(863);t.a=Object(r.select)({folderTable:function(){return Object(i.a)().folderTable}})((function(e,t){var n=Object(a.a)(e);return n||(n=e),t.folderTable.get(n).FolderId}))},1043:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return m}));var r=n(8),a=n(1154),i=n(44),o=n(861),c=n(842),u=n(18),s=n(208);function l(e){try{if(!e)return null;for(var t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),o=0;o<n;o++)r[o]=t.charCodeAt(o);return Object(a.a)(r)}catch(t){return i.d.error("getMailboxGuidFromEwsId : conversion failed for id "+e+" with error "+t),null}}function d(e,t){if(!e||!t)return null;return r.b("{0}@{1}",e,t)}function f(e){if(Object(s.a)()||!e)return null;var t=Object(u.a)().SessionSettings,n=Object(o.a)(),r=n&&n.get(e);return r||e===c.d?e===c.d?d(t.ArchiveMailboxGuid,t.OrganizationDomain):r.treeType===c.c?d((null==r?void 0:r.ReplicaList)?r.ReplicaList[0]:t.ArchiveMailboxGuid,t.OrganizationDomain):r.treeType===c.j?d(l(e),t.OrganizationDomain):null:null}function h(e){if(Object(s.a)()||!e)return null;var t=Object(o.a)(),n=t&&t.get(e);return n&&n.treeType===c.c&&n.ReplicaList?n.ReplicaList[0]:null}function m(e){if(Object(s.a)()||!e)return null;var t=Object(u.a)().SessionSettings,n=l(e);return n===t.MailboxGuid?null:d(n,t.OrganizationDomain)}},1044:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return f}));var r,a=n(1348),i=n(1159),o=n(857),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(i.a)(e+"_16x16"),small:Object(i.a)(e+"_20x20"),medium:Object(i.a)(e+"_32x32"),large:Object(i.a)(e+"_64x64"),cdn:Object(a.a)(e+"_16x16")},c[e])}var s="generic",l=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".apk":"exe",".application":"exe",".app":"exe",".appref-ms":"exe",".appx":"exe",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".ipa":"exe",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":s,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".msi":"exe",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xap":"exe",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"});function f(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(i.a)("folder_20x20"),medium:Object(i.a)("folder_32x32"),large:Object(i.a)("folder_64x64"),cdn:Object(a.a)("folder_16x16")};var c=null,f=Object(o.b)(e);return f&&(c=l[f.toLowerCase()]),!c&&n&&n in d&&(c=d[n]),u(c||s)}},1057:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(4),a=Object(r.action)("ADD_SHARING_LINK",(function(e,t,n,r,a,i){return{linkId:e,url:t,sharingLinkIds:n,response:r,source:a,providerType:i}})),i=Object(r.action)("SHARING_LINK_REMOVED",(function(e,t){return{linkId:e,sharingLinkIds:t}})),o=Object(r.action)("DELETE_LINK",(function(e){return{linkId:e}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(e,t,n){return{linkId:e,providerId:t,isTryAgain:n}})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(function(e,t,n){return{linkId:e,recipientInfos:t,composeId:n}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(e,t){return{linkId:e,linkIdContainer:t}}))},1058:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(4),a=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(e,t){return{linkId:e,sharingDialogResponse:t}})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(e,t){return{linkId:e,newPermission:t}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(e,t,n,r){return{linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(e,t){return{linkId:e,actionStatus:t}})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(e,t,n,r,a,i,o,c){return{linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:a,providerType:i,composeId:o,recipientInfos:c}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(e,t){return{linkId:e,linkModel:t}})),l=Object(r.action)("TOKEN_UNAVAILABLE",(function(e){return{linkId:e}}))},1067:function(e,t,n){"use strict";var r=n(919),a=n(1031),i=n(1814),o=n(4),c=n(1178),u=n(1174),s={shouldShow:!1,viewState:Object(i.a)(),extendedViewState:{previewMode:r.b.Unsupported,attachmentId:null,selectionSource:c.a.MailList,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},editState:{mode:u.a.View,editAllowed:!1,itemId:null,isDraft:!1},customPreviewState:null,eventManager:new a.a,pendingPreviewOperation:null,pendingNavigation:null,readingPaneState:null,composeId:null,customization:null,isInvisible:!1,shouldUseFakeRightHandSide:!1,isUsingFakeRightHandSide:!1,shouldHideReadingPaneOutsideSxS:!1,attachmentViewStateIdFromListView:null,sessionPreviewCount:0,sessionStartTime:0,meetingMessageAddToCalendarStatus:1};s.viewState.previewPane=null;var l=Object(o.createStore)("sxsstore",s);t.a=l()},1081:function(e,t,n){"use strict";function r(e,t){return t+e}n.d(t,"a",(function(){return r}))},1084:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(938),a=n(842);function i(){return Object(r.a)(a.i)}},1085:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(938),a=n(842);function i(){return Object(r.a)(a.d)}},1086:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(938);function a(e){return Object(r.a)(e)}},1095:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r="Success";function a(e){return e&&e.ResponseClass==r}},1099:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(549),a=n.n(r),i=n(550),o=n.n(i),c=n(454),u=n.n(c),s=n(155);function l(e,t,n,r,i,c){var l=Object(s.getJsonRequestHeader)();r&&(l.RequestServerVersion=r);var d=e.map((function(e){return u()({Id:e})}));return a()({Header:l,Body:o()({ItemShape:t,ItemIds:d,ShapeName:n,InternetMessageId:c})},i).then((function(e){return e.Body.ResponseMessages.Items}))}},1110:function(e,t,n){"use strict";n.r(t);var r=n(1004),a=n(1196),i=n(1344),o=n(1014),c=n(193),u=n(1322),s=n(846),l=n(44);function d(e){return function(e,t){return h({isPinned:t,returnTime:e.returnTime,receivedOrRenewedTime:e.lastDeliveryOrRenewTimeStamp,receivedTime:e.lastDeliveryTimeStamp})}(e,Object(o.b)(e))}function f(e){return function(e,t){return h({isPinned:t,returnTime:e.ReturnTime,receivedOrRenewedTime:e.ReceivedOrRenewTime,receivedTime:e.DateTimeReceived})}(e,Object(o.c)(e))}function h(e){var t,n=e.returnTime,r=e.receivedOrRenewedTime,a=e.receivedTime,i=e.isPinned;return!!n||!i&&r&&(t=a,!(new Date(r).setMilliseconds(0)==new Date(t).setMilliseconds(0)))}function m(e,t){return W(e,t,1)}function b(e,t){return W(e,t,2)}function p(e,t){return W(e,t,3)}function v(e,t){return W(e,t,10)}function g(e,t){return W(e,t,13)}function O(e,t){return W(e,t,5)}function I(e,t){return W(e,t,25)}function w(e,t){return W(e,t,6)}function S(e,t){return W(e,t,4)}function j(e,t){return W(e,t,14)}function y(e,t){return W(e,t,16)}function _(e,t){return W(e,t,15)}function C(e,t){return W(e,t,24)}function A(e,t){return W(e,t,17)}function x(e,t){return W(e,t,18)}function T(e,t){return W(e,t,26)}function E(e,t){return W(e,t,23)}function P(e,t){return W(e,t,22)}function D(e,t){return W(e,t,21)}function k(e,t){return W(e,t,19)}function R(e,t){return W(e,t,8)}n.d(t,"getCanDelete",(function(){return m})),n.d(t,"getCategories",(function(){return b})),n.d(t,"getConversationId",(function(){return p})),n.d(t,"getIsPinned",(function(){return v})),n.d(t,"getItemIds",(function(){return g})),n.d(t,"getExecuteSearchSortOrder",(function(){return O})),n.d(t,"getUniqueSenders",(function(){return I})),n.d(t,"getFlagStatus",(function(){return w})),n.d(t,"getEffectiveMentioned",(function(){return S})),n.d(t,"getLastDeliveryOrRenewTimeStamp",(function(){return j})),n.d(t,"getLastModifiedTimeStamp",(function(){return y})),n.d(t,"getLastDeliveryTimeStamp",(function(){return _})),n.d(t,"getSubject",(function(){return C})),n.d(t,"getLastSenderMailbox",(function(){return A})),n.d(t,"getLastSenderSMTP",(function(){return x})),n.d(t,"getUnreadCount",(function(){return T})),n.d(t,"getSize",(function(){return E})),n.d(t,"getRowIdString",(function(){return P})),n.d(t,"getRowClientItemId",(function(){return D})),n.d(t,"getParentFolderId",(function(){return k})),n.d(t,"getInstrumentationContext",(function(){return R})),n.d(t,"getIsDraft",(function(){return F})),n.d(t,"getIsSubmitted",(function(){return N})),n.d(t,"getIsSnoozed",(function(){return M})),n.d(t,"getValidCouponIndexes",(function(){return L})),n.d(t,"getImportance",(function(){return B})),n.d(t,"getArchiveTag",(function(){return V})),n.d(t,"getPolicyTag",(function(){return U}));var F=function(e,t){return W(e,t,9)},N=function(e,t){return W(e,t,12)};function M(e,t){return W(e,t,11)}function L(e,t){return W(e,t,27)}function B(e,t){return W(e,t,7)}function V(e,t){return W(e,t,0)}function U(e,t){return W(e,t,20)}function W(e,t,n){switch(t.tableQuery.listViewType){case 0:return function(e,t,n){var a,i=Object(r.a)(e,t.id);if(!i)return H("getConversationProperty should not be called on conversation that not in cache.",n),null;var c=i.id,l=Object(u.a)(c),f=s.x.conversations.get(c),h=s.x.items.get(i.itemIds[0]);switch(n){case 22:return i.id;case 21:return l.clientId;case 3:return c;case 6:return i.flagStatus;case 10:return o.b(i);case 13:return i.itemIds;case 14:return i.lastDeliveryOrRenewTimeStamp;case 15:return i.lastDeliveryTimeStamp;case 16:return i.lastModifiedTimeStamp;case 26:return i.unreadCount;case 17:return null===(a=i.lastSender)||void 0===a?void 0:a.Mailbox;case 18:return i.lastSender&&i.lastSender.Mailbox.EmailAddress;case 5:return i.executeSearchSortOrder;case 19:return 1===t.tableQuery.type?i.parentFolderId:t.tableQuery.folderId;case 24:return l.subject;case 25:return i.uniqueSenders;case 23:return l.size;case 4:return i.effectiveMentioned;case 8:return i.instrumentationContext;case 2:return i.categories;case 1:return null==f?void 0:f.canDelete;case 27:return l.validCouponIndexes;case 7:return i.importance;case 0:return null==h?void 0:h.ArchiveTag;case 20:return null==h?void 0:h.PolicyTag;case 11:return d(i);case 12:case 9:default:return null}}(e,t,n);case 1:return function(e,t,n){var r,c=Object(a.a)(e,t.id);if(!c)return H("getItemProperty: item not in item relations.",n),null;var u=c.clientId,l=s.x.items.get(u.Id);if(!l)return H("getItemProperty: Item not in item cache.",n),null;var d=Object(i.a)(l)?l:null,h=null===(r=null==d?void 0:d.From)||void 0===r?void 0:r.Mailbox;switch(n){case 22:return u.Id;case 21:return u;case 3:return d.ConversationId.Id;case 6:return l.Flag?l.Flag.FlagStatus:null;case 10:return o.c(l);case 13:return[u.Id];case 14:return l.ReceivedOrRenewTime;case 15:return l.DateTimeReceived;case 16:return l.LastModifiedTime;case 26:return d&&!d.IsRead?1:0;case 17:return h;case 18:return null==h?void 0:h.EmailAddress;case 25:return h?[h.Name]:null;case 5:return c.executeSearchSortOrder;case 19:return l.ParentFolderId.Id;case 24:return l.Subject;case 23:return l.Size;case 4:return l.MentionedMe;case 9:return l.IsDraft;case 12:return l.IsSubmitted;case 8:return c.instrumentationContext;case 2:return l.Categories;case 1:return l.CanDelete;case 27:return l.validCouponIndexes;case 7:return l.Importance;case 0:return l.ArchiveTag;case 20:return l.PolicyTag;case 11:return f(l);default:return null}}(e,t,n);default:return null}}function H(e,t){var n=Object(c.q)(),r=e+" PropertyType:"+t;n&&(r+=" Scenario:"+n.eventName),l.d.error(r)}},1114:function(e,t,n){"use strict";var r=n(4),a=n(1222),i=Object(r.mutatorAction)("setJoinButtonState",(function(e,t){a.a.groupActionState.set(e.toLowerCase(),t)}));t.a=i},1128:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1008);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},1131:function(e,t,n){"use strict";var r=n(4),a=n(1221),i=Object(r.mutatorAction)("setFollowButtonState",(function(e,t){a.a.groupActionState.set(e.toLowerCase(),t)}));t.a=i},1132:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(951),a=n(1222);function i(e){e=e.toLowerCase();var t=a.a.groupActionState;return t.has(e)?t.get(e):r.a.None}},11352:function(e){e.exports=JSON.parse('{"a":"xcb"}')},11353:function(e,t,n){var r=n(11354),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11354:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,"._npEUFSaUqNtPLt0UyUb0{-o-object-fit:cover;object-fit:cover}html[dir] ._npEUFSaUqNtPLt0UyUb0{border-radius:2px}.e-PVICp87qgYYsuOeWMWS{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex}._1yQzYUvZgwigUgnPOCNAQT{position:absolute}._3oAC7cNbEZu1KV-6eDWQNE,._1yQzYUvZgwigUgnPOCNAQT{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={thumbnail:"_npEUFSaUqNtPLt0UyUb0",spanContainer:"e-PVICp87qgYYsuOeWMWS",notLoadedContainer:"_1yQzYUvZgwigUgnPOCNAQT",errorLoadingContainer:"_3oAC7cNbEZu1KV-6eDWQNE"}},1138:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1139:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(951),a=n(1221);function i(e){e=e.toLowerCase();var t=a.a.groupActionState;return t.has(e)?t.get(e):r.a.None}},1143:function(e,t,n){"use strict";var r=n(0),a=n(1878),i=n(1824),o=n(1026),c={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function l(e,t,n,r){var a=new u(e,t,n);c[r.Id]=a,a.start()}var d=n(2634),f=n(4);Object(f.orchestrator)(a.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:a=e.attachment,Object(o.a)(a,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(d.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,a){s(e,!0),Object(i.a)(n,a),Object(o.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var a}))}))}));var h=n(977),m=n(2161),b=n(2499),p=n.n(b),v=n(3122),g=n.n(v);function O(e,t,n,r,a){var i=function(e,t,n,r,a){return p()({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return g()({requestObject:i})}var I=n(193),w=n(876),S=n(1663),j=n(972),y=n(93),_={},C=Object(y.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=new I.a("AttachmentConvertClassicToCloudy"),function(e){Object(o.a)(e,5,8)}(e),i=function(t){if(x(e,t.ResultCode),T(a,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){x(e,1),n(!1,null),T(a,e.attachmentId,1,t)},[4,A(e.attachmentId,t,i,c)];case 1:return r.sent(),[2]}}))}))}));function A(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c,u,s,l;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return[4,Object(S.a)(n)];case 1:i=r.__read.apply(void 0,[d.sent(),4]),o=i[0],c=i[1],u=i[2],s=i[3],_[e.Id]=o,d.label=2;case 2:return d.trys.push([2,4,,5]),[4,O(e.Id,t,o,s,o)];case 3:return d.sent(),[3,5];case 4:return l=d.sent(),a(l.message),j.h.importAndExecute(c,u),[3,5];case 5:return[2]}}))}))}function x(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,9)}delete _[e.attachmentId.Id]}function T(e,t,n,r){var a=Object(w.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var E={name:"CancelConvertClassicToCloudy"},P={name:"CancelConvertCloudyToClassic"},D=n(2500),k=n.n(D),R=n(3123),F=n.n(R);function N(e){var t=function(e){return k()({cancellationId:e})}(e);return F()(t)}var M=n(74),L=Object(M.d)("cancelConvertClassicToCloudy",E)((function(e){var t,n=(t=e.attachmentId.Id,_[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(o.a)(e,5,10),N(n)})),B=n(1419),V=Object(y.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),U=n(2152),W=n(1746),H=(n(1745),n(1317)),z=n(1792),q=n(919),G=n(2056),J=n(2422),Q=n(2883),X=n(1128),Y=Object(y.action)("updateAttachment")((function(e,t,n,a,i){Object(J.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},a.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object(X.b)(a)){var u=n;u.AttachLongPathName=a.AttachLongPathName,u.PermissionType=a.PermissionType,u.ProviderType=a.ProviderType,u.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(G.a)([{attachmentId:c,attachment:n,permissionInfo:i}],!1),e.attachmentId=c,Object(z.a)(e))Object(W.a)(e,1);else{Object(q.g)(e,!1),setTimeout((function(){V(e,1.1)}),500),Object(o.a)(e,0,0);var s=Object(w.a)(c);Object(H.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(Q.a)(c,e.isReadOnly,!0)}})),K=n(2502),Z=n.n(K),$=n(3125),ee=n.n($);function te(e,t,n,r,a,i,o,c){var u=function(e,t,n,r,a,i,o,c){return Z()({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:i,attachmentDataProviderId:c,PermissionLevel:o})}(e,t,n,r,a,i,o,c);return ee()({requestObject:u})}function ne(e){return ce(Object(w.a)(e).model.Size)}function re(e){return 2856+.00145*e}function ae(e){return 4*ce(e)}function ie(e){return 4*ce(e)}function oe(e){return 2*ce(e)}function ce(e){return Math.round(e/256)}var ue=n(2735),se=n.n(ue),le={},de=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,a,i){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:i}})),fe=de;function he(e,t,n,a,i,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,l,d,f;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return[4,Object(S.a)(i)];case 1:c=r.__read.apply(void 0,[h.sent(),4]),u=c[0],s=c[1],l=c[2],d=c[3],le[e.Id]=u,h.label=2;case 2:return h.trys.push([2,4,,5]),[4,te(e.Id,t,u,d,u,n,a)];case 3:return h.sent(),[3,5];case 4:return f=h.sent(),o(f.message),j.h.importAndExecute(s,l),[3,5];case 5:return[2]}}))}))}function me(e,t){switch(t){case 0:break;case 11:Object(o.a)(e,0,0);break;default:Object(o.a)(e,0,12)}delete le[e.attachmentId.Id]}function be(e,t,n,r,a){var i,o=Object(w.a)(t);e.addCosmosOnlyData(JSON.stringify({size:o.model.Size,attachmentId:null===(i=o.model.AttachmentId)||void 0===i?void 0:i.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}Object(f.orchestrator)(de,(function(e){var t=e.attachment;!function(e,t,n,a,i,c){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new I.a("AttachmentConvertCloudyToClassic"),function(e){Object(o.a)(e,6,11)}(e),s=function(t){if(me(e,t.ResultCode),be(u,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=se()({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});i(!0,n)}else i(!1,null);return!0},l=function(t){me(e,1),i(!1,null),be(u,e.attachmentId,1,t,c)},[4,he(e.attachmentId,t,n,a,s,l)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),l(ne(t.attachmentId),.1,(function(e){V(t,e)}),t.attachmentId)}));var pe=n(2503),ve=n.n(pe),ge=n(3126),Oe=n.n(ge);function Ie(e){var t=function(e){return ve()({cancellationId:e})}(e);return Oe()(t)}var we=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(M.c)(P,{attachmentViewState:e})})),Se=we;Object(f.orchestrator)(we,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,le[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(o.a)(e.attachmentViewState,6,10),Ie(n)}));var je=n(971),ye=n(1312),_e=n(914);function Ce(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,ye.h.import()];case 1:return n.sent()(e.model.AttachLongPathName,0).then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(je.e)(e.model,!0),[4,_e.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return a=r.sent(),_e.m.importAndExecute(e.id,a),Object(_e.p)(e.id),[2]}}))}))})),[2]}}))}))}var Ae=n(37),xe=n(857);function Te(e,t,n){if(e&&t===_e.a.providers.ONE_DRIVE_PRO&&(Object(Ae.f)("doc-SxS-jsApi-ODB-Base")||Object(Ae.f)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(Ae.f)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(xe.e)(r)){case xe.a.Word:return Object(Ae.f)("doc-SxS-jsApi-ODB-Word");case xe.a.Excel:return Object(Ae.f)("doc-SxS-jsApi-ODB-Excel");case xe.a.PowerPoint:return!Object(Ae.f)("doc-SxS-jsApi-ODB-Readonly")&&Object(Ae.f)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var Ee=n(1794),Pe=n(965);function De(e,t,n,r,a){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===a&&(a=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:Pe.a.Inline,skipProcessInlineImage:a}}function ke(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var Re=n(1793);n(1986);n.d(t,"a",(function(){return h.a})),n.d(t,"h",(function(){return m.a})),n.d(t,"c",(function(){return L})),n.d(t,"e",(function(){return C})),n.d(t,"u",(function(){return B.a})),n.d(t,"w",(function(){return B.c})),n.d(t,"v",(function(){return B.b})),n.d(t,"D",(function(){return B.d})),n.d(t,"x",(function(){return V})),n.d(t,"y",(function(){return U.a})),n.d(t,"z",(function(){return W.a})),n.d(t,"A",(function(){return o.a})),n.d(t,"E",(function(){return Y})),n.d(t,"r",(function(){return H.a})),n.d(t,"o",(function(){return H.b})),n.d(t,"d",(function(){return Se})),n.d(t,"f",(function(){return fe})),n.d(t,"m",(function(){return Ce})),n.d(t,"b",(function(){return Te})),n.d(t,"B",(function(){return l})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return re})),n.d(t,"l",(function(){return ie})),n.d(t,"q",(function(){return ae})),n.d(t,"j",(function(){return oe})),n.d(t,"g",(function(){return Ee.a})),n.d(t,"i",(function(){return De})),n.d(t,"p",(function(){return ne})),n.d(t,"t",(function(){return ke})),n.d(t,"s",(function(){return z.a})),n.d(t,"n",(function(){return Re.a}))},1144:function(e,t,n){"use strict";var r=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return r.Value}},a=function(e){return"false"!==r(e,"0x10f4")},i=function(e){return parseInt(r(e,"SourceWellKnownFolderType"),10)},o=n(839);var c=function(e,t){switch(e){case Object(o.a)("inbox"):return"Inbox";case Object(o.a)("sentitems"):return"Send";case Object(o.a)("drafts"):return"Edit";case Object(o.a)("deleteditems"):return"Delete";case Object(o.a)("archive"):return"Archive";case Object(o.a)("junkemail"):return"Blocked";case Object(o.a)("scheduled"):return"Clock";case Object(o.a)("notes"):return"QuickNote"}return t?"FabricFolder":null},u=n(0),s=n(1),l=s.lazy((function(){return Promise.all([n.e(8),n.e(738),n.e(28),n.e(796)]).then(n.bind(null,13739))})),d=function(e){return s.createElement(s.Suspense,{fallback:s.createElement("div",{className:e.className})},s.createElement(l,Object(u.__assign)({},e)))};n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}))},1147:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(889),a=n(911);function i(e){var t=Object(a.a)(),n=t&&t.get(e);return(null==n?void 0:n.loadingState)||r.a.Uninitialized}},1149:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(4),a=n(986),i=Object(r.mutatorAction)("setGroupSiteStatus",(function(e,t){e=e.toLocaleLowerCase(),Object(a.a)().groupSiteStatus.has(e)&&t==Object(a.a)().groupSiteStatus.get(e)||Object(a.a)().groupSiteStatus.set(e,t)}));t.a=i},1154:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(44);function a(e){if(!e)return null;var t=e,n=0;if(1==t[0]){if(!(t=o(t)))return null}else n=1;var a=t[++n]+(t[n+1]>>8);return function(e,t,n){if(t+n>e.length)return r.d.error("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var a="",i=t;i<t+n;i++)a+=String.fromCharCode(e[i]);return a}(t,n+=2,a)}function i(e){if(!e)return!1;try{for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);var a=0;return 1===n[0]?n=o(n):a=1,n&&1===n[a]}catch(e){return!1}}function o(e){var t=c(e,null);if(0==t)return r.d.error("rleDecompress : Invalid id"),null;var n=new Uint8Array(t);return c(e,n),n}function c(e,t){for(var n=0,a=1;a<e.length;++a)if(a==e.length-1||e[a]!=e[a+1])null!=t&&(t[n]=e[a]),n++;else{if(a==e.length-2)return r.d.error("decompressEx : Invalid id"),null;for(var i=e[a+2],o=0;o<i+2;o++)null!=t&&(t[n]=e[a]),n++;a+=2}return n}},1159:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2475),a="fileType-icon";function i(e){return r[function(e){return a+"-"+e}(e)]}},1163:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(968),a=n(864);function i(e){switch(e){case r.b.Mail:return a.a.Mail;case r.b.Calendar:return a.a.Calendar;case r.b.FilesHub:return a.a.FilesHub;case r.b.Spaces:return a.a.Mail;default:throw Error("No corresponding SubstrateSearchScenario for given SearchScenarioId ("+e+").")}}},1164:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(37),a=n(942),i=n(65);function o(){return(Object(r.f)("grp-shareable-crud-integrationv2")||Object(a.a)().isSensitivityLabelsEnabled)&&!Object(i.t)()}},1170:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(852);function a(){return r.a.selectedTableViewId}},1172:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.createStore)("currentGroupInformationStore",{smtpAddress:""})},1173:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}}))},1174:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.View=0]="View",e[e.EnteringEdit=1]="EnteringEdit",e[e.Edit=2]="Edit",e[e.Saving=3]="Saving"}(r||(r={}))},1178:function(e,t,n){"use strict";var r;!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(r||(r={})),t.a=r},1184:function(e,t,n){"use strict";var r=new(n(488).a)(50);t.a=r},1186:function(e){e.exports=JSON.parse('{"b":"_fa","d":"$fa","c":"aga","a":"bga"}')},1187:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n(0),a=n(8),i=n(418),o=n(1822),c=n.n(o),u=n(18),s=n(193),l=n(44),d=Object(i.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var i=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,c()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),l.d.warn("Unable to get the download token "+e),e;case 3:return[2]}}))}))}var t,n,a,i,o=this;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=d((function(){return Object(r.__awaiter)(o,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}}))}))})).retriableFunc,a=new s.b("AttachmentRefreshDownloadToken"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n()];case 2:return c.sent(),a.addCustomData([t]),a.end(),[3,4];case 3:return i=c.sent(),l.d.warn("Retry to refresh token failed: "+i),a.addCustomData([t]),a.endWithError("ServerError",i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}}))}))},this.useDownloadUrlBase=!Object(a.f)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(u.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function h(){return f.getInstance().getDownloadToken()}function m(){return f.getInstance().getUseDownloadUrlBase()}function b(){return f.getInstance().getDownloadUrlBase()}},11923:function(e){e.exports=JSON.parse('{"a":"MDb"}')},11924:function(e){e.exports=JSON.parse('{"c":"vDb","a":"wDb","b":"xDb"}')},11925:function(e,t,n){var r=n(11926),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11926:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._3VDyWHnY4QY1L3K_7IVP9r{font-size:14px;color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._3VDyWHnY4QY1L3K_7IVP9r{margin-left:2px}html[dir=rtl] ._3VDyWHnY4QY1L3K_7IVP9r{margin-right:2px}',""]),t.locals={chevronButton:"_3VDyWHnY4QY1L3K_7IVP9r"}},11927:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._3YrNihnPcNYSStHFCTVjYP{top:-11px;position:relative}._36CbeMUul160_BaOc004Od{font-size:11px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._36CbeMUul160_BaOc004Od{padding:0}html[dir=ltr] ._36CbeMUul160_BaOc004Od{margin-right:6px}html[dir=rtl] ._36CbeMUul160_BaOc004Od{margin-left:6px}._25PDIRwPTbbCvgI4wMWgWF:hover{color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={attachmentWellBar:"_3YrNihnPcNYSStHFCTVjYP",barButton:"_36CbeMUul160_BaOc004Od",barButtonHover:"_25PDIRwPTbbCvgI4wMWgWF"}},11928:function(e){e.exports=JSON.parse('{"b":"JDb","a":"KDb","c":"LDb"}')},11929:function(e){e.exports=JSON.parse('{"g":"zDb","f":"ADb","h":"BDb","b":"CDb","c":"DDb","d":"EDb","e":"FDb","a":"GDb"}')},11931:function(e){e.exports=JSON.parse('{"a":"DCb"}')},11932:function(e,t,n){var r=n(11933),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11933:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'html[dir] .bA6VMVlBESJO6HdvixVej{margin-top:10px}html[dir] ._2uDB0Z5c1rxWY8VRiqJxWb{margin-bottom:10px;border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}.EdrnWUF-OJTMMdmp57xv-{width:100%;height:133px;overflow:hidden}._3yxpB2-QTd6f3W7FbncVyN{width:100%;height:65px;overflow:hidden}._3K0R6luHu6vP94NHx0eok3{height:auto}',""]),t.locals={attachmentWell:"bA6VMVlBESJO6HdvixVej",attachmentWellInCompose:"_2uDB0Z5c1rxWY8VRiqJxWb",oneRowImageViews:"EdrnWUF-OJTMMdmp57xv-",oneRowDocViews:"_3yxpB2-QTd6f3W7FbncVyN",allowShowMultipleRows:"_3K0R6luHu6vP94NHx0eok3"}},11934:function(e,t,n){e.exports=n.p+"../resources/images/attach-91ee4c9d6406386b1dcf60138a873730.svg"},1196:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1081),a=n(852);function i(e,t){var n=Object(r.a)(e,t);return a.a.tableViewItemRelations.get(n)}},1197:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return a})),n.d(t,"x",(function(){return i})),n.d(t,"v",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"m",(function(){return p})),n.d(t,"d",(function(){return v})),n.d(t,"k",(function(){return g})),n.d(t,"u",(function(){return O})),n.d(t,"o",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"p",(function(){return S})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return y})),n.d(t,"n",(function(){return _})),n.d(t,"r",(function(){return C}));var r="multipart/signed",a="application/pkcs7-mime",i="application/x-pkcs7-mime",o=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",l="0800",d=57,f=78,h=16,m=11,b="IPM.Note.SMIME.MultipartSigned",p="smime-",v="image",g="OwaToSmime",O="SmimeToOwa",I="en-US",w=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],S="https://ow2.res.office365.com/owasmime/20.19.814.2/owasmime.msi",j="OwaSmimeEdgeExtension.appxbundle",y="https://ow2.res.office365.com/owasmime/20.19.814.2/OwaSmimeEdgeExtension.appxbundle",_="https://ow2.res.office365.com/owasmime/20.19.814.2/SmimeOutlookWebChrome.msi",C="https://ow2.res.office365.com/owasmime/20.19.814.2/SmimeOutlookWebChrome.msi"},1199:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1910),a=n(1223);function i(e){var t=Object(r.a)(),n=Object(a.b)(e);return t.sharingLinks.get(n)}},1202:function(e,t,n){"use strict";var r=n(0),a=n(2585),i=n.n(a),o=n(1937),c=n.n(o);function u(e){var t=c()({ProviderType:e});return i()(t)}var s=n(2586),l=n.n(s),d=n(1938),f=n.n(d);function h(e){var t=f()({ProviderType:e});return l()(t)}var m=n(2446),b=n(1600);n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return C}));var p="code",v="token",g=3e3,O=3;function I(e){return{state:e}}function w(e){return e.state}function S(e){return e.code}function j(e,t,n,a,i){var o={providerType:e,getAuthUrlInfo:null,getCSRFToken:w,getOAuthCode:S};return function e(t,n,a,i,o,c,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),l=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,h(t)];case 1:return d=r.sent(),l=d.AttachmentDataProviderCreator.ProviderAppKey,a=d.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(t)];case 3:d=r.sent(),l=d.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(m.d)(t,a,i,l,o,c),[3,6];case 5:return r.sent(),s>0&&setTimeout((function(){return e(t,n,a,i,o,c,--s)}),g),[3,6];case 6:return[2]}}))}))}(e,o,t,n,a,i,O),o}var y=null;function _(){if(!y){if(y={},Object(b.a)(3)&&(y[3]=j(3,"https://app.box.com/api/oauth2/authorize",Object(m.c)(3),p,I)),Object(b.a)(2)&&(y[2]=j(2,"https://www.dropbox.com/oauth2/authorize",Object(m.b)(2),p,I)),Object(b.a)(6)){var e=j(6,"https://www.facebook.com/dialog/oauth",Object(m.b)(6),v,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=w,e.getOAuthCode=function(e){return e.access_token},y[6]=e}if(Object(b.a)(5)){var t=j(5,"https://accounts.google.com/o/oauth2/auth",m.a+"/ADPRedirect.aspx",p,(function(e){var t={state:e,provider:5..toString(),url:Object(m.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},y[5]=t}Object(b.a)(1)&&(y[1]=j(1,"https://login.live.com/oauth20_authorize.srf",Object(m.c)(1),p,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(b.a)(7)&&(y[7]=j(7,"",Object(m.c)(7),p,I)),Object(b.a)(8)&&(y[8]=j(8,"",Object(m.c)(8),p,I)),Object(b.a)(9)&&(y[9]=j(9,"",Object(m.c)(9),p,I))}return y}function C(e){var t=_();return e in t?t[e]:null}},1206:function(e,t,n){"use strict";var r=n(0),a=n(1735),i=n(93),o=Object(i.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var i=e.infoBarHostKey;n&&(a.b[i]||(a.b[i]={}),a.b[i][t]=n)}}));t.a=o},1212:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"j",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"l",(function(){return d})),n.d(t,"o",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"i",(function(){return g})),n.d(t,"k",(function(){return O})),n.d(t,"n",(function(){return I})),n.d(t,"p",(function(){return w}));var r=n(73),a=new r.c((function(){return n.e(468).then(n.bind(null,2910))})),i=new r.a(a,(function(e){return e.logSearchDone})),o=new r.a(a,(function(e){return e.logEntityClicked})),c=new r.a(a,(function(e){return e.logResponseReceived})),u=new r.a(a,(function(e){return e.logSessionEnd})),s=new r.a(a,(function(e){return e.logResponseRendered})),l=new r.a(a,(function(e){return e.logExecuteSearchCorrelation})),d=new r.a(a,(function(e){return e.logSearchBoxStateChanged})),f=new r.a(a,(function(e){return e.logSearchResultInteraction})),h=new r.a(a,(function(e){return e.logResponseNeverRendered})),m=new r.a(a,(function(e){return e.flushNonRenderedResponseReceivedItemsFromCache})),b=new r.a(a,(function(e){return e.logCachedContentRendered})),p=new r.a(a,(function(e){return e.logFeedback})),v=new r.a(a,(function(e){return e.logClientLayout})),g=new r.a(a,(function(e){return e.logResponseRecievedV2})),O=new r.a(a,(function(e){return e.logResultsRendered})),I=new r.a(a,(function(e){return e.logSearchEntityActions})),w=new r.a(a,(function(e){return e.logSecondaryEntityActionClicked}))},1216:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1218:function(e,t,n){"use strict";var r,a;function i(e){r=e}function o(){return r}function c(e){a=e}function u(){return a}n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}))},1221:function(e,t,n){"use strict";var r=n(4),a=n(12);t.a=Object(r.createStore)("followButtonStore",{groupActionState:new a.ObservableMap})()},1222:function(e,t,n){"use strict";var r=n(4),a=n(12);t.a=Object(r.createStore)("joinButtonStore",{groupActionState:new a.ObservableMap})()},1223:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(37),a="_ODSPPSL";function i(e){return Object(r.f)("doc-link-savePermission")&&e&&-1!==e.indexOf(a)?e.substring(0,e.length-a.length):e}function o(e){return!!Object(r.f)("doc-link-savePermission")&&e.lastIndexOf(a)===e.length-a.length}function c(e,t){return!Object(r.f)("doc-link-savePermission")||2!==t&&1!==t?e:e+a}},1227:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1228:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1250:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"k",(function(){return p})),n.d(t,"p",(function(){return v})),n.d(t,"h",(function(){return g}));var r=100,a=1,i="PublicDL",o="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",l="ExternalMailbox",d="Mailbox",f="OneOff",h="Contact",m="ImplicitContact",b="PublicFolder",p="Other",v="Room",g="LinkedIn"},1251:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(0),a=n(1282),i=function(){return Object(r.__spread)(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},1258:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},1267:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(73),a=new r.c((function(){return n.e(449).then(n.bind(null,2600))})),i=new r.a(a,(function(e){return e.subscribe})),o=new r.a(a,(function(e){return e.unsubscribe})),c=new r.a(a,(function(e){return e.trigger}));new r.a(a,(function(e){return e.removeResizeEventEmitter}))},1268:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(836),a=n(999);function i(){var e=Object(a.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.e.folderTable.get(t)}},1276:function(e,t,n){"use strict";var r="POST",a=n(0),i=n(193),o=n(1456),c=n(190),u=n(1376),s=n.n(u),l=n(1943),d=n.n(l),f=n(44);function h(e,t,n,r,c){return Object(a.__awaiter)(this,void 0,void 0,(function(){var u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Object(o.d)(e,!1,n)];case 1:return u=a.sent(),[3,3];case 2:return a.sent(),[3,3];case 3:return u&&u.split(o.a)[1]?(Object(i.o)("fetchServiceViaDataProvider",[e]),f.d.info("fetchServiceViaDataProvider"),[4,m(t,u,r,c)]):[3,5];case 4:return[2,a.sent()];case 5:Object(i.o)("fetchServiceFailedToGetToken",[e]),a.label=6;case 6:return 0!==e?[3,8]:(Object(i.o)("fetchServiceViaOWAServer"),f.d.info("fetchServiceViaOWAServer"),[4,b(e,t,r,c)]);case 7:return[2,a.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function m(e,t,n,r){return Object(a.__awaiter)(this,void 0,void 0,(function(){var o,u,s;return Object(a.__generator)(this,(function(a){return o=n.datapointNamePrefix+"DataProvider",u=new i.a(o),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},r&&Object.keys(r).forEach((function(e){s[e]=r[e]})),[2,fetch(e,{method:n.method,mode:n.mode,headers:s,body:n.body}).then((function(e){if(Object(c.a)(e.status))return u.end(),e.json();var t=new Error(o+" : Response status = "+e.status+", body = "+e.body);throw u.endWithError("ServerError",t),t})).then((function(e){return JSON.stringify(e)}))]}))}))}function b(e,t,n,o){return Object(a.__awaiter)(this,void 0,void 0,(function(){var u,l,f,h,m;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return u=n.datapointNamePrefix+"OWA",l=new i.a(u),f=s()({ProviderType:e,Url:t,Method:n.method,Body:n.body,Headers:JSON.stringify(o),IsJsonPost:!(!n.body||n.method!==r)}),[4,d()(f)];case 1:if(h=a.sent(),Object(c.a)(h.Status))return l.end(),[2,h.Body];throw m=new Error(u+" : Response status = "+h.Status+", ServerTraceLog = "+h.ServerTraceLog),l.endWithError("ServerError",m),m}}))}))}function p(e){return"u!"+btoa(e).replace(/=+$/,"").replace("/","_").replace("+","-")}n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return"cors"})),n.d(t,"b",(function(){return"GET"})),n.d(t,"e",(function(){return"PUT"})),n.d(t,"c",(function(){return"PATCH"})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return p}))},1282:function(e,t,n){"use strict";var r=n(4),a=n(12),i=n(1563),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},c=Object(r.createStore)("fileProviderStore",o);t.a=c},1295:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(844);function a(e){var t=Object(r.a)(e);return 0===t.searchText.trim().length&&0===t.suggestionPillIds.length}},1301:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n(4),a=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),o=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},1310:function(e,t,n){"use strict";function r(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.focusedViewFilter;case 1:return-1;default:throw new Error("Table Query should be either of type search, mail folder or group")}}n.d(t,"a",(function(){return r}))},1312:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return h})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"j",(function(){return p})),n.d(t,"l",(function(){return v}));var r=n(73),a=n(1561);n.d(t,"n",(function(){return a.a}));var i=n(1502);n.d(t,"a",(function(){return i.a}));n(1250);var o=n(1216);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(1562);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(7),n.e(13),n.e(47),n.e(476)]).then(n.bind(null,3136))})),s=new r.b(u,(function(e){return e.getSharingInformation})),l=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),d=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),h=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),m=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),b=new r.b(u,(function(e){return e.getInvididualRecipients})),p=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),v=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1313:function(e,t,n){"use strict";var r=n(0),a=n(1735),i=n(4);var o=Object(i.mutatorAction)("removeInfoBarMessages",(function(e,t){e&&(Array.isArray(t)?t:t?[t]:e.infoBarIds?Object(r.__spread)(e.infoBarIds):[]).forEach((function(t){return function(e,t){var n=e.infoBarIds&&e.infoBarIds.indexOf(t);n>=0&&e.infoBarIds.splice(n,1);var r=e.infoBarHostKey;a.b[r]&&(delete a.b[r][t],0===Object.keys(a.b[r]).length&&delete a.b[r])}(e,t)}))}));t.a=o},1317:function(e,t,n){"use strict";var r=n(2215),a=n(8),i=n(1824),o=n(1026);var c=n(977),u=n(1128),s=n(971),l=n(914),d=n(93);n.d(t,"b",(function(){return h}));var f=null;function h(){return f||(f=Object.keys(c.a).reduce((function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e}),[])),f}t.a=Object(d.action)("initializeAttachmentFullViewState")((function(e,t,n,d,f){var m;d&&0!==d.length||(m=t.model,d=Object(l.e)(m)?function(e){return 2===Object(l.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(m):h());var b=Object(s.e)(t.model,!0),p=Object(s.k)(),v=Object(u.a)(t),g=Object(r.a)(p,b,t.attachmentClass,t.model,v?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,d,e.isReadOnly,n,f);e.strategy=g,function(e,t,n){n&&!Object(a.f)(t.model.AttachmentOriginalUrl)&&(Object(i.a)(e,2),Object(o.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1322:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(852);function a(e){return r.a.conversationItems.get(e)}},1323:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(1402),a=n.n(r),i=n(340),o=n.n(i),c=n(155),u=n(1403),s=n.n(u),l=n(1042),d=n(981);function f(e,t){return s()({Header:Object(c.getJsonRequestHeader)(),Body:a()({FolderChanges:[{Updates:t,FolderId:o()(Object(l.a)(e))}]})},Object(d.a)(e)).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},1324:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(911);function a(e){var t=Object(r.a)(),n=t&&t.get(e);return null==n?void 0:n.currentLoadedIndex}},1325:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(209),a=n.n(r),i=n(340),o=n.n(i),c=n(37);function u(e,t){return e.serverFolderId?e.serverFolderId==e.tableQuery.folderId?t?null:s(e.tableQuery):l(e.serverFolderId):null}function s(e){return 2==e.type?(t=e.folderId,a()({Id:Object(c.f)("grp-junkemailitems")?"junkemail":"inbox",Mailbox:{MailboxType:"GroupMailbox",EmailAddress:t}})):l(e.folderId);var t}function l(e){return o()({Id:e})}},1327:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n(1044),i=n(1348);function o(e,t,n,o,c){if(n)return r=r||{extraSmall:Object(a.b)("generic").extraSmall,small:Object(a.b)("generic").small,medium:Object(a.b)("blockedfile").medium,large:Object(a.b)("generic").large,cdn:Object(i.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":case"IPM.Schedule.Meeting.Request":case"IPM.Schedule.Meeting.Canceled":return Object(a.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(a.b)("calendar")}return o?Object(a.b)("sharedfolder"):Object(a.a)(e,!1,t)||Object(a.b)("generic")}},13301:function(e){e.exports=JSON.parse('{"a":"uDb"}')},13302:function(e,t,n){var r=n(13303),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13303:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._34qX_Vd5nRnROPJ2LiRPXt{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._34qX_Vd5nRnROPJ2LiRPXt{padding:4px;text-align:center}._34qX_Vd5nRnROPJ2LiRPXt:focus,._34qX_Vd5nRnROPJ2LiRPXt:hover,._2Em6TeWUxMZ6udd4bl6S-D{color:"[theme:neutralSecondary, default:#666666]"}._2Em6TeWUxMZ6udd4bl6S-D{display:block}.TD4bOsB9P6IkOtYafVHpR{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .TD4bOsB9P6IkOtYafVHpR{right:0}html[dir=rtl] .TD4bOsB9P6IkOtYafVHpR{left:0}.TD4bOsB9P6IkOtYafVHpR:focus,.TD4bOsB9P6IkOtYafVHpR:hover{color:"[theme:white, default:#ffffff]"}html[dir] .TD4bOsB9P6IkOtYafVHpR:focus,html[dir] .TD4bOsB9P6IkOtYafVHpR:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .TD4bOsB9P6IkOtYafVHpR:focus,html[dir=ltr] .TD4bOsB9P6IkOtYafVHpR:hover{border-bottom-right-radius:2px}html[dir=rtl] .TD4bOsB9P6IkOtYafVHpR:focus,html[dir=rtl] .TD4bOsB9P6IkOtYafVHpR:hover{border-bottom-left-radius:2px}._1GIY2DlsHSf_ahna5LoBYB{font-size:14px}html[dir] ._1GIY2DlsHSf_ahna5LoBYB{margin:0}html[dir] ._1lodvK0tnJzacvv3PKwjox:focus,html[dir] ._1lodvK0tnJzacvv3PKwjox:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir=ltr] ._1lodvK0tnJzacvv3PKwjox:focus,html[dir=ltr] ._1lodvK0tnJzacvv3PKwjox:hover{border-bottom-right-radius:2px}html[dir=rtl] ._1lodvK0tnJzacvv3PKwjox:focus,html[dir=rtl] ._1lodvK0tnJzacvv3PKwjox:hover{border-bottom-left-radius:2px}html[dir] ._1L5SEStcZYQoOhueSdLhu6:focus,html[dir] ._1L5SEStcZYQoOhueSdLhu6:hover,html[dir] ._2_waUm_VZxYycME1Aj29OD:focus,html[dir] ._2_waUm_VZxYycME1Aj29OD:hover,html[dir] ._1FvYD6zFbpFDwlnaZkMpCD:focus,html[dir] ._1FvYD6zFbpFDwlnaZkMpCD:hover,html[dir] ._25qYUojzjB10HTAguwEyxk:focus,html[dir] ._25qYUojzjB10HTAguwEyxk:hover,html[dir] .-cMwBp-KOdlz5yenLMZAw:focus,html[dir] .-cMwBp-KOdlz5yenLMZAw:hover,html[dir] ._1TAM0OXXRWv2IoCu90eWO4:focus,html[dir] ._1TAM0OXXRWv2IoCu90eWO4:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir=ltr] ._1L5SEStcZYQoOhueSdLhu6:focus,html[dir=ltr] ._1L5SEStcZYQoOhueSdLhu6:hover,html[dir=ltr] ._2_waUm_VZxYycME1Aj29OD:focus,html[dir=ltr] ._2_waUm_VZxYycME1Aj29OD:hover,html[dir=ltr] ._1FvYD6zFbpFDwlnaZkMpCD:focus,html[dir=ltr] ._1FvYD6zFbpFDwlnaZkMpCD:hover,html[dir=ltr] ._25qYUojzjB10HTAguwEyxk:focus,html[dir=ltr] ._25qYUojzjB10HTAguwEyxk:hover,html[dir=ltr] .-cMwBp-KOdlz5yenLMZAw:focus,html[dir=ltr] .-cMwBp-KOdlz5yenLMZAw:hover,html[dir=ltr] ._1TAM0OXXRWv2IoCu90eWO4:focus,html[dir=ltr] ._1TAM0OXXRWv2IoCu90eWO4:hover{border-bottom-right-radius:2px}html[dir=rtl] ._1L5SEStcZYQoOhueSdLhu6:focus,html[dir=rtl] ._1L5SEStcZYQoOhueSdLhu6:hover,html[dir=rtl] ._2_waUm_VZxYycME1Aj29OD:focus,html[dir=rtl] ._2_waUm_VZxYycME1Aj29OD:hover,html[dir=rtl] ._1FvYD6zFbpFDwlnaZkMpCD:focus,html[dir=rtl] ._1FvYD6zFbpFDwlnaZkMpCD:hover,html[dir=rtl] ._25qYUojzjB10HTAguwEyxk:focus,html[dir=rtl] ._25qYUojzjB10HTAguwEyxk:hover,html[dir=rtl] .-cMwBp-KOdlz5yenLMZAw:focus,html[dir=rtl] .-cMwBp-KOdlz5yenLMZAw:hover,html[dir=rtl] ._1TAM0OXXRWv2IoCu90eWO4:focus,html[dir=rtl] ._1TAM0OXXRWv2IoCu90eWO4:hover{border-bottom-left-radius:2px}',""]),t.locals={contextMenuButton:"_34qX_Vd5nRnROPJ2LiRPXt",contextMenuButtonForDocViewInCompose:"_2Em6TeWUxMZ6udd4bl6S-D",contextMenuButtonForImageView:"TD4bOsB9P6IkOtYafVHpR",icon:"_1GIY2DlsHSf_ahna5LoBYB",none:"_1lodvK0tnJzacvv3PKwjox",edit:"_1L5SEStcZYQoOhueSdLhu6",notSelectedAndSaving:"_2_waUm_VZxYycME1Aj29OD",selected:"_1FvYD6zFbpFDwlnaZkMpCD",selectedAndPending:"_25qYUojzjB10HTAguwEyxk",selectedAndSaving:"-cMwBp-KOdlz5yenLMZAw",withBorder:"_1TAM0OXXRWv2IoCu90eWO4"}},13304:function(e,t,n){var r=n(13305),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13305:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._3US7V_pq1RdAcNr19r6-72{display:-webkit-box;display:-ms-flexbox;display:flex}._6Ymsku6T45YYg07um95Qx{width:26px;height:50%;position:absolute;top:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir=ltr] ._6Ymsku6T45YYg07um95Qx{right:0}html[dir=rtl] ._6Ymsku6T45YYg07um95Qx{left:0}._1x8yJH6PJTVJmTqfEb5Bhd{height:50%;position:absolute;bottom:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] ._1x8yJH6PJTVJmTqfEb5Bhd{right:0}html[dir=rtl] ._1x8yJH6PJTVJmTqfEb5Bhd{left:0}._3LhpVV20kQ94W_ooxkJD7R{width:27px;color:"[theme:neutralSecondary, default:#666666]";height:26px}html[dir] ._3LhpVV20kQ94W_ooxkJD7R{text-align:center}._3LhpVV20kQ94W_ooxkJD7R:focus,._3LhpVV20kQ94W_ooxkJD7R:hover{width:26px;color:"[theme:neutralSecondary, default:#666666]"}._3BjpQjW9AyEgOo9EqYrSrD{width:26px}._3BjpQjW9AyEgOo9EqYrSrD,._3BjpQjW9AyEgOo9EqYrSrD:focus,._3BjpQjW9AyEgOo9EqYrSrD:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._3BjpQjW9AyEgOo9EqYrSrD:focus,html[dir] ._3BjpQjW9AyEgOo9EqYrSrD:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}._3mGJyy58u8rGH2y_Kwan1n{font-size:14px}html[dir] ._3mGJyy58u8rGH2y_Kwan1n{margin:0}html[dir] ._1y3xE68_ZZG7O-plJkVQvg:focus,html[dir] ._1y3xE68_ZZG7O-plJkVQvg:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._1Rs4JPnzocmPwE3dogzh7m:focus,html[dir] ._1Rs4JPnzocmPwE3dogzh7m:hover,html[dir] ._2ZJtN517vdoU8H7KGkOPMp:focus,html[dir] ._2ZJtN517vdoU8H7KGkOPMp:hover,html[dir] ._37D_k10XVJcVGBStBrWZir:focus,html[dir] ._37D_k10XVJcVGBStBrWZir:hover,html[dir] ._1O2OymQIkYXguoX9B1AYvb:focus,html[dir] ._1O2OymQIkYXguoX9B1AYvb:hover,html[dir] ._24HhzkbeqH6I5eRPC0nbJV:focus,html[dir] ._24HhzkbeqH6I5eRPC0nbJV:hover,html[dir] ._2MZWoXWMrXbq1g3RCuEPlJ:focus,html[dir] ._2MZWoXWMrXbq1g3RCuEPlJ:hover{background:"[theme:themeTertiary, default:#71AFE5]"}',""]),t.locals={actionsContainerDisplay:"_3US7V_pq1RdAcNr19r6-72",actionContainerFirstLine:"_6Ymsku6T45YYg07um95Qx",secondLineActionsContainer:"_1x8yJH6PJTVJmTqfEb5Bhd",deleteButton:"_3LhpVV20kQ94W_ooxkJD7R",deleteButtonForImageView:"_3BjpQjW9AyEgOo9EqYrSrD",icon:"_3mGJyy58u8rGH2y_Kwan1n",none:"_1y3xE68_ZZG7O-plJkVQvg",edit:"_1Rs4JPnzocmPwE3dogzh7m",notSelectedAndSaving:"_2ZJtN517vdoU8H7KGkOPMp",selected:"_37D_k10XVJcVGBStBrWZir",selectedAndPending:"_1O2OymQIkYXguoX9B1AYvb",selectedAndSaving:"_24HhzkbeqH6I5eRPC0nbJV",withBorder:"_2MZWoXWMrXbq1g3RCuEPlJ"}},13306:function(e){e.exports=JSON.parse('{"a":"pDb"}')},13307:function(e,t,n){var r=n(13308),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13308:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._2mmwVdqCxyAgYvExzOCJwM{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._3AFFqPxHOPsmU-3uBJJtpy{color:"[theme:neutralPrimary, default:#333333]"}.n4WYkkVPRQOLs4vnsE5wf{color:"[theme:neutralSecondary, default:#666666]"}._3jp5I5PeLNawCFQn_MgF22{color:"[theme:white, default:#ffffff]";bottom:6px;position:absolute}html[dir=ltr] ._3jp5I5PeLNawCFQn_MgF22,html[dir=rtl] ._3jp5I5PeLNawCFQn_MgF22{padding-left:4px;padding-right:4px}._13urZpVOYoeFbQ5LIS2F-T{font-size:14px;font-weight:400;max-width:194px}.lDXxk8f5UbY5U8qcwKG9e{font-size:14px;font-weight:400;width:168px}.KVK2kk7EVZpM8RxmlOzZE{width:150px;color:"[theme:white, default:#ffffff]"!important}.NIH92BJjufxj__OY7dhmt,._1hMqfRy9j2T-xZ8UqvLU69,.azLhw19Qg6J76UP7yZSJV,.MwvSBa3rva3PeyAmbNE_0{font-size:11px;font-weight:400;width:194px;display:inline-block}html[dir] .NIH92BJjufxj__OY7dhmt,html[dir] ._1hMqfRy9j2T-xZ8UqvLU69,html[dir] .azLhw19Qg6J76UP7yZSJV,html[dir] .MwvSBa3rva3PeyAmbNE_0{padding-top:3px}._1hMqfRy9j2T-xZ8UqvLU69{width:142px}.azLhw19Qg6J76UP7yZSJV{width:176px}.MwvSBa3rva3PeyAmbNE_0{width:124px}._1tja5f9ZZuouIUikonXEhg,._1udQsv4Ip1kK9JePfJT89H,._8dbKwHZ3tzSxIyoVYKtkz,._23y33PBtZy_NoG8uPiuBI4{font-size:11px;font-weight:400;width:150px;color:"[theme:white, default:#ffffff]"!important;display:inline-block}html[dir] ._1tja5f9ZZuouIUikonXEhg,html[dir] ._1udQsv4Ip1kK9JePfJT89H,html[dir] ._8dbKwHZ3tzSxIyoVYKtkz,html[dir] ._23y33PBtZy_NoG8uPiuBI4{padding-top:3px}._1udQsv4Ip1kK9JePfJT89H{width:98px}._8dbKwHZ3tzSxIyoVYKtkz{width:132px}._23y33PBtZy_NoG8uPiuBI4{width:80px}._22uzMmZPNGqncJTOPDeQff,._2tu7N6Se9u8ZZy-atx3vB2{font-size:12px;font-weight:400;font-weight:600;position:relative;top:-1px}html[dir=ltr] ._22uzMmZPNGqncJTOPDeQff,html[dir=ltr] ._2tu7N6Se9u8ZZy-atx3vB2{padding-right:4px}html[dir=rtl] ._22uzMmZPNGqncJTOPDeQff,html[dir=rtl] ._2tu7N6Se9u8ZZy-atx3vB2{padding-left:4px}.Ijkcd3Wt83tPLe3Fb96im{color:#107c10}._3XT0o9nGpCTzTooWbmMrXO,._2B_qb4EanXiGIS5AFFo1l6{color:#e81123}.pLLdPdGZslUFQvNHNzGtI{color:"[theme:themePrimary, default:#0078D4]";font-weight:600}html[dir=ltr] .pLLdPdGZslUFQvNHNzGtI{padding-left:2px}html[dir=rtl] .pLLdPdGZslUFQvNHNzGtI{padding-right:2px}._2tu7N6Se9u8ZZy-atx3vB2{font-weight:400;color:"[theme:themePrimary, default:#0078D4]"}._1IbQVbGa8oHVtUs3sC8l3-{display:inline-block}',""]),t.locals={textOverFlow:"_2mmwVdqCxyAgYvExzOCJwM",firstLineCommonStyle:"_3AFFqPxHOPsmU-3uBJJtpy",secondLineCommonStyle:"n4WYkkVPRQOLs4vnsE5wf",attachmentInfoForImageView:"_3jp5I5PeLNawCFQn_MgF22",firstLine:"_13urZpVOYoeFbQ5LIS2F-T",firstLineWithActions:"lDXxk8f5UbY5U8qcwKG9e",firstLineForImageView:"KVK2kk7EVZpM8RxmlOzZE",secondLine:"NIH92BJjufxj__OY7dhmt",secondLineWithAction:"_1hMqfRy9j2T-xZ8UqvLU69",secondLineWithIcon:"azLhw19Qg6J76UP7yZSJV",secondLineWithIconAndAction:"MwvSBa3rva3PeyAmbNE_0",secondLineForImageView:"_1tja5f9ZZuouIUikonXEhg",secondLineForImageViewWithAction:"_1udQsv4Ip1kK9JePfJT89H",secondLineForImageViewWithIcon:"_8dbKwHZ3tzSxIyoVYKtkz",secondLineForImageViewWithIconAndAction:"_23y33PBtZy_NoG8uPiuBI4",actionComplete:"_22uzMmZPNGqncJTOPDeQff",attachmentLabelIconEditMode:"_2tu7N6Se9u8ZZy-atx3vB2",colorGreen:"Ijkcd3Wt83tPLe3Fb96im",colorRed:"_3XT0o9nGpCTzTooWbmMrXO",expiredAttachment:"_2B_qb4EanXiGIS5AFFo1l6",attachmentLabelTextEditMode:"pLLdPdGZslUFQvNHNzGtI",oneDriveLinkContainer:"_1IbQVbGa8oHVtUs3sC8l3-"}},13309:function(e,t,n){var r=n(13310),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13310:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._3mdWzAVrq2m9sww1XqTNfM{display:inline-block;width:200px;height:40px;vertical-align:top;font-weight:400;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._3mdWzAVrq2m9sww1XqTNfM{padding:6px 4px 6px 4px}html[dir=ltr] ._3mdWzAVrq2m9sww1XqTNfM{text-align:left}html[dir=rtl] ._3mdWzAVrq2m9sww1XqTNfM{text-align:right}',""]),t.locals={attachmentInfoContainer:"_3mdWzAVrq2m9sww1XqTNfM"}},13311:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'.MUw3D9UhsewUpXnPcGPsp{-o-object-fit:cover;object-fit:cover;position:absolute}._5bVqMP1eD5gyN5LAVgY62{font-size:70px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]";position:absolute;top:25px}html[dir] ._5bVqMP1eD5gyN5LAVgY62{background:transparent}html[dir=ltr] ._5bVqMP1eD5gyN5LAVgY62{left:45px}html[dir=rtl] ._5bVqMP1eD5gyN5LAVgY62{right:45px}._1a80gzjFuXuOaSVwTulv2Z{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%;bottom:0;position:absolute;font-weight:400}html[dir] ._1a80gzjFuXuOaSVwTulv2Z{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";border-radius:2px}._33anPnNowEFTFUduPDw75V{height:50px}html[dir=ltr] ._33anPnNowEFTFUduPDw75V,html[dir=rtl] ._33anPnNowEFTFUduPDw75V{border-bottom-left-radius:2px;border-bottom-right-radius:2px}',""]),t.locals={thumbnail:"MUw3D9UhsewUpXnPcGPsp",placeholder:"_5bVqMP1eD5gyN5LAVgY62",infoContainer:"_1a80gzjFuXuOaSVwTulv2Z",infoContainerForReadingPane:"_33anPnNowEFTFUduPDw75V"}},13312:function(e,t,n){var r=n(13313),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13313:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,"._3C46WTkavwNpL2s9wi5NWq{position:absolute;bottom:-6px;width:100%}html[dir=ltr] ._3C46WTkavwNpL2s9wi5NWq{left:0}html[dir=rtl] ._3C46WTkavwNpL2s9wi5NWq{right:0}._3C46WTkavwNpL2s9wi5NWq .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._3C46WTkavwNpL2s9wi5NWq .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}",""]),t.locals={progressIndicator:"_3C46WTkavwNpL2s9wi5NWq"}},13314:function(e){e.exports=JSON.parse('{"a":"OCb"}')},13315:function(e){e.exports=JSON.parse('{"a":"MCb"}')},13316:function(e){e.exports=JSON.parse('{"b":"KCb","a":"LCb"}')},13317:function(e){e.exports=JSON.parse('{"a":"ICb"}')},13320:function(e){e.exports=JSON.parse('{"a":"FCb"}')},13321:function(e){e.exports=JSON.parse('{"a":"ECb"}')},13322:function(e,t,n){var r=n(13323),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},13323:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'.sM95xSLKng9kArKyOTetK{color:"[theme:white, default:#ffffff]";font-size:11px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex}._1bI7_gx-dcQHEXnK_6e-St{display:inline-block;overflow:hidden;white-space:nowrap;vertical-align:top}html[dir=ltr] ._1bI7_gx-dcQHEXnK_6e-St{margin:1px 10px 10px 1px}html[dir=rtl] ._1bI7_gx-dcQHEXnK_6e-St{margin:1px 1px 10px 10px}._2mZE6q64kgwFv3zDOYIyAn{display:inline-block;position:relative}html[dir] ._2mZE6q64kgwFv3zDOYIyAn{border-style:solid}._2LVdfrWvwtwYcMnT5yLgVG{height:52px;width:260px}html[dir] ._2LVdfrWvwtwYcMnT5yLgVG{border-width:1px;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._2URgRnk47g80nOwQIooci6{height:120px;width:160px}html[dir] ._2URgRnk47g80nOwQIooci6{background:"[theme:neutralLighter, default:#f4f4f4]";border-width:1px;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1rPSXAnDiNVX6P8ASLOuxo{cursor:default}.jmD4ygePpM2-dkXzb1wqw{cursor:pointer}html[dir=ltr] ._30NJOnNJRmOfQxyPn0T3BH,html[dir=rtl] ._30NJOnNJRmOfQxyPn0T3BH{border-top-right-radius:0;border-top-left-radius:0}html[dir] ._GWPlQgHirjrX8TEQ6nfK{border-radius:2px;background:"[theme:white, default:#ffffff]"}html[dir] ._GWPlQgHirjrX8TEQ6nfK:focus,html[dir] ._GWPlQgHirjrX8TEQ6nfK:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._24gHuNDodXcnJuv07pcDks,html[dir] ._2y7wLZ1Tpx0RK7iBLv07r1,html[dir] .kGmjRqAnKQ21UAeZi78ic,html[dir] ._1XErEYUoKLr1B9Y-OhAH29,html[dir] .IeX8f3UgLwd0bSGKcqB76,html[dir] .uCjvHJwE_aECSlIKlAXWC{margin:0;border-width:1px;background-color:"[theme:themeLight, default:#C7E0F4]";border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._24gHuNDodXcnJuv07pcDks{border-style:dashed;background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] ._2y7wLZ1Tpx0RK7iBLv07r1{background:"[theme:neutralLighter, default:#f4f4f4]"}._3nazLS-4wRLkGtIH_4xmp-{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] ._3nazLS-4wRLkGtIH_4xmp-{border-width:1px;border-style:solid;padding:0 4px;background:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir=ltr] ._3nazLS-4wRLkGtIH_4xmp-{left:0}html[dir=rtl] ._3nazLS-4wRLkGtIH_4xmp-{right:0}',""]),t.locals={attachmentLabel:"sM95xSLKng9kArKyOTetK",attachmentContainer:"_1bI7_gx-dcQHEXnK_6e-St",attachmentView:"_2mZE6q64kgwFv3zDOYIyAn",attachmentDocView:"_2LVdfrWvwtwYcMnT5yLgVG",attachmentImageView:"_2URgRnk47g80nOwQIooci6",defaultCursor:"_1rPSXAnDiNVX6P8ASLOuxo",handCursor:"jmD4ygePpM2-dkXzb1wqw",regularTopBorderRadius:"_30NJOnNJRmOfQxyPn0T3BH",none:"_GWPlQgHirjrX8TEQ6nfK",edit:"_24gHuNDodXcnJuv07pcDks",notSelectedAndSaving:"_2y7wLZ1Tpx0RK7iBLv07r1",selected:"kGmjRqAnKQ21UAeZi78ic",selectedAndPending:"_1XErEYUoKLr1B9Y-OhAH29",selectedAndSaving:"IeX8f3UgLwd0bSGKcqB76",withBorder:"uCjvHJwE_aECSlIKlAXWC",dragPreview:"_3nazLS-4wRLkGtIH_4xmp-"}},1333:function(e,t,n){"use strict";var r=n(1),a=n(93),i=Object(a.action)("setDragState")((function(e,t){e.isBeingDragged=t})),o=n(1218),c=n(1382),u=n(35),s=n(44);n.d(t,"a",(function(){return l}));var l=function(){function e(e){var t=this;this.props=e,this.initialPageX=0,this.initialPageY=0,this.dragHelperElement=null,this.isPotentialDrag=!1,this.isDragging=!1,this.onDragStart=function(e){e.dataTransfer.clearData(),t.isDragAllowed()?(e.stopPropagation(),t.setDragStateAndData(e),e.dataTransfer.effectAllowed="copyMove",t.onDragStartInternal(e.pageX,e.pageY),t.overrideDefaultDragPreviewImage(e.dataTransfer)):t.props.showDefaultNoDragImage&&(t.overrideDefaultNoDragImage(e.dataTransfer),e.dataTransfer.setData("text","nodrop"),e.dataTransfer.effectAllowed="none")},this.onDragEnd=function(e){if(t.isDragging){t.isDragging=!1;var n=t.props.onDragEnd,r=e?e.dataTransfer.dropEffect:null;(Object(u.d)()||Object(u.f)())&&(r=Object(o.b)()),n&&n(t.props.getDragData(),r)}t.resetDragStateAndData(),t.removeDragHelperElement()},this.onMouseDown=function(e){!c.a&&0==e.button&&t.isDragAllowed()&&(t.initialPageX=e.pageX,t.initialPageY=e.pageY,t.isPotentialDrag=!0,document.body.addEventListener("mousemove",t.onMouseMove),document.body.addEventListener("mouseup",t.onMouseUp)),t.props.onMouseDown&&t.props.onMouseDown(e)},this.refCallback=function(e){t.div=e,t.div&&t.div.addEventListener("mousedown",t.onMouseDown)},this.onMouseMove=function(e){var n=e.pageX,r=e.pageY;(Math.abs(t.initialPageX-n)>=c.b||Math.abs(t.initialPageY-r)>=c.b)&&(t.removeMouseMoveAndUpEventListeners(),t.isPotentialDrag&&(t.isPotentialDrag=!1,(Object(u.d)()||Object(u.f)())&&window.getSelection().removeAllRanges(),t.isDragAllowed()&&(t.dragHelperElement=t.getDragHelperElement(),document.body.appendChild(t.dragHelperElement))),t.dragHelperElement&&(t.dragHelperElement.addEventListener("dragstart",(function(e){t.onDragStartHelperElement(e)})),t.dragHelperElement.addEventListener("dragend",(function(e){t.onDragEnd(e)})),t.dragHelperElement.dragDrop(),setTimeout(t.onDragEnd,0)))},this.onMouseUp=function(e){t.removeMouseMoveAndUpEventListeners()},this.onDragStartHelperElement=function(e){var n=e;n.stopPropagation(),n.dataTransfer.effectAllowed="copyMove",t.setDragStateAndData(n),t.onDragStartInternal(n.pageX,n.pageY)},this.removeMouseMoveAndUpEventListeners=function(){document.body.removeEventListener("mousemove",t.onMouseMove),document.body.removeEventListener("mouseup",t.onMouseUp)},this.removeDragHelperElement=function(){if(document.body)document.body.contains(t.dragHelperElement)&&(document.body.removeChild(t.dragHelperElement),t.dragHelperElement=null);else{var e=t.dragHelperElement?t.dragHelperElement.innerHTML:"null";s.d.error("removeDragHelperElement: "+e)}}}return e.prototype.onUnmount=function(){this.onDragEnd(null),c.a||this.removeMouseMoveAndUpEventListeners(),this.div.removeEventListener("mousedown",this.onMouseDown)},e.prototype.getDiv=function(){return this.div},e.prototype.onDragStartInternal=function(e,t){this.isDragging=!0;var n=this.props.onDragStart;n&&n(this.props.getDragData(),e,t)},e.prototype.setDragStateAndData=function(e){this.props.dragViewState&&i(this.props.dragViewState,!0);var t=this.props.getDragData();try{e.dataTransfer.setData(t.itemType,JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}Object(o.c)(t.itemType)},e.prototype.resetDragStateAndData=function(){this.props.dragViewState&&i(this.props.dragViewState,!1),Object(o.c)(null),Object(o.d)(null)},e.prototype.overrideDefaultDragPreviewImage=function(e){if(c.a){this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement);var t=this.props.xOffset?this.props.xOffset:0,n=this.props.yOffset?this.props.yOffset:0;e.setDragImage(this.dragHelperElement,t,n)}},e.prototype.overrideDefaultNoDragImage=function(e){c.a&&(this.dragHelperElement=document.createElement("div"),this.dragHelperElement.style.display="none",document.body.appendChild(this.dragHelperElement),e.setDragImage(this.dragHelperElement,0,0))},e.prototype.getDragHelperElement=function(){var e=this.props.getDragPreview(this.props.getDragData());return e.style.top="0px",e.style.left="0px",e.style.zIndex="-1000",e.style.position="fixed",e},e.prototype.isDragAllowed=function(){return!this.props.canDrag||this.props.canDrag()},e}();t.b=r.forwardRef((function(e,t){r.useEffect((function(){return function(){n.current.onUnmount()}}),[]);var n=r.useRef(new l(e));return r.useImperativeHandle(t,(function(){return{getDiv:function(){return n.current.getDiv()}}}),[]),c.a?r.createElement("div",{draggable:!e.isDraggable||e.isDraggable(),className:e.classNames,ref:n.current.refCallback,onDragStart:n.current.onDragStart,onDragEnd:n.current.onDragEnd},e.children):r.createElement("div",{className:e.classNames,ref:n.current.refCallback},e.children)}))},1344:function(e,t,n){"use strict";function r(e){return!e.ItemClass||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")}n.d(t,"a",(function(){return r}))},1345:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(833),a=n(37),i=n(913);function o(e){return"Unread"!==Object(r.K)(e)||Object(a.f)("tri-autoMarkReadInUnreadSetting")&&Object(i.a)(64)}},1347:function(e,t,n){"use strict";n.r(t),n.d(t,"EnteredEditModeEvent",(function(){return r})),n.d(t,"ExitedEditModeEvent",(function(){return a})),n.d(t,"PreviewLoadEvent",(function(){return i})),n.d(t,"PreviewErrorEvent",(function(){return o})),n.d(t,"PreviewLoadOrErrorEvent",(function(){return c})),n.d(t,"CloseEvent",(function(){return u})),n.d(t,"AnimationEndEvent",(function(){return s}));var r="EnteredEditMode",a="ExitedEditMode",i="PreviewLoad",o="PreviewError",c="PreviewLoadOrError",u="Close",s="AnimationEnd"},1348:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=1;function a(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1358:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1111),a=n(842);function i(e){return e&&(Object(r.a)(e,a.f)||Object(r.a)(e,a.a))}},1359:function(e,t,n){"use strict";n.r(t),n.d(t,"DESCENDING_SORT_DIR",(function(){return a})),n.d(t,"ASCENDING_SORT_DIR",(function(){return i})),n.d(t,"DEFAULT_SORT_COLUMN",(function(){return o})),n.d(t,"getSortBySupportingPin",(function(){return c})),n.d(t,"getSupportedSortColumns",(function(){return u})),n.d(t,"getDefaultSortDirectionForSortColumn",(function(){return s})),n.d(t,"getDefaultSortBy",(function(){return l})),n.d(t,"isTableMultiValueSort",(function(){return d}));var r=n(839),a="Descending",i="Ascending",o=1;function c(){return{sortColumn:1,sortDirection:a}}function u(e){return Object(r.a)("sentitems")==e||Object(r.a)("drafts")==e?[1,7]:[1,3,7,5,8]}function s(e){switch(e){case 1:case 7:case 5:return a;case 3:case 8:return i;default:throw new Error("getDefaultSortDirectionForSortColumn: sortColumn not supported")}}function l(){return{sortColumn:o,sortDirection:s(o)}}function d(e){var t=0==e.type&&e.sortBy.sortColumn;return t&&0==e.listViewType&&3==t}},1360:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("inboxPlusStore",{inboxPlusPivots:[],isPivotEnableDisableDialogShown:!1})();t.a=a},1362:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1365:function(e,t,n){"use strict";var r=n(0),a="https://www.googleapis.com/drive/v3/files",i=n(1456);function o(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=n.forceTokenRefresh,o=n.requestInit||{},[4,Object(i.d)(t,a,e)];case 1:return c=r.sent(),o.headers||(o.headers=new Headers),o.headers.set("Authorization",c),[4,fetch(e,o)];case 2:return[2,r.sent()]}}))}))}function c(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o(a+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i)}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}function u(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o(a+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var s="_api/v2.0/drive",l=s+"/items",d="root",f=n(221),h=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function m(){return Object.keys(h).map((function(e){return h[e]})).join(",")}var b,p=n(199),v=n(1276),g=n(37);function O(e,t,n,a,i,c,u){return void 0===c&&(c=b.None),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,O,I,w,S,j,y,_,C,A;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=i||d,s=function(e){switch(e){case 0:return h.name;case 1:return h.size;default:return h.lastModifiedDateTime}}(n),O=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(f.a)(e)}}(a),I="expand=thumbnails(select=medium)&orderby=folder,"+s+" "+O+"&select="+m(),c!==b.None&&(I=I+"&filter="+function(e){switch(e){case b.None:return"";case b.Folder:return"("+h.folder+" ne null)";default:return Object(f.a)(e)}}(c)),u&&(I=I+"&$top="+u.maxEntries,u.skipToken&&(I=I+"&$skiptoken="+u.skipToken)),w=e+"/"+l+"/"+i+"/children?"+I,S={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},Object(g.f)("doc-attachment-uploadAndShareFallback")?(y=Response.bind,[4,Object(v.f)(t,encodeURI(w),w,{method:v.b,mode:v.a,datapointNamePrefix:"getOneDriveItems"},S)]):[3,2];case 1:return j=new(y.apply(Response,[void 0,r.sent()])),[3,4];case 2:return[4,o(w,t,{requestInit:{headers:new Headers(S)}})];case 3:j=r.sent(),r.label=4;case 4:return j.ok?[4,j.text()]:[3,6];case 5:return _=r.sent(),C=JSON.parse(_),A=C["@odata.nextLink"]?function(e){var t=Object(p.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(C["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:C.value,skipToken:A}}];case 6:return[2,{errorResponse:j,result:null}]}}))}))}function I(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,c,u,s,f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=a||d,i="expand=thumbnails(select=medium)&select="+m(),c=t+"/"+l+"/"+a+"/children?"+i,u={name:n,folder:{}},(s=new Headers).append("Content-Type","application/json"),s.append("Accept","application/json"),[4,o(c,e,{requestInit:{method:"POST",body:JSON.stringify(u),headers:s}})];case 1:return(f=r.sent()).ok?[4,f.text()]:[3,3];case 2:return h=r.sent(),[2,{errorResponse:null,result:JSON.parse(h)}];case 3:return[2,{errorResponse:f,result:null}]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(b||(b={}));var w=n(3304);var S=n(190),j=Object.freeze({folderInfo:{type:0,identifier:d},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function y(e,t,n){var a=this,i=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(r.__awaiter)(a,void 0,void 0,(function(){var a,c,u,d,h,m,b,p,O,I,y,A,x,T,E,P,D,k,R;return Object(r.__generator)(this,(function(F){switch(F.label){case 0:switch(function(e){Object.keys(j).forEach((function(t){e[t]=e[t]||j[t]}))}(n),a=n.fileToUpload,c=a.fileName,u=a.fileBlob,d=n.folderInfo,h=d.type,m=d.identifier,b=n.conflictBehavior,p=n.sliceSize,O=n.onProgress,h){case 0:I=t+"/"+l+"/"+m+":/"+encodeURI(c)+":/createUploadSession";break;case 1:I=t+"/"+s+"/"+m+":/"+encodeURI(c)+":/createUploadSession";break;default:Object(f.a)(h)}return y={item:{"@name.conflictBehavior":b}},A=new Headers({"Content-Type":"application/json",Accept:"application/json"}),Object(g.f)("doc-attachment-uploadAndShareFallback")?(T=Response.bind,[4,Object(v.f)(e,encodeURI(I),I,{method:v.d,mode:v.a,body:JSON.stringify(y),datapointNamePrefix:"createUploadSession"},null)]):[3,2];case 1:return x=new(T.apply(Response,[void 0,F.sent()])),[3,4];case 2:return[4,o(I,e,{requestInit:{method:v.d,body:JSON.stringify(y),headers:A}})];case 3:x=F.sent(),F.label=4;case 4:return x.ok?[4,x.text()]:[3,7];case 5:return E=F.sent(),P=JSON.parse(E),D=function(e,t,n,a){var i=this,o=e.uploadUrl,c=t.size,u=null,s=null,l=function(e,t,n,a,i,o){var c=this;return function(u,s){return Object(r.__awaiter)(c,void 0,void 0,(function(){var c,l,d,f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=function(e,t,n){var r=_(e,t,n),a=r.rangeStart,i=r.rangeEnd;return new Headers({"Content-Range":"bytes "+a+"-"+i+"/"+n,Accept:"application/json"})}(s,t,n),l=function(e){var r=_(e,t,n).rangeStart;return function(e){var t=e.loaded;a({loaded:r+t,total:n})}}(s),[4,(m=e,b=l,p={method:"PUT",body:u,headers:c},void 0===p&&(p={method:"POST"}),new Promise((function(e,t){var n=p.method,r=p.body,a=p.headers,i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&e({status:i.status,text:function(){return Promise.resolve(i.responseText)}})},i.ontimeout=function(){t(new Error("Request timed out"))},i.onerror=function(){t(new Error("Request failed"))},i.onabort=function(){t(new Error("Request aborted"))},b&&(i.upload.onprogress=b),i.open(n,m,!0),new Headers(a).forEach((function(e,t){i.setRequestHeader(t,e)})),r?i.send(r):i.send()})))];case 1:return 201!==(d=r.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=r.sent(),h=JSON.parse(f),i(h),r.label=3;case 3:if(!Object(S.a)(d.status))throw o(d),new Error("Unable to upload file");return[2]}var m,b,p}))}))}}(o,n,c,a,(function(e){u=e}),(function(e){s=e})),d=Object(w.a)(t,l,{sliceSize:n,numberOfSlicesToParallelize:1}),h=d.onCompletePromise,m=d.cancel,b=Object(r.__awaiter)(i,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,h];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:s,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:s,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(f.a)(e)]}return[2]}}))}));return{uploadPromise:b,cancel:function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:m(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,b];case 2:return e.sent(),[3,5];case 3:return[4,C(o)];case 4:return[2,e.sent()];case 5:return[2]}}))}))}}}(P,u,p,O),k=D.uploadPromise,R=D.cancel,i=R,[4,k];case 6:return[2,F.sent()];case 7:return[2,{errorResponse:x,result:null}]}}))})),cancel:function(){return Object(r.__awaiter)(a,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,i()];case 1:return[2,e.sent()]}}))}))}}}function _(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object(S.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var A="https://api.dropboxapi.com/2/files";function x(e,t){switch(e){case 0:return t;case 1:return null;default:Object(f.a)(e)}return null}function T(e){return"file"===e[".tag"]}function E(e){return"folder"===e[".tag"]}function P(e){return"deleted"===e[".tag"]}function D(e){return"folder"===e.type}function k(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.path=e.path||"",t=A+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,o(t,2,{requestInit:n})];case 1:return(a=r.sent()).ok?[4,a.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:a,result:null}]}}))}))}var R,F="https://api.box.com/2.0",N=2e3;function M(e,t){return void 0===t&&(t=N),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o(F+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return a=r.sent(),[2,{errorResponse:null,result:JSON.parse(a).entries}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(R||(R={}));var L=R,B="https://graph.facebook.com/v2.7",V=200;function U(e,t){return void 0===t&&(t=V),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o(B+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return a=r.sent(),[2,{errorResponse:null,result:JSON.parse(a).data}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}var W=n(534),H=n.n(W),z=n(535),q=n.n(z),G=n(340),J=n.n(G),Q=n(839),X=n(924),Y=n.n(X),K=n(392),Z=n.n(K),$=n(155),ee=n(44);function te(e,t){var n=function(e,t){return q()({ParentFolderIds:[J()({Id:e})],ItemShape:Z()({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return H()({Header:Object($.getJsonRequestHeader)(),Body:n})}function ne(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Y()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,te(e=e||Object(Q.a)("inbox"),n)];case 1:return a=r.sent(),(i=a.Body.ResponseMessages.Items[0])&&"Success"===i.ResponseClass&&i.RootFolder.Items?[2,{errorResponse:null,result:i.RootFolder.Items}]:(ee.d.warn("Find Item Response of get mail messages failed with "+i),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return O})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return I})),n.d(t,"u",(function(){return y})),n.d(t,"f",(function(){return"https://api.onedrive.com"})),n.d(t,"a",(function(){return"_api/v2.0/shares"})),n.d(t,"c",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"e",(function(){return a})),n.d(t,"p",(function(){return x})),n.d(t,"s",(function(){return T})),n.d(t,"t",(function(){return E})),n.d(t,"r",(function(){return P})),n.d(t,"j",(function(){return k})),n.d(t,"q",(function(){return D})),n.d(t,"i",(function(){return M})),n.d(t,"b",(function(){return F})),n.d(t,"d",(function(){return L})),n.d(t,"k",(function(){return U})),n.d(t,"n",(function(){return ne}))},1374:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},1379:function(e,t,n){"use strict";var r=n(221),a=n(8),i=n(36),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",h="pdfprint.aspx?id={0}&location={1}",m=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var b=n(1187),p=n(208),v=n(48),g=n(2);function O(e,t,n,c,s,d,f,b,p){var v;switch(void 0===s&&(s=0),void 0===d&&(d=0),void 0===f&&(f=!0),void 0===b&&(b=null),void 0===p&&(p=null),n){case 0:v=u;break;case 3:v=h;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&m.indexOf(t.toLowerCase())>=0}(b))return null;v=l;break;default:Object(r.a)(n)}var g=c?d:s;!g&&s&&(g=s);var O=Object(a.b)("{0}{1}{2}&permissionLevel={3}",o,p,Object(a.b)(v,encodeURIComponent(e.Id),encodeURIComponent(t)),g);f&&(O=O+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return O}function I(e,t,n,u,l){var h;switch(void 0===u&&(u=!1),void 0===l&&(l=!0),n){case 0:h=c;break;case 1:h=s;break;case 2:h=d;break;case 3:h=f;break;default:return Object(r.a)(n)}return Object(a.f)(h)?null:Object(a.b)("{0}{1}{2}",function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var u=Object(a.b)(n,encodeURIComponent(t.Id));if(!Object(b.c)()||c&&"Firefox"===Object(v.a)().browser)return o+u+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var s="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(p.a)()&&(s+="&isc=1");var l=Object(a.b)(s,Object(b.b)(),e,u,window.location.hostname,Object(g.g)()||"unofficial");return r&&(l+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),l+="&token="+Object(b.a)()),l}(e,t,h,l,3===n),u?"&isDownload=true":"","&animation=true")}n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return I}))},1382:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=5,a="undefined"!=typeof window&&window.hasOwnProperty("DataTransfer")&&DataTransfer.prototype.setDragImage},1386:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1004),a=n(1196);function i(e,t,n){switch(t.tableQuery.listViewType){case 0:Object(r.a)(e,t.id).instrumentationContext=n;break;case 1:Object(a.a)(e,t.id).instrumentationContext=n}}},1404:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2180),a=n(1585),i=n(1586),o=n(8),c=n(1360),u=n(836),s=n(839);function l(e){switch(e){case 0:return{displayText:1===c.a.inboxPlusPivots.filter((function(e){return e.isEnabled})).length?u.e.folderTable.get(Object(s.a)("inbox")).DisplayName:Object(o.a)(r.a),icon:"Inbox"};case 1:return{displayText:Object(o.a)(i.a),icon:"InboxCheck"};case 2:return{displayText:Object(o.a)(r.c),icon:"ShoppingCart"};case 3:return{displayText:Object(o.a)(r.d),icon:"Like"};case 4:return{displayText:Object(o.a)(r.b),icon:"News"};case 5:return{displayText:Object(o.a)(a.a),icon:"MailLowImportance"};default:return null}}},1406:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ConversationReadingPane=0]="ConversationReadingPane",e[e.ItemReadingPane=1]="ItemReadingPane"}(r||(r={}))},1408:function(e,t,n){"use strict";var r=n(0),a=n(1786),i=n(1930),o=n(221);var c=Object(a.a)((function(e){switch(e){case 0:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(i.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(o.a)(e)}})),u=c.getDataProviderInfo;c.getDefaultDataProviderInfo;t.a=u},14098:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(193),i=n(74),o=n(919),c=n(876),u=n(3073),s=n(1915),l=n(37),d=n(2101),f=n(992),h={ClickAttachment:{name:"ClickAttachment",customData:function(e,t,n,r,a,i,c,u){return void 0===r&&(r=null),void 0===a&&(a=!1),{actionPerformed:o.a[Object(o.e)(e.strategy)],actionSource:f.c[t]}}}},m=n(3507),b=Object(i.d)("clickAttachment",h.ClickAttachment)((function(e,t,n,i,f,h,b,p){var v,g;return void 0===i&&(i=null),void 0===f&&(f=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var O,I,w;return Object(r.__generator)(this,(function(r){if(O=Object(c.a)(e.attachmentId),!e.strategy)return[2];switch(Object(o.e)(e.strategy)){case o.a.Preview:I={viewState:e,previewPaneSelectionSource:t,parentItemId:i,isDraft:f,isEdit:!1,onBeforePreview:h,createImageGallery:b,instrumentationContext:n},Object(m.a)(I),Object(d.d)("PreviewOfAttachmentStarted",[n]);break;case o.a.Download:Object(u.b)(e.attachmentId,e.isCloudy,p),Object(l.f)("doc-attachment-sigs")&&a.l.importAndExecute("AttachmentSaved",{itemId:null==i?void 0:i.Id,customProperties:{FileId:null===(v=e.attachmentId)||void 0===v?void 0:v.Id,Destination:"Local"}});break;case o.a.OpenInNewTab:(w=O).openUrl&&(Object(s.f)(w.openUrl),Object(d.d)("OpenedAnAttachment",[n]),a.l.importAndExecute("OpenedAnAttachment",{itemId:null==i?void 0:i.Id,customProperties:{FileId:null===(g=e.attachmentId)||void 0===g?void 0:g.Id}}))}return[2]}))}))}));n.d(t,"clickAttachment",(function(){return b})),n.d(t,"previewAttachment",(function(){return m.a}))},1410:function(e,t,n){"use strict";var r=n(1379);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var a=n(1187);n.d(t,"c",(function(){return a.a}))},1419:function(e,t,n){"use strict";var r=n(0),a=n(193),i=n(3124),o=n(876),c=n(2501),u=n(2748),s=n(37),l=n(93),d=n(1986),f=n(1824),h=n(2215),m=n(1026),b=Object(l.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return I}));t.a=Object(l.action)("saveToCloud")((function(e,t,n,a){var i=Object(r.__read)(v(e,t,n,a,!1),2),o=i[0],c=i[1];Object(u.b)(e.attachmentId,null,o,c)}));function p(e,t,n,a,i){var o=Object(r.__read)(v(e,t,n,a,!0),2),c=o[0],s=o[1];Object(u.c)(e.attachmentId,c,s,i)}function v(e,t,n,r,i){var o=new a.a("AttachmentSaveToCloud");d.a.run(2,e.attachmentId),O(e,i);return[function(a){var i=0===a.ResultCode;return I(e,i,i?a.Item.Location:null),t(i),g(o,e.attachmentId,a.ResultCode,"ServerError",a.Exception,n,r),!0},function(a,i,c){I(e,!1,null),t(!1),g(o,e.attachmentId,i,c,a,n,r)}]}function g(e,t,n,r,i,u,l){var d=Object(o.a)(t);e.addCustomData({entryPoint:u,result:n}),e.addCosmosOnlyData(JSON.stringify({size:d.model.Size,fileType:Object(c.a)(d)})),0===n?e.end():e.endWithError(r,new Error(i)),Object(s.f)("doc-attachment-sigs")&&a.l.importAndExecute("AttachmentSaved",{itemId:null==l?void 0:l.Id,customProperties:{FileId:t.Id,Destination:"Cloud"}})}function O(e,t){void 0===t&&(t=!1);var n=t?18:1;Object(m.a)(e,2,n)}function I(e,t,n){if(t){Object(f.a)(e,2),Object(i.a)(e.attachmentId,n),d.a.run(3,e.attachmentId);var r=Object(h.b)(!1,!1,n);b(e,r)}else d.a.run(4,e.attachmentId);Object(m.a)(e,0,t?3:4)}},1424:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1428:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected",e[e.SelectedAndPending=3]="SelectedAndPending",e[e.SelectedAndSaving=4]="SelectedAndSaving",e[e.NotSelectedAndSaving=5]="NotSelectedAndSaving",e[e.OtherSaving=6]="OtherSaving",e[e.PendingNavigation=7]="PendingNavigation"}(r||(r={})),t.a=r},1435:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(49),a=n(32);function i(){var e=Object(r.getCookie)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.getCookie)(t)}function o(){var e="",t=Object(a.a)().pathname.split("/").filter((function(e){return e.length}));return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}function c(){var e=o();return e||(e=i()),e}},1440:function(e,t,n){"use strict";var r=n(73),a=n(1821),i=n(1769),o=(n(1282),n(1301)),c=n(1454),u=(n(2402),n(2349),n(1251));var s=n(1741),l=n(1563),d=n(1202);n.d(t,"l",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"m",(function(){return p})),n.d(t,"b",(function(){return a.a})),n.d(t,"i",(function(){return i.a})),n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"o",(function(){return o.c})),n.d(t,"a",(function(){return c.b})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b})),n.d(t,"j",(function(){return s.a})),n.d(t,"c",(function(){return l.a})),n.d(t,"f",(function(){return d.b}));var f=new r.c((function(){return Promise.all([n.e(624),n.e(13),n.e(25),n.e(238)]).then(n.bind(null,13910))})),h=new r.b(f,(function(e){return e.loadProviders})),m=new r.b(f,(function(e){return e.removeFileProvider})),b=new r.b(f,(function(e){return e.addFileProvider})),p=new r.b(f,(function(e){return e.removeAndAddFileProvider}))},1449:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(73),a=n(1044);n.d(t,"e",(function(){return a.a})),n.d(t,"b",(function(){return a.b}));var i=n(1327);n.d(t,"d",(function(){return i.a}));var o=n(1159);n.d(t,"c",(function(){return o.a}));var c=new r.c((function(){return n.e(235).then(n.bind(null,2835))})),u=Object(r.d)(c,(function(e){return e.CloudIconWithOverlay}))},1454:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(a.__spread)(i,[0,4,10]))},1456:function(e,t,n){"use strict";var r=n(0),a=n(2252),i=n.n(a),o=n(8),c=n(208),u=n(593),s=n(199),l=n(2253),d=n.n(l),f=n(1564),h=n.n(f);function m(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,o,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a=h()({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),i=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(o=new Headers).append("X-OWA-ActionName",i),c={headers:o,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0},[4,d()(a,c)];case 1:return[4,(u=r.sent()).json()];case 2:return[2,{token:r.sent(),response:u}]}}))}))}var b="onedrive_implicit.access",p="Bearer ",v=n(37),g=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},O=function(e){return"TokenRetrievalError"===e._typeSpec},I=[],w={},S=1,j=30,y="",_="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function C(e){w[e]=null}function A(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,m(e,t,n)];case 1:return a=r.sent(),function(e,t,n){I=I.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var a="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,i=n.response.headers.get("x-tokenresult"),o=null!=i&&i.indexOf(_)>0;throw g(new Error(a),r.TokenResultCode,o)}var c=w[e]||{};c[t]=r,w[e]=c}(e,t,a),[2,a.token]}}))}))}function x(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){return a=y,0===e&&n&&(i=Object(s.parse)(n),a=Object(o.b)("{0}//{1}/",i.protocol,i.hostname)),Object(v.f)("doc-attachment-testAuthFallback")?[2,""]:[2,E(e,a,t,null)]}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,E(0,e,t,n)]}))}))}function E(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=w[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var a=new Date(r.AccessTokenExpiry),o=i()(new Date(Date.now()),S);return null!=a&&o<a}(e,t)?[3,1]:(o=w[e],c=o[t],i()(new Date(Date.now()),j)>new Date(c.AccessTokenExpiry)&&-1===I.indexOf(t)&&(I.push(t),A(e,t,a)),[2,c.AccessToken]);case 1:return[4,A(e,t,a)];case 2:return[2,(c=r.sent()).AccessToken]}}))}))}function P(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(b)]:[3,2];case 1:return a=r.sent(),[3,4];case 2:return[4,x(e,t,n)];case 3:a=r.sent(),r.label=4;case 4:return[2,p+a]}}))}))}n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return x})),n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return C})),n.d(t,"f",(function(){return O})),n.d(t,"a",(function(){return p}))},1484:function(e,t,n){"use strict";var r=n(221),a=n(78),i=n(1410),o=n(36),c=n(1258);function u(e,t,n,o,u){var s;void 0===u&&(u=!0);var l=t,d=l.AttachmentId,f=l.Name,h=l.OriginalPermissionType,m=l.PermissionType,b=Object(c.a)(t),p=(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)===a.a.GroupMailbox?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(d,b,n,o,m,h,u,f,p);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(d,b,1,o,m,h,u,f,p);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),i.a(e.mailboxInfo.routingKey,e,t,n,r)}function l(e,t,n,r,a){void 0===a&&(a=!1);var c=n?u(e,t,1,r,!1):s(e,1,a,!1);if(n)return{url:c,init:{credentials:"include"}};var l=Object(i.c)(),d=new Headers;return d.set("X-Token",l),d.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:c,init:{headers:d}}}function d(e,t,n,r,a,i){return void 0===i&&(i=!1),r?u(e,t,n,a):s(e,n,i)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}))},1502:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1520:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1521:function(e){e.exports=JSON.parse('{"a":"Zba"}')},1522:function(e){e.exports=JSON.parse('{"a":"Yba"}')},1533:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r={};function a(e,t){r[e]=t}function i(e){return e in r?r[e]:null}function o(e){r[e]=null}},1545:function(e,t,n){"use strict";function r(e,t){return"search/api/"+(2===t?"v2":"v1")+"/"+e}n.d(t,"a",(function(){return r}))},1555:function(e){e.exports=JSON.parse('{"a":"Xba"}')},1556:function(e){e.exports=JSON.parse('{"a":"bca"}')},1561:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1562:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1563:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},1582:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(37),i=n(3),o=null,c="searchtesthook";function u(e){void 0===e&&(e={});var t=Object(r.__assign)(Object(r.__assign)({},e),function(){if(!o){o={};var e=Object(i.a)(c),t=decodeURIComponent(e||"").trim();if(Object(a.f)("sea-debugHook")&&t.length>0){var n=t.split("&");o=n.reduce((function(e,t){var n=Object(r.__read)(t.split("="),2),a=n[0],i=n[1];return e[a]=i,e}),{})}}return o}()),n=Object.keys(t).map((function(e,n){return e+"="+t[e]}));return n?n.join("&"):""}},1585:function(e){e.exports=JSON.parse('{"a":"dJb"}')},1586:function(e){e.exports=JSON.parse('{"a":"cJb"}')},1587:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1345),a=n(833);function i(e){return"Unread"==Object(a.K)(e)&&Object(r.a)(e)}},1589:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1590:function(e){e.exports=JSON.parse('{"b":"_ba","c":"$ba","a":"aca"}')},1600:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(18),a=n(208),i=n(221),o=n(37);function c(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(o.f)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},1612:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.Files=3]="Files",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.WebSearch=8]="WebSearch"}(r||(r={}))},1613:function(e){e.exports=JSON.parse('{"a":"aia"}')},1614:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1585),a=n(1586),i=n(2128),o=n(8),c=n(1404),u=n(1015),s=n(833);function l(e,t,n){if(1===e)return Object(o.a)(i.a);if(t){if(Object(s.J)(t))return Object(s.J)(t);var l=Object(s.l)(t),d=Object(s.p)(t.id);if(Object(u.d)()&&0!==d)return Object(c.a)(d).displayText;switch(l){case 0:return Object(o.a)(a.a);case 1:return Object(o.a)(r.a)}}return n}},1615:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(833);function a(e){var t=Object(r.F)().tableViews.get(e);switch(t.tableQuery.type){case 0:return t.tableQuery.inboxClassificationFilter;case 2:case 1:return 0;default:throw new Error("Table Query should be either of type search, mail folder or group")}}},1626:function(e,t,n){"use strict";function r(){return(new Date).toISOString()}n.d(t,"a",(function(){return r}))},1627:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(844);function a(e){return Object(r.a)(e).searchBoxWidth}},1629:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(65),a=n(839);function i(e){var t=Object(r.h)(),n=1==t.PolicySettings.MessagePreviewsDisabled;return t.UserOptions.ShowReadingPaneOnFirstLoad&&!n&&e.tableQuery.folderId!==Object(a.a)("junkemail")}},1630:function(e){e.exports=JSON.parse('{"a":"XIb","b":"YIb","c":"ZIb"}')},1631:function(e){e.exports=JSON.parse('{"b":"TIb","c":"UIb","d":"VIb","a":"WIb"}')},1632:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(37);function a(e,t){switch(e.tableQuery.type){case 0:return Object(r.f)("tri-triageFolderScope")&&t?e.tableQuery.folderId:e.serverFolderId;case 1:case 2:default:return null}}},1633:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(852),a=n(1110);function i(e,t){var n=r.a.tableViews.get(t),i=[];return e.forEach((function(e){var t=Object(a.getRowIdString)(e,n);-1==i.indexOf(t)&&i.push(t)})),i}},1634:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1004);function a(e,t,n,a){for(var i=[],o=new Map,c=0;c<e.length;c++){var u=e[c],s=Object(r.a)(u,t),l=s.id;!o.get(l)&&n(s,a)&&(i.push(u),o.set(l,!0))}return i}},1641:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(968);function a(e){switch(e){case r.b.Mail:return"Mail";case r.b.Calendar:return"Calendar";case r.b.FilesHub:return"FilesHub";case r.b.FilesPicker:return"FilesPicker";case r.b.Spaces:return"Spaces";default:throw Error("Unknown SearchScenarioId value!")}}},1648:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"r",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return g})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return I})),n.d(t,"i",(function(){return w})),n.d(t,"a",(function(){return S}));var r=n(73),a=(n(1681),new r.c((function(){return Promise.all([n.e(675),n.e(7),n.e(13),n.e(33),n.e(583)]).then(n.bind(null,3431))}))),i=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(a,(function(e){return e.trySetSmimeProperties})),s=new r.b(a,(function(e){return e.tryAddSmimeProperties})),l=new r.b(a,(function(e){return e.createMailResponseBodyContent})),d=new r.b(a,(function(e){return e.downloadSmimeAttachment})),f=new r.b(a,(function(e){return e.getMergedSmimeViewState})),h=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),m=new r.b(a,(function(e){return e.isSmimeItemDecoding})),b=new r.b(a,(function(e){return e.previewSmimeAttachment})),p=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),v=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),g=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),O=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),I=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),w=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),S=Object(r.d)(a,(function(e){return e.SignatureDetails}))},1663:function(e,t,n){"use strict";var r=n(0),a=n(452),i=n(972);function o(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=t||Object(a.a)(),o={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},c=function(t){e(t)&&i.h.importAndExecute(o,c)},[4,i.g.import()];case 1:return r.sent()(o,c),[4,i.b.import()];case 2:return u=r.sent()(),[2,[n,o,c,u]]}}))}))}n.d(t,"a",(function(){return o}))},1676:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v}));var r=n(1236),a=n.n(r),i=n(1246),o=n.n(i),c=n(1309),u=n.n(c),s=n(847),l=n.n(s),d=n(155),f=n(981),h=n(924),m=n.n(h),b=1e3;function p(e,t){return o()({FolderShape:u()({BaseShape:"IdOnly",AdditionalProperties:[l()({FieldURI:"DistinguishedFolderId"}),l()({FieldURI:"FolderClass"}),l()({FieldURI:"FolderDisplayName"}),l()({FieldURI:"ParentFolderId"}),l()({FieldURI:"TotalCount"}),l()({FieldURI:"UnreadCount"})]}),Paging:m()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:b}),ParentFolderIds:e,ReturnParentFolder:!0,ShapeName:"Folder",Traversal:"Deep"})}function v(e,t){void 0===t&&(t=0);var n=e,r=p([n],t);return a()({Header:Object(d.getJsonRequestHeader)(),Body:r},Object(f.a)(n.Id)).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},1681:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",(function(e,t){return{smimeViewState:e,signingCertRawData:t}}))},1700:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var r=n(0),a=new(n(73).c)((function(){return n.e(636).then(n.t.bind(null,3603,7))})),i=null;function o(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return i?[3,2]:[4,a.import()];case 1:e=t.sent(),i=e.default,t.label=2;case 2:return[2,i]}}))}))}var c="span",u="unmark",s="mark",l=9},1702:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4),a=Object(r.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),i=Object(r.action)("SET_REPLICA_LIST",(function(e,t){return{folderId:e,replicaList:t}})),o=Object(r.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",(function(e,t,n){return{rootFolder:e,treeType:t,principalSMTPAddress:n}}))},1732:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1435),a=n(18);function i(){var e=Object(r.c)();return e||Object(a.a)().SessionSettings.UserEmailAddress}},1735:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r={};function a(e,t){var n,a=e.infoBarHostKey;return null===(n=r[a])||void 0===n?void 0:n[t]}},1740:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},1741:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1282);function a(){return Object(r.a)().loadState}},1745:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},1746:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},1758:function(e,t,n){"use strict";var r=n(844),a=n(4);t.a=Object(a.mutatorAction)("setNextSearchQueryId",(function(e,t){Object(r.a)(t).nextSearchQueryId=e}))},1769:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2584),a=n(2348),i=n(2489),o=n(8),c=n(221);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.a)(i.b);case 1:return Object(o.a)(i.a);case 2:case 9:return Object(o.a)(r.b);case 3:case 7:return Object(o.a)(r.a);case 5:return Object(o.a)(r.e);case 6:return Object(o.a)(r.d);case 4:return Object(o.a)(r.f);case 10:return Object(o.a)(a.b);case 8:return Object(o.a)(r.c);default:return Object(c.a)(e)}}},1785:function(e){e.exports=JSON.parse('{"a":"cga","c":"dga","b":"ega"}')},1786:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(883),i=n(965),o=[0,1,3,2,6,5,7,8,4];function c(e){var t=null,n=function(n){var a=Object(i.b)(n);return null===a?null:function(){var n,a;if(!t){t={};try{for(var i=Object(r.__values)(o),c=i.next();!c.done;c=i.next()){var u=c.value;t[u]=e(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}}return t}()[a]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?a.l:a.m)}}}},1787:function(e,t,n){"use strict";function r(e){window.open(e,"_blank")}n.d(t,"a",(function(){return r}))},1792:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},1793:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),a=n(221),i=n(1786),o=n(208);var c=Object(i.a)((function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},t),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},e),{supportConvertCloudyToClassic:Object(o.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(a.a)(e)}var t})),u=c.getDataProviderInfo,s=c.getDefaultDataProviderInfo;t.a=u},1794:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(919),i=n(965);function o(e,t,n,o,c,u,s){void 0===c&&(c=i.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var l=Object(a.c)(e,t,o,u,c,s),d=l.strategy;return Object(r.__assign)(Object(r.__assign)({},l),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},d),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},1814:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1031),a=n(1374),i=n(1362);function o(){return{previewPane:{downloadUrl:null,mode:a.a.Blank},didAutoHideRightPane:!1,hideRightPane:!1,rightPaneSize:0,leftPaneSizePixels:0,rightPaneSizePixels:0,rightPaneDisplay:i.a.Initial,eventManager:new r.a}}},1821:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},1824:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},1878:function(e,t,n){"use strict";var r=n(4),a=n(74),i=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(a.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=i},190:function(e,t,n){"use strict";var r=n(465);n.d(t,"a",(function(){return r.a}))},1909:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function a(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},1910:function(e,t,n){"use strict";var r=n(12),a=n(4),i={sharingLinks:new r.ObservableMap({})},o=Object(a.createStore)("sharingLinkStore",i);t.a=o},1915:function(e,t,n){"use strict";var r=n(2087),a=n(857),i=n(2188),o=n(971);function c(e){var t=Object(o.e)(e,!0),n=Object(a.b)(e.Name);return Object(i.a)(t,e,n)}function u(e){var t=Object(a.b)(e.Name);return c(e)&&t&&(".pdf"===t.toLowerCase()&&Object(r.a)()||Object(a.f)(e.Name))}var s=n(2135),l=n(1787),d=n(73);n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s.a})),n.d(t,"f",(function(){return l.a}));var f=new d.c((function(){return Promise.all([n.e(7),n.e(13),n.e(122)]).then(n.bind(null,14093))})),h=new d.a(f,(function(e){return e.print})),m=new d.a(f,(function(e){return e.download}))},1930:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function a(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},1948:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];var n=[];if(0===t){var r=e;r.CanShareInternally&&(n.push(2),n.push(1)),r.CanCreateOrganizationEditLink&&n.push(6),r.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function a(e){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;default:return 0}}function i(e,t,n){var r=a(e);if(0===r)switch(t){case 2:return n?4:3;case 1:return n?6:5;case 5:return n?2:1;default:return 0}return r}var o=n(3260),c=n(8),u="OneDrivePro",s=n(221),l=n(18);function d(e,t){switch(e){case 3:return Object(c.a)(o.b);case 4:return Object(c.a)(o.a);case 6:return Object(c.a)(o.d);case 5:return Object(c.a)(o.e);case 1:return t===u?Object(c.a)(o.g):Object(c.a)(o.b);case 2:return t===u?Object(c.a)(o.f):Object(c.a)(o.a);case 0:return Object(c.a)(o.c);default:return Object(s.a)(e)}}function f(e,t){return 0===t?function(e){var t,n=null===(t=Object(l.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(c.a)(o.i);case 4:return Object(c.a)(o.h);case 6:return Object(c.b)(Object(c.a)(o.j),n);case 5:return Object(c.b)(Object(c.a)(o.k),n);case 1:return Object(c.a)(o.g);case 2:return Object(c.a)(o.f);case 0:return Object(c.a)(o.c);default:return Object(s.a)(e)}}(e):d(e,null)}function h(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return h}))},1983:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},1986:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=null,a={register:function(e){r=e},run:function(e,t){r&&r(e,t)}}},2006:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return v})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return O})),n.d(t,"e",(function(){return w})),n.d(t,"l",(function(){return S})),n.d(t,"b",(function(){return j}));var r=n(2571),a=n(2240),i=n(48),o=n(1197),c=n(1520),u=n(18);function s(){return Object(i.d)()||Object(i.e)()}function l(e){return function(e){if(e.length<2)return!1;var t=e[0]-parseInt(o.b),n=e[1]-parseInt(o.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map((function(e){return parseInt(e)})):[])}function d(e){var t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=o.b}function f(){return Object(i.l)()&&(Object(i.h)()&&Object(i.b)()[0]==o.i&&Object(a.a)()||Object(r.a)())}function h(e){return 0!==e}function m(e){var t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);var n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function b(e){var t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function p(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function v(e,t){var n=Object(u.a)().SmimeAdminSettings.ClearSign;return t||e&&!n?c.a:o.e}function g(e){return btoa(unescape(encodeURIComponent(e)))}function O(e,t){var n=Object(u.a)().SmimeAdminSettings;return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function I(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function w(){return o.m+I()+I()+I()+I()}function S(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function j(){return o.d+I()+"@"+I()+"."+I()}},2056:function(e,t,n){"use strict";var r=n(8),a=n(3064),i=n(3302),o=n(1408),c=n(3261),u=n(2825),s=n(3121),l=n(1128),d=n(2734),f=n(971),h=n(18),m=n(44),b=n(93),p=n(964);var v=n(0),g=n(1008);t.a=Object(b.action)("addAndInitializeAttachments")((function(e,t,n,O){void 0===n&&(n=!1),void 0===O&&(O=!1);var I=Object(p.a)();n||(e=e.filter((function(e){return!I.attachments.has(e.attachment.AttachmentId.Id)}))),e.map((function(e){var n=e.attachmentId,I=e.attachment,w=e.permissionInfo,S=e.modelInitializationValues,j=function(e,t){var n={id:e,type:Object(g.a)(t),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:t};return 1===n.type?Object(v.__assign)(Object(v.__assign)({},n),{type:1,openUrl:null,isFolder:t.AttachmentIsFolder,requiresFetchingSharingInformation:!1}):n}(n,I);return O||function(e,t,n){var v=Object(l.a)(e),g=Object(f.e)(e.model,!0),O=Object(i.a)(g,e.model);if(e.attachmentClass=O,e.info=Object(a.a)(g,O,e.model,v,v?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(u.a)(e.id,e.model,!0,!0)),v&&(e.openUrl=Object(s.a)(e.model,Object(h.a)()),!n)){var I=e.model,w=Object(o.a)(I.ProviderType);(null==w?void 0:w.requiresFetchingSharingInformation)&&!Object(r.f)(I.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)}if(Object(d.a)(e.model)){var S=e.id.Id;Object(c.a)(e.id,e.model,v).then(Object(b.action)("updateAttachmentThumbnailUrl")((function(e){Object(p.a)().attachments.has(S)&&(Object(p.a)().attachments.get(S).thumbnailImage.url=e)})),(function(e){m.d.warn(e)}))}}(j,w,t),function(e,t){t=t||{},Object.keys(t).forEach((function(n){t[n]&&(e[n]=t[n])}))}(j,S||{}),j})).forEach((function(e){I.attachments.set(e.id.Id,e)}))}))},2078:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1613),a=n(8),i=n(1295);function o(e,t){var n=t||Object(a.a)(r.a),o=n;return Object(i.a)(e)||(o=""),{ariaLabel:n,placeholder:o}}},2079:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(844);function a(e){return!!Object(r.a)(e).suggestionPills.size}},2087:function(e,t,n){"use strict";function r(e,t,n){var r,a=e||((null===(r=null===window||void 0===window?void 0:window.navigator)||void 0===r?void 0:r.userAgent)?window.navigator.userAgent:""),i=-1!==a.indexOf("MSIE")||-1!==a.indexOf("rv:")&&-1!==a.indexOf("Trident"),o=-1===a.indexOf("Edge")&&-1!==a.indexOf("Chrome"),c=-1!==a.indexOf("Firefox"),u=-1!==a.indexOf("Edge");return o?function(e){return(e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins))&&"function"==typeof e.namedItem&&(null!==e.namedItem("Chrome PDF Viewer")||null!==e.namedItem("Microsoft Edge PDF Viewer"))}(n):i?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(t||function(e){return new ActiveXObject(e)}):!c&&!u}n.d(t,"a",(function(){return r}))},2100:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(function(e,t){return{jsEndToEndTime:e,jsRenderingTime:t}}))},2101:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(73),a=n(1983);n.d(t,"d",(function(){return a.a}));var i=new r.c((function(){return n.e(327).then(n.bind(null,4116))})),o=new r.a(i,(function(e){return e.onKeyboardUpDown})),c=new r.a(i,(function(e){return e.onOpenEmail})),u=new r.a(i,(function(e){return e.onKeyboardToggleSelect}))},2126:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r={};function a(e){return r[e]}function i(e,t){r[e]=t}},2128:function(e){e.exports=JSON.parse('{"a":"iJb"}')},2135:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1787),a=n(35);function i(e,t,n,i){var o;if(t||Object(a.f)())Object(r.a)(e);else{var c=document.createElement("a");c.style.display="none",c.href=e,c.download=i||"",n||(n=(null===(o=document.activeElement)||void 0===o?void 0:o.parentElement)||document.body),n.appendChild(c),c.click(),n.removeChild(c)}}},2141:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function a(e){var t,n;t=e+" - start",r&&(null===(n=null===performance||void 0===performance?void 0:performance.mark)||void 0===n||n.call(performance,t))}function i(e){var t,n;if(r){try{null===(t=null===performance||void 0===performance?void 0:performance.measure)||void 0===t||t.call(performance,e,e+" - start")}catch(e){return}var a=performance&&performance.getEntriesByName(e);return null===(n=null===performance||void 0===performance?void 0:performance.clearMarks)||void 0===n||n.call(performance,e+" - start"),a&&a.length>0?a.slice(-1)[0]:void 0}}},2151:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){i(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o}))},2152:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2161:function(e,t,n){"use strict";var r=n(1317),a=n(0),i=n(1009),o=n(907);var c=n(2733);function u(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==o.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===o.a.Wac&&(r.previewMethod=o.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter((function(e){return e!==i.a.Preview}))),n.label=2;case 2:return[2]}var r}))}))}var s=n(1794),l=n(965),d=n(1143),f=n(2056),h=n(876);function m(e,t,n,a,i,o,c,m,b){void 0===c&&(c=null),void 0===b&&(b=!1),Object(f.a)([{attachmentId:e,attachment:t}],n,i);var p=Object(h.a)(e),v=Object(s.a)(e,n,a,1===p.type,l.a.Unknown,!1,c);if(Object(r.a)(v,p,!1,m,o),b){var g=p.model.ProviderType;Object(d.b)(v.isCloudy,g,p.model.Name)||u(v)}return v}n.d(t,"a",(function(){return m}))},2173:function(e){e.exports=JSON.parse('{"b":"TEb","a":"UEb"}')},2174:function(e,t,n){var r=n(2175),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},2175:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'.DqR_QI9wxI9eR6VFTBDcQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 30px;flex:1 1 30px;position:relative}html[dir] .DqR_QI9wxI9eR6VFTBDcQ{padding-bottom:2px}._1Qs0_GHrFMawJzYAmLNL2x,._1Ni7eAfyUBqk15RoZliWfC{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;font-weight:400;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;width:100%}html[dir] ._1Qs0_GHrFMawJzYAmLNL2x,html[dir] ._1Ni7eAfyUBqk15RoZliWfC{background:transparent;border:0}._1Qs0_GHrFMawJzYAmLNL2x::-ms-clear,._1Ni7eAfyUBqk15RoZliWfC::-ms-clear{display:none}._1dMfnPdablqcwDvVlOI1Ai::-webkit-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai::-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-ms-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1LtnCG5oLbhQOwtufJyBi8::-webkit-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8::-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-ms-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1Qs0_GHrFMawJzYAmLNL2x{color:"[theme:black, default:#000000]";z-index:1}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-webkit-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-ms-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={searchBoxInputContainer:"DqR_QI9wxI9eR6VFTBDcQ",searchBoxInput:"_1Qs0_GHrFMawJzYAmLNL2x",searchBoxInputBase:"_1Ni7eAfyUBqk15RoZliWfC",inputPlaceholder:"_1dMfnPdablqcwDvVlOI1Ai",inSearchinputPlaceholder:"_1LtnCG5oLbhQOwtufJyBi8",isDisabled:"_28FTnx_o_MRIbFoSOl9_0"}},2176:function(e,t,n){var r=n(2177),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},2177:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._33tO85F3n_fu7qMMmS4oN3,._1dHZpReBf_xUafaqKmcpI2{color:inherit;font:inherit;cursor:pointer;outline:inherit;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:32px}html[dir] ._33tO85F3n_fu7qMMmS4oN3,html[dir] ._1dHZpReBf_xUafaqKmcpI2{background:none;border:none;padding-bottom:0;padding-top:0}._33tO85F3n_fu7qMMmS4oN3{color:"[theme:headerSearchButtonIcon, default:#FFFFFF]"!important}html[dir] ._33tO85F3n_fu7qMMmS4oN3{background:"[theme:headerSearchButtonBackground, default:#0078D4]"}._33tO85F3n_fu7qMMmS4oN3:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._33tO85F3n_fu7qMMmS4oN3:hover{background:"[theme:headerSearchButtonBackgroundHover, default:#004578]"}._1dHZpReBf_xUafaqKmcpI2{color:"[theme:neutralDark, default:#212121]"}html[dir] ._1dHZpReBf_xUafaqKmcpI2{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._1dHZpReBf_xUafaqKmcpI2{border-top-left-radius:0;border-bottom-left-radius:0}html[dir=rtl] ._1dHZpReBf_xUafaqKmcpI2{border-top-right-radius:0;border-bottom-right-radius:0}._1dHZpReBf_xUafaqKmcpI2:hover{color:"[theme:neutralDark, default:#212121]"}html[dir] ._1dHZpReBf_xUafaqKmcpI2:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}._2s2g07d_g4rYONa6EUffoe{font-size:16px;min-width:32px!important;width:32px!important;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2s2g07d_g4rYONa6EUffoe{padding:0;border-style:none;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._2gHlig06CLXTog_sHdBjxU{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-sizing:border-box;box-sizing:border-box;height:16px;width:16px;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2gHlig06CLXTog_sHdBjxU{border-radius:50%;padding:3px;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._2gHlig06CLXTog_sHdBjxU{margin-right:16px}html[dir=rtl] ._2gHlig06CLXTog_sHdBjxU{margin-left:16px}html[dir] ._2gHlig06CLXTog_sHdBjxU:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2gHlig06CLXTog_sHdBjxU:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._12DoG-LvHF0uq_P3mCl9l1,.E0g4g6FHnvLcvsqx5S5sk{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:44px}html[dir] ._12DoG-LvHF0uq_P3mCl9l1,html[dir] .E0g4g6FHnvLcvsqx5S5sk{background-color:transparent}._12DoG-LvHF0uq_P3mCl9l1{color:"[theme:themePrimary, default:#0078D4]"}._12DoG-LvHF0uq_P3mCl9l1:hover{color:"[theme:themeDarker, default:#004578]"}.E0g4g6FHnvLcvsqx5S5sk,.E0g4g6FHnvLcvsqx5S5sk:hover{color:"[theme:neutralDark, default:#212121]"}._3WHacxy3jm55FX7LXtoTbT,._3OXD24zi--NRNzhEiiUbDf,._1pJKwDVgnVvtTYbSPBYHUf{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:headerSearchBoxIcon, default:#004578]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px}._2ItmDfaS1i9SxH_w5mCuKy._3OXD24zi--NRNzhEiiUbDf,._2ItmDfaS1i9SxH_w5mCuKy._1pJKwDVgnVvtTYbSPBYHUf,._3WHacxy3jm55FX7LXtoTbT._2ItmDfaS1i9SxH_w5mCuKy{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1pJKwDVgnVvtTYbSPBYHUf{color:"[theme:themeDarker, default:#004578]"}._3OXD24zi--NRNzhEiiUbDf{color:"[theme:neutralDark, default:#212121]"}._3w0I3IfXZt11NrlI4Rtops{display:-webkit-box;display:-ms-flexbox;display:flex;height:32px;-ms-flex-item-align:center;align-self:center}html[dir=ltr] ._3w0I3IfXZt11NrlI4Rtops{margin-right:16px}html[dir=rtl] ._3w0I3IfXZt11NrlI4Rtops{margin-left:16px}._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{height:48px;position:fixed;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:3}html[dir] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{background:"[theme:headerBackgroundSearch, default:#005A9E]"}html[dir=ltr] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH,html[dir=rtl] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{left:0;right:0}._1IASxdr5glbGM5ZXvqT4EN{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-item-align:center;align-self:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:32px;width:100%}html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border-radius:2px}@media screen and (-ms-high-contrast:active){html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border:1px solid "[theme:neutralLight, default:#eaeaea]"}}._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;height:48px}html[dir] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){border:none;border-radius:0}html[dir=ltr] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){margin-right:0}html[dir=rtl] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){margin-left:0}html[dir] ._13fYSkaJ0_Cv0uT7sPeR3w{border-radius:0}._1B1INwx9bCktow-2kkawjV{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir] ._1B1INwx9bCktow-2kkawjV._39PnMB35_a5dhoEn1ZSYaH{margin:0 8px}html[dir] ._5qNpXCd-7jY8_77B7v2Nm ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:white, default:#ffffff]"}._3pB3B8SOyfUABGIvVa4Yof{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}html[dir] ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:headerSearchBoxBackground, default:rgba(255,255,255,.7)]"}html[dir] ._3pB3B8SOyfUABGIvVa4Yof._2ItmDfaS1i9SxH_w5mCuKy{background:"[theme:neutralLight, default:#eaeaea]"}._5j-xjOS68WJ1zbIJWTFG7{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-ms-flex-pack:distribute;justify-content:space-around}html[dir=ltr] ._5j-xjOS68WJ1zbIJWTFG7{margin-right:12px}html[dir=rtl] ._5j-xjOS68WJ1zbIJWTFG7{margin-left:12px}',""]),t.locals={searchButton:"_33tO85F3n_fu7qMMmS4oN3",searchButtonNeutral:"_1dHZpReBf_xUafaqKmcpI2",searchBoxButton:"_2s2g07d_g4rYONa6EUffoe",clearBoxButton:"_2gHlig06CLXTog_sHdBjxU",backButton:"_12DoG-LvHF0uq_P3mCl9l1",backButtonNeutral:"E0g4g6FHnvLcvsqx5S5sk",searchIcon:"_3WHacxy3jm55FX7LXtoTbT",searchIconFocused:"_3OXD24zi--NRNzhEiiUbDf",searchIconRest:"_1pJKwDVgnVvtTYbSPBYHUf",isDisabled:"_2ItmDfaS1i9SxH_w5mCuKy",searchBoxCommonContainer:"_3w0I3IfXZt11NrlI4Rtops",searchBoxContainerInSearch:"_5qNpXCd-7jY8_77B7v2Nm",isInCompactMode:"_39PnMB35_a5dhoEn1ZSYaH",searchBoxContainer:"_1IASxdr5glbGM5ZXvqT4EN",searchBoxContainerNoBorderRadius:"_13fYSkaJ0_Cv0uT7sPeR3w",searchBoxColumnContainer:"_1B1INwx9bCktow-2kkawjV",searchBox:"_3pB3B8SOyfUABGIvVa4Yof",searchQueryContainer:"_5j-xjOS68WJ1zbIJWTFG7"}},2180:function(e){e.exports=JSON.parse('{"a":"_Ib","c":"$Ib","d":"aJb","b":"bJb"}')},2181:function(e){e.exports=JSON.parse('{"a":"hJb"}')},2182:function(e){e.exports=JSON.parse('{"a":"gJb"}')},2183:function(e){e.exports=JSON.parse('{"a":"fJb"}')},2184:function(e){e.exports=JSON.parse('{"a":"eJb"}')},2188:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(883),a=n(1408),i=n(971);function o(e,t,n){var o=e.level!==i.b.Block&&e.directFileAccessEnabled;return o&&t.__type===r.n&&(o=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,n.host.indexOf(c,0)>0||n.search.indexOf(u,0)>0)return!1}if(r=e.ProviderType,i=Object(a.a)(r),(null==i?void 0:i.supportDownload)&&!e.AttachmentIsFolder)return!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);var r,i;return!1}(t,n)),o}var c="safelinks.protection.outlook.com",u="b7780972f918485c8cfc32b1ba7438eb"},2215:function(e,t,n){"use strict";var r=n(0),a=n(8),i=n(971),o=n(977),c=n(221),u=n(919);function s(e){switch(e){case o.a.Download:return u.a.Download;case o.a.OpenInNewTab:return u.a.OpenInNewTab;case o.a.Preview:return u.a.Preview;case o.a.ImportCalendarEventAttachment:case o.a.ChangePermissions:case o.a.CopyLink:case o.a.SaveToCloud:case o.a.ViewInProvider:case o.a.ConvertClassicToCloudy:case o.a.ConvertCloudyToClassic:case o.a.MoveAttachmentToInline:case o.a.RefreshLink:case o.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function l(e){switch(e){case u.a.Download:return o.a.Download;case u.a.OpenInNewTab:return o.a.OpenInNewTab;case u.a.Preview:return o.a.Preview;case u.a.NoAction:return null;default:return Object(c.a)(e)}}var d=n(1793);var f=n(914),h=n(208);function m(e,t,n,a,o,c,h,m,p,v,g){var O=Object(u.d)(t,n,a,v);!function(e,t){var n=Object(i.g)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download})):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download&&e!==u.a.Preview})));var r=function(e,t,n){void 0===n&&(n=!1);var r=e.filter((function(e){return-1!==t.indexOf(e)}));return n&&(r=r.filter((function(e,t,n){return n.indexOf(e)===t}))),r}(e.supportedOpenActions.map(l).filter((function(e){return!!e})),t);e.supportedOpenActions=r.map(s)}(O,m);var I,w=function(e){return e.__type===f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(a),S=v&&function(e){return e.__type===f.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(a),j=Object(i.j)(a,w||S,p,g),y=w,_=b(w,S,c),C=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,w||S,p),A=function(e,t,n,r,a){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var i=Object(d.a)(a);return(null==i?void 0:i.supportConvertCloudyToClassic)||!1}return!1}(e,w,p,h,o),x=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,w,S,p);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:I=function(e,t,n,a,i,o,c,u){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:a,isViewingInProviderSupported:i,isConvertClassicToCloudySupported:o,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:u,showActionsMenu:!0,supportedMenuActions:[]})}(O,j,w||S,y,_,C,A,x);break;case 1:I=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(O);break;default:I=w?function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:a,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(O,y,_,A):function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:a,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(O,j,_,C)}return I.supportedMenuActions=m,I}function b(e,t,n){if(e||t)return!1;var r=Object(h.a)(),i=Object(d.b)(r);return!Object(a.f)(n)&&(r||(null==i?void 0:i.supportViewInProvider))}n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}))},2240:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(48);function a(){if(Object(r.h)())try{return new ActiveXObject("htmlfile"),!0}catch(e){return!1}return!1}},2318:function(e,t,n){"use strict";var r=n(73),a=n(1533);n.d(t,"a",(function(){return a.a})),n.d(t,"d",(function(){return a.c}));var i=n(1202);n.d(t,"b",(function(){return i.b}));var o=n(1600);n.d(t,"c",(function(){return o.a}));var c=new r.c((function(){return n.e(237).then(n.bind(null,3772))})),u=new r.a(c,(function(e){return e.addFileProviderAfterAuthFinished}));"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=u);new r.b(c,(function(e){return e.getAddableFileProviderInfo})),new r.b(c,(function(e){return e.addFileProvider})),new r.b(c,(function(e){return e.createAddableFileProviderInfo})),new r.b(c,(function(e){return e.getAuthRedirectPageUrl}))},2348:function(e){e.exports=JSON.parse('{"a":"lha","b":"mha"}')},2349:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2318);function a(e){return Object(r.c)(e)}},2402:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1454),a="file provider is not addable";function i(e){return r.a.indexOf(e)>-1}},2422:function(e,t,n){"use strict";var r=n(964),a=n(93);t.a=Object(a.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2423:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2436:function(e,t,n){"use strict";n.r(t);var r=n(1019),a=n(4);function i(e,t){t&&!e.includes(t)&&e.push(t)}Object(a.mutator)(r.c,(function(e){i(e.sharingLinkIds,e.linkId)})),Object(a.mutator)(r.B,(function(e){var t,n,r;t=e.sharingLinkIds,n=e.linkId,-1!==(r=t.indexOf(n))&&t.splice(r,1)})),Object(a.mutator)(r.d,(function(e){i(e.linkIdContainer,e.linkId)}));var o=n(4409);Object(a.mutator)(o.a,(function(e){var t=e.attachmentWell,n=e.message;t.announcedComponentMessage=n}));var c=n(0),u=n(8100),s=n(8),l=Object(a.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",(function(e,t,n,r,a,i){return{attachmentWellViewState:e,parentItemId:t,recipientInfo:n,infoBarIds:r,infoBarAddHandler:a,infoBarRemoveHandler:i}})),d=n(5521),f=n(7169),h=n(876);function m(e){var t,n=e.docViewAttachments.concat(e.imageViewAttachments);return(t=n,t.filter((function(e){return e.isCloudy})).map((function(e){return function(e,t){if(1!==e.type)return null;var n=e.model;return{id:e.id,name:n.Name,supportsDownsell:t,currentPermissionLevel:n.PermissionType,sharingInfo:e.info.sharingInfo,sharingRecipientsInfo:{recipientPermissionInfos:[]},sharingTipsIgnored:[],typeOfLink:"referenceAttachment"}}(Object(h.a)(e.attachmentId),e.strategy.isConvertCloudyToClassicSupported)}))).filter((function(e){var t;return null===(t=e.sharingInfo)||void 0===t?void 0:t.getSharingInfoSucceeded}))}var b=n(193),p=n(1143),v=n(1312);function g(e,t,n,r){return O(e,m(t),n,[],null,null,r,!0,null)}function O(e,t,n,r,a,i,o,c,u){for(var s,l=0;l<e.length;l++){var d=I(e[l],t,n,r,a,i,o,c,u);d&&(s=d)}if("function"==typeof s){var f=s(null);if((null==f?void 0:f.messageParts)&&f.messageParts.length>0&&"string"==typeof f.messageParts[0])return f.messageParts[0]}else if("object"==typeof s&&s.length>0)return s[0];return null}function I(e,t,n,r,a,i,o,c,u){var s=o(t,e,n,c,u);return i&&i([e]),s&&(a&&a(e,s),r.push(e)),s}Object(a.orchestrator)(l,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,i,o,l,g,I,w,S,j;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return t=e.attachmentWellViewState,n=e.parentItemId,r=e.recipientInfo,a=e.infoBarIds,i=e.infoBarAddHandler,o=e.infoBarRemoveHandler,l=m(t),g=new b.a("AttachmentRefreshSharingTips"),I=function(e){var r=Object(d.a)(t,e);if(r){var a=Object(h.a)(r.attachmentId);return{text:Object(s.a)(u.a),action:function(){var e=a.model;Object(b.o)("SharingTipsConvertToClassic"),Object(p.f)(r,n.Id,e.AttachLongPathName,e.PermissionType,(function(e,n,r,a){Object(f.a)(t,e,n,r,a)}),1)}}}return null},w=Object(v.d)(),S=[],[4,v.f.import()];case 1:return j=c.sent(),O(w,l,r,S,i,o,j,!1,I),function(e,t){var n=Object(v.d)(),r=e.filter((function(e){return-1!==n.indexOf(e)})),a=t.filter((function(e){return-1===r.indexOf(e)})),i=r.filter((function(e){return-1===t.indexOf(e)}));0!==a.length&&Object(b.o)("AttachmentSharingTipAdded",a);0!==i.length&&Object(b.o)("AttachmentSharingTipsRemoved",i)}(a,S),Promise.resolve().then((function(){return g.end()})),[2]}}))}))}));Object(a.orchestrator)(o.a,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(c.__generator)(this,(function(n){return t=e.attachmentWell,null!==e.message&&setTimeout((function(){Object(o.a)(t,null)}),2e3),[2]}))}))}));var w=n(5053),S=n(74),j=n(1009),y=n(907);var _=n(2734),C=n(2691),A=n(3626),x=n(2797),T=n(3613),E=n(44);var P=Object(S.d)("initializeAttachments",A.a.AttachmentWellInitialization)((function(e,t,n,r,a,i,o,u,s){if(e){var l=e.filter((function(e){return!e.Name}));if(l.length>0){var d=l.map((function(e){return e.AttachmentId?e.AttachmentId.Id:"UNDEFINED"})).join(",");E.d.error({error:new Error("[InitializeAttachments] Attachments found with no name. Ids: "+d)})}var f=function(e){return e?Object(p.o)().filter((function(t){return!e.includes(t)})):null}(i);u&&n.docViewAttachments.length>0&&n.docViewAttachments.forEach((function(e){var t;(function(e){var t=Object(h.a)(e);if(null==t?void 0:t.model){return"IPM.Appointment"===t.model.EmbeddedItemClass}return!1})(e.attachmentId)&&((t=e.strategy).previewMethod=y.a.Unsupported,t.supportedOpenActions=t.supportedOpenActions.filter((function(e){return e!==j.a.Preview})))})),n.isInitialized||e.forEach((function(e){!function(e,t,n,r,a,i,o,u){if(!("application/x-sharing-metadata-xml"===e.ContentType||u&&Object(C.a)(e))){var s=Object(p.h)(Object(c.__assign)(Object(c.__assign)({},e.AttachmentId),{mailboxInfo:t}),e,n.isReadOnly,!0,r,u,null,i,!0),l=!!n.parentItemIdMap;if(e.IsInline&&e.__type!==x.c&&e.ContentId&&""!=e.ContentId&&"unknown"!=e.ContentId.toLowerCase()?n.inlineAttachments.push(Object(p.i)(e.AttachmentId,e.AttachmentId.Id,!0,4)):Object(_.a)(e)&&!l?n.imageViewAttachments.push(s):n.docViewAttachments.push(s),s.isCloudy){var d=Object(h.a)(s.attachmentId);d.requiresFetchingSharingInformation&&o&&Object(p.m)(d)}else Object(T.a)(n,e.Size,e.AttachmentId)}}(e,t,n,r,0,f,o,s)})),n.supportedMenuActions=f,n.isInitialized=!0}}));var D=n(93),k=Object(D.action)("reinitializeAttachments")((function(e,t,n,r,a){e&&(n.docViewAttachments=[],n.imageViewAttachments=[],n.inlineAttachments=[],n.isInitialized=!1,P(e,t,n,r,!1,a))})),R=n(3612);function F(e,t){var n=Object(R.a)(!1,void 0===t,e);if(t){var r=t.attachments,a=t.mailboxInfo,i=t.parentItemId;P(r,a,n,!0,!0,null,i)}return n}var N=n(4425);function M(e,t){var n=Object(R.a)(!0,!1,"");return Object(c.__assign)(Object(c.__assign)({},n),{parentItemIdMap:e,itemReceivedTimeMap:t,isVisible:!1,maxHeight:0})}var L=n(3356),B=n(1021),V=n(2006),U=function(e,t,n,r){if(e){var a=e.docViewAttachments,i=e.imageViewAttachments,o=e.inlineAttachments.filter((function(e){var r=Object(h.a)(e.attachmentId);if((null==r?void 0:r.model)&&"HTML"===n){var a=t;return a&&!Object(V.l)(a,r.model)}return!1})),u=Object(c.__spread)(a,i,o);return r?u.filter((function(e){return Object(B.b)(e.attachmentId.Id)})):u.filter((function(e){return!Object(B.b)(e.attachmentId.Id)}))}return[]},W=n(2161),H=n(1746),z=n(1794),q=n(4767),G=n(4397),J=n(4693),Q=Object(a.mutatorAction)("mergeToConversationAttachmentWell",(function(e,t,n,r){e&&(e.docViewAttachments.forEach((function(e){X(e,t,n,r)})),e.imageViewAttachments.forEach((function(e){X(e,t,n,r)})))}));function X(e,t,n,r){t.parentItemIdMap[e.attachmentId.Id]||(t.docViewAttachments.push(Object(c.__assign)({},e)),t.parentItemIdMap[e.attachmentId.Id]=n,t.itemReceivedTimeMap[e.attachmentId.Id]=r)}var Y=Object(a.mutatorAction)("sortConversationAttachmentWell",(function(e,t){e.docViewAttachments=e.docViewAttachments.sort((function(n,r){return(t?1:-1)*(new Date(e.itemReceivedTimeMap[n.attachmentId.Id]).getTime()-new Date(e.itemReceivedTimeMap[r.attachmentId.Id]).getTime())}))})),K=n(1484),Z=Object(a.mutatorAction)("convertImageViewAttachmentToInlineAttachment",(function(e,t,n){var r=Object(h.a)(t.attachmentId);if(r){var a=e.imageViewAttachments,i=e.inlineAttachments,o=a.indexOf(t);if(o>=0){a.splice(o,1),r.model.ContentId=n,r.model.IsInline=!0,r.model.AttachmentOriginalUrl=Object(K.b)(t.attachmentId,1);var c=Object(p.i)(t.attachmentId,t.attachmentId.Id,!1);c.status=3,i.push(c)}}}));n.d(t,"refreshSharingTipsAttachmentWell",(function(){return l})),n.d(t,"addAttachmentIntoWellBeforeUpload",(function(){return w.a})),n.d(t,"initializeAttachments",(function(){return P})),n.d(t,"reinitializeAttachments",(function(){return k})),n.d(t,"getAttachmentWellForCompose",(function(){return F})),n.d(t,"getAttachmentWellInitialValue",(function(){return R.a})),n.d(t,"getAvailableLocalAttachmentSize",(function(){return N.a})),n.d(t,"getConversationAttachmentWellInitialValue",(function(){return M})),n.d(t,"getMaxClassicAttachmentsSize",(function(){return L.a})),n.d(t,"getAllValidAttachments",(function(){return U})),n.d(t,"createAttachmentFullViewStateAndStoreBackingModel",(function(){return W.a})),n.d(t,"setInlineAttachmentStatus",(function(){return H.a})),n.d(t,"createAttachmentFullViewState",(function(){return z.a})),n.d(t,"createAttachmentsViaQueueManager",(function(){return q.a})),n.d(t,"deleteAttachmentViaQueueManager",(function(){return q.b})),n.d(t,"createAttachmentsFromRecentAttachments",(function(){return G.a})),n.d(t,"createAttachmentFileFromExistingMailboxAttachment",(function(){return J.a})),n.d(t,"mergeToConversationAttachmentWell",(function(){return Q})),n.d(t,"sortConversationAttachmentWell",(function(){return Y})),n.d(t,"convertImageViewAttachmentToInlineAttachment",(function(){return Z})),n.d(t,"getLastCloudyAttachmentsSharingIssueForBlockOnSend",(function(){return g}))},2443:function(e,t,n){"use strict";n(2141);var r=n(2100),a=n(73),i=new a.c((function(){return Promise.all([n.e(10),n.e(16),n.e(36),n.e(50),n.e(467)]).then(n.bind(null,14165))})),o=new a.b(i,(function(e){return e.addSearchRequestInstrumentation})),c=new a.b(i,(function(e){return e.addResourceTimingEntry})),u=new a.b(i,(function(e){return e.searchDiagnostics})),s=function(){var e=u.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};n(193);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c}))},2446:function(e,t,n){"use strict";var r=n(456),a=n(2);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var o=Object(a.y)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.m)()+"/mail/"+n+t}function u(e){var t=Object(r.m)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=i(t,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",a),o){var u=o(e);c=Object.keys(u).reduce((function(e,t){return i(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2489:function(e){e.exports=JSON.parse('{"b":"jha","a":"kha"}')},2501:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(857);function a(e){var t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}},2571:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(48),a=n(1197);function i(){return Object(r.d)()&&Object(r.k)([a.f])||Object(r.f)()&&Object(r.k)([a.h])||Object(r.e)()&&Object(r.k)([a.g])}},2584:function(e){e.exports=JSON.parse('{"b":"dha","a":"eha","e":"fha","d":"gha","f":"hha","c":"iha"}')},2593:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2634:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(0),a=n(340),i=n.n(a),o=n(2802),c=n.n(o),u=n(2803),s=n.n(u),l=n(886),d=n.n(l),f=n(155),h=n(240);function m(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,u;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return a?[4,Object(h.e)(a)]:[3,2];case 1:u=l.sent(),o={headers:u.headers,authNeededOnUnAuthorized:u.authNeededOnUnAuthorized},l.label=2;case 2:return[2,c()({Header:Object(f.getJsonRequestHeader)(),Body:s()({Content:e,ImportedItemFolderId:d()({BaseFolderId:i()({Id:t})}),AttachmentId:n})},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},o)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))]}}))}))}},2691:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1197),a=function(e,t){return e.substring(0,t.length)===t},i=function(e,t){return e.substring(e.length-t.length)===t},o=function(e){return e.ContentType&&(a(e.ContentType,r.x)||a(e.ContentType,r.l))},c=function(e){return e.ContentType&&e.ContentType===r.j};function u(e){return(null==e?void 0:e.Name)&&i(e.Name,r.v)&&(o(e)||c(e))}},2729:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r="X-OWA-SmimeInstalled",a="1",i="SmimeWithoutActiveX",o="message/rfc822",c="ErrorSmimeSendCancelled"},2733:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),a=n(193),i=n(2151),o=n(2823),c={},u={},s=[],l=0,d=2;function f(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c;return Object(r.__generator)(this,(function(u){return o=new a.a("InitializeWacUrl"),n&&o.addCustomProperty("actionSource",n),(c=m(e,t,o))?[2,c]:[2,new Promise((function(a,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:o,resolve:a,reject:c};i?h(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!s.length)return[2];if(l>=d)return[2];t=s.shift(),l++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,h(t)];case 2:return n.sent(),[3,4];case 3:return l--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function h(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,s,l,d,f,h,b,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n=e.attachmentId,a=e.isEdit,s=e.actionSource,l=e.datapoint,d=e.resolve,f=e.reject,h=m(n,a,l))return d(h),[2];l.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(n.Id,a,null,null===(t=n.mailboxInfo)||void 0===t?void 0:t.requestOptions,s)];case 2:return 0===(b=r.sent()).Status&&((a?u:c)[n.Id]={expireTime:(new Date).getTime()+36e5,value:b}),b.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",b.Status.toString()),l.end(),d(b),[3,4];case 3:return p=r.sent(),Object(i.a)(p)&&Object(i.c)(l,p.response),Object(i.d)(l,p.toString()),l.endWithError("ServerError"),f(p),[3,4];case 4:return[2]}}))}))}function m(e,t,n){var r=t?u:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},2734:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1408),a=n(1021),i=n(971),o=n(857),c=n(883);function u(e){if(!Object(i.e)(e,!0).directFileAccessEnabled||Object(a.b)(e.AttachmentId.Id))return!1;if(e.Thumbnail)return!0;var t=Object(o.f)(e.Name,e.ContentType,!1),n=Object(o.g)(e.Name);if((e.__type===c.e||e.__type===c.h)&&(t||n))return!0;if(e.__type===c.n){var u=e,s=Object(r.a)(u.ProviderType);if(u.AttachmentThumbnailUrl||t&&s&&s.supportImageThumbnail)return!0}return!1}},2748:function(e,t,n){"use strict";var r=n(0),a=n(914),i=n(193),o={},c=5e3,u=12;function s(e,t,n,s,d){var f=new i.a("SaveToCloudProgressManager"),h=setInterval((function(){!function(e,t,n,i,o,c,u){Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(s=u[e])?(s.counter++,s.counter>c?(l(e,u),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),o&&o(),[2]):[4,a.g.import()]):[2];case 1:return r.sent()(t,n,e,0,(function(e){i&&i(e.NotificationPayloads)})),[2]}}))}))}(n,e,t,s,d,u,o)}),c);o[n]={timer:h,counter:0,datapoint:f}}function l(e,t){void 0===t&&(t=null),t||(t=o);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}var d=n(4),f=Object(d.action)("cancelSaveAttachmentsToCloud",(function(e){return{operationId:e}}));Object(d.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return l(e.operationId),[2]}))}))}));var h=Object(d.action)("saveAttachmentsToCloud",(function(e,t,n,r,a,i,o,c,u){return{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:a,folderId:i,attachmentIds:o,showProgressBar:c,subscriptionId:u}})),m=n(78),b=n(2254),p=n.n(b),v=n(2962),g=n.n(v);function O(e,t,n,r,a,i,o){var c=function(e,t,n,r,a,i,o){return p()({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:a,channelId:r,folderItemId:i,attachmentIds:o})}(e,t,n,r,(null==a?void 0:a.type)===m.a.GroupMailbox?a.deprecatedMailboxId:null,i,o);return g()({requestObject:c},null==a?void 0:a.requestOptions)}var I=n(1663),w=n(972);Object(d.orchestrator)(h,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c,u,d,f;return Object(r.__generator)(this,(function(h){switch(h.label){case 0:return t=!1!==e.showProgressBar,!(n=e.attachmentId||e.itemId)&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]),a=function(r){if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;var a=e.notificationHandler(r);return t&&a&&(l(n.Id),t=!1),a},i=e.subscriptionId,[4,Object(I.a)(a,i)];case 1:return o=r.__read.apply(void 0,[h.sent(),4]),c=o[0],u=o[1],d=o[2],f=o[3],function(e,t,n,a,i,o,c,u,s){Object(r.__awaiter)(this,void 0,void 0,(function(){var l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,O(e?e.Id:null,t?t.Id:null,n,o,S(t,e,s),u,s?s.map((function(e){return e.Id})):null)];case 1:return[2,r.sent()];case 2:return l=r.sent(),c(l,1,"ServerError"),w.h.importAndExecute(a,i),[2,null];case 3:return[2]}}))}))}(e.attachmentId,e.itemId,c,u,d,f,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&s(e.attachmentId,e.itemId,n.Id,(function(e){e.forEach((function(e){a(e)}))}),(function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")})),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,u,d),[2]}}))}))}));function S(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}function j(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=function(n){if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;var r=t(n);return r&&l(e.Id),r},[4,Object(I.a)(i,a)];case 1:return r.sent(),s(e,null,e.Id,(function(e){e.forEach((function(e){i(e)}))}),(function(){n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout")})),[2]}}))}))}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return j}))},2797:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r="ReferenceAttachment:#Exchange",a=1024,i=1048576},2823:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1655),a=n.n(r);function i(e,t,n,r,i){if(i){var o="getWacAttachmentInfo"+i;(r=r||{}).headers=r.headers||new Headers,r.headers.set("X-OWA-ActionName",o)}return a()({attachmentId:e,isEdit:t,draftId:n,appId:null},r)}},2824:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(1365),i=n(3120);function o(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(i.a)(e.AttachLongPathName),[4,Object(a.l)(n)];case 1:return o=r.sent(),[2,(null===(t=o.result)||void 0===t?void 0:t.thumbnailLink)||null]}}))}))}},2825:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(883),a=n(1128),i=n(1484);function o(e,t,n,o){if(void 0===o&&(o=!1),Object(a.b)(t))switch(t.ProviderType){case r.c:return function(e){var t=e.AttachLongPathName,n=t.lastIndexOf("?");return t.substring(0,n)+"?dl=1"}(t)}return Object(i.a)(e,t,0,Object(a.b)(t),n,o)}},2883:function(e,t,n){"use strict";var r=n(876),a=n(2825),i=n(93);t.a=Object(i.action)("refreshDownloadUrl")((function(e,t,n){void 0===n&&(n=!1);var i=Object(r.a)(e),o=Object(a.a)(e,i.model,t,n);i.download.url=o}))},2939:function(e,t,n){"use strict";function r(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return r}))},3064:function(e,t,n){"use strict";var r=n(1948),a=n(857),i=n(5),o=n(37);var c=n(2188),u=n(1408);function s(e,t,n,s,l,d){if(void 0===d&&(d=null),1===t)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};var f,h=Object(a.b)(n.Name),m=Object(c.a)(e,n,h),b=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;var r=Object(u.a)(t);return null==r?void 0:r.supportedPermissionLevels}(s,l,Object(r.a)(d,0)),p=(f=d)&&0===f.ResultCode?(Object(o.f)("doc-attachment-referenceAttachmentExpiration")||(f.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:f.BlocksDownload,canonicalUrl:f.CanonicalUrl,canShareInternally:f.CanShareInternally,canShareExternally:f.CanShareExternally,expirationDate:f.ExpirationDate?Object(i.lc)(f.ExpirationDate):null,canRefresh:!1,shareId:f.ShareId,siteUrl:f.SiteUrl,linkType:f.Type}):null;return s?function(e,t,n){return{allowDownload:e,supportedPermissionLevels:t,sharingInfo:n}}(m,b,p):function(e){return{allowDownload:e,supportedPermissionLevels:null,sharingInfo:null}}(m)}n.d(t,"a",(function(){return s}))},3073:function(e,t,n){"use strict";var r=n(73),a=n(992),i=n(0),o=n(914),c=n(876),u=n(1915),s=n(1648);function l(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return(r=Object(c.a)(e))?Object(o.e)(r.model)?[4,s.e.import()]:[3,2]:[2];case 1:return i.sent()(r.model),[3,3];case 2:(a=r.download.url)&&Object(u.a)(a,t,n),i.label=3;case 3:return[2]}}))}))}n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return a.c})),n.d(t,"b",(function(){return l}));var d=new r.c((function(){return Promise.all([n.e(12),n.e(76),n.e(603),n.e(7),n.e(126)]).then(n.bind(null,14098))})),f=new r.a(d,(function(e){return e.clickAttachment})).importAndExecute,h=new r.a(d,(function(e){return e.previewAttachment}))},3080:function(e,t,n){"use strict";var r=n(844),a=n(4);t.a=Object(a.mutatorAction)("setCurrentSearchQueryId",(function(e,t){Object(r.a)(t).currentSearchQueryId=e}))},3120:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},3121:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(8),a=n(883),i=n(1948);function o(e){return Object(r.f)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function c(e,t){var n=e.AttachLongPathName;if(Object(i.f)(e.PermissionType)||e.ProviderType!==a.m)return n;var r=t.ApplicationSettings;if(null!==n&&null!==r){var c=void 0;null!==(c=o(r.VDirIsPublicProperty||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL))&&(n=function(e,t){var n,r,a,i=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),o=i.exec(e),c=i.exec(t);return o&&c&&o.length>=5&&c.length>=5&&(c[1]&&c[2]&&(a=c[1]+"://"+c[2],n=!0),c[3]&&(a+=c[3]),o[4]&&(r=!0,a+=o[4])),n&&r?a:null}(n,c))}return null!==n?n:e.AttachLongPathName}},3124:function(e,t,n){"use strict";var r=n(876),a=n(93);t.a=Object(a.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},3157:function(e,t,n){"use strict";var r=n(0),a=n(1700),i=!1;function o(e,t,n,o){return void 0===n&&(n=!1),void 0===o&&(o=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e&&((null==t?void 0:t.length)||i)?(i=!0,[4,Object(a.e)()]):[3,2];case 1:c=r.sent(),u=c.call(c,e),(null==t?void 0:t.length)?u.mark(t,{separateWordSearch:n,accuracy:o?"prefix":"partially"}):u.unmark(),r.label=2;case 2:return[2]}}))}))}n.d(t,"a",(function(){return o}))},3260:function(e){e.exports=JSON.parse('{"b":"fga","a":"gga","d":"hga","e":"iga","g":"jga","f":"kga","c":"lga","i":"mga","h":"nga","j":"oga","k":"pga"}')},3261:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(883),i=n(2824),o=n(1484);function c(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n?(c=t).ProviderType===a.f&&c.AttachLongPathName?[4,Object(i.a)(c)]:[3,2]:[2,Object(o.a)(e,t,2,n,!0)];case 1:return[2,r.sent()];case 2:return[2,c.AttachmentThumbnailUrl||null]}}))}))}},3302:function(e,t,n){"use strict";var r=n(883),a=n(1408),i=n(857);function o(e){var t=Object(i.b)(e.Name);return t&&".pdf"===t.toLowerCase()}var c=[".mp3"];var u=[".ics",".ical",".ifb",".icalendar"];var s=[".eml",".msg"];var l=n(1930),d=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(i.f)(e.Name)||e.__type!==r.n&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var h=n(2087),m=n(971);function b(e,t){return!(!o(e)||!Object(h.a)())&&(!!t||Object(m.f)(e,!0).directFileAccessEnabled)}var p=[".txt",".xml",".log"];var v=[".mp4"],g=[".mov"];var O=n(208);function I(e,t){var n;t.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||t.__type===r.a.attachmentTypes.LINK_ATTACHMENT_TYPE?n=function(e){var t=Object(a.a)(e.ProviderType);return t&&t.supportPreview(e,Object(O.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(l.a)(t)?6:b(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0:n=t.__type===r.a.attachmentTypes.FILE_ATTACHMENT_TYPE?e.level===m.b.Block?1:e.level===m.b.AccessDisabled?0:f(t)?2:o(t)?function(e,t){if(!Object(m.k)().isPdfPreviewEnabled())return 1;if(b(t,!1))return 3;if(function(e){return o(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){var t=Object(i.b)(e.Name);return!!t&&c.indexOf(t.toLowerCase())>=0}(t)?5:function(e){var t=Object(i.b)(e.Name);return!!t&&s.indexOf(t.toLowerCase())>=0}(t)?10:function(e){var t=Object(i.b)(e.Name);return!!t&&p.indexOf(t.toLowerCase())>=0}(t)?11:function(e,t){var n,r=Object(i.b)(e.Name);if(r){var a=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),o=-1!==a.indexOf("Safari")&&-1===a.indexOf("Chrome");return v.indexOf(r.toLowerCase())>=0||o&&g.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){var t=Object(i.b)(e.Name);return!!t&&-1!==u.indexOf(t.toLowerCase())}(t)?13:0:t.__type===r.a.attachmentTypes.ITEM_ATTACHMENT_TYPE?8:t.__type===r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE?9:0;return n}n.d(t,"a",(function(){return I}))},3304:function(e,t,n){"use strict";function r(e,t,n,r,a,i){var o=!1;return{task:function(){return new Promise((function(c,u){for(var s=0,l=0,d=0,f=function(){var h,m,b,p,v;o&&c(1),s<n&&d<t.length&&((h=d,m=t[h],b=m.start,p=m.end,v=e.slice(b,p),r(v,i(h),a)).then((function(){return s-=1,(l+=1)===t.length&&c(0),void f()})).catch(u),d+=1,s+=1)},h=0;h<n;h++)f()}))},cancelTask:function(){return o=!0}}}var a=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function i(e,t,n){void 0===n&&(n=a),function(e){e.sliceSize=e.sliceSize||a.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||a.numberOfSlicesToParallelize}(n);var i=n.sliceSize,u=n.numberOfSlicesToParallelize,s=Math.ceil(e.size/i),l=function(e,t,n){for(var r=[],a=0,i=0;i<e;i++){var o=Math.min(a+t,n);r.push({start:a,end:o}),a=o}return r}(s,i,e.size),d=r(e,[l[0]],1,t,s,(function(){return 0})),f=l.length>2?r(e,l.slice(1,l.length-1),u,t,s,(function(e){return e+1})):c(),h=l.length>1?r(e,[l[l.length-1]],1,t,s,(function(){return l.length-1})):c();return{onCompletePromise:d.task().then(o(f.task)).then(o(h.task)),cancel:function(){d.cancelTask(),f.cancelTask(),h.cancelTask()}}}function o(e){return function(t){return 0===t?e():Promise.resolve(t)}}function c(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}n.d(t,"a",(function(){return i}))},3309:function(e,t,n){"use strict";var r=n(1313),a=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles"];function i(e){e&&Object(r.a)(e,a)}n.d(t,"a",(function(){return i}))},3356:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2797),a=n(12),i=n(18),o=25*r.b;function c(){return u.get()}var u=Object(a.computed)((function(){var e=Object(i.a)();return e&&e.SessionSettings?(e.SessionSettings.MaxMessageSizeInKb-2048)*r.a:o}))},3366:function(e){e.exports=JSON.parse('{"a":"nDb"}')},3410:function(e,t,n){"use strict";var r=n(3613),a=n(2422),i=n(876),o=n(93);t.a=Object(o.action)("removeAttachmentFromWell")((function(e,t){var n=Object(i.a)(t.attachmentId);if(n){var o,c;1===t.attachmentType?(o=e.inlineAttachments,c=!0):o=e.imageViewAttachments.some((function(e){return e.attachmentId===t.attachmentId}))?e.imageViewAttachments:e.docViewAttachments;for(var u=!1,s=0;s<o.length;s++)if(o[s].attachmentId===t.attachmentId){o.splice(s,1),u=!0;break}!u||!c&&t.isCloudy||Object(r.a)(e,-1*n.model.Size,n.model.AttachmentId),Object(a.a)(t.attachmentId)}}))},3416:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud"}(r||(r={}))},3434:function(e,t,n){"use strict";var r=n(3414),a=n.n(r),i=n(4427),o=n.n(i),c=n(924),u=n.n(c),s=n(4428),l=n.n(s),d=n(3415),f=n.n(d),h=n(0),m=n(44);function b(e,t,n,r){return e?n(e):(m.d.warn(t.statusText),404===t.status?r(4):401===t.status||403===t.status?r(2):r(1))}var p=Object.freeze({SortColumn:2,SortOrder:1}),v="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",g="GDriveDataProviderItem:#Exchange",O="FacebookDataProviderItem:#Exchange",I="FileAttachmentDataProviderItem:#Exchange",w="FolderAttachmentDataProviderItem:#Exchange",S="OneDriveProScope:#Exchange",j="OneDriveProItemSkipTokenPagingMetadata:#Client",y=n(1365);function _(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map((function(e){return t(e)}))}}function C(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}var A="application/vnd.google-apps.folder";function x(e){return{__type:g,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===A?1:0}}function T(e){return Object(h.__assign)(Object(h.__assign)({},_(e.files,x)),{NextPageToken:e.nextPageToken})}function E(e){return Object(h.__assign)(Object(h.__assign)({},C(e)),{NextPageToken:null})}function P(e,t){return void 0===t&&(t=!1),Object(h.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(h.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(y.m)(e,t)];case 1:return n=i.sent(),r=n.errorResponse,(a=n.result)?[2,b(a,null,T,E)]:[2,b(null,r,T,E)]}}))}))}var D=n(3080),k=n(1758);function R(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function F(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:R(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}var N=function(e){return _(e,F)};function M(e,t){return Object(h.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(h.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(y.n)(e,t)];case 1:return n=i.sent(),r=n.errorResponse,(a=n.result)?[2,b(a,null,N,C)]:[2,b(null,r,N,C)]}}))}))}var L=n(452),B=n(155),V=n(908),U=n(2443),W=n(864),H=n(1212),z=200;function q(e){return Object(h.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,i,o,c,u,s,l,d,f,p,v;return Object(h.__generator)(this,(function(g){switch(g.label){case 0:if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");return t=Object(V.p)(V.g.FilesPicker),Object(D.a)(t.nextSearchQueryId,V.g.FilesPicker),Object(k.a)(Object(L.a)(),V.g.FilesPicker),n=Object(B.getJsonRequestHeader)(),r={Cvid:Object(L.a)(),Scenario:{Name:W.a.MailEmailAttachmentPicker},TimeZone:Object(W.w)(n),TextDecorations:"Off",EntityRequests:(O=e,{Field:"Time",SortDirection:"Desc"},I=[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:O},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}],I)},a=0,i=0,o=new Date,[4,Object(W.I)(r,t.searchSessionGuid)];case 1:return(c=g.sent())&&2==c.length?(u=c[0].status,l=(s=u==z)?null:c[0].statusText,d=function(e,t,n,r,a,i,o){if(!e||2!=e.length)return null;var c=Object(W.d)(e[0],t,n,"SubstrateSearch",r,new Date,a.currentSearchQueryId,new Headers(e[1]),0,W.a.MailEmailAttachmentPicker);return c.ClientJSPreRequestTime=i,c.ClientJSRequestThreadTime=o,Object(V.S)(c.SearchTraceID,V.g.FilesPicker,!1),U.d.import().then((function(e){return e(c)})),H.h.importAndExecute(c.SearchTraceID,c.ClientNetworkTime,c.ClientHttpStatus,new Date),c}(c,e,l,o,t,a,i),s?[4,c[0].json()]:[3,3]):(m.d.warn("3S Response for search mail messages failed"),[2,b(null,v={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},N,C)]);case 2:return f=g.sent(),p=function(e,t){var n,r;if(e&&e.Results&&0!==e.Results.length){var a=[],i=e.Results;try{for(var o=Object(h.__values)(i),c=o.next();!c.done;c=o.next()){var u=c.value,s=Object(W.h)(u.Source,t);s.InstanceKey=u.ReferenceId,a.push(s)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}return[]}(Object(W.t)(f),r),H.j.importAndExecute(d.SearchTraceID,new Date,W.a.MailEmailAttachmentPicker),[2,b(p,null,N,C)];case 3:return m.d.warn("3S Response for search mail messages failed with "+l),v={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:l,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},H.g.importAndExecute(d.SearchTraceID,W.a.MailEmailAttachmentPicker),[2,b(null,v,N,C)]}var O,I}))}))}function G(e,t,n,r,i,c,s){if(void 0===c&&(c=null),5===e)return function(e,t){return void 0===t&&(t=""),Object(h.__awaiter)(this,void 0,void 0,(function(){var n;return Object(h.__generator)(this,(function(r){return n=v+"&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '"+e+"'",t&&(n=n+" and '"+t+"' in parents"),[2,P(n)]}))}))}(n,i);if(10===e)return q(n);var d=f()({AttachmentDataProviderId:t,Query:n,Paging:a()({Sort:s||o()(p),FolderId:r,Location:i,RequestedData:u()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:c})});return l()({request:d})}var J=n(8),Q=n(193),X=n(37),Y=n(1456);function K(e){return null!==e&&e.__type===S}function Z(e,t){return 0===e&&t&&K(t)?t.Type:null}function $(e,t){return Object(h.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(h.__generator)(this,(function(i){switch(i.label){case 0:n="FPAccessTokenUnavailable",r=[e],i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(Y.c)(e,!1,t)];case 2:return a=i.sent(),Object(J.f)(a)?(Object(Q.o)(n,r),[2,!1]):[2,!0];case 3:return i.sent(),Object(Q.o)(n,r),[2,!1];case 4:return[2]}}))}))}function ee(e,t,n){return Object(h.__awaiter)(this,void 0,void 0,(function(){var r;return Object(h.__generator)(this,(function(a){switch(a.label){case 0:switch(e){case 3:case 2:case 6:return[3,1];case 5:case 10:return[3,4];case 0:return[3,5]}return[3,7];case 1:return(r=Object(X.f)("doc-filePicker-thirdPartyProviderClientCalls"))?[4,$(e,null)]:[3,3];case 2:r=a.sent(),a.label=3;case 3:return[2,r];case 4:return[2,!0];case 5:return 0!==Z(e,n)?[2,!1]:[4,$(e,t)];case 6:return[2,a.sent()];case 7:return[2,!1]}}))}))}function te(e){return e.__type===w||1===e.Type}function ne(e){var t=e.filter(te),n=e.filter((function(e){return!te(e)}));return t.concat(n)}var re=n(221);function ae(e,t,n){var r,a,i=null,o=null;switch(e){case"asc":i=(r=Object(h.__read)([t,n],2))[0],o=r[1];break;case"desc":i=(a=Object(h.__read)([n,t],2))[0],o=a[1];break;default:Object(re.a)(e)}return i<o?-1:i>o?1:0}function ie(e,t,n){switch(t){case 2:e.sort((function(e,t){var r=e.Modified,a=t.Modified,i=r?new Date(r):new Date(0),o=a?new Date(a):new Date(0);return ae(0===n?"asc":"desc",i,o)}));break;case 1:e.sort((function(e,t){var r=e.Size||0,a=t.Size||0;return 0===n?r-a:a-r}));break;default:e.sort((function(e,t){var r=e.Name.toLowerCase(),a=t.Name.toLowerCase();return ae(0===n?"asc":"desc",r,a)}))}}function oe(e){return{__type:Object(y.q)(e)?w:I,Id:e.id,AttachmentProviderId:null,Location:(t=e.path_collection,"/"+(t.entries||[]).map((function(e){return e.name})).join("/")+"/"+e.name),Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(y.q)(e)?1:0};var t}var ce=function(e){return _(e,oe)};function ue(e,t,n){return Object(h.__awaiter)(this,void 0,void 0,(function(){var r,a,i,o;return Object(h.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(y.i)(e)];case 1:return r=c.sent(),a=r.errorResponse,(i=r.result)?(ie((o=b(i,null,ce,C)).Items,t,n),o.Items=ne(o.Items),[2,o]):[2,b(null,a,ce,C)]}}))}))}function se(e){return{__type:Object(y.t)(e)?w:I,Id:Object(y.r)(e)?null:e.id,AttachmentProviderId:null,Location:Object(y.r)(e)?"":e.path_lower,Modified:Object(y.s)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(y.s)(e)?e.size:0,Type:Object(y.t)(e)?1:0}}var le=function(e){return _(e,se)};function de(e,t,n){return Object(h.__awaiter)(this,void 0,void 0,(function(){var r,a,i,o;return Object(h.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(y.j)({path:e})];case 1:return r=c.sent(),a=r.errorResponse,(i=r.result)?(ie((o=b(i,null,le,C)).Items,t,n),o.Items=ne(o.Items),[2,o]):[2,b(null,a,le,C)]}}))}))}var fe=n(4429),he=n.n(fe),me=150,be=200;function pe(e){var t,n=(t=e.images,Object(h.__read)(Object(h.__spread)(t).reverse().filter((function(e){return e.width>=be&&e.height>=me})),1)[0]||t[0]);return he()({Url:n.source,Height:n.height,Width:n.width})}function ve(e){var t=pe(e),n=e.images[0],r=he()({Url:n.source,Height:n.height,Width:n.width});return{__type:O,Id:e.id,Name:"Photo "+e.id+".jpg",AttachmentProviderId:null,ProviderType:6,Location:n.source,DownloadUrl:n.source+"&dl=1",Thumbnail:t,Preview:r,From:e.from?e.from.name:null,PlaceName:e.place?e.place.name:null,AlbumName:e.album?e.album.name:null,CreatedTime:e.created_time||null,PostUrl:e.link,Type:0}}var ge=function(e){return _(e,ve)};function Oe(e){return e?function(e){switch(e){case 1:return y.d.Uploaded;case 0:return y.d.Tagged;default:return Object(re.a)(e)}}(e.Type):y.d.Tagged}function Ie(e){return Object(h.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a;return Object(h.__generator)(this,(function(i){switch(i.label){case 0:return t=Oe(e),[4,Object(y.k)(t)];case 1:return n=i.sent(),r=n.errorResponse,(a=n.result)?[2,b(a,null,ge,C)]:[2,b(null,r,ge,C)]}}))}))}function we(e){return e.file?e.file.mimeType:e.package&&"oneNote"===e.package.type?"application/onenote":null}var Se=n(199);function je(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function ye(e,t,n,r,a,i){var o,c=void 0;if(a)switch(r){case 0:var u=i?i.totalItemsFetched+e.length:e.length;o={skipToken:a,totalItemsFetched:u},c=Object(h.__assign)(Object(h.__assign)({},o),{__type:"OneDriveProItemSkipTokenPagingMetadata:#Client"});break;case 1:throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(re.a)(r)}var s=e.length;return a&&c?s=c.totalItemsFetched+1:c&&(s=c.totalItemsFetched),{TotalItemCount:s,ResultCode:0,Items:e.map((function(e){return function(e,t,n,r){var a,i,o,c=Object(h.__read)(e.folder?[w,null,e.folder.childCount,1,0]:[I,we(e),0,0,e.size],5),u=c[0],s=c[1],l=c[2],d=c[3],f=c[4];return{__type:u,Id:e.id,Name:e.name,Size:f,Thumbnail:{Url:(null===(i=null===(a=e.thumbnails)||void 0===a?void 0:a[0])||void 0===i?void 0:i.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(o=e.lastModifiedBy)||void 0===o?void 0:o.user)?e.lastModifiedBy.user.displayName:null,MimeType:s,Location:e.webDavUrl,ProviderEndpointUrl:t,ChildCount:l,AttachmentProviderId:n,ProviderType:r,Type:d}}(e,t,n,r)})),PagingMetadata:c}}function _e(e,t,n,r,a,i,o){return t?b(t,null,(function(e){return ye(e,n,r,a,i,o)}),je):b(null,e,(function(e){return ye(e,n,r,a,i,o)}),je)}function Ce(e,t,n,r,a,i){return void 0===i&&(i=null),Object(h.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s,l,d,f,m;return Object(h.__generator)(this,(function(h){switch(h.label){case 0:return o=Object(Se.parse)(e),c=o.protocol+"//"+o.host,u=i?{maxEntries:i.maxEntries,skipToken:i.metadata?i.metadata.skipToken:null}:null,[4,Object(y.o)(c,0,n,r,a,void 0,u)];case 1:return s=h.sent(),l=s.errorResponse,d=s.result,f=d.items,m=d.skipToken,[2,_e(l,f,e,t,0,m,i?i.metadata:null)]}}))}))}var Ae="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";function xe(e,t){var n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");var r=t&&0===t.SortOrder?"asc":"desc";return Ae+"&orderBy=folder,"+n+" "+r+'&q=mimeType!="application/octet-stream" and trashed=false and "'+(e||"root")+'" in parents'}var Te=n(4430),Ee=n.n(Te),Pe=n(4431),De=n.n(Pe),ke=Ee()({Type:0,DisplayName:"Files",AriaLabel:"Files"});function Re(e,t,n,r,i,o,c,s,l){var d={AttachmentDataProviderId:e,Paging:a()({Sort:l||p,FolderId:r||"",Location:o||"",ItemsEndpointUrl:i||"",FilterBy:n,RequestedData:u()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),PagingMetadata:s}),Scope:null==c?ke:c};return De()({request:d})}function Fe(e,t,n,r,a,i,o,c,u,s,l){return void 0===a&&(a=null),void 0===i&&(i=null),void 0===u&&(u=null),void 0===l&&(l=null),Object(h.__awaiter)(this,void 0,void 0,(function(){var d,f,b,v,g,O;return Object(h.__generator)(this,(function(h){switch(h.label){case 0:return h.trys.push([0,27,,28]),[4,ee(e,i,a)];case 1:return d=h.sent(),f=void 0,b=!1,d?5!==e?[3,3]:(b=!0,[4,P(xe(c,s))]):[3,25];case 2:return f=h.sent(),[3,25];case 3:if(2!==e)return[3,8];v=s?s.SortColumn:p.SortColumn,g=s?s.SortOrder:p.SortOrder,b=!0,h.label=4;case 4:return h.trys.push([4,6,,7]),[4,de(c,v,g)];case 5:return f=h.sent(),[3,7];case 6:return h.sent(),[3,7];case 7:return[3,25];case 8:if(3!==e)return[3,13];v=s?s.SortColumn:p.SortColumn,g=s?s.SortOrder:p.SortOrder,b=!0,h.label=9;case 9:return h.trys.push([9,11,,12]),[4,ue(o,v,g)];case 10:return f=h.sent(),[3,12];case 11:return h.sent(),[3,12];case 12:return[3,25];case 13:if(6!==e)return[3,18];b=!0,h.label=14;case 14:return h.trys.push([14,16,,17]),[4,Ie(a)];case 15:return f=h.sent(),[3,17];case 16:return h.sent(),[3,17];case 17:return[3,25];case 18:if(0!==Z(e,a))return[3,23];if(u&&!function(e){return e&&e.__type===j}(u))throw new Error("The paging metadata is not of type OneDriveProItemsSkipTokenPagingMetadata");b=!0,h.label=19;case 19:return h.trys.push([19,21,,22]),[4,Ce(i,t,s?s.SortColumn:p.SortColumn,s?s.SortOrder:p.SortOrder,o,{metadata:u,maxEntries:100})];case 20:return f=h.sent(),[3,22];case 21:return h.sent(),[3,22];case 22:return[3,25];case 23:return 10!==e?[3,25]:(b=!0,[4,M(o,n)]);case 24:f=h.sent(),h.label=25;case 25:return f&&0===f.ResultCode?(Object(Q.o)("FPgetItemsClientCall",[!0,e]),[2,f]):(b&&Object(Q.o)("FPgetItemsClientCall",[!1,e]),[4,Re(t,n,r,o,l,c,a,u,s)]);case 26:return[2,h.sent()];case 27:throw O=h.sent(),m.d.warn("FilePicker: getFileProviderItems got error: "+O.message),O;case 28:return[2]}}))}))}n.d(t,"g",(function(){return G})),n.d(t,"c",(function(){return Fe})),n.d(t,"a",(function(){return ee})),n.d(t,"b",(function(){return Y.b})),n.d(t,"f",(function(){return Y.f})),n.d(t,"e",(function(){return K})),n.d(t,"d",(function(){return we}))},3435:function(e,t,n){"use strict";var r,a=n(4),i={uploadFolders:new(n(12).ObservableMap)},o=Object(a.createStore)("attachmentsUploadFolderStore",i),c=n(65);!function(e){e.User="User",e.Group="Group"}(r||(r={}));var u=Object(a.action)("preloadUploadFolder",(function(e,t){return void 0===e&&(e=Object(c.h)().SessionSettings.UserEmailAddress),void 0===t&&(t=r.User),{mailboxId:e,uploadFolderMailboxType:t}})),s=Object(a.action)("uploadFolderLoaded",(function(e,t){return{mailboxId:e,uploadFolder:t}}));Object(a.mutator)(s,(function(e){var t=e.mailboxId,n=e.uploadFolder;o().uploadFolders.set(t,n)}));var l=n(0),d=n(4061),f=n(8),h=n(221),m=n(70),b="Email attachments";function p(e){switch(e){case r.Group:return b;case r.User:return Object(f.a)(d.a);default:return Object(h.a)(e)}}var v=n(4272),g=n.n(v),O=n(240);function I(e,t){switch(t){case r.Group:var n=new Headers;return Object(O.g)(e,n),n;case r.User:return null;default:return Object(h.a)(t)}}function w(e){return void 0===e&&(e=Object(c.h)().SessionSettings.UserEmailAddress),o().uploadFolders.get(e)||null}var S=n(44);function j(e,t){return void 0===e&&(e=null),void 0===t&&(t=r.User),Object(l.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i;return Object(l.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=e||Object(c.h)().SessionSettings.UserEmailAddress,(n=w(e))?[2,n]:[4,g()({},{headers:I(e,t)})];case 1:return r=o.sent(),a=function(e,t,n){return{mailboxId:e,folderId:n.FolderId,folderName:Object(m.b)(n.FolderName)?p(t):n.FolderName}}(e,t,r),s(e,a),[2,a];case 2:return i=o.sent(),S.d.warn("fetchUploadFolder got error: "+i.message),[2,null];case 3:return[2]}}))}))}Object(a.orchestrator)(u,(function(e){return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(l.__generator)(this,(function(r){switch(r.label){case 0:return t=e.mailboxId,n=e.uploadFolderMailboxType,w(t)?[3,2]:[4,j(t,n)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return r}))},3507:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("previewAttachment",(function(e){return{context:e}}))},3531:function(e){e.exports=JSON.parse('{"a":"Eka"}')},3612:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,a=n(3356);function i(e,t,n){return r||(r=Object(a.a)()),{composeId:n,allowShowMultipleRows:!e,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:t,isReadOnly:e,groupId:null,maxTotalClassicAttachmentSize:r,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[],announcedComponentMessage:null}}},3613:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("changeTotalClassicAttachmentSize")((function(e,t,n){e.totalClassicAttachmentSize+=t}))},3626:function(e,t,n){"use strict";t.a={AttachmentCreationClassicFromLocalFile:{name:"AttachmentCreationClassicFromLocalFile",customData:function(e,t,n,r,a){return r?[r.size]:[0]}},AttachmentCreationFromRecentAttachment:{name:"AttachmentCreationFromRecentAttachment",customData:function(e,t,n,r,a,i){return r?[r.size]:[0]}},AttachmentCreationCloudyFromAttachmentDataProvider:{name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:function(e,t,n,r){return[n.providerType]}},AttachmentCreationCloudyFromLocalFile:{name:"AttachmentCreationCloudyFromLocalFile"},AttachmentDeletionAction:{name:"AttachmentDeletionAction",customData:function(e,t,n,r){return{generatedAttachmentId:t.attachmentId.Id}},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({attachmentId:t.attachmentId.Id,fileType:r})}},AttachmentWellInitialization:{name:"AttachmentWellInitialization",customData:function(e,t,n,r,a,i,o){return{hasAttachments:e&&e.length>0,isCompose:a}},options:{sessionSampleRate:1}}}},3665:function(e,t,n){"use strict";var r=n(3531),a=n(8);function i(e,t){return{name:Object(a.a)(r.a),key:"OpenInNewTab",onClick:function(){window.open(e,"_blank"),t&&t()}}}n.d(t,"a",(function(){return"owa-attachment-remove-on-send-end"})),n.d(t,"b",(function(){return"owa-attachment-remove-on-send-start"})),n.d(t,"c",(function(){return i}))},3672:function(e,t,n){"use strict";var r=n(1005),a=n(3157),i=function(e){var t=Object(r.a)();t&&Object(a.a)(e,t.highlightTerms,!1,!0)};n.d(t,"a",(function(){return i}))},3829:function(e){e.exports=JSON.parse('{"a":"IDb"}')},3830:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(73),a=new r.c((function(){return Promise.all([n.e(12),n.e(76),n.e(603),n.e(7),n.e(126)]).then(n.bind(null,6607))})),i=Object(r.d)(a,(function(e){return e.AttachmentThumbnailView})),o=Object(r.d)(a,(function(e){return e.AttachmentIconView})),c=Object(r.d)(a,(function(e){return e.AttachmentDocInfoView}))},389:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},3926:function(e){e.exports=JSON.parse('{"a":"ila"}')},3927:function(e){e.exports=JSON.parse('{"a":"hla"}')},3928:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},3929:function(e,t,n){"use strict";var r=n(0),a=function(e){function t(t,n,r){var a=e.call(this,t)||this;return a.errorCode=n,a.errorContext=r,a}return Object(r.__extends)(t,e),t}(Error);t.a=a},4061:function(e){e.exports=JSON.parse('{"a":"Qha"}')},418:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return o(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return i(o,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},4397:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(965),i=n(883),o=n(1038);function c(e,t,n,c,s,l){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,f,h,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o.c.import()];case 1:return d=r.sent(),f=n.filter((function(e){return!((t=e).__type!==i.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE&&t.IsInline);var t})).map(d),h=f.filter((function(e){return e.fileType===a.a.Cloud})),(m=f.filter((function(e){return e.fileType===a.a.AttachmentItem}))).length>0&&u(t,e,m,c,!1,!1,s,l),h.length>0&&u(t,e,h,c,!1,!0,s,l),[2]}}))}))}function u(e,t,n,a,i,c,u,s){var l={isInline:i,isHiddenInline:!1},d=c?Object(r.__assign)(Object(r.__assign)({},l),{shouldShare:!0}):Object(r.__assign)(Object(r.__assign)({},l),{shouldShare:!1});o.f.import().then((function(r){r(e,t,n,a,d,null,u,s)}))}},4399:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var r="application/octet-stream",a=1024,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},4409:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("setAnnouncedComponentMessage",(function(e,t){return{attachmentWell:e,message:t}}))},4424:function(e){e.exports=JSON.parse('{"a":"oha"}')},4425:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(44);function a(e){var t=e.maxTotalClassicAttachmentSize-e.totalClassicAttachmentSize;return t<0?(r.d.error("AttachmentWellAvailableSize is smaller than zero: "+e.composeId),0):t}},4570:function(e){e.exports=JSON.parse('{"a":"PCb"}')},465:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},466:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(12),a=n(1);function i(e){return{get:e}}function o(e,t){return Object(a.useMemo)((function(){return Object(r.computed)(e)}),t).get()}},4693:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(883),a=n(965);function i(e){if(e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE){var t=e;return{fileType:a.a.Cloud,name:t.Name,size:t.Size,providerId:"",providerType:4,location:t.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:t.AttachmentThumbnailUrl,previewUrl:t.AttachmentPreviewUrl,fileId:t.AttachmentId.Id,fileParentId:"",type:t.ContentType}}return{attachmentItemId:e.AttachmentId.Id,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE,EmbeddedItemClass:e.EmbeddedItemClass,ContentType:e.ContentType}}},4705:function(e){e.exports=JSON.parse('{"a":"dub"}')},4706:function(e){e.exports=JSON.parse('{"a":"JCb"}')},4767:function(e,t,n){"use strict";var r=n(5522),a=n(8),i=n(1227),o=n(1228),c=n(3309),u=n(193),s=n(221),l=n(876),d=n(857),f=n(0),h=n(6273),m=n(6275);var b=n(5053),p=n(1143),v=n(44),g=n(93),O=n(972),I=n(914),w=n(5054),S=n(1948);var j=n(3410),y=n(4409),_=n(5004),C=n(8101);function A(e,t,n,r,i,o,c){Object(y.a)(c,Object(a.a)(C.a)),Object(p.E)(e,t,n,r,o),Object(_.a)(i,r.AttachmentId.RootItemChangeKey),function(e,t,n){n&&0===n.ResultCode&&0===e.attachmentType&&(n.CanShareInternally||Object(S.f)(t.PermissionType)||(Object(u.o)("AttachmentsCanNotShareInternally"),Object(w.a)(e.attachmentId,0)),Object(I.p)(t.AttachmentId))}(e,n,o)}function x(e,t,n,r){1===e.attachmentType&&Object(p.z)(e,2),t&&Object(j.a)(t,e),n&&r&&O.h.importAndExecute(n,r)}var T=Object(g.action)("handleCreateAttachmentNotification")((function(e,t,n,r,a,i,o,c){var u=e;try{if(0!==u.ResultCode)throw new Error("ResultCode:"+u.ResultCode+", Id:"+u.Id+", Exception: "+u.Exception);var s=u.Response.ResponseMessages.Items[0];if(s&&s.Attachments.length>0)return Object(p.C)(a.attachmentId,!0),i(s.Attachments[0]),void A(a,n,r,s.Attachments[0],t,u.Response.SharingInformation,c.attachmentWellViewState)}catch(e){v.d.error("Error handling the create attachment notification: "+e)}Object(p.C)(a.attachmentId,!1),o(new Error(u.Exception)),x(a,c.attachmentWellViewState,null,null)})),E=n(452);function P(e,t){return Object(f.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i;return Object(f.__generator)(this,(function(o){switch(o.label){case 0:return n=Object(E.a)(),r={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null},a=function(e){t(e),O.h.importAndExecute(r,a)},[4,O.g.import()];case 1:return o.sent()(r,a),[4,O.b.import()];case 2:return i=o.sent()(),e(n,r,i,a),[2]}}))}))}var D=n(8102),k=n.n(D),R=n(240);function F(e,t,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o;return Object(f.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(R.e)(e.mailboxInfo)];case 1:return o=c.sent()||{},[4,k()({itemId:e,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",subscriptionId:r,channelId:a,dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:t,isInline:i},o)];case 2:return[2,c.sent()]}}))}))}var N=Object(g.action)("createAttachmentFromAttachmentDataProvider")((function(e,t,n,r,a,i,o,c,s){return Object(f.__awaiter)(this,void 0,void 0,(function(){var l,d,h,m=this;return Object(f.__generator)(this,(function(b){return(l=new u.a("AttachmentCreationClassicFromAttachmentDataProvider")).addCustomData([a.providerType]),d=function(e){o(e),l.end()},h=function(e){c(),l.endWithError("ServerError",e)},P((function(t,n,o,u){return Object(f.__awaiter)(m,void 0,void 0,(function(){return Object(f.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),0===i.attachmentType&&Object(p.B)(Object(p.k)(a.size),.05,(function(e){Object(p.x)(i,e)}),i.attachmentId),[4,F(e,r,a,t,o,!1)];case 1:if(!l.sent())throw new Error("Empty response for createAttachmentFromAttachmentDataProvider request");return[3,3];case 2:return l.sent(),Object(p.C)(i.attachmentId,!1),c(),x(i,s.attachmentWellViewState,n,u),[2];case 3:return[2]}}))}))}),(function(r){T(r,e,t,n,i,d,h,s)})),[2]}))}))})),M=n(3626),L=n(36);function B(e,t,n,r,a,i){return new Promise((function(o,c){var u=new XMLHttpRequest;u.onreadystatechange=function(){if(4===u.readyState)if(200===u.status){var e=void 0;try{e=JSON.parse(u.responseText)}catch(e){v.d.error("Attachment: Deserialize response failed with error: "+e.Message),v.d.error("Attachment: Deserialize response Failure Stack Trace: "+e.stack),c(e)}o(e)}else c(new Error("Request failed with status "+u.status+". Message: "+u.responseText))},u.ontimeout=function(){c(new Error("Request timed out"))},a&&(u.upload.onprogress=a),u.open("POST",e,!0),u.setRequestHeader("X-OWA-Action",n),u.setRequestHeader("X-OWA-CANARY",Object(L.getOwaCanaryCookie)()),i&&Object.keys(i).forEach((function(e){u.setRequestHeader(e,i[e])}));var s=JSON.stringify(t);r?(u.setRequestHeader("X-OWA-UrlPostData",encodeURI(s)),u.send(r)):u.send(s)}))}var V=n(30);function U(e){var t=Object(V.getConfig)();return t.baseUrl?""+t.baseUrl+e:"/owa"+e}var W=n(5055),H=n.n(W),z=n(5523),q=n.n(z),G=n(155),J=U("/service.svc/CreateAttachmentFromLocalFile");function Q(e,t,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s;return Object(f.__generator)(this,(function(l){switch(l.label){case 0:return o=q()({ParentItemId:e,Attachments:[t],RequireImageType:t.IsInline,IncludeContentIdInResponse:t.IsInline,ClientSupportsIrm:!0,CancellationId:n}),i&&(o.SliceNumber=i.sliceNumber,o.TotalSlices=i.totalSlices),c=H()({Header:Object(G.getJsonRequestHeader)(),Body:o}),u=t,v.d.info("Attachment: createAttachment Id: "+e.Id+", ChangeKey: "+e.ChangeKey),[4,Object(R.d)(e.mailboxInfo)];case 1:return s=l.sent(),[4,B(J,c,"CreateAttachmentFromLocalFile",u&&r?r:null,a,s)];case 2:return[2,l.sent().Body]}}))}))}function X(e){var t="Attachment: createAttachment failed",n="genericError";return(null==e?void 0:e.MessageText)&&(t+=" with MessageText: "+e.MessageText),v.d.warn(t),(null==e?void 0:e.ResponseCode)&&(n=e.ResponseCode),{errorMessage:t,errorCode:n}}function Y(e){var t=Object(f.__assign)({},e);return Object.keys(t).forEach((function(e,n){null===t[e]&&(t[e]=void 0)})),t}var K=n(74),Z=Object(K.d)("createAttachmentFromLocalFile",M.a.AttachmentCreationClassicFromLocalFile)((function(e,t,n,r,a){return Object(f.__awaiter)(this,void 0,void 0,(function(){var i,o,c,u;return Object(f.__generator)(this,(function(s){switch(s.label){case 0:return i=null,0===a.attachmentType&&(i=function(e){var t=e.loaded/e.total;Object(p.x)(a,t)}),o=Y(t),[4,Q(e,o,n,r,i)];case 1:if(c=s.sent(),(u=c.ResponseMessages.Items[0])&&u.Attachments.length>0&&u.Attachments[0])return[2,{attachment:u.Attachments[0],sharingInfo:null}];throw X(u)}}))}))})),$=n(4426),ee=n.n($),te=Object(K.d)("createAttachmentFromMailboxFile",M.a.AttachmentCreationFromRecentAttachment)((function(e,t,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s;return Object(f.__generator)(this,(function(l){switch(l.label){case 0:return o=null,0===a.attachmentType&&(o=function(e){var t=e.loaded/e.total;Object(p.x)(a,t)}),c=Y(t),i&&(c=function(e,t){return ee()({AttachmentId:e.AttachmentId,AttachmentIdToAttach:t,ContentType:e.ContentType,Name:e.Name,Size:e.Size,Thumbnail:e.Thumbnail,ThumbnailMimeType:e.ThumbnailMimeType,CreateAttachmentInlineType:2})}(c,r.fileId)),[4,Q(e,c,n,null,o)];case 1:if(u=l.sent(),(s=u.ResponseMessages.Items[0])&&s.Attachments.length>0&&s.Attachments[0])return[2,{attachment:s.Attachments[0],sharingInfo:u.SharingInformation}];throw X(s)}}))}))}));var ne=n(8103),re=n.n(ne);function ae(e,t,n,r,a,i){return Object(f.__awaiter)(this,void 0,void 0,(function(){var o;return Object(f.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(R.e)(e.mailboxInfo)];case 1:return o=c.sent()||{},[4,re()({itemId:e,uri:t,name:n,subscriptionId:r,isInline:a,contentId:i},o)];case 2:return[2,c.sent()]}}))}))}var ie=Object(g.action)("createAttachmentFromUri")((function(e,t,n,r,a,i,o,c,s){var l=this,d=new u.a("AttachmentCreationFromUri");d.addCustomData({size:a?a.size:0});var h=function(e){o(e),d.end()},m=function(e){c(),d.endWithError("ServerError",e)};P((function(t,r,o,u){return Object(f.__awaiter)(l,void 0,void 0,(function(){return Object(f.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),0===i.attachmentType&&Object(p.B)(Object(p.l)(a.size),.05,(function(e){Object(p.x)(i,e)}),i.attachmentId),[4,ae(e,a.uri,a.name,t,n.IsInline,null)];case 1:if(!o.sent())throw new Error("Empty response for createAttachmentFromUriProvider request");return[3,3];case 2:return o.sent(),Object(p.C)(i.attachmentId,!1),c(),x(i,s.attachmentWellViewState,r,u),[3,3];case 3:return[2]}}))}))}),(function(r){T(r,e,t,n,i,h,m,s)}))})),oe=n(8104),ce=n.n(oe);function ue(e,t,n){return Object(f.__awaiter)(this,void 0,void 0,(function(){var r;return Object(f.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(R.e)(e.mailboxInfo)];case 1:return r=a.sent()||{},[4,ce()({itemId:e,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:t,thumbnailUrl:n.thumbnailUrl,previewUrl:n.previewUrl,isFolder:n.isFolder,mimeType:n.type},r)];case 2:return[2,a.sent()]}}))}))}var se=Object(K.d)("createReferenceAttachmentFromAttachmentDataProvider",M.a.AttachmentCreationCloudyFromAttachmentDataProvider)((function(e,t,n,r){return Object(f.__awaiter)(this,void 0,void 0,(function(){return Object(f.__generator)(this,(function(a){return 0===r.attachmentType&&Object(p.B)(4e3,.05,(function(e){Object(p.x)(r,e)}),r.attachmentId),[2,ue(e,t,n).then((function(e){var t=e.ResponseMessages.Items[0];if(t&&t.Attachments.length>0)return Object(p.C)(r.attachmentId,!0),{attachment:t.Attachments[0],sharingInfo:e.SharingInformation};throw Object(p.C)(r.attachmentId,!1),X(t)}))]}))}))})),le=n(8105),de=n.n(le),fe=U("/service.svc/CreateReferenceAttachmentFromLocalFile");function he(e,t,n,r,a,i,o,c,u,s){return Object(f.__awaiter)(this,void 0,void 0,(function(){var l,d,h;return Object(f.__generator)(this,(function(f){switch(f.label){case 0:return l=de()({ParentItemId:e,FileName:t.Name,SubscriptionId:a,ChannelId:i,FileSizeInBytes:t.Size,SliceNumber:o,TotalSlices:c,CancellationId:n,FileContentToUpload:"",GroupSmtpAddress:u,UploadFolderId:s}),d={requestObject:l},[4,Object(R.d)(e.mailboxInfo)];case 1:return h=f.sent()||{},[4,B(fe,d,"CreateReferenceAttachmentFromLocalFile",r,void 0,h)];case 2:return[2,f.sent()]}}))}))}var me=n(3435),be=Object(K.d)("createReferenceAttachmentFromLocalFile",M.a.AttachmentCreationCloudyFromLocalFile)((function(e,t,n,r,a,i,o,c,u){return Object(f.__awaiter)(this,void 0,void 0,(function(){var s=this;return Object(f.__generator)(this,(function(l){return P((function(t,o,l,d){return Object(f.__awaiter)(s,void 0,void 0,(function(){return Object(f.__generator)(this,(function(s){return function(e,t,n,r,a,i,o,c,u,s,l,d){var h;Object(f.__awaiter)(this,void 0,void 0,(function(){var m,b,v,g,O,I,w,S;return Object(f.__generator)(this,(function(f){switch(f.label){case 0:return m=Math.ceil(r.size/s),Object(p.B)(Object(p.q)(r.size),.05,(function(e){Object(p.x)(a,e)}),a.attachmentId),b=null,(v=null===(h=null==d?void 0:d.attachmentWellViewState)||void 0===h?void 0:h.groupId)?(b=Object(me.c)(v)?Object(me.c)(v).folderId:null)?[3,2]:[4,Object(me.b)(v,me.a.Group)]:[3,2];case 1:(S=f.sent())&&(b=S.folderId),f.label=2;case 2:g=0,f.label=3;case 3:if(!(g<m))return[3,8];O=0+g*s,I=Math.min(O+s,r.size),w=r.slice(O,I),f.label=4;case 4:return f.trys.push([4,6,,7]),[4,he(e,t,n,w,i,c,g,m,v,b)];case 5:if(!(S=f.sent()))throw new Error("Empty response for createReferenceAttachmentFromLocalFile request");return[3,7];case 6:return f.sent(),Object(p.C)(a.attachmentId,!1),l(),x(a,d.attachmentWellViewState,o,u),[2];case 7:return g++,[3,3];case 8:return[2]}}))}))}(e,n,r,a,i,t,o,l,d,10485760,c,u),[2]}))}))}),(function(r){T(r,e,t,n,i,o,c,u)})),[2]}))}))}));var pe=n(965),ve=n(3434),ge=n(1440),Oe=n(199),Ie=n(1365);function we(e,t,n,r,a,i,o,c){var s=this,l=new u.a("UploadLocalFileAndCreateCloudyAttachment",{timeout:3e5}),d=Object(ge.h)(),h=Object(f.__read)(d.filter((function(e){return 0===e.type})),1)[0];if(!h)throw new Error("Unable to upload file as couldnt find OneDrivePro provider");var m=h.model,b=m.Id,v=m.EndPointUrl,g=Object(Ie.u)(0,v,{fileToUpload:{fileName:n.Name,fileBlob:i},conflictBehavior:"rename",folderInfo:Se(a),onProgress:function(e){var t=e.loaded/e.total;Object(p.x)(o,t)}}),O=g.uploadPromise,I=g.cancel,w=!1;return{onCompletePromise:Object(f.__awaiter)(s,void 0,void 0,(function(){var a,i,s,d,h,m,g,I,S,j;return Object(f.__generator)(this,(function(f){switch(f.label){case 0:a=null,f.label=1;case 1:return f.trys.push([1,6,7,8]),[4,O];case 2:return i=f.sent(),s=i.errorResponse,d=i.result,s?[4,s.text()]:[3,4];case 3:throw h=f.sent(),new Error("Unable to upload file with status code: "+s.status+"; response: "+h);case 4:return m=function(e,t,n,r){return{fileType:pe.a.Cloud,name:e.name,size:e.size,providerId:t,providerType:n,location:Object(Oe.parse)(e.webUrl).path,providerEndpointUrl:r,isFolder:!1,fileId:e.id,fileParentId:e.parentReference.id,thumbnailUrl:"",previewUrl:"",type:Object(ve.d)(e)}}(d,b,0,v),[4,ue(e,r,m)];case 5:if(g=f.sent(),(I=g.ResponseMessages.Items[0])&&I.Attachments.length>0)return Object(p.C)(o.attachmentId,!0),S=I.Attachments[0],A(o,t,n,S,e,g.SharingInformation,c.attachmentWellViewState),[2,S];throw new Error(I.MessageText);case 6:if(j=f.sent(),Object(p.C)(o.attachmentId,!1),x(o,c.attachmentWellViewState),w)return[2,null];throw a=j,j;case 7:return a?(new u.a("UploadLocalFileAndCreateCloudyAttachmentError",{isCore:!0}).endWithError(a),l.endWithError(a)):l.end(),[7];case 8:return[2]}}))})),cancel:function(){w=!0,I()}}}function Se(e){var t=e.identifierType,n=e.identifier;switch(t){case 0:return{type:0,identifier:n};case 1:return{type:1,identifier:n};default:return Object(s.a)(t)}}var je=n(37),ye=n(3304),_e=14680064;function Ce(e,t,n,r){e.addCustomData([t]),n?e.end():e.endWithError("ServerError",r)}function Ae(e,t,n,r,a,i){void 0===i&&(i={}),i.sliceSizeInBytes=i.sliceSizeInBytes||_e;var o=new u.a("AttachmentCreationClassicFromLocalFileSliced",{timeout:3e5}),c=function(e,t,n,r,a){var i=this,o=null,c=!1,u=null;return{action:function(s,l,d){return Object(f.__awaiter)(i,void 0,void 0,(function(){var i,h,m;return Object(f.__generator)(this,(function(b){switch(b.label){case 0:return u||(u=function(e){for(var t=[],n=0;n<e;n++)t[n]=0;return t}(d)),i=null,0===a.attachmentType&&(i=function(e){u[l]=e.loaded;var t=u.reduce((function(e,t){return e+t}),0)/r.size;Object(p.x)(a,t)}),h=Y(t),[4,Q(e,h,n,s,i,{sliceNumber:l,totalSlices:d})];case 1:if(m=b.sent(),!function(e){return e&&e.Attachments.length>0&&e.Attachments[0]}(o=m.ResponseMessages.Items[0]))throw X(o);return c||(t=Object(f.__assign)(Object(f.__assign)({},t),{AttachmentId:o.Attachments[0].AttachmentId}),c=!0),[2]}}))}))},getLastResponseMessage:function(){return o}}}(e,t,n,r,a),l=c.action,d=c.getLastResponseMessage,h=Object(ye.a)(r,l,{sliceSize:i.sliceSizeInBytes,numberOfSlicesToParallelize:1}),m=h.onCompletePromise,b=h.cancel,v=!1;return{onCompletePromise:m.then((function(e){switch(e){case 0:return Ce(o,r.size,!0),{status:0,attachment:d().Attachments[0]};case 1:return{status:1};default:return Object(s.a)(e)}})).catch((function(e){if(v)return{status:1};throw Ce(o,r.size,!1,e),e})),cancel:function(){v=!0,b()}}}function xe(e,t,n,r,a,i,o){void 0===o&&(o={shouldShare:!1});var c,u=r&&(r.fileType===pe.a.Cloud||r.fileType===pe.a.CloudSuggestion||r.fileType===pe.a.ContextualSuggestion),l=null,d=Object(f.__assign)(Object(f.__assign)({},t.AttachmentId),{mailboxInfo:e.mailboxInfo}),h=o.shouldShare,m=function(){};if((c=r).fileType===pe.a.AttachmentItem||c.fileType===pe.a.AttachmentItemSuggestion||(c.fileType===pe.a.Cloud||c.fileType===pe.a.CloudSuggestion||c.fileType===pe.a.ContextualSuggestion)&&4===c.providerType)l=te(e,t,n,r,a,u).then((function(e){return e}));else if(h||u){if(!h&&u)return{createAttachmentPromise:new Promise((function(o,c){N(e,d,t,n,r,a,o,c,i)})),cancelCreateAttachment:m};if(!h||!u){if(Object(je.f)("doc-attachment-upsellEntryPoint")&&o.shouldShare&&o.shareProperties&&!o.shareProperties.groupMailboxId){var b=we(e,d,t,n,o.shareProperties.folderInfo,r.fileObject,a,i);return{createAttachmentPromise:v=b.onCompletePromise,cancelCreateAttachment:b.cancel}}return{createAttachmentPromise:new Promise((function(o,c){return be(e,d,t,n,r.fileObject,a,o,c,i),t})),cancelCreateAttachment:m}}l=se(e,n,r,a)}else if(r&&r.fileType===pe.a.Local&&r.fileObject){var p=Ae(e,t,n,r.fileObject,a),v=p.onCompletePromise;m=p.cancel,l=v.then((function(e){switch(e.status){case 0:return{attachment:e.attachment,sharingInfo:null};case 1:return null;default:return Object(s.a)(e)}}))}else{if(r&&r.fileType===pe.a.Uri)return{createAttachmentPromise:new Promise((function(o,c){ie(e,d,t,n,r,a,o,c,i)})),cancelCreateAttachment:m};l=Z(e,t,n,r&&r.fileType===pe.a.Local?r.fileObject:null,a)}return function(e,t,n,r,a,i,o){return{createAttachmentPromise:i.then((function(i){return i?(A(r,t,n,i.attachment,e,i.sharingInfo,a.attachmentWellViewState),i.attachment):null})).catch((function(e){throw x(r,a.attachmentWellViewState,null,null),e})),cancelCreateAttachment:o}}(e,d,t,a,i,l,m)}var Te=n(5490),Ee=Object(K.d)("deleteAttachment",M.a.AttachmentDeletionAction)((function(e,t,n,r){return Object(Te.a)(t.attachmentId).then((function(r){var a=r.ResponseMessages.Items[0];"Success"===a.ResponseClass?(Object(j.a)(e,t),Object(_.a)(n,a.RootItemId.RootItemChangeKey)):v.d.warn("Attachment: Failed to delete attachment with ResponseClass= "+a.ResponseClass+", ResponseCode="+a.ResponseCode)})).catch((function(e){throw v.d.warn("Attachment: deleteAttachment got error: "+e.message),e}))})),Pe=n(8106),De=n.n(Pe);var ke=n(883);function Re(e){if(null==e)return null;switch(e){case 0:return ke.m;case 5:return ke.f;case 1:return ke.l;case 2:return ke.c;case 3:return ke.b;case 7:return ke.o;case 9:return ke.p;case 8:return ke.q;case 4:return ke.j;case 6:return ke.d;case 10:return ke.k;default:return Object(s.a)(e)}}var Fe=n(2735),Ne=n.n(Fe),Me=n(5524),Le=n.n(Me),Be=n(5525),Ve=n.n(Be),Ue=n(454),We=n.n(Ue),He=n(5526),ze=n.n(He),qe=n(4846),Ge=n.n(qe),Je=n(5489),Qe=n(1206);function Xe(e,t){var n=Object(l.a)(e.item.attachmentId);if(n){!function(e,t,n){Object(Qe.a)(n,e,[t])}("WarningAttachmentsCanNotBeDeleted",Object(a.b)(Object(a.a)(Je.a),n.model.Name),t)}}var Ye=n(8107),Ke=n(916),Ze=4;function $e(e,t,n){Object(Qe.a)(n,e,[t])}function et(e,t){var n,r=(n=function(e){return e.reason},e.reduce((function(e,t){var r=n(t);return e[r]?e[r].push(t):e[r]=[t],e}),{}));Object.keys(r).forEach((function(e){var n=r[e];switch(parseInt(e)){case 0:!function(e,t){var n=null,r=null;if(1===e.length&&null!==e[0].item.tryAgainCallback){var i=e[0],o=i.item.file.name,c=Object(a.b)(Object(a.a)(Ye.e),o),u={key:"WarningFilesCanNotBeAttachedWithNamesGenericError",source:Ke.c.Compose,rank:Ke.b.Info,message:c,messageParts:[c]},s={text:Object(a.a)(Ye.a),action:function(){return i.item.tryAgainCallback()}};return u.messageParts.push(s),void Object(Qe.a)(t,"WarningFilesCanNotBeAttachedWithNamesGenericError",(function(e){return u}))}if(e.length<Ze){var l=e.map((function(e){return e.item.file.name})).join(", ");r="WarningFilesCanNotBeAttachedWithNamesGenericError",n=Object(a.b)(Object(a.a)(Ye.b),l)}else r="WarningSeveralFilesCanNotBeAttachedGenericError",n=Object(a.b)(Object(a.a)(Ye.d),e.length);$e(r,n,t)}(n,t);break;case 1:!function(e,t){$e("WarningFilesCannotBeAttachedFromOtherMailboxes",Object(a.a)(Ye.c),t)}(0,t)}}))}var tt=function(){function e(e,t,n,r,a){var i=this;void 0===r&&(r=null),void 0===a&&(a=null),this.attachmentWellViewState=e,this.parentItemId=t,this.infoBar=n,this.onAnyAttachmentCreatedInParentItemCallback=r,this.onAnyAttachmentDeletedInParentItemCallback=a,this.uploadQueue=[],this.deleteQueue=[],this.uploadFailures=[],this.onFinishPromise=new Promise((function(e,t){i.onFinish=function(t){e(t)}}))}return e.prototype.enqueueAttachmentCreation=function(e,t,n,r,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=null);var i=t.isInline,o=t.shouldShare,u=t.isHiddenInline,s=t.skipProcessInlineImage;if(Object(c.a)(this.infoBar),!o&&Object(m.a)(e,this.infoBar,this.attachmentWellViewState))return[];e=Object(h.a)(e,i,this.infoBar);for(var l=0,d=void 0;d=e[l];l++){var g=void 0,O={Name:null,ContentType:null,ContentId:null,ContentLocation:null,AttachmentOriginalUrl:null,Size:0,LastModifiedTime:null,IsInline:!1,IsInlineToUniqueBody:!1,IsInlineToNormalBody:!1,ThumbnailMimeType:null,Thumbnail:null};if(o){var I=d;g=Ge()(Object(f.__assign)(Object(f.__assign)({},O),{Name:I.name,Size:I.size,ContentType:I.type,ProviderType:Re(I.providerType),AttachmentIsFolder:I.isFolder,IsInline:!1,PermissionType:0,AttachLongPathName:null,ProviderEndpointUrl:null,AttachmentThumbnailUrl:null,AttachmentPreviewUrl:null,OriginalPermissionType:0}))}else if(d.fileType===pe.a.Base64InlineImage){var w=d;g=Ne()(Object(f.__assign)(Object(f.__assign)({},O),{Name:w.name,Size:w.size,ContentType:w.type,IsInline:!0,Content:w.dataUri,IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0}))}else if(d.fileType===pe.a.MailItem){var S=d;if(S.mimeContent)g=Ve()(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,Size:d.size,IsInline:!1,Item:Le()({MimeContent:ze()({Value:S.mimeContent})}),ContentType:"message/rfc822"}));else{var j=We()({Id:S.itemId});g=ee()(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,IsInline:!1,ItemId:j,Size:d.size,AttachmentIdToAttach:null,CreateAttachmentInlineType:0}))}}else if(d.fileType===pe.a.AttachmentItem||d.fileType===pe.a.AttachmentItemSuggestion){var y=d;g=ee()(Object(f.__assign)(Object(f.__assign)({},O),{Name:y.name,AttachmentIdToAttach:y.attachmentItemId,__type:y.type,Size:d.size,ItemId:null,CreateAttachmentInlineType:0}))}else g=d.fileType===pe.a.Uri?Ne()(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,AttachmentOriginalUrl:d.uri,Size:d.size,ContentType:d.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})):Ne()(Object(f.__assign)(Object(f.__assign)({},O),{Name:d.name,Size:d.size,ContentType:d.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0}));var _={Id:Object(E.a)(),mailboxInfo:this.parentItemId.mailboxInfo},C=void 0;i?C=Object(p.i)(_,_.Id,u,0,s):(C=Object(p.g)(_,!1,!1,o,d.fileType,!0),t.isAddedFromSmartDoc&&(C.fileType=pe.a.SmartDoc),this.attachmentWellViewState.supportedMenuActions&&(C.strategy.supportedMenuActions=this.attachmentWellViewState.supportedMenuActions),t.downsellFromLink&&Object(p.A)(C,6,11)),Object(b.a)(C,this.attachmentWellViewState,g,_);var A={attachmentState:C,file:d,attachment:g,shouldShareInfo:t,cancelPendingUpload:function(){},onAttachmentCreatedCallback:n,onAttachmentCanceledOrFailedCallback:r,tryAgainCallback:a};v.d.info("Attachment: UploadQueue enqueue attachment: Name="+d.name),this.uploadQueue.push(A)}return this.startProcessIfNotStarted(),e},e.prototype.deleteAttachment=function(e,t){var n=this;void 0===t&&(t=null),Object(c.a)(this.infoBar);var r,a=1===e.attachmentType;if(a||Object(p.A)(e,3,6),(a?0===e.status:e.actionCompletePercent<=1)&&this.currentUploadItem)if(this.currentUploadItem.attachmentState.attachmentId===e.attachmentId){v.d.info("Attachment: Cancelling attachment: TempId="+e.attachmentId);var i=this.currentUploadItem;if(i.cancelPendingUpload(),0===e.attachmentType&&e.isCloudy){if(v.d.info("Attachment: Put attachment: Id= "+e.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter((function(t){return t.attachmentState.attachmentId===e.attachmentId})).length){var o={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(o)}this.startProcessIfNotStarted()}else this.isCancelling||(this.isCancelling=!0,(r=e.attachmentId.Id,De()({cancellationId:r})).then((function(t){n.isCancelling=!1,t?(Object(j.a)(n.attachmentWellViewState,e),i.onAttachmentCanceledOrFailedCallback&&i.onAttachmentCanceledOrFailedCallback(!0)):n.onAttachmentDeleteFailure(e)})))}else v.d.info("Attachment: Removing attachment: TempId= "+e.attachmentId+" from queue"),function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.attachmentState.attachmentId===e.attachmentId&&(r.onAttachmentCanceledOrFailedCallback&&r.onAttachmentCanceledOrFailedCallback(!0),t.splice(n,1))}}(e,this.uploadQueue),Object(j.a)(this.attachmentWellViewState,e);else{if(v.d.info("Attachment: Put attachment: Id= "+e.attachmentId+" into deleteQueue"),0===this.deleteQueue.filter((function(t){return t.attachmentState.attachmentId===e.attachmentId})).length){o={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(o)}this.startProcessIfNotStarted()}},e.prototype.onAttachmentDeleteFailure=function(e){var t,n;t={item:e,reason:0},n=this.infoBar,Object(c.a)(n),Xe(t,n),1!==e.attachmentType&&Object(p.A)(e,0,0),v.d.warn("Attachment: Failed to cancel attachment: TempId="+e.attachmentId)},e.prototype.startProcessIfNotStarted=function(){this.isInProgress||(this.datapoint=new u.a("AttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment("NewProcess"))},e.prototype.processNextAttachment=function(e){var t=this;if(v.d.info("Attachment: Invoking processNextAttachment from: "+e),0!==this.deleteQueue.length){var n=this.deleteQueue[0],r=n.attachmentState,a=n.onAttachmentDeletedCallback,i=Object(l.a)(r.attachmentId);v.d.info("Attachment: Deleting attachment: Id= "+r.attachmentId),Ee(this.attachmentWellViewState,r,this.parentItemId,r.fileType).then((function(){t.deleteQueue.shift(),nt(a,t.parentItemId,r.attachmentId,i.model),nt(t.onAnyAttachmentDeletedInParentItemCallback,t.parentItemId,r.attachmentId,i.model),t.processNextAttachment("DeleteAttachmentFinish")})).catch((function(e){t.deleteQueue.shift(),t.onAttachmentDeleteFailure(r),t.logDeletionFailure(e.message,r),t.processNextAttachment("DeleteAttachmentFinish")}))}else if(0!==this.uploadQueue.length){this.currentUploadItem=this.uploadQueue.shift();var o=this.currentUploadItem.onAttachmentCreatedCallback,c={attachmentWellViewState:this.attachmentWellViewState,parentItemId:this.parentItemId,infoBar:this.infoBar},u=xe(this.parentItemId,this.currentUploadItem.attachment,this.currentUploadItem.attachmentState.attachmentId.Id,this.currentUploadItem.file,this.currentUploadItem.attachmentState,c,this.currentUploadItem.shouldShareInfo),s=u.createAttachmentPromise,d=u.cancelCreateAttachment;this.currentUploadItem.cancelPendingUpload=d,s.then((function(e){if(e){var n=Object(f.__assign)(Object(f.__assign)({},e.AttachmentId),{mailboxInfo:t.parentItemId.mailboxInfo});nt(o,t.parentItemId,n,e),nt(t.onAnyAttachmentCreatedInParentItemCallback,t.parentItemId,n,e)}t.processNextAttachment("CreateAttachmentFinish")})).catch((function(e){var n=0;e&&"ErrorNonExistentMailbox"===e.errorCode&&(n=1),t.uploadFailures.push({item:t.currentUploadItem,reason:n}),t.currentUploadItem.onAttachmentCanceledOrFailedCallback&&t.currentUploadItem.onAttachmentCanceledOrFailedCallback(!1),t.logCreationFailure(),t.processNextAttachment("CreateAttachmentFinish")}))}else this.finishProcess()},e.prototype.finishProcess=function(){v.d.info("Attachment: AttachmentQueueManager: finishProcess"),this.isInProgress=!1;var e=this.currentUploadItem&&this.currentUploadItem.attachmentState?this.currentUploadItem.attachmentState.attachmentId:null;this.currentUploadItem=null,this.onFinish(e),this.datapoint.end(),this.datapoint=null,et(this.uploadFailures,this.infoBar),this.uploadFailures=[]},e.prototype.logCreationFailure=function(){Object(u.o)("AttachmentCreationFailure")},e.prototype.logDeletionFailure=function(e,t){Object(u.o)("AttachmentDeletionFailure",[e],{cosmosOnlyData:JSON.stringify({attachmentId:t.attachmentId.Id})})},e}();function nt(e,t,n,r){e&&e(t,n,r)}n.d(t,"a",(function(){return at})),n.d(t,"b",(function(){return it}));var rt={};function at(e,t,n,i,o,s,l,f,h){if(void 0===o&&(o={isInline:!1,isHiddenInline:!1,shouldShare:!1,skipProcessInlineImage:!1}),!t)return Object(c.a)(i),Object(Qe.a)(i,"WarningFilesCanNotBeAttachedGenericError",[Object(a.a)(r.a)]),[];var m=ot(e,t,i,s);return function(e,t,n){for(var r=0;r<e.length;r++){var a=e[r];Object(u.o)("AttachmentCreation",[t,n],{cosmosOnlyData:JSON.stringify({fileType:a.fileType,size:a.size,ext:Object(d.d)(a.name)||""})})}}(n,o.isInline,o.shouldShare),m.enqueueAttachmentCreation(n,o,l,f,h)}function it(e,t,n,r,a){var i=ot(e,n,r);!function(e){var t=e.attachmentType;switch(t){case 1:Object(u.o)("AttachmentDeletion",[!0,!1,0]);break;case 0:var n=Object(l.a)(e.attachmentId);Object(u.o)("AttachmentDeletion",[!1,e.isCloudy],{cosmosOnlyData:JSON.stringify({size:n.model.Size})});break;default:Object(s.a)(t)}}(t),i.deleteAttachment(t,a)}function ot(e,t,n,r){var a=rt[t.Id];return a||(a=function(e,t,n,r,a){return void 0===r&&(r=null),void 0===a&&(a=null),new tt(e,t,n,r,a)}(e,t,n,i.a,o.a),rt[t.Id]=a,a.onFinishPromise.then((function(e){delete rt[t.Id],r&&r(e)}))),a}},4848:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(73),a=new r.c((function(){return Promise.all([n.e(12),n.e(76),n.e(603),n.e(7),n.e(126)]).then(n.bind(null,7125))})),i=new r.a(a,(function(e){return e.prefetchAllWacResources})),o=new r.a(a,(function(e){return e.prefetchWacResourcesForAttachments})),c=new r.a(a,(function(e){return e.prefetchWacResourcesForFiles}))},4989:function(e,t,n){var r=n(4990),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4990:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,"._2YqHaNr7AxdT45Zi8VE4lo,._7WS-6bgq7Wp3KBLcn-lEO{width:32px;height:32px;display:inline-block}html[dir] ._2YqHaNr7AxdT45Zi8VE4lo,html[dir] ._7WS-6bgq7Wp3KBLcn-lEO{background-color:transparent}._2YqHaNr7AxdT45Zi8VE4lo{width:16px;height:16px}html[dir] .JfNle5WjFhEs0bokdMeaU{margin:10px 10px 10px 10px}",""]),t.locals={extraSmallIcon:"_2YqHaNr7AxdT45Zi8VE4lo",icon:"_7WS-6bgq7Wp3KBLcn-lEO",iconDefault:"JfNle5WjFhEs0bokdMeaU"}},5003:function(e,t,n){"use strict";function r(e,t){var n,r=null===(n=null==e?void 0:e.AttachmentId)||void 0===n?void 0:n.RootItemId;return r&&t&&r===t.Id}n.d(t,"a",(function(){return r}))},5004:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("updateChangeKeyOnItemId")((function(e,t){e.ChangeKey=t}))},5006:function(e){e.exports=JSON.parse('{"a":"sfa"}')},5048:function(e){e.exports=JSON.parse('{"a":"gla"}')},5049:function(e){e.exports=JSON.parse('{"a":"fla"}')},5050:function(e){e.exports=JSON.parse('{"a":"dla"}')},5051:function(e){e.exports=JSON.parse('{"a":"K9a","b":"L9a"}')},5053:function(e,t,n){"use strict";var r=n(0),a=n(3613),i=n(2056),o=n(2734),c=n(93),u=n(1143);t.a=Object(c.action)("addAttachmentIntoWellBeforeUpload")((function(e,t,n,c,s){var l;void 0===s&&(s=null),n.AttachmentId=c,Object(i.a)([{attachmentId:Object(r.__assign)(Object(r.__assign)({},n.AttachmentId),{mailboxInfo:c.mailboxInfo}),attachment:n,modelInitializationValues:s}],!1,!0,!0),Object(u.s)(e)?(t.inlineAttachments.push(e),l=!0):(e.isPlaceholderAttachment=!0,Object(o.a)(n)?t.imageViewAttachments.push(e):t.docViewAttachments.push(e)),!l&&e.isCloudy||Object(a.a)(t,n.Size,n.AttachmentId)}))},5054:function(e,t,n){"use strict";var r=n(1173),a=n(876),i=n(3121),o=n(37),c=n(18),u=n(93);t.a=Object(u.action)("setAttachmentPermissionLevel")((function(e,t,n,u){var s=Object(a.a)(e),l=s.model;l.PermissionType=t,n&&(l.AttachLongPathName=n,s.openUrl=Object(i.a)(l,Object(c.a)())),Object(o.f)("doc-attachment-referenceAttachmentExpiration")&&s.info&&s.info.sharingInfo&&(s.info.sharingInfo.expirationDate=u),Object(r.a)(e)}))},5056:function(e,t,n){"use strict";var r=n(0),a=n(876),i=n(883),o=n(2824),c=n(1128),u=n(1484),s=n(93);t.a=Object(s.action)("refreshThumbnailImageUrl")((function(e,t,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(s=Object(a.a)(e),!Object(c.b)(s.model))return[3,7];switch(s.model.ProviderType){case i.f:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(s.model)];case 2:return l=r.sent(),s.thumbnailImage.url=l,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:l=Object(u.a)(e,s.model,2,Object(c.b)(s.model),t,n),s.thumbnailImage.url=l,r.label=8;case 8:return[2]}}))}))}))},5076:function(e){e.exports=JSON.parse('{"a":"NCb"}')},5489:function(e){e.exports=JSON.parse('{"a":"Fga"}')},5490:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(240),i=n(6151),o=n.n(i),c=n(3845),u=n.n(c),s=n(155);function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,c;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return n=function(e){return o()({ClientSupportsIrm:!0,AttachmentIds:[e]})}(e),[4,Object(a.e)(e.mailboxInfo)];case 1:return i=l.sent()||{},c=Object(r.__assign)(Object(r.__assign)({},i),t||{}),[4,u()({Header:Object(s.getJsonRequestHeader)(),Body:n},c)];case 2:return[2,l.sent().Body]}}))}))}},5491:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4399);function a(e){if(!e)return e;var t=e.toLowerCase().charCodeAt(0);if(t>=97&&t<=122&&-1===e.indexOf("#")&&-1===e.indexOf("-"))try{return atob(e)}catch(e){}for(var n="",a=0,i=function(){var t=e.charAt(a++);switch(t){case"\r":case"\n":return i();default:return t}};a<e.length;){var o=r.a.indexOf(i()),c=r.a.indexOf(i()),u=r.a.indexOf(i()),s=r.a.indexOf(i()),l=o<<2|c>>4,d=(15&c)<<4|u>>2,f=(3&u)<<6|s;n+=String.fromCharCode(l),64!=u&&(n+=String.fromCharCode(d)),64!=s&&(n+=String.fromCharCode(f))}return n}},5521:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(78);function a(e,t){var n=e.docViewAttachments.filter((function(e){return Object(r.f)(e.attachmentId,t)}));return 0===n.length&&(n=e.imageViewAttachments.filter((function(e){return Object(r.f)(e.attachmentId,t)}))),0===n.length?null:n[0]}},5522:function(e){e.exports=JSON.parse('{"a":"Dea"}')},5534:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},5535:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n(6969),a=n(1745),i=n(2593),o={},c=null;function u(e,t){o[e.attachmentId.Id]&&(clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(r.a)(e,!0),t&&!Object(i.a)(e)&&Object(a.a)(e,!0)}function s(e,t){o[e.attachmentId.Id]&&clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=setTimeout((function(){Object(r.a)(e,!1),t&&!Object(i.a)(e)&&Object(a.a)(e,!1),e.attachmentId.Id===c&&(c=null),o[e.attachmentId.Id]=null}),40)}function l(e,t){Object(r.a)(e,!0),t&&!Object(i.a)(e)&&Object(a.a)(e,!0)}function d(e,t){e.attachmentId.Id!==c&&(Object(r.a)(e,!1),t&&!Object(i.a)(e)&&Object(a.a)(e,!1))}},5557:function(e){e.exports=JSON.parse('{"a":"tDb"}')},5641:function(e,t,n){"use strict";var r=n(25),a=n(486),i=n(42),o=n(992),c=n(44),u=n(1),s=n(3416),l=n(5535),d=n(221),f=n(8),h=n(5076),m=n(4706),b=n(8236);var p=n(1143),v=n(6970),g=n(78),O=n(37),I=n(208),w=n(2939),S=n(6971);function j(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case s.a.addToCalendar:return!1;case s.a.download:return!Object(w.a)(p.a.Download,t)||!Object(v.a)(t);case s.a.saveToCloud:case s.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n,r=Object(I.a)()&&(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type)===g.a.GroupMailbox,a=!1;a=t===s.a.openNewTabAndSaveToCloud?Object(O.f)("woven-newTabExperiment")&&Object(S.a)(e.attachmentId):Object(O.f)("woven-saveToCloud-noHoverWithCloud")||Object(O.f)("woven-saveToCloud-hoverWithCloud")||Object(O.f)("woven-saveToCloud2-surfaceActionOnly")||Object(O.f)("woven-saveToCloud2-viewInOneDrive")||Object(O.f)("woven-saveToCloud2-editInOneDrive")||Object(O.f)("woven-saveToCloud2-editInApp")||Object(O.f)("woven-saveToCloud2-editOnline")||Object(O.f)("woven-saveToCloud2-openFolder")||Object(O.f)("woven-newTabExperiment");return a&&Object(w.a)(p.a.SaveToCloud,e)&&Object(p.t)(e)&&!r}(t,e);case s.a.editAndReply:return!t.isReadOnly||!Object(S.a)(t.attachmentId);default:return Object(d.a)(e)}}var y=n(0),_=n(193),C=n(6372),A=n(6972),x=n(914),T=n(876),E=n(2501),P=n(3073),D=n(1915),k=n(452),R=n(1648),F=n(478),N=n(32),M="/"+Object(y.__spread)(["mail"],Object(F.a)().split("/").slice(1)).join("/")+"deeplink/saveAndEdit/";function L(e,t,n){switch(e){case s.a.addToCalendar:Object(A.a)(t,C.a.SurfaceAction);break;case s.a.download:!function(e,t){var n,r;Object(y.__awaiter)(this,void 0,void 0,(function(){var a;return Object(y.__generator)(this,(function(i){switch(i.label){case 0:return(a=Object(T.a)(e.attachmentId))?(Object(_.o)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:a.model.Size,fileType:Object(E.a)(a),attachmentId:null===(n=a.model.AttachmentId)||void 0===n?void 0:n.Id})}),Object(O.f)("doc-attachment-sigs")&&_.l.importAndExecute("AttachmentSaved",{itemId:null==t?void 0:t.Id,customProperties:{FileId:null===(r=a.model.AttachmentId)||void 0===r?void 0:r.Id,Destination:"Local"}}),Object(x.e)(a.model)?[4,R.e.import()]:[3,2]):(c.d.error("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return i.sent()(a.model),[3,3];case 2:Object(D.a)(a.download.url,e.isCloudy,document.body),i.label=3;case 3:return[2]}}))}))}(t,n);break;case s.a.saveToCloud:!function(e,t){var n,r=Object(T.a)(e.attachmentId);if(!r)return void c.d.error("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(_.o)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:Object(E.a)(r),attachmentId:null===(n=r.model.AttachmentId)||void 0===n?void 0:n.Id}),isCore:!0}),Object(p.B)(Object(p.p)(e.attachmentId),.1,(function(t){Object(p.x)(e,t)}),e.attachmentId),Object(p.u)(e,(function(t){Object(p.C)(e.attachmentId,t)}),"SurfaceAction",t)}(t,n);break;case s.a.editAndReply:!function(e,t){Object(y.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(y.__generator)(this,(function(a){switch(a.label){case 0:return[4,P.d.import()];case 1:return n=a.sent(),Object(_.o)("WovenEditAndReplyFromSurface",{},{isCore:!0}),r={viewState:e,previewPaneSelectionSource:o.c.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:function(){return null},createImageGallery:function(){return null},instrumentationContext:null},n(r),[2]}}))}))}(t,n);break;case s.a.openNewTabAndSaveToCloud:!function(e,t){Object(y.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(y.__generator)(this,(function(a){return n=Object(k.a)(),function(e,t,n){var r=""+M;r+=encodeURIComponent(null==n?void 0:n.Id)+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+"/"+Object(N.a)().search,window.open(r,"_blank")}(e.attachmentId.Id,n,t),r=new _.a("WovenNewTabSaveToCloud",{isCore:!0}),Object(p.B)(4*Object(p.p)(e.attachmentId),.1,(function(t){Object(p.x)(e,t)}),e.attachmentId),Object(p.D)(e,(function(t){Object(p.C)(e.attachmentId,t),t?r.end():r.endWithError("ServerError")}),"PencilExperiment",t,n),[2]}))}))}(t,n);break;default:Object(d.a)(e)}}var B=n(8237),V=n(218).bind(B);t.a=Object(r.a)((function(e){var t=e.action,n=e.attachmentViewState,r=e.customClassName,p=e.isForImageView,v=e.previewState;if(j(t,n))return null;var g=void 0,O=function(e){switch(e){case o.a.Edit:return B.edit;case o.a.NotSelectedAndSaving:return B.notSelectedAndSaving;case o.a.OtherSaving:return B.attachmentView;case o.a.Selected:return B.selected;case o.a.SelectedAndPending:return B.selectedAndPending;case o.a.SelectedAndSaving:return B.selectedAndSaving;default:return B.default}}(v);if(p){var I={extraRightPadding:U(t,n)};g=V([B.actionButton,B.actionButtonForImageView,r,I])}else g=n.isReadOnly?V([B.actionButton,O,r]):V([B.actionButton,O,B.actionButtonForDocViewInCompose,r]);var w=function(e){switch(e){case s.a.addToCalendar:return"AddEvent";case s.a.download:return"Download";case s.a.saveToCloud:return"CloudUpload";case s.a.openNewTabAndSaveToCloud:return"Edit";case s.a.editAndReply:return"PencilReply";default:return Object(d.a)(e)}}(t),S=function(e){switch(e){case s.a.addToCalendar:return Object(f.a)(h.a);case s.a.download:return Object(f.a)(m.a);case s.a.saveToCloud:return Object(f.a)(b.c);case s.a.openNewTabAndSaveToCloud:return Object(f.a)(b.b);case s.a.editAndReply:return Object(f.a)(b.a);default:return Object(d.a)(e)}}(t);return u.createElement(a.a,{onFocus:function(){return Object(l.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){e.shouldNotHandleOnBlur||Object(l.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(t){t.keyCode!==i.a.enter&&t.keyCode!==i.a.space||(c.d.info("AttachmentSurfaceActionButton.keyDown enter|space"),t.stopPropagation(),L(e.action,e.attachmentViewState,e.parentItemId))},ariaLabel:S,title:S,onClick:function(t){c.d.info("AttachmentSurfaceActionButton.onclick"),t.stopPropagation(),L(e.action,e.attachmentViewState,e.parentItemId)},className:g,iconProps:{iconName:w,styles:{root:B.icon}}})}));function U(e,t){return(e===s.a.saveToCloud||e===s.a.editAndReply||e===s.a.openNewTabAndSaveToCloud)&&!j(s.a.download,t)}},5657:function(e,t,n){"use strict";var r=n(8),a=n(25),i=n(1449),o=n(1),c=n(4989),u=n(218).bind(c),s=Object(a.a)((function(e){var t,n=e.contentType,a=e.customizeStyle,s=e.embeddedItemClass,l=e.fileName,d=e.iconSize,f=e.isBlocked,h=e.isCloudy,m=e.isFolder;if(e.useCloudIcon&&h)return o.createElement(i.a,{fileName:l,contentType:n,isBlocked:f,isFolder:m,embeddedItemClass:null});var b=0===d;return t=b?Object(i.d)(l,n,f,m,s).extraSmall:Object(i.d)(l,n,f,m,s).medium,o.createElement("div",{className:u(b?c.extraSmallIcon:c.icon,Object(r.f)(a)?c.iconDefault:a,t)})})),l=n(6117),d=n(218).bind(l),f=Object(a.a)((function(e){var t=e.firstLineTitle,n=e.firstLineText,r=e.secondLineTitle,a=e.secondLineText,i=e.highlightAttachmentName;return e.isShortDocView?o.createElement("div",{className:d(l.firstLineCommonStyle,e.firstLineStyle,l.textOverFlow),title:t,ref:i},n):o.createElement(o.Fragment,null,o.createElement("div",{className:d(l.firstLineCommonStyle,e.firstLineStyle,l.textOverFlow),title:t},n),o.createElement("div",{title:r,className:d(l.secondLineCommonStyle,e.secondLineStyle,l.textOverFlow)},a))}));n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return f}))},5675:function(e,t,n){"use strict";var r=n(0),a=n(93),i=n(5),o=n(5054),c=n(4699),u=n.n(c),s=n(6280),l=n.n(s);function d(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var a=function(e,t,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),u()({AttachmentIds:e,PermissionLevel:t,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(e,t,n,r);return l()({request:a})}t.a=Object(a.action)("changeAttachmentPermission")((function(e,t,n,a){return void 0===n&&(n=null),void 0===a&&(a=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,d(e.map((function(e){return e.Id})),t,n,a)];case 1:if(!(c=r.sent()).OperationSucceeded||!c.NewAttachLongPathNames||c.NewAttachLongPathNames.length!==e.length)throw new Error("Error setting attachment permissions");return e.forEach((function(e,n){var r,a=null;(null===(r=c.ExpirationDates)||void 0===r?void 0:r[n])&&(a=Object(i.lc)(c.ExpirationDates[n])),Object(o.a)(e,t,c.NewAttachLongPathNames[n],a)})),[2]}}))}))}))},6117:function(e,t,n){var r=n(6118),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6118:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._2X2yCI1apLbzgmii0Q6oCO{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._1yE-UJD1Vuoih6tE1JwSeO{color:"[theme:neutralPrimary, default:#333333]"}._1bH5SwDCDD5umcFQjNgXyX{color:"[theme:neutralSecondary, default:#666666]"}',""]),t.locals={textOverFlow:"_2X2yCI1apLbzgmii0Q6oCO",firstLineCommonStyle:"_1yE-UJD1Vuoih6tE1JwSeO",secondLineCommonStyle:"_1bH5SwDCDD5umcFQjNgXyX"}},6273:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(6274),a=n(1206),i=n(8),o=n(3309),c=n(965),u=n(857);function s(e,t,n,r){var i=[],o=[];if(e.forEach((function(e){n(e)?i.push(e):o.push(e)})),o.length>0){var c=r(o.map((function(e){return e.name})).join(", ")),u=c.messageId,s=c.message;Object(a.a)(t,u,[s])}return i}function l(e,t,n){Object(o.a)(n);for(var a=[],l=0;l<e.length;l++)a.push(e[l]);return a=function(e,t){return s(e,t,(function(e){return!(e.fileType===c.a.Local&&0===e.size)}),(function(e){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(i.b)(Object(i.a)(r.a),e)}}))}(a,n),t&&(a=function(e,t){return s(e,t,(function(e){return Object(u.f)(e.name,e.type)}),(function(e){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(i.b)(Object(i.a)(r.b),e)}}))}(a,n)),a}},6274:function(e){e.exports=JSON.parse('{"a":"vfa","b":"wfa"}')},6275:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6276),a=n(8),i=n(44),o=n(2797),c=n(4425),u=n(1206);function s(e,t,n){for(var s=0,l=0,d=void 0;d=e[l];l++)s+=d.size;var f=Object(c.a)(n);if(s>f){var h=Math.floor(f/o.b),m=void 0,b=void 0;return e.length>1?(b="ErrorTooLargeForLocalAttachmentMultiple",m=Object(a.b)(Object(a.a)(r.a),h)):(b="ErrorTooLargeForLocalAttachmentSingle",m=Object(a.b)(Object(a.a)(r.b),h)),Object(u.a)(t,b,[m]),!0}return i.d.info("Attachment: TotalSize = "+Math.floor(n.totalClassicAttachmentSize/1048576)),!1}},6276:function(e){e.exports=JSON.parse('{"a":"tfa","b":"ufa"}')},6281:function(e){e.exports=JSON.parse('{"a":"p_a"}')},6372:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},6416:function(e){e.exports=JSON.parse('{"a":"mDb"}')},6589:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(25),i=n(599),o=n(193),c=n(914),u=n(876),s=n(1915),l=n(983),d=n(962),f=n(8),h=n(36),m=n(44),b=n(456),p=n(1),v=n(11923),g=n(867),O=n(93),I=Object(O.action)("setAllowShowMultipleRows")((function(e,t){e.allowShowMultipleRows=t})),w=Object(O.action)("setCanOverrideAllowShowMultipleRows")((function(e,t){e.canOverrideAllowShowMultipleRows=t})),S=n(11924),j=n(8233),y=n(857);function _(e,t,n){var r=e.docViewAttachments.length+e.imageViewAttachments.length,a=e.totalClassicAttachmentSize,i=t&&!n;if(a>0){var o=i?Object(f.a)(S.c):Object(f.a)(S.a),c=Object(y.h)(a);return Object(f.b)(o,r,c)}o=i?Object(f.a)(S.b):Object(f.a)(j.a);return Object(f.b)(o,r)}var C=n(78);function A(e,t){return e.some((function(e){return Object(C.f)(e.attachmentId,t)}))}function x(e,t){return e.canOverrideAllowShowMultipleRows?e.allowShowMultipleRows||function(e,t){return!!t&&(A(e.docViewAttachments,t)||A(e.imageViewAttachments,t))}(e,t):e.allowShowMultipleRows}var T=n(11925),E=n(8234),P=n(410),D=Object(a.a)((function(e){var t,n,a=e.attachmentWellViewState.didViewOverflowOneRow,o=x(e.attachmentWellViewState,e.attachmentIdBeingPreviewed),c=_(e.attachmentWellViewState,a,o),u={iconProps:{}};return a?(o?(u.onClick=function(t){I(e.attachmentWellViewState,!1),w(e.attachmentWellViewState,!1)},u.iconProps.iconName="DoubleChevronUp",n={role:g.a.button,expanded:!0}):(u.onClick=function(t){I(e.attachmentWellViewState,!0)},u.iconProps.iconName="DoubleChevronDown",n={role:g.a.button,expanded:!1}),u.disabled=!1,t=P(E.barButton,E.barButtonHover)):(u.disabled=!0,t=E.barButton),p.createElement("span",null,p.createElement(i.a,Object(r.__assign)({},Object(g.b)(n),{className:t,disabled:u.disabled,iconProps:{iconName:u.iconProps.iconName,styles:{root:T.chevronButton}},onClick:u.onClick}),c))})),k=n(11928),R=n(3829),F=n(11929),N=n(6968),M=n(4705),L=n(8228),B=n(221),V=n(919),U=n(3435),W=n(208),H=n(70);function z(e,t,n){var r=Object(f.a)(N.a);switch(n){case 1:return Object(W.a)()?Object(f.b)(Object(f.a)(F.g),Object(V.f)(),r):t?Object(f.a)(F.f):Object(f.b)(Object(f.a)(F.h),Object(f.a)(M.a));case 3:return t?Object(f.a)(F.b):Object(f.b)(Object(f.a)(F.c),Object(W.a)()?r:Object(f.a)(M.a));case 2:if(t)return Object(f.a)(F.d);var a=function(e){var t=Object(U.c)(e);return t?t.folderName:(Object(U.b)(e),null)}(e);return Object(H.b)(a)&&(a=Object(f.a)(L.a)),Object(f.b)(Object(f.a)(F.e),a);case 4:return Object(f.a)(F.a);case 0:throw new Error("Unsupported SaveAllToCloudStatus: "+n);default:return Object(B.a)(n),""}}var q=n(1143),G=n(2748);function J(e,t){return Q(e.docViewAttachments,t)||Q(e.imageViewAttachments,t)}function Q(e,t){return Object(r.__read)(e.filter((function(e){return Object(C.f)(e.attachmentId,t)})),1)[0]}var X=n(8119);function Y(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,new Promise((function(r,a){var i=[],c={operationFailed:!1,error:void 0},u=new o.a("AttachmentSaveAllToCloud");!function(e,t){var n=e.totalClassicAttachmentSize/256;K(e.docViewAttachments,t,n),K(e.imageViewAttachments,t,n)}(e,i);var s=Object(X.b)(i,c,u,e.totalClassicAttachmentSize,(function(t){return J(e,t)}),n,q.C),l=Object(X.a)(i,u,e.totalClassicAttachmentSize,(function(t){return J(e,t)}),n,q.C);Object(G.b)(null,t,s,l,(function(e,t,n){r([e,t,n,i])}))}))]}))}))}function K(e,t,n){e.forEach((function(e){t.push(e.attachmentId),Object(q.w)(e),Object(q.B)(n,.1,(function(t){Object(q.x)(e,t)}),e.attachmentId)}))}var Z=Object(O.action)("setSaveAllToCloudStatus")((function(e,t){e.saveAllToCloudStatus=t})),$=n(11930),ee=n.n($);var te=n(972),ne=n(8234),re=n(410),ae=Object(a.a)((function(e){var t,n,a=this,c=p.useRef(),u=p.useRef(),s=p.useRef(),l=p.useRef(),d=function(t){Z(e.attachmentWellViewState,t?3:2)},h=e.attachmentWellViewState.imageViewAttachments.concat(e.attachmentWellViewState.docViewAttachments),m=h.length>1,b=h.every(q.t)&&m,v=re(ne.barButton,ne.barButtonHover);return p.createElement("span",null,function(t){var n;return!!t&&(0==e.attachmentWellViewState.saveAllToCloudStatus&&((null===(n=e.parentItemId.mailboxInfo)||void 0===n?void 0:n.type)!=C.a.GroupMailbox||!Object(W.a)()))}(b)&&p.createElement(i.a,{className:v,onClick:function(t){return Object(r.__awaiter)(a,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Z(e.attachmentWellViewState,1),Object(o.o)("AttachmentWellSaveAllToCloud",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize]),[4,Y(e.attachmentWellViewState,e.parentItemId,d)];case 1:return t=r.__read.apply(void 0,[n.sent(),4]),c.current=t[0],u.current=t[1],s.current=t[2],l.current=t[3],[2]}}))}))}},function(){var t,n=(null===(t=e.parentItemId.mailboxInfo)||void 0===t?void 0:t.type)===C.a.GroupMailbox;if(Object(W.a)())return Object(f.a)(k.b);if(n)return Object(f.a)(k.a);var r=Object(f.a)(k.c);return Object(f.b)(r,Object(V.f)())}()),(1===(n=e.attachmentWellViewState.saveAllToCloudStatus)||3===n||2===n||4===n)&&p.createElement(i.a,{className:v,disabled:!0},z(e.parentItemId.mailboxInfo.mailboxSmtpAddress,(null===(t=e.parentItemId.mailboxInfo)||void 0===t?void 0:t.type)===C.a.GroupMailbox,e.attachmentWellViewState.saveAllToCloudStatus)),1===e.attachmentWellViewState.saveAllToCloudStatus&&p.createElement(i.a,{className:v,onClick:function(t){var n,r;(n=e.parentItemId.Id,r=e.parentItemId.mailboxInfo.requestOptions,ee()({itemId:n},r)).then((function(t){t&&(te.h.importAndExecute(u.current,s.current),Object(G.a)(c.current),l.current.forEach((function(t){var n=J(e.attachmentWellViewState,t);Object(q.A)(n,0,5),Object(q.C)(t,!1)})),Z(e.attachmentWellViewState,4))})),Object(o.o)("AttachmentWellCancelSaveAllToCloud",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize])}},Object(f.a)(R.a)))}));var ie=n(8234),oe=n(218).bind(ie),ce=Object(a.a)((function(e){var t=p.useRef(),n=p.useRef(),r=p.useRef(),a=function(a){for(var i,o=0;o<a.length;o++){i=a[o];var c=Object(u.a)(i.attachmentId);if(c&&c.info&&c.info.allowDownload||(r.current=!1,c||e.isDraft||m.d.error("The model for attachment "+i.attachmentId.Id+" could not be found")),!r.current)break;i.isCloudy?t.current++:n.current++}},g=e.attachmentWellViewState.imageViewAttachments.length+e.attachmentWellViewState.docViewAttachments.length>1;t.current=0,n.current=0,r.current=!0;var O=e.attachmentWellViewState.docViewAttachments.some((function(e){var t=Object(u.a)(e.attachmentId);return t&&Object(c.e)(t.model)}));a(e.attachmentWellViewState.imageViewAttachments),a(e.attachmentWellViewState.docViewAttachments);var I=r.current&&n.current>1&&0===t.current&&!O;return p.createElement("span",{className:ie.attachmentWellBar},g&&p.createElement(D,{attachmentWellViewState:e.attachmentWellViewState,attachmentIdBeingPreviewed:e.attachmentIdBeingPreviewed}),I&&p.createElement(i.a,{className:oe(ie.barButton,ie.barButtonHover),onClick:function(t){var n="service.svc/s/GetAllAttachmentsAsZip?id="+encodeURIComponent(e.parentItemId.Id),r=(null===window||void 0===window?void 0:window.location)?window.location.pathname:null,a=Object(l.d)()?Object(d.c)()+"/":"",i=Object(b.r)("/owa/",r)+"/"+a+n+"&X-OWA-CANARY="+Object(h.getOwaCanaryCookie)();Object(s.a)(i,!1),Object(o.o)("AttachmentWellDownloadAll",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize])}},Object(f.a)(v.a)),!O&&p.createElement(ae,{attachmentWellViewState:e.attachmentWellViewState,parentItemId:e.parentItemId}))}));var ue=n(8235),se=n(4767),le=Object(O.action)("setDidViewOverflowOneRow")((function(e,t){e.didViewOverflowOneRow=t})),de=n(4693),fe=n(7169),he=n(8746),me=n(952),be=n(1267),pe=n(6614),ve=n(992),ge=n(969),Oe=n(1428),Ie=n(1174),we=n(1067),Se=n(37),je=500;function ye(e,t,n,r,a){var i;if(we.a.pendingNavigation&&Object(C.f)(we.a.pendingNavigation.toAttachmentId,e)&&we.a.pendingNavigation.triggerTime+je>=(new Date).getTime())return Oe.a.PendingNavigation;if(!Object(ge.a)())return Oe.a.None;var c=we.a.extendedViewState.attachmentId,s=null===(i=we.a.pendingPreviewOperation)||void 0===i?void 0:i.attachmentId;return Object(C.f)(c,e)?we.a.editState.mode===Ie.a.View||we.a.editState.mode===Ie.a.EnteringEdit?function(e,t,n,r,a){var i=Object(u.a)(e);if(i&&1===i.type){if(Object(Se.f)("doc-SxS-jsApi-ODB-BaseNoEditString"))return!1;var c=we.a.viewState.previewPane;return c&&!1===c.readOnly}if(!i){var s=e?e.Id:"UNDEFINED";m.d.error("AttachmentModel not found in getAttachmentPreviewMode"),Object(o.o)("AttchmentModelMissingInRenderAttachmentWell",{attachmentId:s,composeId:t,isInitialized:n,isReadOnly:r,isGroup:a},{isQos:!0})}return!1}(e,t,n,r,a)?Oe.a.Edit:Oe.a.Selected:we.a.editState.mode===Ie.a.Saving?Object(C.f)(s,e)?Oe.a.SelectedAndSaving:Oe.a.NotSelectedAndSaving:Oe.a.Edit:Object(C.f)(s,e)?Oe.a.SelectedAndPending:Oe.a.None}var _e=n(4848),Ce=n(11931),Ae=n(11932),xe=n(218).bind(Ae),Te=Object(a.a)((function(e){var t=this;p.useEffect((function(){var t=(e.attachmentWellViewState.docViewAttachments||[]).map((function(e){return e.attachmentId}));return _e.b.importAndExecute(t),be.a.importAndExecute(m),function(){be.c.importAndExecute(m)}}),[]),p.useEffect((function(){m()}));var n=p.useRef(),a=p.useRef(),i=p.useRef({}),u=function(t){var n=e.attachmentWellViewState,r=e.parentItemId,a=e.infoBar,i=e.onAttachmentDeletedCallback,o=e.isDeletionDisabled,u=n.imageViewAttachments.slice(0),s=n.docViewAttachments.slice(0);if(!o)if(Object(c.d)(t.attachmentId.Id))Object(pe.b)(n,t,r,a,i);else{Object(se.b)(n,t,r,a,(function(e,n,r){i(e,n,r),setTimeout((function(){l(t,u,s)}),0)}))}},s=function(t,n,r,a){Object(fe.a)(e.attachmentWellViewState,t,n,r,a)},l=function(n,a,o){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,c,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=a.indexOf(n),c=o.indexOf(n),t>-1&&a.splice(t,1),c>-1&&o.splice(c,1),u=function(e,t,n,r){return n>-1?0===e.length?t[0]:n<e.length?e[n]:e[n-1]:0===t.length?e[e.length-1]:r<t.length?t[r]:t[r-1]}(a,o,t,c),Object(ve.k)(n.attachmentId)?[4,ve.r.import()]:[3,2];case 1:r.sent()("deleteAttachment"),r.label=2;case 2:return(null===(s=null==u?void 0:u.attachmentId)||void 0===s?void 0:s.Id)&&i.current[u.attachmentId.Id]?i.current[u.attachmentId.Id]():e.onLostFocus&&e.onLostFocus(),[2]}}))}))},d=function(){w(e.attachmentWellViewState,!0)},h=function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,Object(he.a)(e.attachmentWellViewState)]}))}))},m=function(){setTimeout((function(){b(!0)}),1)},b=function(t){var r=!1;if(e.attachmentWellViewState.imageViewAttachments.length>0)if(De(n.current)){if(Pe(n.current))return void le(e.attachmentWellViewState,!0)}else r=!0;if(e.attachmentWellViewState.docViewAttachments.length>0)if(De(a.current)){if(Pe(a.current))return void le(e.attachmentWellViewState,!0);r||le(e.attachmentWellViewState,!1)}else r=!0;r&&(t?(Object(o.o)("AttachmentWellRetryToCheckWhetherViewOverflowOneRow"),setTimeout((function(){b(!1)}),500)):Object(o.o)("AttachmentWellRetryToCheckWhetherViewOverflowOneRowFailed"))},v=function(e,t){i.current[e]=t},O=e.attachmentWellViewState,I={attachmentWellInCompose:!e.attachmentWellViewState.isReadOnly};if(e.attachmentWellViewState.imageViewAttachments.length+e.attachmentWellViewState.docViewAttachments.length===0)return null;var S={allowShowMultipleRows:x(e.attachmentWellViewState,ve.H.extendedViewState.attachmentId)};return p.createElement("div",{tabIndex:-1,className:xe([Ae.attachmentWell,I,"disableTextSelection"]),onClick:Ee},O.imageViewAttachments.length>0?p.createElement("div",{role:g.a.listbox,"aria-label":Object(f.a)(Ce.a),className:xe(Ae.oneRowImageViews,S),ref:function(e){n.current=e}},O.imageViewAttachments.map((function(t){return p.createElement(ue.b,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:u,onReplaceAttachment:s,onDragStart:ke,instrumentationContext:e.instrumentationContext,onBeforePreview:d,isImage:!0,parentItemId:e.parentItemId,isDraft:e.isDraft,previewMode:ye(t.attachmentId,O.composeId,O.isInitialized,O.isReadOnly,!!O.groupId),moveAttachmentToInlineHandler:e.moveAttachmentToInlineHandler,createImageGallery:h,registerFocusFunction:v})}))):null,O.docViewAttachments.length>0?p.createElement("div",{role:g.a.listbox,"aria-label":Object(f.a)(Ce.a),className:xe(Ae.oneRowDocViews,S),ref:function(e){a.current=e}},e.attachmentWellViewState.docViewAttachments.map((function(t){return p.createElement(ue.b,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:u,onReplaceAttachment:s,onDragStart:ke,instrumentationContext:e.instrumentationContext,onBeforePreview:d,isImage:!1,parentItemId:e.parentItemId,isDraft:e.isDraft,previewMode:ye(t.attachmentId,O.composeId,O.isInitialized,O.isReadOnly,!!O.groupId),createImageGallery:h,registerFocusFunction:v,referenceAttachmentsSupported:e.referenceAttachmentsSupported})}))):null,O.isReadOnly&&O.imageViewAttachments.length+O.docViewAttachments.length>0?p.createElement(ce,{attachmentWellViewState:O,parentItemId:e.parentItemId,isDraft:e.isDraft,attachmentIdBeingPreviewed:ve.H.extendedViewState.attachmentId}):null)}));function Ee(e){e.stopPropagation()}function Pe(e){return!!e&&e.children.length>0&&e.scrollHeight>2*e.children[0].clientHeight}function De(e){return!!e&&e.children.length>0}function ke(e){var t=Object(de.a)(e);return{itemType:me.a.Attachment,attachmentFile:t}}var Re="{0}; ";var Fe=n(8045);var Ne=function(e){var t=e.attachmentWellViewState;if(t.imageViewAttachments.length+t.docViewAttachments.length===0)return null;var a,i,o=n(11934);return p.createElement("div",{className:Fe.panel},p.createElement("div",null,p.createElement("img",{src:o,className:Fe.attachIcon}),p.createElement("span",{className:Fe.attachmentCountLabel},_(t,!1,!1))),p.createElement("div",{className:Fe.attachmentCollectionContainer},p.createElement("span",{className:Fe.attachmentCollectionLabel},(a=t,i="",Object(r.__spread)(a.docViewAttachments,a.imageViewAttachments).forEach((function(e){var t=Object(u.a)(e.attachmentId);t&&(i+=Object(f.b)(Re,t.model.Name))})),i))))};n.d(t,"AttachmentWellView",(function(){return Te})),n.d(t,"AttachmentWellPrintView",(function(){return Ne}))},6607:function(e,t,n){"use strict";n.r(t);var r=n(25),a=n(5657),i=n(876),o=n(1),c=Object(r.a)((function(e){var t=Object(i.a)(e.attachmentId),n=1===t.type,r=!!n&&t.model.AttachmentIsFolder,c=null;return n||2!==t.type||(c=t.model.EmbeddedItemClass||"IPM.Note"),o.createElement(a.b,{contentType:t.model.ContentType,customizeStyle:e.className,embeddedItemClass:c,fileName:t.model.Name,iconSize:e.iconSize,isBlocked:1===t.attachmentClass,isCloudy:n,isFolder:r,useCloudIcon:e.useCloudIcon})})),u=n(6663),s=Object(r.a)((function(e){var t=Object(u.a)(e.attachmentViewState,e.attachment),n=Object(u.b)(e.attachmentViewState,e.attachment);return o.createElement(a.a,{firstLineStyle:e.firstLineStyle,firstLineText:e.attachment.model.Name,firstLineTitle:t,highlightAttachmentName:e.highlightAttachmentName,isShortDocView:e.isShortDocView,secondLineStyle:e.secondLineStyle,secondLineText:n.text,secondLineTitle:n.title?n.title:t})})),l=n(0),d=n(261),f=n(56),h=n(919),m=n(5056),b=n(8),p=n(11352),v=n(44),g=[],O=5,I=0,w=5e3,S=null,j=0,y=0;function _(){(j++,0===g.length)?(I>0&&I--,A("Queue is empty.")):(g.shift()(!1),A("Display next."))}function C(){g.length>0?j===y?(I=0,A("Watch dog is processing the queue."),_()):(A("Watch dog is watching."),y=j):(window.clearInterval(S),S=null,A("Stop watch dog."))}function A(e){v.d.info("Attachment:throttleThumbnails:active="+I+";throttled="+g.length+";processed="+j+";lastProcessed="+y+";info="+e)}var x=n(410),T=n(11353),E=Object(r.a)((function(e){var t=this;o.useEffect((function(){return function(e){if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");I<O?(e(!1),I++,j++,A("Display now.")):(e(!0),g.push(e),A("Pushs to queue."),S||(S=window.setInterval(C,w),A("Start watch dog.")))}(v),function(){var e,t;u&&(e=v,t=g.indexOf(e),g.splice(t,1),I=0,A("unregisterComponent:"+t))}}),[]),o.useEffect((function(){var n=e.attachmentViewState,r=n.attachmentId,o=n.isReadOnly;n.isPlaceholderAttachment||Object(l.__awaiter)(t,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(m.a)(r,o)];case 1:return t.sent(),e=Object(i.a)(r).thumbnailImage.url,a(e),[2]}}))}))}),[]),o.useEffect((function(){a(e.thumbnailUrl)}),[e.thumbnailUrl]);var n=Object(l.__read)(o.useState(e.thumbnailUrl),2),r=n[0],a=n[1],c=Object(l.__read)(o.useState(!0),2),u=c[0],s=c[1],v=function(e){s(e)},y=e.attachmentViewState.thumbnailLoadState,E=e.imageLoadErrorCSSClass?e.imageLoadErrorCSSClass:e.placeHolderCSSClass,P=e.fileIconCssClass?e.imageLoadErrorCSSClass:e.placeHolderCSSClass;return o.createElement("span",{className:T.spanContainer},(u||0===y)&&o.createElement("div",{className:T.notLoadedContainer,style:{height:e.thumbnailHeight,width:e.thumbnailWidth}},o.createElement("span",{className:P})),2===y&&o.createElement("div",{className:T.errorLoadingContainer,style:{height:e.thumbnailHeight,width:e.thumbnailWidth}},o.createElement("span",{className:E})),2!==y&&o.createElement(d.a,{src:u?"":r,onError:function(t){u||(_(),Object(h.h)(e.attachmentViewState,2),e.onImageLoadError&&e.onImageLoadError())},onLoad:function(t){u||(_(),Object(h.h)(e.attachmentViewState,1))},width:e.thumbnailWidth,height:e.thumbnailHeight,className:e.customThumbnailCssClass?e.customThumbnailCssClass:T.thumbnail,imageFit:e.fileIconCssClass?f.b.contain:f.b.cover,alt:Object(b.a)(p.a)}),1===y&&e.fileIconCssClass&&o.createElement("span",{style:e.customFileIconCssClass?null:{position:"absolute",top:5-e.thumbnailHeight,left:5},className:x(e.fileIconCssClass,e.customFileIconCssClass)}))}));n.d(t,"AttachmentIconView",(function(){return c})),n.d(t,"AttachmentDocInfoView",(function(){return s})),n.d(t,"AttachmentThumbnailView",(function(){return E}))},6614:function(e,t,n){"use strict";var r=n(5522),a=n(8),i=n(1206),o=n(3309),c=n(44),u=n(0),s=function(e){if(!e)return e;if(0===e.indexOf("data:")){var t=e.indexOf(";base64,");return e.substr(t+";base64,".length)}return e},l=n(193),d=n(6929),f=n(5003),h=n(876),m=n(3410),b=n(5491),p=n(5006),v=n(6930),g=n.n(v),O=n(8112),I=n.n(O),w=n(2006),S=n(6928),j=n(3929),y=n(78),_=n(1410),C=function(e,t){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var n,r,a,i;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:n=new l.a("FetchAttachmentContent",{isCore:!0}),r=Object(_.a)(Object(y.d)(),e,0),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Object(S.a)(r+(t?"&asDataUri=true":""))];case 2:return a=o.sent(),n.end(),[2,a];case 3:throw i=o.sent(),c.d.error("SmimeTraceError: FetchAttachmentContent failed. URL: "+r),n.endWithError("ServerError",i),new j.a(i.message,11);case 4:return[2]}}))}))},A=n(8113),x=n(1143),T=n(914),E=n(883);var P=function(){function e(e,t,n){var r=this;this.attachmentWellViewState=e,this.parentItemId=t,this.infoBar=n,this.downloadQueue=[],this.downloadFailures=[],this.deleteQueue=[],this.onFinishPromise=new Promise((function(e,t){r.onFinish=function(t){e(t)}}))}return e.prototype.enqueueSmimeAttachmentDownload=function(e,t){var n=this;void 0===t&&(t=null),e.map((function(e){var r={attachmentState:e,attachment:Object(h.a)(e.attachmentId),onAttachmentDownloaded:t};n.downloadQueue.push(r)})),this.startProcessIfNotStarted()},e.prototype.deleteSmimeAttachment=function(e,t){var n=1===e.attachmentType,r=n?0===e.status:0===e.ongoingAction;n||Object(x.A)(e,3,6),r&&this.currentDownloadItem&&this.currentDownloadItem.attachmentState.attachmentId!==e.attachmentId&&(c.d.info("Attachment: Removing attachment: TempId= "+e.attachmentId+" from S/MIME download queue"),this.removeRelatedItemFromDownloadQueue(e,this.downloadQueue)),this.deleteQueue.push({attachmentState:e,onAttachmentDeleted:t}),this.startProcessIfNotStarted()},e.prototype.startProcessIfNotStarted=function(){this.isInProgress||(this.datapoint=new l.a("SmimeAttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment())},e.prototype.processNextAttachment=function(){var e;return Object(u.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,i,o,p,v,O,S,j,y,_,A,x,P,D,k,R,F,N,M;return Object(u.__generator)(this,(function(L){switch(L.label){case 0:return 0==this.deleteQueue.length?[3,1]:(t=this.deleteQueue.shift(),i=t.attachmentState,n=t.onAttachmentDeleted,r=Object(h.a)(i.attachmentId),Object(m.a)(this.attachmentWellViewState,i),null==n||n(this.parentItemId,r.model.AttachmentId,r.model),this.processNextAttachment(),[3,19]);case 1:if(0===this.downloadQueue.length)return[3,18];this.currentDownloadItem=this.downloadQueue.shift(),a=this.currentDownloadItem,i=a.attachmentState,o=a.attachment,p=a.onAttachmentDownloaded,v=Object(T.c)(o.model),O=o.model,S=void 0,L.label=2;case 2:return L.trys.push([2,15,16,17]),j=this.getAttachmentId(o.model,this.parentItemId),S=Object(u.__assign)({},O),2!==v?[3,9]:(null===(e=(y=O).Item)||void 0===e?void 0:e.MimeContent)?(S.MimeContent=Object(b.a)(y.Item.MimeContent.Value),[3,8]):[3,3];case 3:return O.MimeContent?[3,8]:(null==j?void 0:j.Id)?[4,C(j)]:[3,5];case 4:return A=L.sent(),[3,7];case 5:return[4,I()({itemId:this.getItemId(o.model)})];case 6:A=L.sent(),L.label=7;case 7:_=A,S.__type=E.g,S.MimeContent=_,Object(l.o)("SmimeAttachmentDownloadDatapoint",{isMailDownload:!0},{isCore:!0}),L.label=8;case 8:return[3,14];case 9:return 0!==v?[3,13]:O.Content?[3,11]:[4,C(j,!0)];case 10:return x=L.sent(),S.__type=E.e,S.Content=s(x),Object(l.o)("SmimeAttachmentDownloadDatapoint",{isFileDownload:!0},{isCore:!0}),[3,12];case 11:S=Object(u.__assign)({},O),L.label=12;case 12:return[3,14];case 13:throw 1===v?new Error("S/MIME: Unsupported reference attachment"):new Error("S/MIME: Unsupported attachment type");case 14:return P=O.AttachmentId,Object(T.e)(O)&&Object(f.a)(O,this.parentItemId)||(P=Object(u.__assign)(Object(u.__assign)({},g()({Id:Object(w.e)()})),{mailboxInfo:this.parentItemId.mailboxInfo})),null==p||p(o.model),Object(d.a)(i,P,O,S,this.parentItemId),[3,17];case 15:return"S/MIME: Unsupported reference attachment"!==(D=L.sent()).message&&c.d.error("SmimeTraceError: "+D.message),k=this.currentDownloadItem.attachment.model.IsInline,R=this.currentDownloadItem.attachment,F=R.attachmentClass,N=R.type,Object(l.o)("SmimeAttachmentDownloadDatapoint",{attachmentClass:F,type:N,IsInline:k,isError:!0,message:D.message},{isCore:!0}),M={item:this.currentDownloadItem,reason:"S/MIME: Unsupported reference attachment"===D.message?1:0},this.downloadFailures.push(M),[3,17];case 16:return this.processNextAttachment(),[7];case 17:return[3,19];case 18:this.finishProcess(),L.label=19;case 19:return[2]}}))}))},e.prototype.finishProcess=function(){var e=this.currentDownloadItem&&this.currentDownloadItem.attachmentState?this.currentDownloadItem.attachmentState.attachmentId:null;c.d.info("Attachment: SmimeAttachmentQueueManager: finishProcess"),this.isInProgress=!1,this.currentDownloadItem=null,this.onFinish(e),this.datapoint.end(),this.datapoint=null,this.downloadFailures.length&&this.removeFromAttachmentWellAndShowError(this.downloadFailures),this.downloadFailures=[]},e.prototype.removeRelatedItemFromDownloadQueue=function(e,t){for(var n=0;n<t.length;n++){t[n].attachmentState.attachmentId===e.attachmentId&&t.splice(n,1)}},e.prototype.removeFromAttachmentWellAndShowError=function(e){var t=this,n=[],r=[];e.map((function(e){var a=e.item.attachment&&e.item.attachment.model.Name;1===e.reason?n.push(a):0===e.reason&&r.push(a),Object(m.a)(t.attachmentWellViewState,e.item.attachmentState)})),n.length>0&&Object(i.a)(this.infoBar,"ErrorSmimeHasCloudOrUriAttachments",[Object(a.b)(Object(a.a)(p.a),n.join(", "))]),r.length>3?Object(i.a)(this.infoBar,"ErrorAttachmentDownloadFailedMultipleFiles",[Object(a.b)(Object(a.a)(A.b),r.length)]):r.length>0&&Object(i.a)(this.infoBar,"ErrorAttachmentDownloadFailed",[Object(a.b)(Object(a.a)(A.a),r.join(", "))])},e.prototype.getAttachmentId=function(e,t){var n,r=e,a=r.AttachmentIdToAttach&&g()({Id:r.AttachmentIdToAttach});switch(e.__type){case E.g:case E.h:n=a;break;default:n=a||e.AttachmentId}return Object(u.__assign)(Object(u.__assign)({},n),{mailboxInfo:t.mailboxInfo})},e.prototype.getItemId=function(e){var t=e;return t.Item?t.Item.ItemId:t.ItemId},e}();n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return R}));var D={};function k(e,t,n,c,u){return t?F(e,t,n).enqueueSmimeAttachmentDownload(c,u):(Object(o.a)(n),Object(i.a)(n,"WarningFilesCanNotBeAttachedGenericError",[Object(a.a)(r.a)]),[])}function R(e,t,n,r,a){F(e,n,r).deleteSmimeAttachment(t,a)}function F(e,t,n){var r=D[t.Id];return r||(c.d.info("Creating SmimeAttachmentQueueManager"),r=function(e,t,n){return new P(e,t,n)}(e,t,n),D[t.Id]=r,r.onFinishPromise.then((function(){c.d.info("Deleting SmimeAttachmentQueueManager"),delete D[t.Id]}))),r}},6663:function(e,t,n){"use strict";function r(e,t){var n,r,a=(n=e,null!=(r=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$","i").exec(n))&&r.length>1?r[1].toLowerCase():null);return null!=a?a:t}var a=n(6933),i=n(857);function o(e,t){var n=t.model.Name;if(e.isCloudy){var r=t;if(r.openUrl)n+="\n \n"+r.openUrl;else{var a=t.model;a.AttachLongPathName&&(n+="\n \n"+a.AttachLongPathName)}}return n}function c(e,t){var n,o;if(e.isCloudy){var c=t.model;if(e.isReadOnly)return{text:r(t.openUrl,c.AttachLongPathName||null),title:null};var u=null===(o=null===(n=t.info)||void 0===n?void 0:n.sharingInfo)||void 0===o?void 0:o.expirationDate,s=Object(a.a)(c.PermissionType,c.ProviderType,u,e.isPlaceholderAttachment);return{text:s,title:s}}var l=t.model.Size>0?Object(i.h)(t.model.Size):null;return{text:l,title:l}}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}))},6928:function(e,t,n){"use strict";var r=n(0),a=n(2729),i=n(190);t.a=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t={}).method="GET",t.headers=new Headers,t.headers.set(a.c,a.d),t.headers.set("Content-Type","application/json;charset=utf-8"),[4,fetch(e,t)];case 1:if(n=r.sent(),!Object(i.a)(n.status))throw new Error("The data package cannot be retrieved. StatusCode: "+n.status);return[4,n.text()];case 2:return[2,r.sent()]}}))}))}},6929:function(e,t,n){"use strict";var r=n(1317),a=n(1746),i=n(2423),o=n(5003),c=n(1792),u=n(919),s=n(2056),l=n(2422),d=n(876),f=n(93),h=n(914);t.a=Object(f.action)("updateSmimeAttachment")((function(e,t,n,f,m){Object(o.a)(n,m)&&Object(l.a)(e.attachmentId);var b=Object(h.c)(n);if(n.AttachmentId=t,n.Name=f.Name||n.Name,n.Size=f.Size||n.Size,n.ContentType=f.ContentType||n.ContentType,n.__type=f.__type||n.__type,2===b?n.MimeContent=f.MimeContent:0===b&&(n.Content=f.Content),n.IsInline&&(n.ContentId=f.ContentId||n.ContentId),Object(s.a)([{attachmentId:t,attachment:n}],!1),e.attachmentId=t,Object(c.a)(e))Object(a.a)(e,1);else{var p=Object(d.a)(t);Object(u.g)(e,!1),Object(i.a)(e,0),Object(r.a)(e,p,!1,[])}}))},6933:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(8120),a=n(8),i=n(1948),o=n(37),c=n(5);function u(e,t,n,u){return void 0===n&&(n=null),void 0===u&&(u=!1),null==e||u?null:Object(o.f)("doc-attachment-referenceAttachmentExpiration")&&n&&Object(c.Gb)(n,Object(c.Pb)())?Object(a.b)(Object(a.a)(r.a),n):Object(i.d)(e,t)}},6968:function(e){e.exports=JSON.parse('{"a":"lDb"}')},6969:function(e,t,n){"use strict";var r=n(93);t.a=Object(r.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},6970:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(914),a=n(876);function i(e){var t=Object(a.a)(e.attachmentId);return!!t&&(!!Object(r.e)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},6971:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(876),a=n(857),i=n(3928);function o(e){var t=Object(r.a)(e),n=Object(a.c)(t.model.Name||"");return""!==Object(i.a)(n)&&"Visio"!==Object(i.a)(n)}},6972:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n(5076),a=n(8),i=n(193),o=n(1143),c=n(1878),u=n(1026),s=n(6372),l=n(876),d=n(2501),f=n(37),h=n(2939);function m(e,t){var n=Object(l.a)(e.attachmentId),r=Object(d.a)(n);Object(i.o)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:r})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(u.a)(e,0,15):(Object(o.B)(Object(o.j)(n.model.Size),.1,(function(t){Object(o.x)(e,t)}),e.attachmentId),Object(c.a)(e,0))}function b(e){var t=Object(l.a)(e.attachmentId);return Object(h.a)(o.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass&&Object(f.f)("cal-ics-preview")?{name:Object(a.a)(r.a),key:"AddToCalendar",onClick:function(){m(e,s.a.ContextMenu)}}:null}},7125:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n(44),o=n(914),c=n(4),u=Object(c.action)("PREFETCH_ALL_WAC_RESOURCES"),s=Object(c.action)("PREFETCH_WAC_RESOURCES_ATTACHMENTS",(function(e){return{attachmentIds:e}})),l=Object(c.action)("PREFETCH_WAC_RESOURCES_FILES",(function(e){return{fileNames:e}})),d=n(857),f=Object(c.action)("WAC_PRELOAD_APPS_FOR_FILES",(function(e){return{fileNames:e}})),h=Object(c.action)("WAC_PRELOAD_APPS",(function(e){return{appsToPreload:e}})),m=Object(c.action)("WAC_APPS_PRELOADED",(function(e){return{appsPreloaded:e}})),b={appsPreloaded:(r={},r[d.a.Word]=!1,r[d.a.Excel]=!1,r[d.a.PowerPoint]=!1,r)},p=Object(c.createStore)("wacPrefetchResourcesStore",b),v=n(37),g=n(35);function O(){return e=p().appsPreloaded,!Object.keys(e).every((function(t){return e[t]}))&&Object(v.f)("doc-SxS-Wac-prefetchStaticResources")&&!Object(g.f)();var e}function I(e){var t=document.createElement("iframe");t.setAttribute("src",e),t.setAttribute("style","visibility:hidden; position:absolute; width:0px; height:0px; left:0px; top 0px;"),document.body.appendChild(t)}Object(c.orchestrator)(u,(function(){O()&&h([d.a.Word,d.a.Excel,d.a.PowerPoint])})),Object(c.orchestrator)(l,(function(e){var t=e.fileNames;O()&&t&&0!==t.length&&f(t)})),Object(c.orchestrator)(s,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,c;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=e.attachmentIds,O()&&t&&0!==t.length?[4,o.i.import()]:[2];case 1:return n=a.sent(),r=t.map(n).filter((function(e){return!!e})).map((function(e){return e.model.Name})),f(r),[3,3];case 2:return c=a.sent(),i.d.error({message:"PrefetchWacResourcesError: Unhandled error",error:c}),[3,3];case 3:return[2]}}))}))})),Object(c.orchestrator)(f,(function(e){var t=e.fileNames.reduce((function(e,t){var n=Object(d.b)(t),r=Object(d.e)(n);return null!=r&&(e[r]=!0),e}),{}),n=Object.keys(t);h(n)}));var w=[".docx",".doc",".docm",".odt"],S=[".xlsx",".xlsm",".xlsb",".ods"],j=[".pptx",".ppxs",".odp"];var y=n(65);Object(c.orchestrator)(h,(function(e){var t,n,r=e.appsToPreload,i=p();r=r.filter((function(e){return!i.appsPreloaded[e]})),m(r),(t=r,n=function(e){var t,n=function(t){return Object(a.__read)(t.map((function(t){return e[t]})).filter((function(e){return!!e})),1)[0]};return(t={})[d.a.Word]=n(w),t[d.a.Excel]=n(S),t[d.a.PowerPoint]=n(j),t}((Object(y.h)().AttachmentPolicy.WacPreloadMappings||[]).reduce((function(e,t){var n=Object(a.__read)(t,2),r=n[0],i=n[1];return e[r]=i,e}),{})),t.map((function(e){return n[e]}))).filter((function(e){return!!e})).forEach(I)})),Object(c.mutator)(m,(function(e){var t=e.appsPreloaded,n=p();t.forEach((function(e){return n.appsPreloaded[e]=!0}))})),n.d(t,"prefetchAllWacResources",(function(){return u})),n.d(t,"prefetchWacResourcesForAttachments",(function(){return s})),n.d(t,"prefetchWacResourcesForFiles",(function(){return l}))},7169:function(e,t,n){"use strict";var r=n(0),a=n(3613),i=n(3410),o=n(914),c=n(44),u=n(93),s=Object(u.action)("replaceAttachmentInWell")((function(e,t,n,r){var u=e.docViewAttachments.indexOf(t);u>-1?(Object(i.a)(e,t),e.docViewAttachments.splice(u,0,n)):(u=e.imageViewAttachments.indexOf(t))>-1?(Object(i.a)(e,t),e.imageViewAttachments.splice(u,0,n)):c.d.error("Can't find the oldAttachment when invoking replaceAttachmentInWell"),n.isCloudy||Object(a.a)(e,r,n.attachmentId),Object(o.p)(n.attachmentId)})),l=n(1143);function d(e,t,n,a,i){var o=Object(l.h)(Object(r.__assign)(Object(r.__assign)({},n.AttachmentId),{mailboxInfo:t.attachmentId.mailboxInfo}),n,a,i,!0,!1,null,null,!1);s(e,t,o,n.Size)}n.d(t,"a",(function(){return d}))},8045:function(e,t,n){var r=n(8046),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8046:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._29oqv7lZi2AHN1HNINq7VD{font-size:12px;font-weight:400}html[dir] ._29oqv7lZi2AHN1HNINq7VD{margin-top:20px;margin-bottom:20px}._1VOfgH1-FDYFFJZco8zmNn{vertical-align:middle}._35i1AdKWszq6SVdd9o6PLa{color:"[theme:neutralSecondary, default:#666666]";vertical-align:middle}html[dir=ltr] ._35i1AdKWszq6SVdd9o6PLa{margin-left:7px}html[dir=rtl] ._35i1AdKWszq6SVdd9o6PLa{margin-right:7px}html[dir] ._2cOLXWI-omGMjt0an7y1Xr{margin-top:5px}.LKLb61DbC-bbgtCQyyR0e{color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={panel:"_29oqv7lZi2AHN1HNINq7VD",attachIcon:"_1VOfgH1-FDYFFJZco8zmNn",attachmentCountLabel:"_35i1AdKWszq6SVdd9o6PLa",attachmentCollectionContainer:"_2cOLXWI-omGMjt0an7y1Xr",attachmentCollectionLabel:"LKLb61DbC-bbgtCQyyR0e"}},8100:function(e){e.exports=JSON.parse('{"a":"Sfa"}')},8101:function(e){e.exports=JSON.parse('{"a":"Gga"}')},8107:function(e){e.exports=JSON.parse('{"b":"Aga","d":"Bga","e":"Cga","c":"Dga","a":"Ega"}')},8113:function(e){e.exports=JSON.parse('{"a":"qfa","b":"rfa"}')},8119:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(1419);function a(e,t,n,a,i,o,c){return function(u){var s=u.AttachmentId,l=-1,d=e.filter((function(e,t){return e.Id===s&&(l=t,!0)}));if(d.length>0){e.splice(l,1);var f=i(d[0]),h=0===u.ResultCode;Object(r.b)(f,h,h?u.Item.Location:null),c&&c(d[0],h),0!==u.ResultCode&&(t.operationFailed=!0,u.Exception&&(t.error=u.Exception))}return 0===e.length&&(o(t.operationFailed),n.addCustomData([a,!t.operationFailed,u.ResultCode]),t.error?n.endWithError("ServerError",new Error(t.error)):n.end(),!0)}}function i(e,t,n,a,i,o){return function(c,u,s){e.forEach((function(e){var t=a(e);Object(r.b)(t,!1,null),o&&o(e,!1)})),i(!0),t.addCustomData([n,!1,u]),t.endWithError(s,new Error(c))}}},8120:function(e){e.exports=JSON.parse('{"a":"ycb"}')},8228:function(e){e.exports=JSON.parse('{"a":"HDb"}')},8233:function(e){e.exports=JSON.parse('{"a":"yDb"}')},8234:function(e,t,n){var r=n(11927),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8235:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s}));var r=n(73),a=n(5534);n.d(t,"d",(function(){return a.a}));var i=n(3416);n.d(t,"c",(function(){return i.a}));var o=n(5641);n.d(t,"a",(function(){return o.a}));var c=new r.c((function(){return Promise.all([n.e(12),n.e(76),n.e(603),n.e(7),n.e(126)]).then(n.bind(null,9427))})),u=Object(r.d)(c,(function(e){return e.AttachmentView})),s=new r.b(c,(function(e){return e.getContextMenus}))},8236:function(e){e.exports=JSON.parse('{"a":"qDb","b":"rDb","c":"sDb"}')},8237:function(e,t,n){var r=n(8238),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8238:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._2KRgryadS8K-_TLdBoNKmd{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._2KRgryadS8K-_TLdBoNKmd{padding:4px;text-align:center}._2KRgryadS8K-_TLdBoNKmd:focus,._2KRgryadS8K-_TLdBoNKmd:hover,._1eq1P1PoHUzBriyfNWVd1T{color:"[theme:neutralSecondary, default:#666666]"}._1eq1P1PoHUzBriyfNWVd1T{display:block}.HDG8P1QaVRBOeSU0W5zmW{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW{right:26px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW{left:26px}.HDG8P1QaVRBOeSU0W5zmW:focus,.HDG8P1QaVRBOeSU0W5zmW:hover{color:"[theme:white, default:#ffffff]"}html[dir] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir] .HDG8P1QaVRBOeSU0W5zmW:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-right-radius:2px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-left-radius:2px}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{right:52px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{left:52px}._2ebptdF8eCnt_2-FT7dzaH{font-size:14px}html[dir] ._2ebptdF8eCnt_2-FT7dzaH{margin:0}html[dir] .IPPU7NtLHAzlPwHTIXmXp:focus,html[dir] .IPPU7NtLHAzlPwHTIXmXp:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .rPIl3tr-13EegQ4JcXUy_,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq,html[dir] ._17q1sDoo-1SD8o99_vx_Wl,html[dir] ._1H8nRWpPKM9iogJAm6ze6p,html[dir] ._3bO0ii_CywH_7ysZAUsxkB,html[dir] ._1E-xlZkNQ0oWd42XQohXqv{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_:focus,html[dir] .rPIl3tr-13EegQ4JcXUy_:hover,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:focus,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:hover,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:focus,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:hover,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:focus,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:hover,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:focus,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:hover,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:focus,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .rPIl3tr-13EegQ4JcXUy_{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={actionButton:"_2KRgryadS8K-_TLdBoNKmd",actionButtonForDocViewInCompose:"_1eq1P1PoHUzBriyfNWVd1T",actionButtonForImageView:"HDG8P1QaVRBOeSU0W5zmW",extraRightPadding:"_2RdXhaKvBvt2MX9AyW7pcR",icon:"_2ebptdF8eCnt_2-FT7dzaH",default:"IPPU7NtLHAzlPwHTIXmXp",edit:"rPIl3tr-13EegQ4JcXUy_",notSelectedAndSaving:"_3vsJWDG9Ae71RWCd-gnOXq",selected:"_17q1sDoo-1SD8o99_vx_Wl",selectedAndPending:"_1H8nRWpPKM9iogJAm6ze6p",selectedAndSaving:"_3bO0ii_CywH_7ysZAUsxkB",thematic:"_1E-xlZkNQ0oWd42XQohXqv"}},833:function(e,t,n){"use strict";var r=n(1110),a=n(1359),i=n(852),o=n(93),c=n(910),u=Object(o.action)("createFocusedOtherDropViewState")((function(){i.a.focusedOtherDropViewState=Object(c.a)()}));function s(){return i.a.focusedOtherDropViewState||u(),i.a.focusedOtherDropViewState}var l,d=n(1614);n(1629);!function(e){e[e.None=0]="None",e[e.Previous=1]="Previous",e[e.Next=2]="Next"}(l||(l={}));var f=l,h=n(1310),m=n(1615);function b(e){var t=e.isInVirtualSelectAllMode,n=e.virtualSelectAllExclusionList,r=e.selectedRowKeys,a=e.rowKeys,i=e.totalRowsInView,o=e.tableQuery,c=e.isInCheckedMode;return t?0===n.length:(a.length==i||1==o.type)&&(c&&r.size==a.length)}var p=n(1325);function v(e){var t=i.a.tableViews.get(e);switch(null==t?void 0:t.tableQuery.type){case 2:return t.serverFolderId;case 0:return t.tableQuery.folderId;default:return null}}var g=n(1005);function O(){var e=Object(g.a)();return!!e&&1===e.tableQuery.type}var I=n(2181),w=n(2182),S=n(8),j=n(836),y=n(2183),_=n(2184),C=n(1630),A=n(1631),x=n(1015),T=n(1404),E=n(839);function P(e,t,n,r){var a=t.tableQuery,i=t.virtualSelectAllExclusionList,o=t.totalRowsInView;if(e){if(Object(x.d)()&&Object(E.a)("inbox")===a.folderId){var c=Object(T.a)(r);return Object(S.b)(Object(S.a)(A.a),c.displayText)}if(-1!==n)return 0===n?Object(S.a)(I.a):Object(S.a)(_.a);if(1==a.type)return Object(S.a)(w.a);if(he(t))return Object(S.b)(Object(S.a)(y.a),he(t));var u=j.e.folderTable.get(a.folderId);return Object(S.b)(Object(S.a)(y.a),Object(j.k)(u))}if($(t)){var s=o-i.length;return 1===a.listViewType?Object(S.b)(Object(S.a)(C.c),s):Object(S.b)(Object(S.a)(A.d),s)}return Object(S.a)(w.a)}function D(e){switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.sortBy;default:throw new Error("getSortByForTable: Table Query type should be either of type group, or mail folder")}}function k(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 1:return e.tableQuery.viewFilter;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function R(e){return e&&"Unread"==k(e)}var F=n(18),N=n(842),M=n(862),L=["drafts","junkemail","recoverableitemsdeletions"];function B(e){if(e){var t=Object(j.p)().get(e);if(t&&(-1!=L.indexOf(Object(M.a)(e))||t.treeType===N.c||t.treeType===N.j)||Object(j.G)(e))return 1}return Object(F.a)().UserOptions.GlobalListViewTypeReact||0}var V=n(1632),U=n(5);function W(e,t){var n=Object(G.a)(e,t),r=null;return me(i.a.tableViews.get(t).tableQuery.folderId)?r=Object(U.tb)(i.a.inboxPausedDateTime):n&&new Date(n.lastModifiedTimeStamp).toISOString(),{conversationId:n.id,conversationLastSyncTimeStamp:r}}var H=n(44);function z(e,t){switch(t){case 0:case 1:return e.InstanceKey;default:return H.d.warn("listViewType:"+t+" not supported"),null}}var q=n(1081),G=n(1004),J=n(1196),Q=n(1633);function X(e,t){for(var n=[],r=0;r<e.length;r++){var a=t.rowIdToRowKeyMap.get(e[r]);a&&Array.prototype.push.apply(n,a)}return n}var Y=n(1344),K=n(1634);function Z(e){var t;switch(e){case 0:t="Conversation";break;case 1:t="Message";break;default:t="Unknown"}return t}function $(e){var t=e.isInVirtualSelectAllMode,n=e.virtualSelectAllExclusionList;return t&&n.length>0}function ee(e){return e.folderId===Object(E.a)(N.b)||e.folderId===Object(E.a)(N.g)}var te=n(1014),ne=n(0);function re(e,t,n){var a=[];return t.forEach((function(t){var i=r.getItemIds(t,n);"Flagged"==e.FlagStatus?a.push(i[0]):a.push.apply(a,Object(ne.__spread)(i))})),a}function ae(e,t,n){return!Object(oe.a)(e)&&(t&&n)}var ie,oe=n(1345),ce=n(1587),ue=n(1170),se=n(1322);function le(){return!Object(g.a)().isInCheckedMode&&i.a.expandedConversationViewState.selectedNodeIds.length>0}function de(e){var t=i.a.tableViews.get(e),n=Object(h.a)(t),r=t.tableQuery,a=t.selectedRowKeys,o=b(t);if(o||$(t))return P(o,t,n,Object(m.a)(e));var c=le()?i.a.expandedConversationViewState.selectedNodeIds.length:a.size;return 1==r.listViewType||le()?0===c?Object(S.a)(C.a):1===c?Object(S.a)(C.b):Object(S.b)(Object(S.a)(C.c),c):0===c?Object(S.a)(A.b):1===c?Object(S.a)(A.c):Object(S.b)(Object(S.a)(A.d),c)}function fe(e,t){return e?-1!==Object(h.a)(e)||0!==Object(m.a)(e.id)||"All"!==t&&"UserCategory"!==t:null}function he(e){return 0===e.tableQuery.type&&"UserCategory"===e.tableQuery.viewFilter?e.tableQuery.categoryName:null}function me(e){return i.a.inboxPausedDateTime&&e&&"inbox"===Object(M.a)(e)}!function(e){e[e.None=0]="None",e[e.BusStart=1]="BusStart",e[e.BusEnd=2]="BusEnd",e[e.BusStop=3]="BusStop",e[e.NoStop=4]="NoStop",e[e.CheckMark=5]="CheckMark"}(ie||(ie={}));var be=ie;n(1386);function pe(e){return"persona"===e||"privatedistributionlist"===e||"category"===e}function ve(e,t){e.currentRowOperation=t,Promise.resolve().then((function(){e.currentRowOperation=0}))}n.d(t,"m",(function(){return s})),n.d(t,"o",(function(){return d.a})),n.d(t,"F",(function(){return i.b})),n.d(t,"S",(function(){return i.a})),n.d(t,"d",(function(){return f})),n.d(t,"l",(function(){return h.a})),n.d(t,"p",(function(){return m.a})),n.d(t,"q",(function(){return b})),n.d(t,"i",(function(){return p.a})),n.d(t,"j",(function(){return p.b})),n.d(t,"n",(function(){return v})),n.d(t,"s",(function(){return O})),n.d(t,"B",(function(){return P})),n.d(t,"C",(function(){return g.a})),n.d(t,"E",(function(){return D})),n.d(t,"K",(function(){return k})),n.d(t,"W",(function(){return R})),n.d(t,"w",(function(){return B})),n.d(t,"k",(function(){return V.a})),n.d(t,"h",(function(){return W})),n.d(t,"z",(function(){return z})),n.d(t,"I",(function(){return q.a})),n.d(t,"G",(function(){return G.a})),n.d(t,"H",(function(){return J.a})),n.d(t,"y",(function(){return Q.a})),n.d(t,"A",(function(){return X})),n.d(t,"Q",(function(){return Y.a})),n.d(t,"g",(function(){return K.a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"x",(function(){return Z})),n.d(t,"P",(function(){return $})),n.d(t,"L",(function(){return ee})),n.d(t,"t",(function(){return te.b})),n.d(t,"r",(function(){return te.a})),n.d(t,"u",(function(){return re})),n.d(t,"V",(function(){return ae})),n.d(t,"f",(function(){return oe.a})),n.d(t,"e",(function(){return ce.a})),n.d(t,"D",(function(){return ue.a})),n.d(t,"T",(function(){return se.a})),n.d(t,"v",(function(){return de})),n.d(t,"R",(function(){return le})),n.d(t,"N",(function(){return fe})),n.d(t,"J",(function(){return he})),n.d(t,"O",(function(){return me})),n.d(t,"a",(function(){return be})),n.d(t,"M",(function(){return pe})),n.d(t,"U",(function(){return ve}))},834:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"o",(function(){return b})),n.d(t,"q",(function(){return p})),n.d(t,"p",(function(){return v})),n.d(t,"u",(function(){return g})),n.d(t,"v",(function(){return O})),n.d(t,"x",(function(){return I})),n.d(t,"w",(function(){return w})),n.d(t,"f",(function(){return S})),n.d(t,"l",(function(){return j})),n.d(t,"y",(function(){return y})),n.d(t,"d",(function(){return _})),n.d(t,"t",(function(){return C})),n.d(t,"j",(function(){return A})),n.d(t,"r",(function(){return x})),n.d(t,"s",(function(){return T}));var r=n(4),a=n(74),i=Object(r.action)("ADD_SUGGESTION_PILL",(function(e,t,n){return{suggestionPill:e,suggestionSelected:t,scenarioId:n}})),o=Object(r.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",(function(e,t,n){return{indexToSelect:e,suggestionToSelect:t,scenarioId:n}})),c=Object(r.action)("CLEAR_SEARCH_BOX",(function(e){return{scenarioId:e}})),u=Object(r.action)("END_SEARCH_CONVERSATION",(function(e){return{scenarioId:e}})),s=(Object(r.action)("EXECUTE_COMMAND",(function(e){return{scenarioId:e}})),Object(r.action)("EXIT_SEARCH",(function(e,t,n){return void 0===n&&(n=!1),{actionSource:e,scenarioId:t,forceExit:n}}))),l=Object(r.action)("GET_SUGGESTIONS",(function(e){return Object(a.c)({name:"Search_SuggestionsE2E"},{scenarioId:e})})),d=Object(r.action)("ON_SEARCH_TEXT_CHANGED",(function(e,t){return{searchText:e,scenarioId:t}})),f=Object(r.action)("SEARCH_BOX_BLURRED",(function(e){return{scenarioId:e}})),h=Object(r.action)("SEARCH_SESSION_STARTED",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}})),m=Object(r.action)("SET_CURRENT_SUGGESTIONS",(function(e,t,n){return void 0===n&&(n=null),{suggestionSet:e,scenarioId:t,qfRequestId:n}})),b=Object(r.action)("SET_DISPLAYED_QF_REQUEST_TIME",(function(e,t){return{displayedQFRequestTime:e,scenarioId:t}})),p=Object(r.action)("SET_LATEST_TRACE_ID",(function(e,t,n){return{latestTraceId:e,scenarioId:t,isQFTraceId:n}})),v=Object(r.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",(function(e,t){return{isSuggestionsDropdownVisible:e,scenarioId:t}})),g=Object(r.action)("START_SEARCH",(function(e,t,n,r,a,i){return void 0===n&&(n=!1),void 0===r&&(r=[]),void 0===i&&(i="All"),{actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r,searchProvider:a,filter:i}})),O=Object(r.action)("START_SEARCH_SESSION",(function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}})),I=Object(r.action)("SUGGESTION_SELECTED",(function(e,t,n,r,a){return{suggestion:e,actionSource:t,scenarioId:n,suggestionSetTraceId:r,index:a}})),w=Object(r.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",(function(e,t,n,r,a,i){return{suggestion:e,suggestionIndex:t,actionSource:n,scenarioId:r,suggestionSetTraceId:a,entityActionTakenType:i}})),S=Object(r.action)("END_SEARCH_SESSION",(function(e,t){return{scenarioId:e,actionSource:t}})),j=Object(r.action)("SEARCH_SESSION_ENDED",(function(e,t,n,r){return{searchSessionGuid:e,scenarioId:t,latestTraceId:n,actionSource:r}})),y=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",(function(e,t){return{isComplete:e,scenarioId:t}})),_=Object(r.action)("DOWNLOAD_FILE_SUGGESTION",(function(e,t,n){return{attachmentId:e,attachmentType:t,scenarioId:n}})),C=Object(r.action)("SHARE_FILE_SUGGESTION",(function(e,t,n){return{attachmentId:e,attachmentType:t,scenarioId:n}})),A=Object(r.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",(function(e,t){return{scenarioId:e,callback:t}})),x=Object(r.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",(function(e,t){return{searchTextForSuggestion:e,scenarioId:t}})),T=Object(r.action)("setShowSearchBoxInCompactMode",(function(e,t){return{scenarioId:e,showSearchBoxInCompactMode:t}}))},836:function(e,t,n){"use strict";var r=n(73),a=n(863),i=n(4),o=n(1036),c=n(911),u=(Object(i.mutator)(o.a,(function(e){var t=e.loadingState;Object(c.a)().get(e.folderTreeId).loadingState=t})),n(0)),s=Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",(function(e,t){return{existingFolders:e,personaOrPdlFavorites:t}})),l=n(861),d=(Object(i.mutator)(s,(function(e){e.existingFolders.forEach((function(t){if(t){var n=t.FolderId.Id,r=e.personaOrPdlFavorites.filter((function(e){return e.searchFolderId===n}));if(1===r.length){var a=r[0].displayName,i=Object(u.__assign)(Object(u.__assign)({},t),{DisplayName:a});Object(l.a)().set(t.FolderId.Id,i)}}}))})),n(855)),f=n(340),h=n.n(f),m=n(93);function b(e,t){t.forEach((function(t){e.folderTable.delete(t)}))}var p=Object(m.action)("removeFolderFromParentFolder")((function(e,t){if(t.ParentFolderId){var n=e.folderTable.get(t.ParentFolderId.Id).childFolderIds;n.splice(n.indexOf(t.FolderId.Id),1)}}));function v(e,t,n){for(var r=t.folderTable.get(n).childFolderIds,a=!1,i=fe(e).toLowerCase(),o=0;o<r.length&&!a;o++){fe(t.folderTable.get(r[o])).toLowerCase()>i&&(r.splice(o,0,e.FolderId.Id),a=!0)}a||r.push(e.FolderId.Id)}var g=Object(m.action)("moveFolderToParentFolder")((function(e,t,n){v(t,e,n),t.ParentFolderId=h()({Id:n}),t.treeType=Object(d.e)(n)})),O=n(1042),I=n(868);function w(e,t,n,r){var a=Object(O.a)(n),i=Object(l.a)().get(n).treeType,o=Object(u.__assign)({DisplayName:r,ParentFolderId:a,childFolderIds:[],FolderClass:"IPF.Note",distinguishedFolderId:void 0,UnreadCount:0,TotalCount:0,treeType:i},t);e.folderTable.set(t.FolderId.Id,o),v(o,e,a.Id)}Object(i.mutator)(I.a,(function(e){w(e.folderStore,e.folder,e.parentFolderId,e.displayName)})),Object(i.mutator)(I.g,(function(e){w(e.folderStore,e.folder,e.parentFolderId,e.displayName)}));var S=n(842);var j=n(1144),y=function(e){return Object(j.c)(e,"0x7018")},_=n(1037),C=n(1702);function A(e,t,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);var i={id:e,rootFolder:t,loadingState:n,hasMoreData:r,currentLoadedIndex:a};Object(c.a)().set(e,i)}var x=n(889),T=n(65),E=n(12);Object(i.mutator)(_.a,(function(e){var t=e.rootFolder,n=e.treeType,r=e.principalSMTPAddress,a=e.displayName;A(e.folderTreeIdentifier,P(t,n,r,a),x.a.Loaded,!t.IncludesLastItemInRange,t.IndexedPagingOffset)}));function P(e,t,n,r){var i=e.ParentFolder,o=function(e,t){return t===S.j?null:e.DistinguishedFolderId}(i,t),c={},u=c[i.FolderId.Id]=D(i,o,t,n);r&&(u.DisplayName=r);for(var s=[],d=0;d<e.Folders.length;d++){var f=e.Folders[d],h=f.FolderId.Id,m=f.DistinguishedFolderId;k(m,f)&&(c[h]=D(f,m,t,n),s.push(h))}return s.forEach((function(e){var t=c[e],n=c[t.ParentFolderId.Id]||Object(l.a)().get(t.ParentFolderId.Id);n&&!t.isHidden&&n.childFolderIds.push(e)})),0==Object(l.a)().size?Object(a.a)().folderTable=new E.ObservableMap(c):Object.keys(c).forEach((function(e){Object(l.a)().set(e,c[e])})),u}function D(e,t,n,r){return Object(l.a)().has(e.FolderId.Id)?Object(l.a)().get(e.FolderId.Id):Object(u.__assign)({childFolderIds:[],distinguishedFolderId:t,UnreadCount:e.UnreadCount,TotalCount:e.TotalCount,isHidden:Object(j.d)(e),remoteFolderDisplayName:y(e),sourceWellKnownFolderType:Object(j.e)(e),treeType:n,principalSMTPAddress:r},e)}function k(e,t){var n=!!Object(T.h)().SegmentationSettings.JunkEMail;if("junkemail"===e&&!n)return!1;var r=!!Object(T.h)().SegmentationSettings.StickyNotes;return!("notes"===e&&!r)&&("clutter"!==e||0!==t.TotalCount)}Object(i.mutator)(C.b,(function(e){P(e.rootFolder,e.treeType,e.principalSMTPAddress)}));var R=Object(i.action)("REMOVE_FOLDERTREE_DATA",(function(e){return{folderTreeId:e}}));Object(i.mutator)(I.f,(function(){var e={DistinguishedFolderId:S.d,DisplayName:Object(T.h)().SessionSettings.ArchiveDisplayName};A(S.d,e,x.a.Uninitialized)})),Object(i.mutator)(R,(function(e){Object(c.a)().delete(e.folderTreeId)}));var F=n(1445),N=n.n(F),M=n(209),L=n.n(M),B=n(1425),V=n.n(B),U=n(886),W=n.n(U),H=n(1446),z=n.n(H),q=n(155),G=n(981);function J(e,t,n){return void 0===n&&(n="IPF.Note"),z()({Header:Object(q.getJsonRequestHeader)(),Body:N()({ParentFolderId:W()({BaseFolderId:Q(e)}),Folders:[V()({DisplayName:t,FolderClass:n})]})},Object(G.a)(e)).then((function(e){return e.Body.ResponseMessages.Items[0]}))}function Q(e){return"string"==typeof e?h()({Id:e}):L()({Id:e})}var X=n(1323),Y=n(839);function K(e,t,n){for(var r=("string"==typeof n?e.folderTable.get(n):e.folderTable.get(Object(Y.a)(n))).childFolderIds,a=t.toLowerCase(),i=0;i<r.length;i++){var o=r[i],c=e.folderTable.get(o);if(c&&c.DisplayName.toLowerCase()==a)return!0}return!1}function Z(e){var t=[e];return Object(l.a)().get(e).childFolderIds.forEach((function(e){Array.prototype.push.apply(t,Z(e))})),t}function $(e){var t=Object(l.a)().get(e);return!!t.childFolderIds&&t.childFolderIds.filter((function(e){var t=Object(l.a)().get(e);return Object(d.g)(t)})).length>0}function ee(e,t){return function e(t,n,r){var a=[];if(0===n){var i=e(t,n+1,r);a.push.apply(a,Object(u.__spread)(i))}else t.forEach((function(t){var i=Object(l.a)().get(t);if(Object(d.g)(i)&&(a.push(Object(u.__assign)(Object(u.__assign)({},i),{depth:n})),$(t)&&r(t))){var o=e(i.childFolderIds,n+1,r);a.push.apply(a,Object(u.__spread)(o))}}));return a}(e,0,t)}var te,ne=null;var re=function(e,t){ne.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&ne.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.distinguishedFolderId&&(te[e.distinguishedFolderId]=e.FolderId.Id)};re=Object(m.action)("addFolderToStore-TestMethod")(re);var ae=Object(i.action)("INITIALIZE_SHARED_FOLDERS"),ie=n(1085),oe=n(1084),ce=n(1147);n(938);function ue(e){var t=Object(c.a)(),n=t&&t.get(e);return null==n?void 0:n.hasMoreData}var se=n(1324),le=n(1086),de=n(18);function fe(e){return e?Object(de.a)().SessionSettings.IsShadowMailbox&&e.remoteFolderDisplayName?e.remoteFolderDisplayName:e.DisplayName:""}var he=n(1676),me=n(193),be=n(1252),pe=n(1732);function ve(){return Object(u.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(u.__generator)(this,(function(r){switch(r.label){case 0:return(e=Object(ce.a)(S.i))==x.a.Loading||e==x.a.Loaded?[2]:(Object(o.a)(S.i,x.a.Loading),t=Object(be.d)(),n=null,t?(n=t.Body.ResponseMessages.Items[0],[3,4]):[3,1]);case 1:return r.trys.push([1,3,,4]),[4,Object(he.b)(L()({Id:S.i}))];case 2:return n=r.sent(),[3,4];case 3:return r.sent(),Object(o.a)(S.i,x.a.ErrorLoading),[2];case 4:return n&&n.RootFolder&&n.RootFolder.Folders&&n.RootFolder.ParentFolder?(Object(_.a)(n.RootFolder,S.i,S.h,Object(pe.a)(),Object(de.a)().SessionSettings.UserDisplayName,S.i),function(){var e=Object(l.a)().get(Object(Y.a)("inbox")).childFolderIds.length,t=Object(l.a)().get(Object(Y.a)("msgfolderroot")).TotalCount;Object(me.o)("TnS_LoadFolders",[e,t]);var n=Object(Y.a)("notes"),r=Object(l.a)().get(n);if(null!=n&&null!=r){var a=r.TotalCount,i=r.ChildFolderCount;Object(me.o)("Notes_LoadFolders",{noteCount:a,childFolderCount:i})}}(),[2]):(Object(o.a)(S.i,x.a.ErrorLoading),[2])}}))}))}var ge=n(946),Oe=Object(m.select)({folderTable:function(){return a.b.folderTable}})((function(e,t){return Object(ge.c)(e,"msgfolderroot",t)}));function Ie(e){return Object(ge.a)(a.b.folderTable.get(e),"msgfolderroot")}n(1043);var we=n(1154);n.d(t,"J",(function(){return je})),n.d(t,"K",(function(){return ye})),n.d(t,"M",(function(){return _e})),n.d(t,"N",(function(){return Ce})),n.d(t,"I",(function(){return Ae})),n.d(t,"L",(function(){return xe})),n.d(t,"y",(function(){return a.a})),n.d(t,"d",(function(){return J})),n.d(t,"X",(function(){return X.a})),n.d(t,"g",(function(){return K})),n.d(t,"h",(function(){return Z})),n.d(t,"l",(function(){return ee})),n.d(t,"z",(function(){return $})),n.d(t,"a",(function(){return x.a})),n.d(t,"R",(function(){return s})),n.d(t,"f",(function(){return b})),n.d(t,"S",(function(){return p})),n.d(t,"O",(function(){return g})),n.d(t,"c",(function(){return I.a})),n.d(t,"A",(function(){return I.f})),n.d(t,"o",(function(){return I.e})),n.d(t,"n",(function(){return I.d})),n.d(t,"Z",(function(){return I.k})),n.d(t,"Y",(function(){return I.i})),n.d(t,"P",(function(){return I.g})),n.d(t,"B",(function(){return ae})),n.d(t,"T",(function(){return R})),n.d(t,"Q",(function(){return _.a})),n.d(t,"V",(function(){return o.a})),n.d(t,"j",(function(){return G.a})),n.d(t,"i",(function(){return ie.a})),n.d(t,"v",(function(){return oe.a})),n.d(t,"p",(function(){return l.a})),n.d(t,"s",(function(){return ce.a})),n.d(t,"r",(function(){return ue})),n.d(t,"q",(function(){return se.a})),n.d(t,"x",(function(){return le.a})),n.d(t,"k",(function(){return fe})),n.d(t,"U",(function(){return A})),n.d(t,"w",(function(){return ve})),n.d(t,"F",(function(){return Oe})),n.d(t,"E",(function(){return Ie})),n.d(t,"H",(function(){return ge.c})),n.d(t,"D",(function(){return ge.a})),n.d(t,"W",(function(){return d.g})),n.d(t,"m",(function(){return d.b})),n.d(t,"u",(function(){return d.d})),n.d(t,"C",(function(){return d.f})),n.d(t,"b",(function(){return d.a})),n.d(t,"t",(function(){return d.c})),n.d(t,"G",(function(){return we.b}));t.e=a.b;var Se=new r.c((function(){return n.e(252).then(n.bind(null,13905))})),je=new r.b(Se,(function(e){return e.getArchiveFolders})),ye=new r.b(Se,(function(e){return e.getFolderPermissions})),_e=new r.b(Se,(function(e){return e.updateFolderPermissions})),Ce=new r.b(Se,(function(e){return e.updateFolderPermissionsInStore})),Ae=new r.b(Se,(function(e){return e.arePermissionArraysEqual})),xe=(new r.b(Se,(function(e){return e.arePermissionsEqual})),new r.b(Se,(function(e){return e.getSharedFolders})))},8414:function(e){e.exports=JSON.parse('{"k":"WCb","l":"XCb","m":"YCb","j":"ZCb","h":"_Cb","i":"$Cb","f":"aDb","g":"bDb","o":"cDb","p":"dDb","q":"eDb","b":"fDb","n":"gDb","d":"hDb","c":"iDb","a":"jDb","e":"kDb"}')},8415:function(e){e.exports=JSON.parse('{"f":"QCb","b":"RCb","d":"SCb","a":"TCb","c":"UCb","e":"VCb"}')},8416:function(e,t,n){"use strict";function r(e){return e.actionCompletePercent>0&&e.actionCompletePercent<=1}n.d(t,"a",(function(){return r}))},842:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"k",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return h}));var r="archivemsgfolderroot",a="msgfolderroot",i="archivedeleteditems",o="deleteditems",c="archiverecoverableitemsdeletions",u="recoverableitemsdeletions",s="msgfolderroot",l="sharedFolderTree",d="primaryFolderTree",f="archiveFolderTree",h="favorites"},844:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1641),a=n(940);function i(e){return Object(a.b)().scenarioStores.get(Object(r.a)(e))||Object(a.a)()}},846:function(e,t,n){"use strict";var r=n(73),a=n(851),i=n(1424),o=n(1138),c=n(1099),u="ChronologicalNewestOnBottom";function s(e,t){return e[t==u?0:e.length-1]}var l=n(78),d=n(2033),f=n.n(d),h=n(340),m=n.n(h),b=n(1549),p=n.n(b),v=n(2034),g=n.n(v),O=n(454),I=n.n(O),w=n(2035),S=n.n(w),j=n(155),y=n(839),_=["journal","outbox","syncissues"];function C(e){return"ChronologicalNewestOnBottom"==e?"DateOrderAscending":"DateOrderDescending"}function A(e){var t=[];return e||_.forEach((function(e){var n=Object(y.a)(e);n&&t.push(m()({Id:n}))})),t}function x(e,t,n,r,a,i,o,c,u){void 0===c&&(c="Default");var s=f()({ConversationId:I()(e)});s.SyncState=i?"":n;var d=function(e,t,n,r,a,i,o){return g()({Conversations:[e],ItemShape:t,ShapeName:"ItemPart",SortOrder:C(n),MaxItemsToReturn:r,ReturnModernConversationItems:a,Action:i,FoldersToIgnore:A(o),ReturnSubmittedItems:!0})}(s,t,a,r,o,c,function(e){var t=e.mailboxInfo;return t&&t.type==l.a.GroupMailbox}(e)),h=Object(j.getJsonRequestHeader)();return h.RequestServerVersion="V2017_08_18",S()(p()({Header:h,Body:d}),u).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var T=n(1095),E=n(392),P=n.n(E),D=n(847),k=n.n(D);function R(e){return Object(c.a)([e],P()({BaseShape:"IdOnly",AdditionalProperties:[k()({FieldURI:"TailoredXpEntities"}),k()({FieldURI:"TailoredXpCalendarEventIds"}),k()({FieldURI:"TailoredXpEntitiesStatus"}),k()({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){return function(e){if(Object(T.a)(e[0])){var t=e[0].Items[0];return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}(e)}))}function F(e){return a.a.items.get(e)}var N=n(18);function M(e){var t=a.a.conversations.get(e);if(t){var n=Object(N.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}var L=n(1184),B=n(836),V=n(93),U=Object(V.select)({folderTable:function(){return B.e.folderTable}})((function(e,t){var n=t.folderTable.get(e);return!!n&&Object(B.W)(n)})),W=n(842);function H(e,t){var n=B.e.folderTable.get(e);return!!n&&(Object(B.H)(n,W.d,t)||n.DistinguishedFolderId===W.b)}function z(e){return H(e)||function(e){var t=B.e.folderTable.get(e);return t&&t.distinguishedFolderId===W.d}(e)}var q=Object(V.select)({folderTable:function(){return B.e.folderTable}})((function(e,t,n){return Object(B.H)(e,t,n)})),G=n(1358),J=n(1111);function Q(e){return e&&(Object(J.a)(e,W.g)||Object(J.a)(e,W.b))}function X(e){return e&&(q(e,W.f)||q(e,W.a))}var Y=n(1268);function K(e,t){try{return Z(e,t)}catch(e){return null}}function Z(e,t){if(!e||!t)return null;var n=Object(B.p)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===t}));return null==n?void 0:n[0]}var $=n(208),ee="OneOff",te="Unknown";function ne(e,t,n){return!Object($.a)()&&(n==ee||n==te)&&e.indexOf(t)<0}var re=n(4),ae=Object(re.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,t){var n=Object(a.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)})),ie=n(37),oe=n(287),ce=n.n(oe);function ue(e){Object(ie.f)("rp-omeRevocation")&&e.AdditionalProperties.push(ce()({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}))}n.d(t,"v",(function(){return le})),n.d(t,"x",(function(){return a.a})),n.d(t,"j",(function(){return a.b})),n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"h",(function(){return c.a})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return x})),n.d(t,"w",(function(){return R})),n.d(t,"y",(function(){return F})),n.d(t,"t",(function(){return M})),n.d(t,"e",(function(){return L.a})),n.d(t,"c",(function(){return T.a})),n.d(t,"u",(function(){return U})),n.d(t,"p",(function(){return H})),n.d(t,"o",(function(){return z})),n.d(t,"q",(function(){return q})),n.d(t,"m",(function(){return G.a})),n.d(t,"n",(function(){return Q})),n.d(t,"s",(function(){return X})),n.d(t,"i",(function(){return Y.a})),n.d(t,"k",(function(){return K})),n.d(t,"l",(function(){return Z})),n.d(t,"r",(function(){return ne})),n.d(t,"z",(function(){return ae})),n.d(t,"d",(function(){return ue}));var se=new r.c((function(){return n.e(563).then(n.bind(null,14128))})),le=new r.a(se,(function(e){return e.setTriageActionAnnouncement}))},8497:function(e){e.exports=JSON.parse('{"a":"HCb"}')},8498:function(e){e.exports=JSON.parse('{"a":"GCb"}')},851:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(12),a=n(4),i={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},o=Object(a.createStore)("mail",i),c=o();t.a=c},852:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(12),a=n(4),i={conversationItems:new r.ObservableMap({}),itemContextMenuState:null,selectedTableViewId:null,tableViewConversationRelations:new r.ObservableMap({}),tableViewItemRelations:new r.ObservableMap({}),tableViews:new r.ObservableMap({}),attachmentViewStates:new r.ObservableMap({}),expandedConversationViewState:{expandedRowKey:null,focusedNodeId:null,selectedNodeIds:[],allNodeIds:[],shouldBeExpanded:!1,busStopStateMap:new r.ObservableMap({})},rowAttachmentPreviewWellViews:new r.ObservableMap({}),focusedOtherDropViewState:null,couponPeekPreviews:new r.ObservableMap({}),rowInfoForVLV:new r.ObservableMap({}),meetingMessageItems:new r.ObservableMap({}),offsetHeight:0,scrollTop:0,inboxPausedDateTime:null,inboxPausedLength:null},o=Object(a.createStore)("listview",i),c=o();t.a=c},855:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return v})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return O}));var r=n(18),a=n(839),i=n(862),o=n(863),c=n(1084),u=n(861),s=n(1085),l=n(37),d=n(1086),f=n(208),h=["journal","outbox","syncissues"];function m(){var e=Object(f.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(l.f)("notes-folder-view")&&e.push("notes"),e}function b(e){if(!function(e){return e&&"Folder:#Exchange"==e.__type}(e))return!1;if(e.isHidden||h.indexOf(Object(i.a)(e.FolderId.Id))>=0)return!1;var t=Object(r.a)();return"notes"==Object(i.a)(e.FolderId.Id)?t.SegmentationSettings.StickyNotes&&Object(l.f)("cal-stickyNotesFolder"):!("junkemail"==Object(i.a)(e.FolderId.Id)&&!t.SegmentationSettings.JunkEMail)}function p(e){var t=Object(u.a)(),n=Object(a.a)(e);return t.get(n)}function v(e,t){if("sharedFolder"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,r=[];switch(e){case"archive":n=Object(s.a)();break;case"sharedFolder":n=Object(d.a)(t);break;default:n=Object(c.a)()}var a=m();"primary"==e&&n.DistinguishedFolderId==Object(c.a)().DistinguishedFolderId&&a.forEach((function(e){var t=p(e);t&&b(t)&&t.ParentFolderId.Id===n.FolderId.Id&&r.push(t.FolderId.Id)}));for(var u=function(e){var t=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var n=o.b.folderTable.get(e);n&&b(n)&&t.push(n.FolderId.Id)}));return t}(n),l=0;l<u.length;l++)-1==a.indexOf(Object(i.a)(u[l]))&&r.push(u[l]);return r}function g(e,t){var n=Object(u.a)().get(e);return!(!n||n.treeType!==t)}function O(e){var t=null,n=Object(u.a)().get(e);return n&&(t=n.treeType),t}},857:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function a(e){var t=r(e);return t?t.replace(".",""):null}function i(e){var t;return(null===(t=a(e))||void 0===t?void 0:t.substring(0,4))||""}var o=n(1186),c=n(8);function u(e){var t;return e>=1073741824?(e/=1073741824,t=Object(c.a)(o.b)):e>=1048576?(e/=1048576,t=Object(c.a)(o.d)):e>=1024?(e/=1024,t=Object(c.a)(o.c)):t=Object(c.a)(o.a),Object(c.b)(t,Math.round(e))}function s(e){return t=e||"",(n=d.exec(t))&&n.length>1&&l[n[1].toLowerCase()];var t,n}var l={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},d=/^\s*([^;\s]*)(?:;|\s|$)/;var f=n(35),h=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],m=[".tiff",".tif"];function b(e,t,n){void 0===n&&(n=!0);var a=r(e)||s(t);return!!a&&(h.indexOf(a.toLowerCase())>=0||n&&m.indexOf(a.toLowerCase())>=0&&(Object(f.d)()||Object(f.c)()||Object(f.g)()||Object(f.f)()&&!Object(f.i)()))}var p,v=n(37),g=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function O(e){if(!Object(v.f)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&g.indexOf(t.toLowerCase())>=0}function I(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return p.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return p.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return p.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(p||(p={})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return I})),n.d(t,"a",(function(){return p}))},861:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(863);function a(){return Object(r.a)().folderTable}},862:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(27);function a(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},863:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r,a=n(4),i=n(12),o=n(889),c=n(842),u=Object(a.createStore)("folderStore",{folderTable:new i.ObservableMap,folderTreeTable:new i.ObservableMap((r={},r[c.i]={id:c.i,rootFolder:null,loadingState:o.a.Uninitialized},r)),sharedFolderUserEmails:[]}),s=u();t.a=u},864:function(e,t,n){"use strict";var r=n(73),a=n(0),i=n(1582),o=n(452),c=n(198),u=n(100),s=n(44),l=n(65);function d(e,t,n,r,d){var h=this,m=function(e,t,n,r,a){var i=Object(u.createDefaultHeaders)();i["client-session-id"]=t,i["x-client-localtime"]=Object(Dt.a)(),i["X-Search-Griffin-Version"]="GWSv2",i["Accept-Language"]=Object(l.j)(),r&&r.length>0&&(i["x-anchormailbox"]=r[0].mailboxSmtpAddress,i.authorization=r[0].tokenString);n&&(i["X-Client-Flights"]=n);i.scenariotag=function(e){var t=e.EntityRequests.length>1,n=e.EntityRequests[0],r=[];t&&r.push("ErrMER");0==n.From&&r.push("1stPg");var a=f[n.EntityType];return r.push(a||"Unknown"),r.join("_")}(e),a&&Object.keys(a).forEach((function(e){i[e]=a[e]}));return i}(e,t,n,r,d),b=Object(i.a)(),p=b?"?"+b:"";return Object(c.d)(""+Object(jt.a)("query")+p,e,Object(o.a)(),!0,m,void 0,void 0,!1).then((function(e){return Object(a.__awaiter)(h,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,[e,m]]}))}))})).catch((function(e){return s.d.warn(e),[e]}))}var f={Event:"ev",Conversation:"cv",Email:"em",Message:"mg",MailItems:"mi",CalendarItems:"ci",MailConversations:"mc",MessageItems:"gi"},h=n(1959),m=n.n(h);function b(e){return e?[m()({RefinerQuery:"ShallowRefiner::SearchScope:hasattachment:true"})]:null}var p=n(1611),v=n.n(p),g=n(1161),O=n.n(g),I=n(1168),w=n.n(I),S=n(1895),j=n.n(S),y=n(1642),_=n.n(y),C=n(847),A=n.n(C),x=n(1162),T=n.n(x),E=n(5),P="DateTimeReceived";function D(e,t,n,r){if(e||t){var a=[];a.push(_()({FieldURIOrConstant:w()({Item:O()({Value:t?t.toString().substring(0,10):Object(E.Qb)().toString().substring(0,10)})}),Item:A()({FieldURI:n||P})})),a.push(j()({FieldURIOrConstant:w()({Item:O()({Value:e?e.toString().substring(0,10):Object(E.Qb)("UTC",0).toString().substring(0,10)})}),Item:A()({FieldURI:r||P})}));var i=v()({Items:a});return T()({Item:i})}return null}var k=n(913),R=n(37);function F(e,t){if(Object(R.f)("sea-settings")&&Object(k.a)(128))return"DateTime";return e||(t>0?"Hybrid":"DateTime")}var N=n(209),M=n.n(N),L=n(340),B=n.n(L),V=n(1960),U=n.n(V),W=n(1961),H=n.n(W),z=n(1962),q=n.n(z),G=n(1963),J=n.n(G),Q=n(1124),X=n.n(Q),Y=n(862);var K=n(18),Z=n(839),$=n(842),ee=n(855);var te={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t,n=[];if(n.push(yt({folderId:Object(Z.a)($.i),kind:"PrimaryMailbox"})),Object(R.f)("sea-advanced-search")){var r=Object(ee.d)("primary");try{for(var i=Object(a.__values)(r),o=i.next();!o.done;o=i.next()){var c=o.value;n.push(yt({folderId:c,kind:"PrimaryMailbox"}))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}else{n.push(yt({folderId:Object(Z.a)("inbox"),kind:"PrimaryMailbox"})),n.push(yt({folderId:Object(Z.a)($.f),kind:"PrimaryMailbox"})),n.push(yt({folderId:Object(Z.a)("sentitems"),kind:"PrimaryMailbox"}));var u=Object(K.a)().UserOptions.ArchiveFolderId;u&&n.push(yt({folderId:u,kind:"PrimaryMailbox"}))}return n},getSearchScopeType:function(e){var t,n=Object(Y.a)(e.folderId);return t="none"!=n?M()({Id:n}):B()({Id:e.folderId}),[U()({FolderScope:q()({BaseFolderId:t}),IsDeepTraversal:!0})]}},ne={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t=[],n=Object(K.a)();return(null===(e=null==n?void 0:n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)||t.push(_t({folderId:Object(Z.a)($.d),kind:"ArchiveMailbox"})),t.push(_t({folderId:Object(Z.a)($.a),kind:"ArchiveMailbox"})),t},getSearchScopeType:function(e){var t,n=Object(Y.a)(e.folderId);return t="none"!=n?M()({Id:n}):B()({Id:e.folderId}),[H()({FolderScope:q()({BaseFolderId:t})})]}},re={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},ae={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[J()({GroupIdentity:X()({Type:0,Value:e.groupId})})]}},ie={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},oe={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},ce=function(e){switch(e.kind){case"PrimaryMailbox":return te;case"ArchiveMailbox":return ne;case"SharedFolders":return re;case"Group":return ae;case"Calendar":return ie;case"PublicFolder":return oe;default:throw new Error("Unregistered search scope")}},ue=function(e){return ce(e).getKey(e)},se=function(e){return ce(e).getSearchScopeList()},le=function(e){return ce(e).getSearchScopeType(e)};function de(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.TimeZoneContext)||void 0===t?void 0:t.TimeZoneDefinition)||void 0===n?void 0:n.Id)?e.TimeZoneContext.TimeZoneDefinition.Id:"UTC"}function fe(e,t,n,r){var a,i,o,c=[];if(r===n){var u={Range:(a={},a[r]={gte:t,lte:e},a)};c.push(u)}else{var s={Range:(i={},i[r]={gte:t},i)};c.push(s);var l={Range:(o={},o[n]={lte:e},o)};c.push(l)}return c}function he(e){switch(e){case"StartTime":return"StartTime";case"EndTime":return"EndTime";case"DateTimeReceived":default:return"received"}}var me="MsgFolderRoot";function be(e){var t=function(e){var t,n,r=[],i=[];if(e&&e.length>0)try{for(var o=Object(a.__values)(e),c=o.next();!c.done;c=o.next()){var u=c.value,s=u.__type;if("PrimaryMailboxSearchScopeType:#Exchange"===s)ve(u.FolderScope,r,i);else if("SingleLargeArchiveSearchScopeType:#Exchange"===s)ve(u.FolderScope,r,i);else if("LargeArchiveSearchScopeType:#Exchange"===s){1==(1&u.ArchiveTypes)&&i.push("archivemsgfolderroot")}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return{folderIds:r,folderNames:i}}(e.Body.SearchScope);return pe(t.folderIds,t.folderNames,e.Body.IncludeDeleted,"CalendarItems"!==e.Body.ItemTypes?me:null)}function pe(e,t,n,r){var i,o,c,u;void 0===r&&(r=null);var s=[];0===e.length&&0===t.length&&null!=r&&e.push(Object(Z.a)(r));try{for(var l=Object(a.__values)(t),d=l.next();!d.done;d=l.next()){var f=d.value;s.push({Term:{DistinguishedFolderName:f}})}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}try{for(var h=Object(a.__values)(e),m=h.next();!m.done;m=h.next()){var b=m.value;if(b&&Object(Y.a)(b)==$.d)return[];s.push({Term:{FolderId:b}})}}catch(e){c={error:e}}finally{try{m&&!m.done&&(u=h.return)&&u.call(h)}finally{if(c)throw c.error}}n&&s.push({Term:{DistinguishedFolderName:"DeletedItems"}});var p=[],v={Or:s};return p.push(v),s.length>0?p:null}function ve(e,t,n){var r=e.BaseFolderId,a=e.BaseFolderId.__type;if("FolderId:#Exchange"===a)t.push(r.Id);else if("DistinguishedFolderId:#Exchange"===a){var i=r.Id;if("msgfolderroot"===i.toLowerCase())n.push(i);else{var o=Object(Z.a)(i);t.push(o)}}}function ge(e){var t=function(e){var t=function(e){var t=null,n=null,r=null,a=null;if(null==e?void 0:e.Item){var i=e.Item;if("And:#Exchange"===i.__type){var o=i;if(o.Items&&2===o.Items.length){if("IsLessThanOrEqualTo:#Exchange"===o.Items[0].__type){var c=o.Items[0];if("Constant:#Exchange"===c.FieldURIOrConstant.Item.__type&&"PropertyUri:#Exchange"===c.Item.__type){var u=c.FieldURIOrConstant.Item,s=c.Item;t=u.Value,n=s.FieldURI}}if("IsGreaterThanOrEqualTo:#Exchange"===o.Items[1].__type){var l=o.Items[1];if("Constant:#Exchange"===l.FieldURIOrConstant.Item.__type&&"PropertyUri:#Exchange"===l.Item.__type){u=l.FieldURIOrConstant.Item,s=l.Item;r=u.Value,a=s.FieldURI}}}}}return{lteFieldValue:t,lteFieldUri:n,gteFieldValue:r,gteFieldUri:a}}(e.Body.SearchRestrictions),n=t.lteFieldValue,r=t.gteFieldValue,a=t.lteFieldUri,i=t.gteFieldUri;return n&&a&&r&&i?fe(n,r,a=he(a),i=he(i)):[]}(e),n=be(e),r=t.concat(n).filter((function(e){return!!e})),a={And:r};return 0===r.length?null:1===r.length?r[0]:a}function Oe(e){var t=[];return e.Body.SearchScope.forEach((function(n){"PrimaryMailboxSearchScopeType:#Exchange"===n.__type||"CalendarItems"===e.Body.ItemTypes?t.push("Exchange"):"LargeArchiveSearchScopeType:#Exchange"!==n.__type&&"SingleLargeArchiveSearchScopeType:#Exchange"!==n.__type||t.push("ExchangeArchive")})),t}function Ie(e){if(!e)return"MailItems";switch(e){case"CalendarItems":return"Event";case"MailConversations":return"Conversation";case"MessageItems":return"Email";case"MailItems":default:return"Message"}}function we(e,t,n,r){var a,i,o,c,u,s=0===n&&"QueryAlterationRecourseLink"!==r;return[{EntityType:Ie(e.Body.ItemTypes),Filter:ge(e),From:e.Body.ResultRowOffset,PropertySet:"ProvenanceOptimized",Provenances:Oe(e),Query:Se(e,t),QueryAlterationOptions:{EnableSuggestion:s,EnableAlteration:s},RefiningQueries:(u=e.Body.SearchRefiners,0===(u?u.length:0)?null:u.map((function(e){return{RefinerString:e.RefinerQuery}}))),Size:e.Body.ResultRowCount,Sort:(a=e.Body.SortOrder,i={Field:"Score",SortDirection:"Desc",Count:3},o={Field:"Time",SortDirection:"Desc"},c={Relevance:[i],Hybrid:[i,o],DateTime:[o]},a&&c[a]?c[a]:[o])}]}function Se(e,t){return t?{QueryString:e.Body.Query,DisplayQueryString:"",ClientQueryAlterationReasons:"PeopleSearch Scenario"}:{QueryString:e.Body.Query}}function je(e,t,n){var r,i,o,c,u,s,l,d,f,h,m;return Object(a.__awaiter)(this,void 0,void 0,(function(){var b;return Object(a.__generator)(this,(function(p){return e&&200===e.status&&(b=null===(i=null===(r=t.EntitySets)||void 0===r?void 0:r[0])||void 0===i?void 0:i.QueryAlterationResponse)?ye(b.QueryAlterationType)?[2,Object(a.__assign)(Object(a.__assign)({},n),{querySuggestionData:{alteredQuery:null===(c=null===(o=b.AlteredQuery)||void 0===o?void 0:o.AlteredQuery)||void 0===c?void 0:c.RawString,flaggedTokens:null===(u=b.AlteredQuery)||void 0===u?void 0:u.FlaggedTokens,recourseQuery:null===(s=b.RecourseQuery)||void 0===s?void 0:s.RawString,suggestedSearchTerm:null===(f=null===(d=null===(l=b.AlteredQuery)||void 0===l?void 0:l.FlaggedTokens)||void 0===d?void 0:d[0])||void 0===f?void 0:f.Suggestion,suggestedSearchTermReferenceId:null===(m=null===(h=b.AlteredQuery)||void 0===h?void 0:h.AlteredQuery)||void 0===m?void 0:m.ReferenceId,queryAlterationType:b.QueryAlterationType}})]:[2,Object(a.__assign)(Object(a.__assign)({},n),{querySuggestionData:{alteredQuery:"",flaggedTokens:null,recourseQuery:"",suggestedSearchTerm:null,suggestedSearchTermReferenceId:null,queryAlterationType:null}})]:[2,Object(a.__assign)({},n)]}))}))}var ye=function(e){var t=["Suggestion"];return Object(R.f)("sea-spellingCorrectedSearchNoResults")&&t.push("NoResultModification"),(Object(R.f)("sea-naturalLanguageR")||Object(R.f)("sea-trySuggestions")||Object(R.f)("sea-trySuggestions-always"))&&t.push("NoRequeryModification"),Object(R.f)("sea-modificationQueryAlteration")&&t.push("Modification"),Object(R.f)("sea-extensionQueryAlteration")&&t.push("Extension"),t.includes(e)};function _e(e){return e?{Id:e.Id,ChangeKey:null}:null}function Ce(e,t){var n=null;(null==t?void 0:t.TimeZone)&&(n=new Date(e).toISOString());return n}function Ae(e){return(null==e?void 0:e.EmailAddress)?{Mailbox:{EmailAddress:e.EmailAddress.Address,Name:e.EmailAddress.Name,RoutingType:"SMTP"}}:null}function xe(e){return e?{Id:e.Id}:null}function Te(e){switch(e){case"DateTime":return"DateTime";case"Hybrid":return"Hybrid";case"Relevance":return"Relevance";default:return null}}function Ee(e){if(null===e||0===e.length)return null;for(var t=[],n=0;n<e.length;n++)t[n]=_e(e[n]);return t}function Pe(e){var t;return(null===(t=null==e?void 0:e.QueryId)||void 0===t?void 0:t.Id)?{Id:e.QueryId.Id}:null}function De(e,t){return{Categories:e.Categories,ConversationId:_e(e.ConversationId),ConversationTopic:e.ConversationTopic,FlagStatus:e.FlagStatus,FolderId:xe(e.ParentFolderId),FolderRefinerId:e.FolderRefinerId,From:Ae(e.From),GlobalItemIds:Ee(e.GlobalItemIds),GlobalMessageCount:e.GlobalMessageCount,GlobalUnreadCount:e.GlobalUnreadCount,HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,HasIrm:e.HasIrm,Importance:e.Importance,ItemClasses:e.ItemClasses,ItemIds:Ee(e.ItemIds),LastDeliveryOrRenewTime:Ce(e.LastDeliveryOrRenewTime,t),LastDeliveryTime:Ce(e.LastDeliveryTime,t),LastModifiedTime:Ce(e.LastModifiedTime,t),MailboxGuids:e.MailboxGuids,MessageCount:e.MessageCount,ParentFolderId:xe(e.ParentFolderId),Preview:e.Preview,SenderSMTPAddress:e.SenderSMTPAddress,SortOrderSource:Te(e.SortOrderSource),UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,UnreadCount:e.UnreadCount}}var ke="IPM.Appointment";function Re(e){var t=Ae(e.Organizer);return{CalendarItemType:e.CalendarItemType.toString(),Categories:e.Categories,CharmId:e.Charm,DisplayTo:e.DisplayTo,End:e.End,Start:e.Start,HasAttachments:e.HasAttachments,IsAllDayEvent:e.IsAllDayEvent,IsMeeting:e.IsMeeting,IsMeetingPollEvent:e.IsMeetingPollEvent,ItemClass:e.ItemClass?e.ItemClass:ke,FreeBusyType:e.LegacyFreeBusyStatus?e.LegacyFreeBusyStatus.toString():null,Location:{DisplayName:e.Location},Sensitivity:e.Sensitivity,SeriesId:e.SeriesMasterItemId?e.SeriesMasterItemId.Id:null,Subject:e.Subject,Organizer:t,UID:e.UID,ItemId:_e(e.ItemId),ParentFolderId:xe(e.ParentFolderId),SortOrderSource:Te(e.SortOrderSource),Preview:e.Preview,IsOrganizer:e.IsOrganizer&&Object(K.a)().SessionSettings.UserEmailAddress===t.Mailbox.EmailAddress,IsCancelled:e.IsCancelled,ResponseType:e.MyResponseType}}function Fe(e,t){var n,r,a=function(e){if(!e)return e;var t=e.indexOf(":");return t>0&&t<6&&t+1<e.length?e.substring(t+1).trim():e}(e.Subject);return{Categories:e.Categories,ConversationId:_e(e.ConversationId),ConversationIndex:e.ConversationIndex,ConversationThreadId:{Id:e.ConversationThreadId,ChangeKey:null},ConversationTopic:a,DateTimeReceived:Ce(e.DateTimeReceived,t),DateTimeSent:Ce(e.DateTimeSent,t),LastModifiedTime:Ce(e.DateTimeLastModified,t),DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:(r=e.Flag,r?{FlagStatus:r.FlagStatus,CompleteDate:r.CompleteDate,DueDate:r.DueDate,StartDate:r.StartDate}:null),From:Ae(e.From),HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,IconIndex:e.IconIndex,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},MailboxGuids:e.MailboxGuids,ParentFolderId:xe(e.ParentFolderId),Preview:e.Preview,Sender:Ae(e.Sender),SenderSMTPAddress:e.SenderSMTPAddress,Sensitivity:e.Sensitivity,SortOrderSource:Te(e.SortOrderSource),Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,ExtendedProperty:[{ExtendedFieldURI:{DistinguishedPropertySetId:"Common",PropertyId:3613,PropertyType:"String"},Value:a}]}}function Ne(e){var t,n,r;return(null===(r=null===(n=null===(t=null==e?void 0:e.EntitySets)||void 0===t?void 0:t[0])||void 0===n?void 0:n.ResultSets)||void 0===r?void 0:r[0])?e.EntitySets[0].ResultSets[0]:null}function Me(e){return e.Source.DateTimeReceived?new Date(e.Source.DateTimeReceived):new Date(e.Source.LastDeliveryTime)}function Le(e){var t=e.filter((function(e){return"Relevance"===e.Source.SortOrderSource}));return t.sort((function(e,t){var n=Me(e);return Me(t)>n?0:-1})),t}function Be(e,t){var n,r,i=[];try{for(var o=Object(a.__values)(e),c=o.next();!c.done;c=o.next()){var u=c.value,s=Fe(u.Source,t);s.InstanceKey=u.ReferenceId,i.push(s)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Ve(e,t){var n,r,i=[];try{for(var o=Object(a.__values)(e),c=o.next();!c.done;c=o.next()){var u=c.value,s=De(u.Source,t);s.InstanceKey=u.ReferenceId,i.push(s)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Ue(e,t){var n,r,i=Ne(e);if(!i||!i.Results||0===i.Results.length)return{SearchResults:{MoreResultsAvailable:!1,TotalResultsCount:0,SearchResultsCount:0,TDQueryId:Pe(null)}};var o=i.Results,c=o.length,u=[],s=[],l=[];switch(e.EntitySets[0].Type){case"Message":case"Messages":if(Object(R.f)("sea-sortTopResults")){var d=Le(o);o.splice(0,d.length),u.push.apply(u,Object(a.__spread)(Be(d,t)))}u.push.apply(u,Object(a.__spread)(Be(o,t)));break;case"Conversation":case"Conversations":if(Object(R.f)("sea-sortTopResults")){d=Le(o);o.splice(0,d.length),s.push.apply(s,Object(a.__spread)(Ve(d,t)))}s.push.apply(s,Object(a.__spread)(Ve(o,t)));break;case"Event":case"Events":try{for(var f=Object(a.__values)(o),h=f.next();!h.done;h=f.next()){var m=h.value,b=Re(m.Source);b.InstanceKey=m.ReferenceId,l.push(b)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}}return{SearchResults:{Items:u.length>0?u:null,Conversations:s.length>0?s:null,CalendarItems:l.length>0?l:null,MoreResultsAvailable:i.MoreResultsAvailable,SearchRefiners:null,TotalResultsCount:i.Total,SearchTerms:e.SearchTerms,SearchResultsCount:c,TDQueryId:Pe(i)}}}function We(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var r;return Object(a.__generator)(this,(function(i){return e?200!==e.status?[2,{Body:{MessageText:He(e,t)}}]:(r=Ue(t,n),[2,{Body:Object(a.__assign)({},r)}]):[2,{Body:{MessageText:"No response received"}}]}))}))}var He=function(e,t){return(null==t?void 0:t.error)?JSON.stringify(t.error):e.statusText},ze=n(1964),qe=n.n(ze),Ge=n(1965),Je=n.n(Ge),Qe=n(155),Xe=n(30),Ye=n(104),Ke=n.n(Ye),Ze=n(95),$e=n.n(Ze),et=n(2),tt="ows/beta/substratesearch/query",nt=2048;function rt(e,t,n,r,a,i){return it(e,t,n,r,ct,a,i)}function at(e,t,n,r,a,i){return it(e,t,n,r,ot,a,i)}function it(e,t,n,r,a,i,o){var c=Ke()(),u=c.headers;u.append("Action","ExecuteSearch"),i&&u.append("X-OWA-ActionSource",i);var s=a("ExecuteSearch",t,e,n,c,o),l=0,d=0;return r&&(l=r.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then((function(){d=r.addCheckmark("ClientJSRequestThread")}))),s?s.then((function(e){var t=e[0],n=e[1],r=[t,n,e[2]];return n.ClientJSPreRequestTime=l,n.ClientJSRequestThreadTime=d,r})):Promise.reject("Client-side issue prevented request from being sent")}function ot(e,t,n,r,i,c){var u=this,s=JSON.stringify(n),l=encodeURIComponent(s),d=!1,f=i.headers;f.append("Content-Type","application/json; charset=utf-8"),i.returnFullResponseOnSuccess=!0,l.length>nt?i.body=s:(d=!0,f.append("X-OWA-UrlPostData",l),i.body=null);var h=function(e,t){var n=Object(Xe.getConfig)(),r=(n.baseUrl?n.baseUrl+"/service.svc?action=":"/owa/service.svc?action=")+e;n.appName&&(r+="&app="+n.appName);t&&(r+="&EP=1");return r+="&id="+Object(o.a)()}(e,d),m=new Date;return $e()("ExecuteSearch",h,1,i).then((function(e){return Object(a.__awaiter)(u,void 0,void 0,(function(){var o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,e.json()];case 1:return o=a.sent(),[2,[o,ut(e,n.Body.Query,200==e.status?null:o?JSON.stringify(o.Body):null,"ExecuteSearch",m,new Date,r,i.headers,t,c),e.url]]}}))}))}))}function ct(e,t,n,r,i,u){var l=this;if(!r)return s.d.error("SearchQueryId must be specified when calling makeExecuteSearchRequest!"),null;var d={};i.headers.forEach((function(e,t){d[t]=e})),d["X-Search-Griffin-Version"]="GWSv2";var f=new Date;return n.Body.SearchSessionId=r,n.Body.Scenario=u,Object(c.d)(tt,n,Object(o.a)(),!0,d).then((function(e){return Object(a.__awaiter)(l,void 0,void 0,(function(){var o;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,e.json()];case 1:return[2,[o=a.sent(),ut(e,n.Body.Query,200==e.status?null:o?JSON.stringify(o.Body):null,"SubstrateSearch",f,new Date,r,i.headers,t,u),e.url]]}}))}))})).catch((function(e){return s.d.warn(e),null}))}var ut=function(e,t,n,r,a,i,o,c,u,s){var l=e.headers||new Headers;return{ClientSearchProvider:r,PageNumber:u,ClientNetworkTime:i.getTime()-a.getTime(),ClientJSEndToEndTime:0,ClientJSPreRequestTime:0,ClientJSRequestThreadTime:0,ClientResponseProcessTime:0,ClientJSRenderingTime:0,SearchDateTime:l.get("date"),SearchBETarget:l.get("x-calculatedbetarget"),SearchFETarget:l.get("x-calculatedfetarget"),SearchBEHttpStatus:l.get("x-backendhttpstatus"),SearchMsEdgeRef:l.get("x-msedge-ref"),SearchErrorContent:n,SearchTraceID:l.get("request-id"),SearchQueryId:o,ClientBuildNumber:Object(et.g)(),ClientTimeSentUTC:a,ClientTimeFinishedUTC:i,ClientHttpStatus:e.status||-1,SearchClientRequestID:c.get("client-request-id"),SearchClientSessionID:Object(et.f)(),ClientName:s,DiagnosticsCheckpoints:l.get("x-ms-diagnostics-checkpoints"),ResourceTimingEntry:null,PIIData:{queryText:t}}};var st=250;function lt(e,t,n,r,i,o,c,u,s,l,f,h,m,p,v,g,O,I,w,S,j){return void 0===h&&(h=0),void 0===m&&(m=!1),void 0===p&&(p=null),void 0===v&&(v=null),void 0===g&&(g=null),void 0===O&&(O=null),void 0===I&&(I=null),void 0===w&&(w=!1),void 0===S&&(S=null),void 0===j&&(j=null),Object(a.__awaiter)(this,void 0,void 0,(function(){var y,_,C,A,x,T,E,P,N,M,L,B,V,U,W,H,z;return Object(a.__generator)(this,(function(q){switch(q.label){case 0:return(y=Object(Qe.getJsonRequestHeader)()).RequestServerVersion="V2016_06_15",_={Header:y,Body:Je()({ApplicationId:"Owa",IdFormat:"EwsId",IncludeDeleted:!Object(R.f)("sea-settings")||!Object(k.a)(256),ItemTypes:c,MaxPreviewLength:60,MaxRefinersCountPerRefinerType:5,MaxResultsCountHint:st,PropertySetName:"Owa16",Query:t,ResultRowCount:e.resultRowCount,ResultRowOffset:e.resultRowOffset,RetrieveRefiners:!1,Scenario:"Calendar"==s?"CalendarSearch":"MailSearch",SearchRefiners:b(m),SearchScope:le(i),SearchRestrictions:D(p,v,g,O),SearchSessionId:n,SortOrder:F(I,h),MaxHybridCountHint:h})},C=qe()(_),A=-1===o?-1:e.pageNumber,"SubstrateSearch"!==l?[3,6]:(x=function(e){var t=e.request,n=e.cvid,r=e.queryIncludesPeopleSuggestion,a=e.pageNumber,i=e.substrateSearchScenario,o=e.actionSource;return{Cvid:n,Scenario:{Name:i},TimeZone:de(t.Header),TextDecorations:"Off",EntityRequests:we(t,r,a,o)}}({request:C,cvid:r,queryIncludesPeopleSuggestion:w,pageNumber:A,substrateSearchScenario:f,actionSource:s}),T=0,E=0,u&&(T=u.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then((function(){E=u.addCheckmark("ClientJSRequestThread")}))),P=new Date,[4,d(x,n,S,[],j)]);case 1:return N=q.sent(),M=new Date,N&&2==N.length?(L=Object(a.__read)(N,2),B=L[0],V=L[1],U=null,(null==B?void 0:B.json)?[4,B.json().catch((function(e){return[e]}))]:[3,3]):[2,null];case 2:U=q.sent(),q.label=3;case 3:return[4,We(B,U,x)];case 4:return W=q.sent(),[4,je(B,U,W.Body)];case 5:return H=q.sent(),(z=ut(B,C.Body.Query,200==B.status?null:W?JSON.stringify(W.Body):null,"SubstrateSearch",P,M,r,new Headers(V),e.pageNumber,f)).ClientJSPreRequestTime=T,z.ClientJSRequestThreadTime=E,[2,[H,z,B.url]];case 6:return[2,("ExecuteSearch"===l?at:rt)(C,e.pageNumber,r,u,s,f).then((function(e){return[e[0].Body,e[1],e[2]]})).catch((function(e){return null}))]}}))}))}function dt(e,t,n,r,a,o){var u={cvid:n,query:encodeURIComponent(e),textdecorations:"1",scenario:a,entityTypes:r},l=Object(i.a)(u);return t?Object(c.b)(Object(jt.a)("suggestions")+"?"+l,void 0,!0,o,void 0,!1).then((function(e){return e})).catch((function(e){return s.d.warn(e),null})):Promise.resolve(null)}var ft=n(1966),ht=n.n(ft),mt=n(1967),bt=n.n(mt);function pt(e,t){return bt()({Header:Object(Qe.getJsonRequestHeader)(),Body:ht()({SearchSessionId:e,WarmupOptions:16777215,SuggestionTypes:1,SearchScope:le(t),IdFormat:"EwsId",ApplicationId:"Owa"})}).then((function(e){return e.Body}))}var vt=n(1968),gt=n.n(vt),Ot=n(1969),It=n.n(Ot);function wt(e){return It()({Header:Object(Qe.getJsonRequestHeader)(),Body:gt()({SearchSessionId:e})}).then((function(e){return e.Body}))}function St(e,t){return!(!e||!t)&&ue(e)===ue(t)}var jt=n(1545);function yt(e){return Object(a.__assign)({},e)}function _t(e){return Object(a.__assign)({},e)}function Ct(e){return Object(a.__assign)({},e)}function At(e){return Object(a.__assign)({},e)}function xt(e){return Object(a.__assign)({},e)}var Tt,Et,Pt,Dt=n(1626),kt=n(93),Rt=[{resultRowOffset:0,resultRowCount:25,pageNumber:0},{resultRowOffset:25,resultRowCount:50,pageNumber:1},{resultRowOffset:75,resultRowCount:75,pageNumber:2},{resultRowOffset:150,resultRowCount:100,pageNumber:3},{resultRowOffset:250,resultRowCount:200,pageNumber:4},{resultRowOffset:450,resultRowCount:200,pageNumber:5},{resultRowOffset:650,resultRowCount:200,pageNumber:6},{resultRowOffset:850,resultRowCount:200,pageNumber:7}],Ft=Object(kt.select)({pageContexts:function(){return Rt}})((function(e,t){if(e<0||e>=t.pageContexts.length)throw new Error("The pageNumber for execute search is invalid:"+e);return t.pageContexts[e]})),Nt=Object(kt.select)({pageContexts:function(){return Rt}})((function(e,t,n,r){var a=e.pageNumber+1,i="PrimaryMailbox"===n&&Object(R.f)("sea-fetchOnScroll1")?2:4;return t.MoreResultsAvailable&&a<i?Ft(a,r):null})),Mt=function(e){switch(e){case 74:return Rt[2];case 149:return Rt[3];case 249:return Rt[4];case 449:return Rt[5];case 649:return Rt[6];case 849:return Rt[7];default:return null}};!function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(Tt||(Tt={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData"}(Et||(Et={})),function(e){e.Mail="owa.react",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.MailAdvancedSearch="owa.react.mail.advancedSearch",e.SuggestedAttachments="suggestedattachments"}(Pt||(Pt={}));var Lt=Pt,Bt=n(1612);n.d(t,"B",(function(){return Ut})),n.d(t,"C",(function(){return Wt})),n.d(t,"x",(function(){return Ht})),n.d(t,"A",(function(){return zt})),n.d(t,"D",(function(){return qt})),n.d(t,"y",(function(){return Gt})),n.d(t,"z",(function(){return Jt})),n.d(t,"l",(function(){return lt})),n.d(t,"I",(function(){return d})),n.d(t,"J",(function(){return dt})),n.d(t,"m",(function(){return pt})),n.d(t,"k",(function(){return wt})),n.d(t,"e",(function(){return St})),n.d(t,"n",(function(){return ue})),n.d(t,"u",(function(){return se})),n.d(t,"v",(function(){return jt.a})),n.d(t,"s",(function(){return D})),n.d(t,"E",(function(){return yt})),n.d(t,"c",(function(){return _t})),n.d(t,"G",(function(){return Ct})),n.d(t,"H",(function(){return At})),n.d(t,"F",(function(){return xt})),n.d(t,"o",(function(){return Dt.a})),n.d(t,"q",(function(){return Ft})),n.d(t,"p",(function(){return Nt})),n.d(t,"r",(function(){return Mt})),n.d(t,"g",(function(){return Re})),n.d(t,"f",(function(){return De})),n.d(t,"h",(function(){return Fe})),n.d(t,"i",(function(){return fe})),n.d(t,"j",(function(){return pe})),n.d(t,"t",(function(){return Ne})),n.d(t,"w",(function(){return de})),n.d(t,"d",(function(){return ut})),n.d(t,"a",(function(){return Lt})),n.d(t,"b",(function(){return Bt.a}));var Vt=new r.c((function(){return Promise.all([n.e(7),n.e(472)]).then(n.bind(null,14042))})),Ut=new r.a(Vt,(function(e){return e.logLocalContentDataSource})),Wt=new r.a(Vt,(function(e){return e.logLocalContentLayout})),Ht=new r.a(Vt,(function(e){return e.clearLocalContentInstrumentationCache})),zt=new r.b(Vt,(function(e){return e.getLocalContentId})),qt=new r.b(Vt,(function(e){return e.substrateSearchInitOperation})),Gt=new r.b(Vt,(function(e){return e.deleteSubstrateSearchHistoryService})),Jt=new r.b(Vt,(function(e){return e.exportSubstrateSearchHistoryService}))},866:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc"}(r||(r={}))},868:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"a",(function(){return h})),n.d(t,"g",(function(){return m}));var r=n(4),a=Object(r.action)("GET_ARCHIVE_FOLDERS",(function(e,t){return{source:e,isLoadingMore:t}})),i=Object(r.action)("INITIALIZE_ARCHIVE_FOLDER_TREE_FROM_SESSIONDATA"),o=Object(r.action)("GET_FOLDER_PERMISSIONS",(function(e){return{folderId:e}})),c=Object(r.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),u=Object(r.action)("GET_FOLDER_PERMISSIONS_FAILED"),s=Object(r.action)("UPDATE_FOLDER_PERMISSIONS",(function(e,t){return{folderId:e,permissions:t}})),l=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",(function(e,t){return{folderId:e,permissions:t}})),d=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),f=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),h=Object(r.action)("ADD_NEW_FOLDER_TO_STORE",(function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}})),m=Object(r.action)("ON_CREATE_NEW_FOLDER_INBOX_RULES_RESPONSE",(function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}}))},8709:function(e,t,n){"use strict";var r=n(4570),a=n(3366),i=n(6416),o=n(6968),c=n(8414),u=n(4705),s=n(8),l=n(221),d=n(37),f=n(857),h=n(44),m=n(8415);function b(e){return Object(d.f)("woven-saveToCloud2-viewInOneDrive")?Object(s.a)(m.f):Object(d.f)("woven-saveToCloud2-editInOneDrive")?Object(s.a)(m.b):Object(d.f)("woven-saveToCloud2-editInApp")||Object(d.f)("woven-newTabExperiment")?function(e){var t=Object(f.b)(e)||"",n=Object(f.e)(t);if(null===n)return h.d.error("invalid office app for save to cloud experiment string"),Object(s.a)(m.b);switch(n){case f.a.Word:return Object(s.a)(m.d);case f.a.Excel:return Object(s.a)(m.a);case f.a.PowerPoint:return Object(s.a)(m.c);default:return Object(l.a)(n)}}(e):Object(d.f)("woven-saveToCloud2-editOnline")?Object(s.a)(m.e):Object(d.f)("woven-saveToCloud2-openFolder")?Object(s.a)(m.f):Object(s.a)(m.e)}var p=n(5);function v(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.info)||void 0===t?void 0:t.sharingInfo)||void 0===n?void 0:n.expirationDate)&&Object(p.Gb)(e.info.sharingInfo.expirationDate,Object(p.Pb)())}var g=n(919),O=n(78),I=n(208),w=n(6663);function S(e,t,n,r){return void 0===r&&(r=""),t?Object(s.a)(c.h):n?b(r):Object(s.b)(Object(s.a)(c.i),e?Object(s.a)(o.a):Object(s.a)(u.a))}function j(e,t,n,f){var h;void 0===f&&(f="");var m,b=Object(I.a)(),p=(null===(h=t.id.mailboxInfo)||void 0===h?void 0:h.type)==O.a.GroupMailbox;if(0===e.actionMessage)return function(e,t){var n=Object(w.b)(e,t);return{text:n.text,title:n.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(d.f)("doc-attachment-referenceAttachmentExpiration")&&v(t)}}(e,t);var j=!1,y=!1;switch(e.actionMessage){case 1:m=function(e,t){if(t)return Object(s.a)(c.k);var n=Object(g.f)();return e?Object(s.b)(Object(s.a)(c.l),Object(s.a)(o.a)):Object(s.b)(Object(s.a)(c.m),n)}(b,p);break;case 5:m=Object(s.a)(c.b);break;case 2:m=S(b,p,n,f);break;case 3:m=S(b,p,n,f),j=!0;break;case 4:case 9:m=function(e,t){return t?Object(s.a)(c.f):Object(s.b)(Object(s.a)(c.g),e?Object(s.a)(o.a):Object(s.a)(u.a))}(b,p),y=!0;break;case 7:m=Object(s.a)(c.n);break;case 6:m=Object(s.a)(c.d);break;case 8:m=function(e,t){if(t)return Object(s.a)(c.o);var n=Object(g.f)();return e?Object(s.b)(Object(s.a)(c.p),n,Object(s.a)(o.a)):Object(s.b)(Object(s.a)(c.q),n)}(b,p);break;case 10:m=Object(s.a)(c.c);break;case 11:m=Object(s.a)(c.a);break;case 12:m=Object(s.a)(c.e),y=!0;break;case 16:m=Object(s.a)(c.c);break;case 14:m=Object(s.a)(i.a),j=!0;break;case 15:m=Object(s.a)(a.a),y=!0;break;case 13:m=Object(s.a)(r.a);break;case 17:m=Object(s.a)(c.n);break;case 18:m=Object(s.a)(c.j);break;default:Object(l.a)(e.actionMessage)}return{text:m,title:m,shouldDisplaySuccessIcon:j,shouldDisplayFailureIcon:y,useExpiredAttachmentStyling:!1}}n.d(t,"a",(function(){return j}))},8746:function(e,t,n){"use strict";var r=n(0),a=n(914),i=n(44);function o(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,c,u,s,l,d,f,h,m,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=[],[4,a.i.import()];case 1:return o=r.sent(),[4,a.l.import()];case 2:return c=r.sent(),t?[4,a.o.import()]:[3,4];case 3:return s=r.sent(),[3,5];case 4:s=null,r.label=5;case 5:u=s,l=t?e.docViewAttachments:e.imageViewAttachments,d=0,r.label=6;case 6:if(!(d<l.length))return[3,12];if(f=l[d],h=o(f.attachmentId),t&&!u(h.model))return[3,11];r.label=7;case 7:return r.trys.push([7,9,,10]),[4,c(f.attachmentId,e.isReadOnly)];case 8:return r.sent(),[3,10];case 9:return m=r.sent(),i.d.warn("Unable to refresh thumbnail image for "+f.attachmentId+". Got error "+m),[3,10];case 10:b={downloadUrl:h.download.url,id:f.attachmentId,previewUrl:h.previewImage.url,thumbnailUrl:h.thumbnailImage.url},n.push(b),r.label=11;case 11:return d++,[3,6];case 12:return[2,n]}}))}))}n.d(t,"a",(function(){return o}))},876:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(964);function a(e){return Object(r.a)().attachments.get(e.Id)}},883:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"n",(function(){return o})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"o",(function(){return p})),n.d(t,"p",(function(){return v})),n.d(t,"q",(function(){return g})),n.d(t,"a",(function(){return O}));var r="FileAttachment:#Exchange",a="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange",u="Box",s="Dropbox",l="Facebook",d="GDrive",f="Mailbox",h="MailMessage",m="OneDriveConsumer",b="OneDrivePro",p="WopiBox",v="WopiDropbox",g="WopiEgnyte",O={providers:{BOX:u,DROPBOX:s,FACEBOOK:l,GDRIVE:d,MAILBOX:f,ONE_DRIVE_CONSUMER:m,ONE_DRIVE_PRO:b,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:p,WOPI_EGNYTE:g},attachmentTypes:{FILE_ATTACHMENT_TYPE:r,ITEM_ATTACHMENT_TYPE:a,ITEM_ID_ATTACHMENT_TYPE:i,REFERENCE_ATTACHMENT_TYPE:o,LINK_ATTACHMENT_TYPE:c}}},885:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return I})),n.d(t,"s",(function(){return w})),n.d(t,"t",(function(){return S})),n.d(t,"u",(function(){return j})),n.d(t,"v",(function(){return y})),n.d(t,"w",(function(){return _})),n.d(t,"l",(function(){return C})),n.d(t,"m",(function(){return A}));var r=n(4),a=n(74),i=Object(r.action)("ADD_SUGGESTION_PILL_INTERNAL",(function(e,t){return{suggestionPill:e,scenarioId:t}})),o=Object(r.action)("INITIALIZE_SCENARIO_STORE",(function(e,t){return{scenarioId:e,isUsing3S:t}})),c=Object(r.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",(function(e,t){return{cursorPosition:e,scenarioId:t}})),u=Object(r.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",(function(e){return{scenarioId:e}})),s=Object(r.action)("ON_ENTER_PRESSED_SEARCH_INPUT",(function(e,t){return{selectedSuggestionIndex:e,scenarioId:t}})),l=Object(r.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",(function(e){return{scenarioId:e}})),d=Object(r.action)("ON_KEY_DOWN_SEARCH_INPUT",(function(e,t){return{evtKeyCode:e,scenarioId:t}})),f=Object(r.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",(function(e,t){return{cursorPosition:e,scenarioId:t}})),h=Object(r.action)("ON_RESIZE_SUGGESTIONSCALLOUT",(function(e,t){return{searchBoxWidth:e,scenarioId:t}})),m=Object(r.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",(function(e){return{scenarioId:e}})),b=Object(r.action)("ON_SEARCH_INPUT_FOCUSED",(function(e){return Object(a.c)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e})})),p=Object(r.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",(function(e){return{scenarioId:e}})),v=(Object(r.action)("REMOVE_PARAMETER_PILL_FROM_STORE",(function(e){return{scenarioId:e}})),Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",(function(e,t,n){return{suggestionPillId:e,scenarioId:t,actionSource:n}}))),g=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",(function(e,t,n){return{suggestionPillId:e,suggestionPillIndex:t,scenarioId:n}})),O=Object(r.action)("RESET_SEARCH_STORE",(function(e){return{scenarioId:e}})),I=Object(r.action)("SET_SEARCH_TEXT",(function(e,t){return{searchText:e,scenarioId:t}})),w=Object(r.action)("SET_SELECTED_PILL_INDEX",(function(e,t){return{selectedPillIndex:e,scenarioId:t}})),S=Object(r.action)("SET_SELECTED_SUGGESTION_INDEX",(function(e,t){return{selectedSuggestionIndex:e,scenarioId:t}})),j=Object(r.action)("SET_SUGGESTION_PILL_IDS",(function(e,t){return{suggestionPillIds:e,scenarioId:t}})),y=Object(r.action)("SET_SUGGESTION_PILLS",(function(e,t){return{suggestionPills:e,scenarioId:t}})),_=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",(function(e,t){return{isComplete:e,scenarioId:t}})),C=Object(r.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",(function(e){return{scenarioId:e}})),A=Object(r.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",(function(e){return{scenarioId:e}}))},889:function(e,t,n){"use strict";var r;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(r||(r={})),t.a=r},896:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(73),a=n(1032);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(185)]).then(n.bind(null,2016))})),o=new r.b(i,(function(e){return e.confirmAction}));function c(e,t,n,r){return o.import().then((function(a){return a(e,t,n,r)}))}},908:function(e,t,n){"use strict";var r=n(73),a=n(844),i=n(4),o=n(834);Object(i.mutator)(o.n,(function(e){var t=e.suggestionSet;Object(a.a)(e.scenarioId).currentSuggestions=t}));var c=n(0),u=n(1641),s=n(940),l=n(885);Object(i.mutator)(l.b,(function(e){var t=Object(u.a)(e.scenarioId);Object(s.b)().scenarioStores.get(t)||(Object(s.b)().scenarioStores.set(t,Object(c.__assign)({},Object(s.a)())),Object(s.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)})),Object(i.mutator)(o.p,(function(e){Object(a.a)(e.scenarioId).isSuggestionsDropdownVisible=e.isSuggestionsDropdownVisible}));Object(i.mutator)(l.r,(function(e){Object(a.a)(e.scenarioId).searchText=e.searchText})),Object(i.mutator)(l.a,(function(e){var t=Object(a.a)(e.scenarioId),n=e.suggestionPill,r=n.ReferenceId;t.suggestionPills.set(r,n),t.suggestionPillIds.push(r)})),Object(i.mutator)(o.q,(function(e){var t=Object(a.a)(e.scenarioId),n=e.latestTraceId;t.latestTraceId=n,e.isQFTraceId&&(t.latestQFTraceId=n)}));Object(i.mutator)(l.k,(function(e){Object(a.a)(e.scenarioId).searchBoxHasFocus=!0})),Object(i.mutator)(o.k,(function(e){Object(a.a)(e.scenarioId).searchBoxHasFocus=!1}));Object(i.mutator)(o.r,(function(e){Object(a.a)(e.scenarioId).searchTextForSuggestion=e.searchTextForSuggestion}));var d=Object(i.mutatorAction)("setLatestRenderedQFTraceId",(function(e,t){Object(a.a)(t).latestRenderedQFTraceId=e})),f=n(864),h=n(1212),m=n(1163),b=(Object(i.orchestrator)(o.e,(function(e){var t=e.scenarioId;h.a.importAndExecute(Object(m.a)(t)),f.x.importAndExecute()})),Object(i.mutator)(o.u,(function(e){Object(a.a)(e.scenarioId).queryActionSource=e.actionSource})),Object(i.orchestrator)(l.k,(function(e){var t=e.scenarioId,n=Object(a.a)(t),r=n.searchSessionGuid,i=n.searchText,c=n.searchTextForSuggestion;if(Object(o.p)(!0,t),r){if(i&&i===c)return;Object(o.r)(i,t),Object(o.h)(t)}else Object(o.v)("SearchBox",!1,t)})),n(1295));Object(i.orchestrator)(l.e,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r;return Object(c.__generator)(this,(function(i){return t=e.scenarioId,n=e.selectedSuggestionIndex,r=Object(a.a)(t),n!==Object(s.a)().selectedSuggestionIndex?(Object(o.x)(r.currentSuggestions.Suggestions[n],"keyboard",t,r.currentSuggestions.TraceId,n),r.searchText||(Object(o.i)("",t),Object(o.r)("",t))):Object(b.a)(t)||Object(o.u)("Keyboard",t,!0),Object(o.p)(!1,t),[2]}))}))})),Object(i.orchestrator)(o.i,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(c.__generator)(this,(function(r){return t=e.scenarioId,n=e.searchText,Object(l.r)(n,t),[2]}))}))}));var p=n(1758),v=Object(i.mutatorAction)("setSearchSessionGuid",(function(e,t){Object(a.a)(t).searchSessionGuid=e})),g=n(452),O=n(193),I=n(968),w=(Object(i.orchestrator)(o.v,(function(e){var t=e.actionSource,n=e.shouldStartSearch,r=e.scenarioId,i=Object(a.a)(r);if(i.searchSessionGuid)throw new Error("searchSessionGuid should not be set when starting a search session.");var c=Object(g.a)();v(c,r),Object(p.a)(Object(g.a)(),r),i.isUsing3S&&f.D.import().then((function(e){e(i.nextSearchQueryId,Object(m.a)(r),"",1)})),Object(o.m)(t,n,r),$.import(),ee.import(),ge.import(),ie.import(),le.import(),Object(O.o)("Search_SessionStarted",[I.b[r],t])})),n(2126));Object(i.orchestrator)(o.j,(function(e){Object(w.b)(e.scenarioId,e.callback)}));Object(i.orchestrator)(o.a,(function(e){var t=e.scenarioId,n=e.suggestionPill;n&&(function(e,t){var n=Object(a.a)(t);switch(e.kind){case f.b.People:return Object(c.__spread)(n.suggestionPills.values()).filter((function(t){var n,r,a,i;if(t.kind!==f.b.People)return!1;try{for(var o=Object(c.__values)(e.EmailAddresses),u=o.next();!u.done;u=o.next()){var s=u.value;try{for(var l=(a=void 0,Object(c.__values)(t.EmailAddresses)),d=l.next();!d.done;d=l.next()){if(s===d.value)return!0}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1})).length>0;case f.b.Category:return n.suggestionPillIds.indexOf(e.ReferenceId)>-1;default:return!1}}(n,t)||Object(l.a)(n,t),e.suggestionSelected&&(Object(o.i)("",t),Object(o.r)("",t)))})),Object(i.mutator)(o.e,(function(e){var t=Object(a.a)(e.scenarioId),n=Object(s.a)();t.latestQFRequestId=n.latestQFRequestId,t.searchTextForSuggestion=n.searchTextForSuggestion,t.currentSuggestions=n.currentSuggestions,t.selectedSuggestionIndex=n.selectedSuggestionIndex}));function S(e){var t=Object(a.a)(I.b.Mail).suggestionPills,n=e.SearchTerms;return t.forEach((function(e){switch(e.kind){case f.b.People:var t=e,r=t.DisplayName.toLowerCase().split(" ");j(n,r),j(n,t.EmailAddresses);break;case f.b.Category:var a=e.Name.toLowerCase().split(" ");j(n,a)}})),n}function j(e,t){t.forEach((function(t){!function(e,t){for(var n=-1,r=0;r<e.length;r++)0==e[r].localeCompare(t,"en",{sensitivity:"base",ignorePunctuation:!0})&&(n=r);n>-1&&e.splice(n,1)}(e,t)}))}var y=n(928),_=n(2173),C=n(1613),A=n(8),x=n(25),T=n(466),E=n(1),P=n(2078),D=n(410),k=n(2174),R=Object(x.a)((function(e,t){var n=this,r=E.useRef(),i=Object(T.a)((function(){return Object(a.a)(e.scenarioId).searchText})),u=Object(T.a)((function(){var t=e.isSuggestionsCalloutVisible,n=e.scenarioId,r=Object(a.a)(n).selectedSuggestionIndex;return t&&r>=0?""+y.q+r:""}));E.useImperativeHandle(t,(function(){return{setFocus:function(){r.current&&r.current.focus()}}}),[]);var s=function(){return r.current?r.current.selectionStart!==r.current.selectionEnd?-1:r.current.selectionStart:-1},d=function(){var e=r.current.value.length;r.current.setSelectionRange(e,e)},f=e.scenarioId,h=e.searchPlaceHolderText,m=e.isDisabled,b=e.isSuggestionsCalloutVisible,p=!!Object(a.a)(e.scenarioId).searchSessionGuid,v=D(k.searchBoxInput,m&&k.isDisabled,p?k.inSearchinputPlaceholder:k.inputPlaceholder),g=Object(P.a)(f,h),O=g.ariaLabel,I=g.placeholder;return E.createElement("div",{className:k.searchBoxInputContainer},E.createElement("input",{"aria-activedescendant":u.get(),"aria-autocomplete":"list","aria-label":O,"aria-owns":b?y.p:"",autoComplete:"off",className:v,disabled:m,onChange:function(){var t=e.scenarioId,n=r.current.value;Object(o.i)(n,t),Object(o.r)(n,t),Object(o.h)(t),Object(a.a)(t).isSuggestionsDropdownVisible||Object(o.p)(!0,t)},onClick:function(t){t.stopPropagation(),Object(o.p)(!0,e.scenarioId)},onFocus:function(t){var n=t.relatedTarget;n||(n=document.activeElement),n.id.indexOf(y.q)>-1||(Object(o.p)(!0,e.scenarioId),Object(l.k)(e.scenarioId))},onKeyDown:function(t){return Object(c.__awaiter)(n,void 0,void 0,(function(){var n,r,i;return Object(c.__generator)(this,(function(o){switch(o.label){case 0:switch(t.stopPropagation(),n=t.keyCode,r=e.scenarioId,i=Object(a.a)(r).selectedSuggestionIndex,Object(l.g)(n,e.scenarioId),n){case 13:return[3,1];case 8:return[3,2];case 38:return[3,4];case 40:return[3,6];case 37:return[3,8];case 27:return[3,10]}return[3,11];case 1:return d(),Object(l.e)(i,r),[3,12];case 2:return[4,ne.import()];case 3:return o.sent()(s(),r),[3,12];case 4:return t.preventDefault(),[4,ae.import()];case 5:return o.sent()(r),[3,12];case 6:return[4,te.import()];case 7:return o.sent()(r),[3,12];case 8:return[4,re.import()];case 9:return o.sent()(s(),r),[3,12];case 10:return t.preventDefault(),Object(l.f)(r),[3,12];case 11:return[3,12];case 12:return[2]}}))}))},placeholder:I,ref:function(e){return r.current=e},value:i.get(),spellCheck:!1,autoCorrect:"off"}))}),{forwardRef:!0}),F=n(2079);function N(e,t){return e?y.c:t||y.b}var M=n(12),L=n(453),B=n(486),V=n(343),U=n(216),W=n(178),H=n(42),z=n(37),q=n(867),G=n(410),J=n(2176),Q="LPCPseudoTabbableElement",X=function(e){function t(t){var n=e.call(this,t)||this;n.onExitClick=function(){n.onExit("SearchBoxBackArrow")},n.isInActiveSearchSession=function(){return!!Object(a.a)(n.props.scenarioId).searchSessionGuid},n.onCompactSearchButtonClick=function(){Object(o.v)("SearchCollapsedButton",!1,n.props.scenarioId)},n.onSearchFolderScopeSelected=function(){return Object(c.__awaiter)(n,void 0,void 0,(function(){return Object(c.__generator)(this,(function(e){switch(e.label){case 0:return this.searchInput?[4,ge.import()]:[3,2];case 1:e.sent()(I.a.Mail)&&this.searchInput.setFocus(),e.label=2;case 2:return[2]}}))}))},n.focusSearchInput=function(){Object(a.a)(n.props.scenarioId).showSearchBoxInCompactMode&&!n.isInActiveSearchSession()?Object(o.v)("Keyboard",!1,n.props.scenarioId):n.searchInput.setFocus()},n.onSearchBoxClick=function(e){e.stopPropagation(),n.focusSearchInput()},n.onExit=function(e){Object(o.g)(e,n.props.scenarioId,Object(z.f)("sea-nextSearchBoxInteractions"))},n.onSearchBoxBlur=function(e){var t=e.relatedTarget;t||(t=document.activeElement),Object(W.a)(n.searchBoxContainer,t)||t.id==Q||t.id===y.f||t.id===y.g||t.firstElementChild&&t.firstElementChild.id===y.k||(Object(o.p)(!1,n.props.scenarioId),Object(o.k)(n.props.scenarioId))},n.onRemovePill=function(e){return Object(c.__awaiter)(n,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return[4,ie.import()];case 1:return t.sent()(e,this.props.scenarioId,"Click"),[2]}}))}))},n.onClearSearchBoxClicked=function(e){var t=n.props.scenarioId;e.stopPropagation(),Object(o.c)(t),n.focusSearchInput(),Object(O.o)("Search_ClearSearchBoxButtonClicked",[I.a[t]])},n.onClearSearchBoxClickedKeyDown=function(e){e.keyCode!==H.a.enter&&e.keyCode!==H.a.space||n.onClearSearchBoxClicked(e)};var r=t.isUsing3S,i=void 0===r||r;return Object(l.b)(t.scenarioId,i),n}return Object(c.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.isInActiveSearchSession();this.props.showCompactSearchBox==e.showCompactSearchBox&&t&&!this.previousSearchActiveValue&&this.focusSearchInput(),this.previousSearchActiveValue=t},Object.defineProperty(t.prototype,"isSuggestionsCalloutVisible",{get:function(){var e=Object(a.a)(this.props.scenarioId),t=e.isSuggestionsDropdownVisible,n=e.currentSuggestions;return!this.props.isSuggestCalloutDisabled&&n&&n.Suggestions&&n.Suggestions.length>0&&t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchBoxButtonProps",{get:function(){var e=this;return Object(a.a)(this.props.scenarioId).searchBoxHasFocus?{ariaLabel:Object(A.a)(C.a),iconProps:{iconName:"Forward"},onClick:this.onSearchButtonClicked(),title:Object(A.a)(C.a)}:{ariaLabel:Object(A.a)(_.b),iconProps:{iconName:"Clear"},onClick:function(){return e.onExit("SearchBoxXButton")},title:Object(A.a)(_.b)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchGlyphClasses",{get:function(){return Object(z.f)("sea-nextSearchBoxInteractions")?G(Object(a.a)(this.props.scenarioId).searchSessionGuid?J.searchIconFocused:J.searchIconRest,this.props.isDisabled&&J.isDisabled):G(J.searchIcon,this.props.isDisabled&&J.isDisabled)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClearSearchBoxButtonVisible",{get:function(){return!!Object(z.f)("sea-searchBoxInteractionsClear")&&!Object(b.a)(this.props.scenarioId)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.isDisabled,r=t.scenarioId,i=Object(a.a)(r).showSearchBoxInCompactMode,o=this.isInActiveSearchSession(),u={maxWidth:N(o,this.props.customCollapsedMaxWidth)+"px",width:"100%"},s=G(J.searchBoxCommonContainer,i&&J.isInCompactMode,o&&J.searchBoxContainerInSearch),l=G(J.searchBoxContainer,Object(z.f)("sea-folderScope")&&o&&J.searchBoxContainerNoBorderRadius,o&&J.searchBoxContainerInSearch,i&&J.isInCompactMode);if(i&&!o)return E.createElement("div",{role:"search",className:l,ref:function(t){return e.searchBoxContainer=t}},E.createElement(me,{onClick:this.onCompactSearchButtonClick}));var d=G(J.searchBox,n&&J.isDisabled),f=this.searchGlyphClasses,h=this.isSuggestionsCalloutVisible?E.createElement(he,{scenarioId:r,focusSearchInput:this.focusSearchInput}):null,m={role:q.a.button,label:Object(A.a)(_.a)},b=G(J.searchBoxColumnContainer,i&&J.isInCompactMode);return E.createElement("div",{style:u,className:s},E.createElement("div",{className:b},E.createElement("div",{role:"search",tabIndex:-1,className:l,ref:function(t){return e.searchBoxContainer=t},"aria-expanded":this.isSuggestionsCalloutVisible,onBlur:this.onSearchBoxBlur},E.createElement("div",{id:y.k,className:d},h,o&&!Object(z.f)("sea-nextSearchBoxInteractions")?E.createElement(B.a,{className:G(Object(z.f)("sea-colors")?J.backButtonNeutral:J.backButton,"flipForRtl"),iconProps:{iconName:"Back"},onClick:this.onExitClick,ariaLabel:Object(A.a)(_.b)}):E.createElement("div",{"aria-hidden":!0,className:f,onClick:this.onSearchBoxClick},E.createElement(U.a,{iconName:"Search"})),E.createElement("div",{className:J.searchQueryContainer,onClick:this.onSearchBoxClick},Object(F.a)(this.props.scenarioId)&&E.createElement(fe,{focusSearchInput:this.focusSearchInput,onRemovePill:this.onRemovePill,scenarioId:this.props.scenarioId}),E.createElement(R,{ref:function(t){return e.searchInput=t},searchPlaceHolderText:this.props.searchPlaceHolderText,isDisabled:this.props.isDisabled,scenarioId:this.props.scenarioId,isSuggestionsCalloutVisible:this.isSuggestionsCalloutVisible})),this.isClearSearchBoxButtonVisible&&E.createElement("div",Object(c.__assign)({className:J.clearBoxButton,onClick:this.onClearSearchBoxClicked,onKeyDown:this.onClearSearchBoxClickedKeyDown,tabIndex:0,title:Object(A.a)(_.a)},Object(q.b)(m)),E.createElement(U.a,{iconName:"Clear",styles:{root:{fontSize:"8px"}}})),o&&this.props.renderRefiners&&E.createElement("div",{tabIndex:-1},this.props.renderRefiners()),o&&Object(z.f)("sea-nextSearchBoxInteractions")&&E.createElement(V.a,Object(c.__assign)({className:J.searchBoxButton,styles:{icon:{fontSize:"16px"}}},this.searchBoxButtonProps))),o&&!Object(z.f)("sea-nextSearchBoxInteractions")&&E.createElement(B.a,{className:Object(z.f)("sea-colors")?J.searchButtonNeutral:J.searchButton,iconProps:{iconName:"Search"},onClick:this.onSearchButtonClicked(),ariaLabel:Object(A.a)(C.a)})),E.createElement("div",{id:y.j})))},t.prototype.onSearchButtonClicked=function(){var e=this;return function(t){return Object(c.__awaiter)(e,void 0,void 0,(function(){var e;return Object(c.__generator)(this,(function(n){switch(n.label){case 0:return t.stopPropagation(),e=this.props.scenarioId,[4,ge.import()];case 1:return n.sent()(e)?this.focusSearchInput():(Object(o.p)(!1,this.props.scenarioId),Object(o.u)("SearchButton",e,!0)),[2]}}))}))}},Object(c.__decorate)([M.computed],t.prototype,"isSuggestionsCalloutVisible",null),Object(c.__decorate)([M.computed],t.prototype,"searchBoxButtonProps",null),Object(c.__decorate)([M.computed],t.prototype,"searchGlyphClasses",null),Object(c.__decorate)([M.computed],t.prototype,"isClearSearchBoxButtonVisible",null),t=Object(c.__decorate)([L.observer],t)}(E.Component),Y=n(1627);function K(e){var t=Object(a.a)(e).suggestionPills;return!(!t||0===t.size)&&Object(c.__spread)(t.values()).filter((function(e){return e.kind===f.b.People})).length>0}n.d(t,"t",(function(){return $})),n.d(t,"u",(function(){return ee})),n.d(t,"A",(function(){return te})),n.d(t,"z",(function(){return ne})),n.d(t,"B",(function(){return re})),n.d(t,"C",(function(){return ae})),n.d(t,"D",(function(){return ie})),n.d(t,"F",(function(){return oe})),n.d(t,"E",(function(){return ce})),n.d(t,"I",(function(){return ue})),n.d(t,"G",(function(){return se})),n.d(t,"H",(function(){return le})),n.d(t,"e",(function(){return de})),n.d(t,"f",(function(){return fe})),n.d(t,"h",(function(){return he})),n.d(t,"a",(function(){return me})),n.d(t,"v",(function(){return be})),n.d(t,"w",(function(){return pe})),n.d(t,"x",(function(){return ve})),n.d(t,"y",(function(){return ge})),n.d(t,"R",(function(){return d})),n.d(t,"o",(function(){return S})),n.d(t,"p",(function(){return a.a})),n.d(t,"c",(function(){return y.n})),n.d(t,"b",(function(){return y.d})),n.d(t,"g",(function(){return I.b})),n.d(t,"i",(function(){return o.a})),n.d(t,"j",(function(){return o.c})),n.d(t,"k",(function(){return o.d})),n.d(t,"n",(function(){return o.g})),n.d(t,"s",(function(){return o.h})),n.d(t,"M",(function(){return o.k})),n.d(t,"N",(function(){return o.l})),n.d(t,"O",(function(){return o.m})),n.d(t,"P",(function(){return o.n})),n.d(t,"Q",(function(){return o.o})),n.d(t,"U",(function(){return o.t})),n.d(t,"V",(function(){return o.u})),n.d(t,"S",(function(){return o.q})),n.d(t,"Y",(function(){return o.x})),n.d(t,"X",(function(){return o.w})),n.d(t,"J",(function(){return o.i})),n.d(t,"W",(function(){return o.v})),n.d(t,"m",(function(){return o.f})),n.d(t,"L",(function(){return o.j})),n.d(t,"T",(function(){return o.r})),n.d(t,"l",(function(){return o.e})),n.d(t,"r",(function(){return m.a})),n.d(t,"d",(function(){return X})),n.d(t,"q",(function(){return Y.a})),n.d(t,"K",(function(){return K}));var Z=new r.c((function(){return Promise.all([n.e(5),n.e(9),n.e(12),n.e(653),n.e(463)]).then(n.bind(null,13818))})),$=new r.b(Z,(function(e){return e.clearSearchBox})),ee=new r.b(Z,(function(e){return e.endSearchSession})),te=new r.b(Z,(function(e){return e.onDownArrowPressedSearchInput})),ne=new r.b(Z,(function(e){return e.onBackspacePressedSearchInput})),re=new r.b(Z,(function(e){return e.onLeftArrowPressedSearchInput})),ae=(new r.b(Z,(function(e){return e.onRightArrowPressedSearchInput})),new r.b(Z,(function(e){return e.onUpArrowPressedSearchInput}))),ie=new r.b(Z,(function(e){return e.removeSuggestionPillFromSearchBox})),oe=new r.b(Z,(function(e){return e.setLatestQFRequestId})),ce=new r.b(Z,(function(e){return e.setIsSuggestionsDropdownVisible})),ue=new r.b(Z,(function(e){return e.updateIsSuggestionSetComplete})),se=new r.b(Z,(function(e){return e.setShowSearchBoxInCompactMode})),le=new r.a(Z,(function(e){return e.setSpellerData})),de=(Object(r.d)(Z,(function(e){return e.PersonaPill})),Object(r.d)(Z,(function(e){return e.PrivateDistributionListPill})),Object(r.d)(Z,(function(e){return e.SearchBoxDropdown}))),fe=Object(r.d)(Z,(function(e){return e.SearchBoxPillWell})),he=Object(r.d)(Z,(function(e){return e.SuggestionsCallout})),me=Object(r.d)(Z,(function(e){return e.CompactSearchBox})),be=new r.b(Z,(function(e){return e.getSuggestionAtIndex})),pe=new r.b(Z,(function(e){return e.isInSearchMode})),ve=new r.b(Z,(function(e){return e.isQFRequestIdEqualToLatest})),ge=new r.b(Z,(function(e){return e.isSearchBoxEmpty}))},910:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},911:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(863);function a(){return Object(r.a)().folderTreeTable}},913:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(18),a=n(93);function i(e){return!!(e&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}var o=Object(a.action)("setBit")((function(e,t){i(t)!==e&&(e?Object(r.a)().ViewStateConfiguration.ListViewBitFlags|=t:Object(r.a)().ViewStateConfiguration.ListViewBitFlags&=~t)}))},914:function(e,t,n){"use strict";n.d(t,"f",(function(){return l})),n.d(t,"n",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"m",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return p})),n.d(t,"i",(function(){return v})),n.d(t,"g",(function(){return g})),n.d(t,"o",(function(){return O}));var r=n(73),a=n(1173);n.d(t,"p",(function(){return a.a}));var i=n(964);n.d(t,"b",(function(){return i.a}));var o=n(1008);n.d(t,"c",(function(){return o.a}));var c=n(1021);n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return c.b}));var u=n(883);n.d(t,"a",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(7),n.e(13),n.e(33),n.e(121)]).then(n.bind(null,2363))})),l=new r.a(s,(function(e){return e.addAndInitializeAttachments})),d=new r.a(s,(function(e){return e.setPreviewImageUrl})),f=new r.a(s,(function(e){return e.refreshDownloadUrl})),h=new r.a(s,(function(e){return e.createAttachmentInfo})),m=new r.a(s,(function(e){return e.setAttachmentInfo})),b=new r.a(s,(function(e){return e.refreshThumbnailImageUrl})),p=new r.a(s,(function(e){return e.refreshPreviewImageUrl})),v=new r.b(s,(function(e){return e.getAttachment})),g=new r.b(s,(function(e){return e.checkPendingAttachmentOperation})),O=new r.b(s,(function(e){return e.shouldShowImageView}))},915:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(12),i=Object(r.createStore)("groupsStore",{groups:new a.ObservableMap})},916:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage"}(a||(a={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},919:function(e,t,n){"use strict";var r=n(1009),a=n(907),i=n(914),o=n(37);function c(e,t,n,c){if(Object(i.e)(n))return function(e){return 2===Object(i.c)(e)?l():u()}(n);if(3===Object(i.c)(n)&&!c)return s();var d;switch(t){case 2:d={allowEdit:!1,previewMethod:a.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:d={allowEdit:!1,previewMethod:a.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:d={allowEdit:!1,previewMethod:a.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:d={allowEdit:e.wacEdit,previewMethod:a.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:d={allowEdit:!1,previewMethod:a.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:d={allowEdit:!1,previewMethod:a.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:d=l();break;case 11:d={allowEdit:!1,previewMethod:a.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:d={allowEdit:!1,previewMethod:a.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:d={allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]};break;case 13:d=Object(o.f)("cal-ics-preview")?{allowEdit:!1,previewMethod:a.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]}:u();break;default:d=function(e){return e.__type===i.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||e.__type===i.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(n)?s():u()}return d}function u(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.Download]}}function s(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function l(){return{allowEdit:!1,previewMethod:a.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var d=n(93),f=(Object(d.action)("setPreviewLoaded")((function(e,t){e.previewLoaded=t})),Object(d.action)("setIsPlaceholderAttachment")((function(e,t){e.isPlaceholderAttachment=t}))),h=Object(d.action)("setThumbnailLoadState")((function(e,t){e.thumbnailLoadState=t}));function m(e,t,n,r,i,o){return void 0===o&&(o=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]},parentItemId:o,fileType:i}}var b=n(18);function p(){return Object(b.a)().SessionSettings.CompanyName}function v(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return r.a}))},928:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"m",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return f})),n.d(t,"q",(function(){return h})),n.d(t,"l",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return v})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return O}));var r="Click",a=356,i=928,o=String.fromCharCode(57345),c=new RegExp(o,"g"),u=String.fromCharCode(160),s=/\s/g,l=String.fromCharCode(57344),d=new RegExp(l,"g"),f="searchSuggestionsCallout",h="searchSuggestion-",m=38,b=52,p="searchBoxId",v="searchBoxAnchorId",g="folderScopeButtonId",O="folderScopeWrapperId"},9321:function(e){e.exports=JSON.parse('{"a":"oDb"}')},9322:function(e,t,n){var r=n(13311),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},937:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(915);function a(e){var t=Object(r.a)().groups.get(e.toLowerCase());return t?t.groupDetails:null}},938:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(911);function a(e){var t=Object(r.a)(),n=t&&t.get(e);return null==n?void 0:n.rootFolder}},940:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12),a=n(4),i=function(){return{alteredQuery:"",currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null}},o={scenarioStores:new r.ObservableMap},c=Object(a.createStore)("commonSearchStore",o);t.b=c},942:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(982),i=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:a.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},9427:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(25),i=n(42),o=n(867),c=n(193),u=n(919),s=n(1143),l=n(876),d=n(3073),f=n(1333),h=n(37),m=n(8),b=n(6281),p=n(992),v=n(44),g=n(1),O=n(5534),I=n(9321),w=n(5535),S=n(3830),j=n(486),y=n(65),_=n(3416),C=n(13301),A=n(5557),x=n(410),T=n(13302),E=Object(a.a)((function(e){if(0!==e.attachmentViewState.ongoingAction||!e.attachmentViewState.strategy.showActionsMenu)return null;var t=void 0,n=function(e){switch(e){case p.a.Edit:return T.edit;case p.a.NotSelectedAndSaving:return T.notSelectedAndSaving;case p.a.OtherSaving:return T.attachmentView;case p.a.Selected:return T.selected;case p.a.SelectedAndPending:return T.selectedAndPending;case p.a.SelectedAndSaving:return T.selectedAndSaving;default:return T.none}}(e.previewState);return t=e.isForImageView?x([T.contextMenuButton,T.contextMenuButtonForImageView]):e.attachmentViewState.isReadOnly?x([T.contextMenuButton,n]):x([T.contextMenuButton,n,T.contextMenuButtonForDocViewInCompose]),g.createElement(j.a,{onFocus:function(){Object(w.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){Object(w.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(t){t.keyCode!==i.a.enter&&t.keyCode!==i.a.space||(v.d.info("AttachmentContextMenuButton.keyDown enter|space"),t.stopPropagation(),Object(s.y)(e.attachmentViewState,!0))},ariaLabel:Object(m.a)(A.a),"aria-haspopup":"true","aria-expanded":e.attachmentViewState.shouldShowContextMenu,title:Object(m.a)(A.a),onClick:function(t){v.d.info("AttachmentContextMenuButton.onclick"),t.stopPropagation(),Object(s.y)(e.attachmentViewState,!0)},className:t,iconProps:{iconName:"ChevronDownMed",styles:{root:T.icon}}})}));var P=n(5641),D=n(6971),k=n(410),R=n(13304),F=Object(a.a)((function(e){var t,n=e.attachmentClass,r=e.attachmentViewState,a=e.isForImageView,o=e.previewState,c=e.parentItemId;t=a?k([R.deleteButton,R.deleteButtonForImageView]):k(R.deleteButton,function(e){switch(e){case p.a.Edit:return R.edit;case p.a.NotSelectedAndSaving:return R.notSelectedAndSaving;case p.a.OtherSaving:return R.attachmentView;case p.a.Selected:return R.selected;case p.a.SelectedAndPending:return R.selectedAndPending;case p.a.SelectedAndSaving:return R.selectedAndSaving;default:return R.none}}(o));var u=13===n&&Object(h.f)("cal-ics-preview");return g.createElement(g.Fragment,null,r.isReadOnly?null:g.createElement("div",{className:k(R.actionContainerFirstLine,R.actionContainerDisplay)},g.createElement(j.a,{onFocus:function(){Object(w.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){Object(w.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(t){t.keyCode!==i.a.enter&&t.keyCode!==i.a.space||(v.d.info("AttachmentDeleteButton.keyDown enter|space"),t.stopPropagation(),t.preventDefault(),e.onDeleteButtonClicked(e.attachmentViewState))},ariaLabel:Object(m.a)(C.a),className:t,onClick:function(t){t.stopPropagation(),e.onDeleteButtonClicked(e.attachmentViewState)},iconProps:{iconName:"Cancel",styles:{root:R.icon}}})),g.createElement("div",{className:k(R.secondLineActionsContainer,R.actionContainerDisplay)},!Object(y.h)().SessionSettings.IsShadowMailbox&&g.createElement(P.a,{attachmentViewState:r,isForImageView:a,previewState:o,action:N(r.attachmentId),parentItemId:c}),g.createElement(P.a,{attachmentViewState:r,isForImageView:a,previewState:o,action:u?_.a.addToCalendar:_.a.download,parentItemId:c}),g.createElement(E,{attachmentViewState:r,isForImageView:a,previewState:o})))}));function N(e){return Object(h.f)("woven-newTabExperiment")&&Object(D.a)(e)?_.a.openNewTabAndSaveToCloud:Object(h.f)("woven-editAndReplySurfaceAction")?_.a.editAndReply:_.a.saveToCloud}var M=n(13306),L=n(857);function B(e,t,n,r){if(t||!n||!V()&&!Object(h.f)("woven-saveToCloud2-openFolder")||Object(m.f)(r))return null;var a=Object(L.b)(e)||"";if(null===Object(L.e)(a))return null;if(V()){var i=function(){if(Object(h.f)("woven-saveToCloud2-viewInOneDrive"))return"from=OWAPromo&WT.mc_id=PROD_OL-Web_attachment_editInOneDrive_surface";if(Object(h.f)("woven-saveToCloud2-editInOneDrive"))return"from=OWAPromo&WT.mc_id=PROD_OL-Web_attachment_editInOneDrive_surface";if(Object(h.f)("woven-saveToCloud2-editInApp")||Object(h.f)("woven-newTabExperiment"))return"from=OWAPromo&WT.mc_id=PROD_OL-Web_attachment_editInAppName_surface";if(Object(h.f)("woven-saveToCloud2-editOnline"))return"from=OWAPromo&WT.mc_id=PROD_OL-Web_attachment_editOnline_surface";return""}(),o=-1===r.indexOf("?")?"?":"&";return r+o+i}return"https://onedrive.live.com/?id=attachments"}function V(){return Object(h.f)("woven-saveToCloud2-viewInOneDrive")||Object(h.f)("woven-saveToCloud2-editInOneDrive")||Object(h.f)("woven-saveToCloud2-editInApp")||Object(h.f)("woven-saveToCloud2-editOnline")||Object(h.f)("woven-newTabExperiment")}var U=n(216),W=n(6663),H=n(3672),z=n(8709),q=n(13307),G=n(218).bind(q),J=Object(a.a)((function(e){var t,n=e.attachmentViewState,r=e.attachment,a=e.isForImageView,i=Object(W.a)(n,r),o={attachmentInfoForImageView:a},u={colorGreen:!a},s={colorRed:!a},l=B(r.model.Name,n.isCloudy,n.isReadOnly,r.model.AttachmentOriginalUrl),d=Object(z.a)(n,r,!Object(m.f)(l),r.model.Name),f={expiredAttachment:d.useExpiredAttachmentStyling&&!n.isReadOnly},h=function(e,t,n){if(e)return q.firstLineForImageView;if(!t&&n)return q.firstLineWithActions;return q.firstLine}(a,n.isReadOnly,e.isActionsContainerVisible),v=function(e,t,n){return e?t?n?q.secondLineForImageViewWithIconAndAction:q.secondLineForImageViewWithIcon:n?q.secondLineForImageViewWithAction:q.secondLineForImageView:t?n?q.secondLineWithIconAndAction:q.secondLineWithIcon:n?q.secondLineWithAction:q.secondLine}(a,d.shouldDisplayFailureIcon||d.shouldDisplaySuccessIcon,e.isActionsContainerVisible);switch(e.previewState){case p.a.Edit:t=1===r.type?Object(m.a)(I.a):Object(m.a)(M.a);break;case p.a.SelectedAndSaving:case p.a.NotSelectedAndSaving:t=Object(m.a)(b.a);break;default:t=""}var O=""!==t,w={expiredAttachment:d.useExpiredAttachmentStyling&&!n.isReadOnly,attachmentLabelTextEditMode:O};return g.createElement("div",{className:G(o)},g.createElement("div",{className:G(f,q.firstLineCommonStyle,h,q.textOverFlow),title:i,ref:Q},r.model.Name),g.createElement("div",{title:d.title?d.title:i},d.shouldDisplaySuccessIcon&&g.createElement(U.a,{iconName:"Accept",className:G(q.actionComplete,u)}),d.shouldDisplayFailureIcon&&g.createElement(U.a,{iconName:"Cancel",className:G(q.actionComplete,s)}),O&&g.createElement(U.a,{className:q.attachmentLabelIconEditMode,iconName:"Edit"}),Object(m.f)(l)?g.createElement("span",{className:G(w,q.secondLineCommonStyle,v,q.textOverFlow)},O?t:d.text):g.createElement("div",{onClick:function(t){Object(c.o)("WVNHyperLinkOnAttachmentClicked",{},{isCore:!0,cosmosOnlyData:JSON.stringify({attachmentId:e.attachmentViewState.attachmentId.Id})}),t.stopPropagation()},className:q.oneDriveLinkContainer},g.createElement("a",{href:l,target:"_blank",className:G(v,q.textOverFlow)},d.text))))}));function Q(e){Object(H.a)(e)}var X=n(13309),Y=Object(a.a)((function(e){return g.createElement(g.Fragment,null,g.createElement(S.b,{attachmentId:e.attachmentViewState.attachmentId,useCloudIcon:!0}),g.createElement("div",{className:X.attachmentInfoContainer},g.createElement(J,{attachmentViewState:e.attachmentViewState,attachment:e.attachment,isForImageView:!1,isActionsContainerVisible:e.isActionsContainerVisible,previewState:e.previewState})),e.isActionsContainerVisible&&g.createElement(F,{attachmentViewState:e.attachmentViewState,onDeleteButtonClicked:e.onDeleteButtonClicked,isForImageView:!1,previewState:e.previewState,attachmentClass:e.attachment.attachmentClass,parentItemId:e.parentItemId}))})),K=n(9),Z=n(1449),$=n(9322),ee=n(218).bind($),te=Object(a.a)((function(e){var t={infoContainerForReadingPane:e.attachmentViewState.isReadOnly};return e.attachmentViewState.shouldShowImageOverlay?g.createElement("div",{className:ee($.infoContainer,t)},g.createElement(J,{attachmentViewState:e.attachmentViewState,attachment:e.attachment,isForImageView:!0,isActionsContainerVisible:e.isActionsContainerVisible,previewState:p.a.None}),e.isActionsContainerVisible&&g.createElement(F,{attachmentViewState:e.attachmentViewState,onDeleteButtonClicked:e.onDeleteButtonClicked,isForImageView:!0,previewState:p.a.None,attachmentClass:e.attachment.attachmentClass,parentItemId:e.parentItemId})):null})),ne=n(410),re=n(9322),ae=Object(a.a)((function(e){var t=e.attachment.model.Name,n=null,r=Object(Z.e)(t),a=Object(K.getIconClassName)("Photo2"),i=r.small,o=r.large;return Object(L.g)(t)&&(n=i,a=o),g.createElement("span",{tabIndex:-1},g.createElement(S.c,{attachmentViewState:e.attachmentViewState,placeHolderCSSClass:ne(a,re.placeholder),fileIconCssClass:n,imageLoadErrorCSSClass:o,thumbnailWidth:160,thumbnailHeight:120}),g.createElement(te,{attachment:e.attachment,attachmentViewState:e.attachmentViewState,onDeleteButtonClicked:e.onDeleteButtonClicked,isActionsContainerVisible:e.isActionsContainerVisible,parentItemId:e.parentItemId}))})),ie=n(8416),oe=n(3312),ce=n(13312),ue=Object(a.a)((function(e){return Object(ie.a)(e.attachmentViewState)&&g.createElement("span",{className:ce.progressIndicator},g.createElement(oe.a,{percentComplete:e.attachmentViewState.actionCompletePercent}))})),se=n(13314),le=n(221),de=n(18),fe=n(208),he=n(6972),me=n(13315),be=n(5051),pe=n(2939),ve=n(6933),ge=n(5675),Oe=n(896);function Ie(e,t){if(!Object(pe.a)(s.a.ChangePermissions,e)||e.isReadOnly)return null;var n=Object(l.a)(e.attachmentId);if(!n||!n.info)return null;if(!n.info.supportedPermissionLevels||n.info.supportedPermissionLevels.length<=1)return null;var r=n.model;return 0===r.PermissionType?null:{name:Object(m.a)(be.a),key:"ChangePermissions",items:we(n.info,t,e,r.PermissionType)}}function we(e,t,n,a){return e.supportedPermissionLevels.map((function(e){return function(e,t,n,a){if(0===e)return null;return{name:Object(ve.a)(e,t),key:e.toString(),onClick:function(){!function(e,t,n,a){var i;Object(r.__awaiter)(this,void 0,void 0,(function(){var o,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(o=Object(l.a)(t.attachmentId),Object(c.o)("AttachmentContextMenuItemChangePermission",[a,null===(i=o.model.AttachmentId)||void 0===i?void 0:i.Id]),e===n)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),Object(s.A)(t,4,7),[4,Object(ge.a)([t.attachmentId],e)];case 2:return r.sent(),[3,4];case 3:return u=r.sent(),v.d.error("changeAttachmentPermission error message: '"+u.message+"', stack: '"+u.stack+"'"),Object(Oe.b)("",Object(m.a)(me.a),!1,{hideCancelButton:!0}),[3,4];case 4:return Object(s.A)(t,0,0),[2]}}))}))}(e,n,a,t)}}}(e,t,n,a)}))}var Se=n(13316),je=n(914);function ye(e,t,n,a,i,o,c,d,f,h,b,v){if(!Object(pe.a)(s.a.ConvertClassicToCloudy,e)||!e.strategy.isConvertClassicToCloudySupported||v&&!v())return null;var g=Object(l.a)(e.attachmentId);return g&&g.model.__type!==je.a.attachmentTypes.ITEM_ATTACHMENT_TYPE?{name:Object(m.b)(Object(m.a)(Se.b),Object(fe.a)()?Object(m.a)(Se.a):Object(u.f)()),key:"ConvertClassicToCloudy",onClick:function(){!function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(p.k)(e.attachmentId)?[4,p.m.import()]:[3,5];case 1:return[4,r.sent()()];case 2:return r.sent()?[3,4]:[4,p.r.import()];case 3:r.sent()("convertClassicToCloudy"),r.label=4;case 4:r.label=5;case 5:return Object(s.B)(Object(s.p)(e.attachmentId),.1,(function(t){Object(s.x)(e,t)}),e.attachmentId),Object(s.e)(e,t,(function(t,r){if(t){n(e,r,!1,!0);var a=Object(l.a)(r.AttachmentId);Object(s.m)(a)}else Object(s.C)(e.attachmentId,t)})),[2]}}))}))}(e,c,d)}}:null}var _e=n(5048);function Ce(e,t,n,a,i,o,c,u,l){return Object(pe.a)(s.a.ConvertCloudyToClassic,e)&&e.strategy.isConvertCloudyToClassicSupported?{name:Object(m.b)(Object(m.a)(_e.a)),key:"ConvertCloudyToClassic",onClick:function(){!function(e,t,n,a,i){Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(p.k)(e.attachmentId)?[4,p.m.import()]:[3,5];case 1:return[4,r.sent()()];case 2:return r.sent()?[3,4]:[4,p.r.import()];case 3:r.sent()("convertCloudyToClassic"),r.label=4;case 4:r.label=5;case 5:return Object(s.f)(e,t.Id,n,a,i,0),[2]}}))}))}(e,c,l,i,u)}}:null}var Ae=n(5049),xe=n(3926),Te=n(3927),Ee=n(35);function Pe(e,t){var n=Object(l.a)(e.attachmentId);return Object(pe.a)(s.a.CopyLink,e)&&e.strategy&&e.strategy.isOpeningByLinkSupported&&n&&!Object(m.f)(n.openUrl)?{name:Object(m.a)(Ae.a),key:"CopyLink",onClick:function(){var e,r,a;r=n.openUrl,a=Object(Ee.i)()?Object(m.a)(Te.a):Object(m.a)(xe.a),window.prompt(a,r),function(e,t){Object(c.o)("AttachmentContextMenuItemCopyLink",[e,t])}(t,null===(e=n.model.AttachmentId)||void 0===e?void 0:e.Id)}}:null}var De=n(6970),ke=n(2501),Re=n(4706);function Fe(e,t,n,r,a,i,o,u,f,b){var p=Object(l.a)(e.attachmentId);if(!Object(pe.a)(s.a.Download,e)||!p||!Object(De.a)(e))return null;var v=Object(ke.a)(p);return{name:Object(m.a)(Re.a),key:"download",onClick:function(){var t;Object(c.o)("AttachmentDownload",{entryPoint:"ContextMenu",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:p.model.Size,fileType:v,attachmentId:null===(t=p.model.AttachmentId)||void 0===t?void 0:t.Id})}),Object(d.b)(e.attachmentId,e.isCloudy,b),Object(h.f)("doc-attachment-sigs")&&c.l.importAndExecute("AttachmentSaved",{itemId:null==o?void 0:o.Id,customProperties:{FileId:e.attachmentId.Id,Destination:"Local"}})}}}var Ne=n(13317),Me=n(13318),Le=n.n(Me);function Be(e,t,n,a,i,o,c,u,l,d,f){return Object(pe.a)(s.a.MoveAttachmentToInline,e)&&e.strategy.isMoveAttachmentToInlineSupported?{name:Object(m.a)(Ne.a),key:"MoveAttachmentToInline",onClick:function(){!function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(a){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n={ewsAttachmentId:e.attachmentId,itemId:t.Id},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Le()({requestObject:n})];case 2:return(a=r.sent()).ErrorMessage?(v.d.warn("Failed to convert image attachment to inline, error message: "+a.ErrorMessage),[3,4]):[2,a.ContentId];case 3:return i=r.sent(),v.d.warn("Failed to move image attachment to the message body, error message: "+i.message),[3,4];case 4:return[2,null]}}))}))}(e,t).then((function(t){n(e,t)})),[2]}))}))}(e,c,f)}}:null}var Ve=n(3665);function Ue(e,t){var n=Object(l.a)(e.attachmentId);if(!Object(pe.a)(s.a.OpenInNewTab,e)||!e.strategy.isOpeningInProviderSupported||!n||Object(m.f)(n.openUrl))return null;var r=Object(ke.a)(n);return Object(Ve.c)(n.openUrl,(function(){var e;Object(c.o)("OpenInNewTab",{providerType:t,entryPoint:"ContextMenu"},{cosmosOnlyData:JSON.stringify({fileType:r,attachmentId:null===(e=n.model.AttachmentId)||void 0===e?void 0:e.Id})})}))}var We=n(5050);function He(e,t,n,r,a,i){var o=Object(l.a)(e.attachmentId),f=Object(ke.a)(o);return Object(pe.a)(s.a.Preview,e)&&Object(u.e)(e.strategy)===u.a.Preview&&o&&!Object(p.k)(e.attachmentId)?{name:Object(m.a)(We.a),key:"Preview",onClick:function(){var t;Object(c.o)("AttachmentContextMenuItemPreview",[e.isCloudy,o.attachmentClass,f,null===(t=o.model.AttachmentId)||void 0===t?void 0:t.Id]),d.d.importAndExecute(i)}}:null}var ze=n(4424),qe=n(1173);function Ge(e){var t=Object(l.a)(e.attachmentId),n=t.model;return Object(h.f)("doc-attachment-referenceAttachmentExpiration")&&Object(pe.a)(s.a.RefreshLink,e)&&function(e,t,n){return!n&&e&&e.info&&e.info.sharingInfo&&e.info.sharingInfo.expirationDate&&e.info.supportedPermissionLevels.indexOf(t)>-1}(t,n.PermissionType,e.isReadOnly)?{name:Object(m.a)(ze.a),key:"Refresh",onClick:function(){!function(e,t){Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.o)("AttachmentContextMenuItemRefreshLink"),n=t.model,Object(s.A)(e,8,17),[4,Object(ge.a)([t.id],n.PermissionType)];case 1:return r.sent(),Object(qe.a)(t.id),Object(s.A)(e,0,0),[2]}}))}))}(e,t)}}:null}var Je=n(78),Qe=n(8497),Xe=n(8498),Ye=n(13320);function Ke(e,t,n,r,a,i,o){var c,u=Object(l.a)(e.attachmentId),d=(null===(c=e.attachmentId.mailboxInfo)||void 0===c?void 0:c.type)===Je.a.GroupMailbox,f=Object(fe.a)()&&d;return u&&Object(pe.a)(s.a.SaveToCloud,e)&&Object(s.t)(e)&&!f?{name:Ze(d),key:"Save to OneDrive",onClick:function(){Object(s.B)(Object(s.p)(e.attachmentId),.1,(function(t){Object(s.x)(e,t)}),e.attachmentId),Object(s.u)(e,(function(t){Object(s.C)(e.attachmentId,t)}),"ContextMenu",o)}}:null}function Ze(e){return e?Object(m.a)(Qe.a):Object(fe.a)()?Object(m.a)(Xe.a):Object(m.b)(Object(m.a)(Ye.a),Object(u.f)())}var $e=n(4705),et=n(13321);var tt=n(1786);function nt(){return Object(m.b)(Object(m.a)(et.a),Object(m.a)($e.a))}function rt(){var e={viewInProviderOptionText:null,GetUrlForViewInProviderAction:function(e){return e}};return Object(r.__assign)(Object(r.__assign)({},e),{viewInProviderOptionText:nt(),GetUrlForViewInProviderAction:function(e){return function(e){if(Object(m.f)(e))return e;var t=e.lastIndexOf("/");return t>=1?e.substr(0,t):e}(e)}})}var at=Object(tt.a)((function(e){switch(e){case 0:return rt();case 1:return t={viewInProviderOptionText:null,GetUrlForViewInProviderAction:function(e){return e}},Object(r.__assign)(Object(r.__assign)({},t),{viewInProviderOptionText:nt()});case 2:case 3:case 5:case 7:case 8:case 9:return{viewInProviderOptionText:null,GetUrlForViewInProviderAction:function(e){return e}};case 6:case 4:case 10:return null;default:return Object(le.a)(e)}var t})),it=(at.getDataProviderInfo,at.getDefaultDataProviderInfo),ot=n(1915);function ct(e,t,n,r){var a=Object(l.a)(e.attachmentId);if(!Object(pe.a)(s.a.ViewInProvider,e)||!e.strategy.isViewingInProviderSupported||!a)return null;var i=it(n),o=i.GetUrlForViewInProviderAction(r);return Object(m.f)(o)?null:{name:i.viewInProviderOptionText,key:"ViewInProvider",onClick:function(){Object(c.o)("AttachmentContextMenuItemViewInProvider",[t]),Object(ot.f)(o)}}}function ut(e){var t=function(){var e=[8,0,4,2,7,3,10,5,6,11];return Object(de.a)().SessionSettings.IsShadowMailbox||(e.push(1),e.push(9)),e}(),n=[];return t.forEach((function(t){switch(t){case 0:n.push(Ie);break;case 4:n.push(Fe);break;case 9:n.push(Ke);break;case 3:n.push(Pe);break;case 7:n.push(Ue);break;case 10:n.push(ct);break;case 8:n.push(He);break;case 1:n.push(ye);break;case 2:n.push(Ce);break;case 5:n.push(he.b);break;case 6:e&&n.push(Be);break;case 11:n.push(Ge);break;default:Object(le.a)(t)}})),n}function st(e,t,n,r,a,i,o,c){var u=ut(o),s=[];return u.forEach((function(u){var l=null,d=null,f=null;if(e.isCloudy){var h=t.model;f=h.AttachLongPathName,d=h.ProviderType,l=e.isReadOnly?h.OriginalPermissionType:h.PermissionType}var m=u(e,d,Object(fe.a)(),t.model.AttachmentOriginalUrl,l,n,r,a,f,i,o,c);m&&s.push(m)})),s}var lt=n(51),dt=n(450),ft=n(2152),ht=Object(a.a)((function(e){return e.attachmentViewState.shouldShowContextMenu?g.createElement(dt.a,{shouldFocusOnMount:!0,directionalHint:lt.DirectionalHint.bottomRightEdge,target:e.targetElementGetter(),onDismiss:function(t){Object(ft.a)(e.attachmentViewState,!1)},items:st(e.attachmentViewState,e.attachment,e.previewContext,e.parentItemId,e.onReplaceAttachment,null,e.moveAttachmentToInlineHandler,e.referenceAttachmentsSupported)}):null})),mt=n(13322),bt=n(218).bind(mt),pt=Object(a.a)((function(e){e=Object(r.__assign)({attachment:Object(l.a)(e.attachmentViewState.attachmentId)},e),g.useEffect((function(){e.registerFocusFunction&&e.registerFocusFunction(e.attachmentViewState.attachmentId.Id,C)}),[e.registerFocusFunction]),g.useEffect((function(){e.previewMode===p.a.PendingNavigation&&y()}),[e.previewMode]);var t,n=g.useRef(),a=g.useRef(),S=function(){Object(w.c)(e.attachmentViewState,e.isImage)},j=function(){return n.current},y=function(){if((e.previewMode===p.a.None||e.previewMode===p.a.PendingNavigation)&&a.current!==u.a.NoAction){var t=O.a.OnClick,n=t.name,r=t.customData;Object(c.o)(n,r(a.current)),Object(d.c)(e.attachmentViewState,d.a.ReadingPane,e.instrumentationContext,e.parentItemId,e.isDraft,e.onBeforePreview,e.createImageGallery)}},_=function(t){switch(t.ongoingAction){case 5:try{Object(s.c)(t)}catch(e){}break;case 6:try{Object(s.d)(t)}catch(e){}break;default:e.onDeleteButtonClicked(t)}},C=function(){n.current&&n.current.focus()};if(!e.attachment){if(e.isDraft)return null;var A=e.attachmentViewState,x=A.isCloudy,T=A.fileType;return v.d.error("Attachment not found for AttachmentView. IsCloudy: "+x+", fileType: "+T),null}switch(e.previewMode){case p.a.Edit:t=Object(m.a)(I.a);break;case p.a.SelectedAndSaving:case p.a.NotSelectedAndSaving:t=Object(m.a)(b.a);break;default:t=""}var E=""!==t;a.current=Object(u.e)(e.attachmentViewState.strategy);var P,D,k={attachmentImageView:e.isImage,attachmentDocView:!e.isImage,handCursor:a.current!==u.a.NoAction,defaultCursor:a.current===u.a.NoAction,regularTopBorderRadius:E};return k[function(e){switch(e){case p.a.Edit:return"edit";case p.a.NotSelectedAndSaving:return"notSelectedAndSaving";case p.a.OtherSaving:return"attachmentView";case p.a.Selected:return"selected";case p.a.SelectedAndPending:return"selectedAndPending";case p.a.SelectedAndSaving:return"selectedAndSaving";default:return"none"}}(e.previewMode)]=!0,g.createElement("div",{className:mt.attachmentContainer},g.createElement("div",{role:o.a.option,onKeyDown:function(e){e.keyCode!==i.a.enter&&e.keyCode!==i.a.space||(v.d.info("AttachmentView.keyPressEnter"),y())},"aria-label":e.attachment.model.Name+" "+Object(m.a)(se.a),tabIndex:0,className:bt(mt.attachmentView,k),onFocus:function(){Object(w.b)(e.attachmentViewState,e.isImage)},onBlur:function(){Object(w.a)(e.attachmentViewState,e.isImage)},onMouseEnter:S,onMouseOver:S,onMouseLeave:function(){Object(w.d)(e.attachmentViewState,e.isImage)},ref:function(e){return n.current=e},onClick:y,onContextMenu:function(t){t.preventDefault(),Object(s.y)(e.attachmentViewState,!0)}},g.createElement(f.b,{canDrag:function(){return!!e.attachment},getDragData:function(){return e.onDragStart(e.attachment.model)},getDragPreview:function(){var t=document.createElement("div");return t.className=mt.dragPreview,t.innerText=e.attachment.model.Name,t},xOffset:-12,yOffset:5},(P={viewState:e.attachmentViewState,previewPaneSelectionSource:d.a.ReadingPane,parentItemId:e.parentItemId,isDraft:e.isDraft,isEdit:!1,onBeforePreview:e.onBeforePreview,createImageGallery:e.createImageGallery,instrumentationContext:e.instrumentationContext},D=function(e){switch(e){case p.a.Edit:case p.a.Selected:case p.a.SelectedAndPending:case p.a.SelectedAndSaving:return!0;default:return!1}}(e.previewMode)||e.attachmentViewState.shouldShowActionsContainer||Object(h.f)("woven-saveToCloud-noHoverNoCloud")||Object(h.f)("woven-saveToCloud-noHoverWithCloud"),[e.isImage?g.createElement(ae,{key:"view",attachmentViewState:e.attachmentViewState,attachment:e.attachment,onDeleteButtonClicked:_,isActionsContainerVisible:D,parentItemId:e.parentItemId}):g.createElement(Y,{key:"view",attachmentViewState:e.attachmentViewState,attachment:e.attachment,onDeleteButtonClicked:_,previewState:e.previewMode,isActionsContainerVisible:D,parentItemId:e.parentItemId}),g.createElement(ue,{attachmentViewState:e.attachmentViewState,key:"progress"}),g.createElement(ht,{key:"contextMenu",attachment:e.attachment,attachmentViewState:e.attachmentViewState,targetElementGetter:j,previewContext:P,parentItemId:e.parentItemId,onReplaceAttachment:e.onReplaceAttachment,moveAttachmentToInlineHandler:e.moveAttachmentToInlineHandler,referenceAttachmentsSupported:e.referenceAttachmentsSupported})]))))}));n.d(t,"AttachmentView",(function(){return pt})),n.d(t,"getContextMenus",(function(){return st}))},946:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(863),a=n(93);function i(e){return"msgfolderroot"===e.distinguishedFolderId}var o=Object(a.select)({folderTable:function(){return r.b.folderTable}})((function(e,t,n){var r=!!e&&e.ParentFolderId;if(!r)return!1;for(var a=n.folderTable.get(r.Id);a;){if(a.distinguishedFolderId==t)return!0;if(!a.ParentFolderId)return!1;a=n.folderTable.get(a.ParentFolderId.Id)}return!1}));t.a=Object(a.select)({folderTable:function(){return r.b.folderTable}})((function(e,t,n){return function(e,t){return!!e&&e.distinguishedFolderId==t}(e,t)||o(e,t,n)}))},951:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Executing=1]="Executing",e[e.Succeed=2]="Succeed",e[e.FailureNotice=3]="FailureNotice",e[e.FailureRetry=4]="FailureRetry"}(r||(r={})),t.a=r},952:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",Todo:"todo",Attachment:"attachment"}},962:function(e,t,n){"use strict";var r=n(4),a=n(12),i=(Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new a.ObservableMap})(),n(1164),n(982),n(915)),o=n(942),c=n(937);function u(e){var t=Object(i.a)().groups.get(e.toLowerCase());return!!t&&!t.groupDetailsError}var s=n(1024),l=n(1172),d=function(){return Object(l.a)().smtpAddress},f=n(986),h=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(e,t,n,r){if(2==t){var a=Object(c.a)(e);Object(s.a)(a,"Site")[0].Url=n,Object(s.a)(a,"Files")[0].Url=r}})),m=n(1149);function b(e){return e=e.toLocaleLowerCase(),Object(f.a)().groupSiteStatus.has(e)?Object(f.a)().groupSiteStatus.get(e):0}var p=function(e){var t="string"==typeof e?Object(c.a)(e):e;return t?t.ExternalDirectoryObjectId:null},v=(n(951),n(1131),n(1114),n(1139),n(1132),n(1555)),g=n(1556),O=n(1590),I=n(1521),w=n(1522),S=n(8);function j(e){var t=e.groupDetails?e.groupDetails.AccessType:e.basicInformation?e.basicInformation.AccessType:null;if(t){if(1===t)return Object(S.a)(I.a);if(3===t)return Object(S.a)(w.a)}return""}function y(e){var t=e.groupDetails?e.groupDetails.AccessType:e.basicInformation?e.basicInformation.AccessType:null;if(t){if(1===t)return Object(S.a)(O.b);if(3===t)return Object(S.a)(O.c)}return""}function _(e){var t=0;return e.members?t=e.members.totalCount:e.groupDetails&&(t=e.groupDetails.MemberCount),t?t>1?Object(S.b)(Object(S.a)(g.a),t.toString()):Object(S.b)(Object(S.a)(v.a),t.toString()):Object(S.a)(O.a)}n.d(t,"j",(function(){return i.a})),n.d(t,"l",(function(){return o.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"m",(function(){return u})),n.d(t,"f",(function(){return s.a})),n.d(t,"g",(function(){return s.b})),n.d(t,"c",(function(){return d})),n.d(t,"i",(function(){return f.a})),n.d(t,"o",(function(){return h})),n.d(t,"n",(function(){return m.b})),n.d(t,"h",(function(){return b})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return y})),n.d(t,"k",(function(){return _}))},964:function(e,t,n){"use strict";var r=n(12),a=n(4),i={attachments:new r.ObservableMap({})},o=Object(a.createStore)("attachment",i);t.a=o},965:function(e,t,n){"use strict";var r=n(866),a=n(857);function i(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}}))}var o=n(44);function c(e,t,n){if(e.length!=t.length)return o.d.error("The sizes of subjects and latestItemIds are different"),null;for(var a=[],i=0;i<e.length;i++){var c={fileType:r.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};a.push(c)}return a}function u(e,t,n){var a=[],i={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return a.push(i),a}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n],i={fileType:r.a.Local,name:a.name,size:a.size,type:a.type,fileObject:a};t.push(i)}return t}function l(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function d(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var f={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function h(e){switch(e?e.toLowerCase():null){case f.ONE_DRIVE_PRO.toLowerCase():return 0;case f.GDRIVE.toLowerCase():return 5;case f.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case f.DROPBOX.toLowerCase():return 2;case f.BOX.toLowerCase():return 3;case f.WOPI_BOX.toLowerCase():return 7;case f.WOPI_EGNYTE.toLowerCase():return 8;case f.MAILBOX.toLowerCase():return 4;case f.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"h",(function(){return i})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return r.a}))},968:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces"}(r||(r={})),t.b=r},969:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(1067),a=n(78);function i(){return r.a.shouldShow}function o(){return r.a.shouldShow&&r.a.shouldHideReadingPaneOutsideSxS}function c(e){return i()&&Object(a.f)(e,r.a.extendedViewState.attachmentId)}function u(e){return i()&&(e&&e.composeId===r.a.composeId||!e&&r.a.composeId)}},971:function(e,t,n){"use strict";var r,a=[0,1],i=n(857),o=n(18);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));var c=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,a){e&&(e=e.toLowerCase());var i=this.getFileAccessLevel(e,t),o=!1,c=!1,u=!1,s="ReferenceAttachment:#Exchange"===a;return i!==r.Block&&n&&(this.isWacViewingEnabled(e)&&(o=!0),!this.directFileAccessEnabled&&s&&(o=!1),c=this.isForceBrowserViewingFirst(o),o&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(u="FileAttachment:#Exchange"===a?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),o||this.directFileAccessEnabled||(i=r.AccessDisabled)),{directFileAccessEnabled:this.directFileAccessEnabled,level:i,useWac:o,forceBrowserViewingFirst:c,wacEdit:u}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;var a=this.mimeTypeToPolicyMap[t];return a===r.Block?r.Block:n===r.ForceSave||a===r.ForceSave?r.ForceSave:n===r.Allow||a===r.Allow?r.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach((function(t){e[t]=n}))},e.prototype.createPolicyMap=function(e,t,n){var a={};return this.addPolicyIntoMap(a,n,r.Allow),this.addPolicyIntoMap(a,t,r.ForceSave),this.addPolicyIntoMap(a,e,r.Block),a},e}(),u=null,s=null;function l(){if(!u){var e=Object(o.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;u=new c(t,n),n&&(s=u)}return u}function d(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return l().getPolicyInfo(n,r,t,e.__type)}function f(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return function(){if(!s){var e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return l();s=new c(e.AttachmentPolicy,!0)}return s}().getPolicyInfo(n,r,t,e.__type)}function h(e,t,n,a){if(a)return!1;var i=d(e,!0),o=l();return i.level!==r.Block&&o.saveAttachmentsToCloudEnabled&&!t&&n}var m=n(1785),b=n(8),p=n(221),v=n(916);function g(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:v.c.Compose,rank:v.b.Error,message:Object(b.a)(m.b),messageParts:[Object(b.a)(m.b),O()],color:v.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:v.c.Compose,rank:v.b.Error,message:Object(b.a)(m.c),messageParts:[Object(b.a)(m.c),O()],color:v.a.Red};default:return Object(p.a)(e)}}function O(){return{text:Object(b.a)(m.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var I=n(1589);function w(e){var t=e.AttachmentPolicy;return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}function S(){return w(Object(o.a)())}function j(e){var t=Object(o.a)();return e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!function(e){return e.__type===I.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t}))}(e)?w(t):[]}function y(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(p.a)(e)}}function _(){var e=Object(o.a)().AttachmentPolicy;return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled&&!e.PrintWithoutDownloadEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"a",(function(){return a})),n.d(t,"j",(function(){return h})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"k",(function(){return l})),n.d(t,"i",(function(){return g})),n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return j})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return _}))},972:function(e,t,n){"use strict";var r=n(73),a=n(1031),i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return i}));var o=new r.c((function(){return Promise.all([n.e(638),n.e(373)]).then(n.bind(null,13873))})),c=new r.a(o,(function(e){return e.subscribe})),u=new r.a(o,(function(e){return e.unsubscribe})),s=new r.b(o,(function(e){return e.getChannelId})),l=new r.b(o,(function(e){return e.getChannelReady})),d=new r.a(o,(function(e){return e.setup})),f=new r.a(o,(function(e){return e.initializeNotificationManager})),h=new r.b(o,(function(e){return e.getNotificationEmitter}));a.a},977:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},978:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(4),a=Object(r.action)("reloadReadingPaneAfterClosingSxS"),i=Object(r.action)("onSxSChangeOrClose",(function(e,t){return{selectedLinkId:e,isSelectedLinkReadOnly:t}})),o=Object(r.action)("showSxS",(function(e,t,n,r){return{customization:e,extendedViewState:t,editState:n,selectedLinkId:r}})),c=Object(r.action)("closeSxS")},981:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1043),a=n(44),i="X-AnchorMailbox",o="X-AuxMailbox";function c(e,t){try{var n={headers:new Headers},c=null;if(e){c=Object(r.a)(e);var u=Object(r.c)(e);u&&n.headers.append(o,u)}else t&&(c=Object(r.b)(t));return c&&n.headers.append(i,c),n}catch(n){return a.d.error(" getDefaultRequestOptions failed for folderId "+e+" and itemId "+t+" with error "+n),{}}}},982:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Private=0]="Private",e[e.Public=1]="Public"}(r||(r={}))},983:function(e,t,n){"use strict";var r=n(73),a=n(833);function i(){return o(Object(a.C)())}function o(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function c(){var e=Object(a.C)();return e&&2==e.tableQuery.type}function u(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function l(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function d(){var e=Object(a.C)();return e&&u(e.tableQuery)}n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return p})),n.d(t,"j",(function(){return v})),n.d(t,"i",(function(){return g})),n.d(t,"k",(function(){return O})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return d}));var f=new r.c((function(){return Promise.all([n.e(28),n.e(391)]).then(n.bind(null,14017))})),h=new r.b(f,(function(e){return e.getGroupDisplayName})),m=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),b=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),p=new r.b(f,(function(e){return e.isJoinedGroup})),v=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),g=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),O=new r.b(f,(function(e){return e.isGroupOwner}))},986:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(12),i=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new a.ObservableMap})},992:function(e,t,n){"use strict";var r=n(1347),a=n(73),i=n(978);n(0);var o,c=n(1067),u=(n(919),n(969));function s(){return Object(u.a)()}!function(e){e[e.Mail=0]="Mail",e[e.FilesHub=1]="FilesHub",e[e.DeepLink=2]="DeepLink",e[e.GroupFilesHub=3]="GroupFilesHub"}(o||(o={}));var l=n(1406),d=n(1174),f=n(1178),h=n(1428);n.d(t,"C",(function(){return b})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return v})),n.d(t,"o",(function(){return g})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return I})),n.d(t,"r",(function(){return w})),n.d(t,"s",(function(){return S})),n.d(t,"t",(function(){return j})),n.d(t,"u",(function(){return y})),n.d(t,"y",(function(){return _})),n.d(t,"v",(function(){return C})),n.d(t,"w",(function(){return A})),n.d(t,"x",(function(){return x})),n.d(t,"z",(function(){return T})),n.d(t,"A",(function(){return E})),n.d(t,"B",(function(){return P})),n.d(t,"D",(function(){return D})),n.d(t,"F",(function(){return i.c})),n.d(t,"E",(function(){return i.b})),n.d(t,"G",(function(){return i.d})),n.d(t,"g",(function(){return i.a})),n.d(t,"H",(function(){return c.a})),n.d(t,"e",(function(){return r})),n.d(t,"i",(function(){return u.a})),n.d(t,"j",(function(){return u.b})),n.d(t,"k",(function(){return u.c})),n.d(t,"l",(function(){return u.d})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return l.a})),n.d(t,"b",(function(){return d.a})),n.d(t,"c",(function(){return f.a})),n.d(t,"a",(function(){return h.a}));var m=new a.c((function(){return Promise.all([n.e(1),n.e(76),n.e(658),n.e(7),n.e(494)]).then(n.bind(null,13828))})),b=new a.b(m,(function(e){return e})),p=new a.b(m,(function(e){return e.canCloseSxS})),v=new a.b(m,(function(e){return e.closeComposeInSxS})),g=new a.b(m,(function(e){return e.createImageGalleryFromAttachmentViewStateIds})),O=new a.b(m,(function(e){return e.editAndReply})),I=new a.b(m,(function(e){return e.editInDraft})),w=new a.b(m,(function(e){return e.forceCloseSxS})),S=new a.a(m,(function(e){return e.logUsageWithSxSCustomData})),j=new a.b(m,(function(e){return e.onBeforeImageGalleryItemSelected})),y=new a.b(m,(function(e){return e.onChangeByImageGallery})),_=new a.b(m,(function(e){return e.onSxSReadingPaneChange})),C=new a.b(m,(function(e){return e.onPendingNavigation})),A=new a.b(m,(function(e){return e.onPreviewOperationFinished})),x=new a.b(m,(function(e){return e.onPreviewOperationStart})),T=new a.b(m,(function(e){return e.openComposeInSxS})),E=new a.b(m,(function(e){return e.reloadTextPreview})),P=new a.b(m,(function(e){return e.showSxS})),D=new a.a(m,(function(e){return e.tryCloseSxS}));new a.b(m,(function(e){return e.tryExitSxSEditMode}))},999:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),i=a();function o(){return i.selectedNode}function c(){var e=o();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.Attachments.js.map
self.scriptsLoaded['owa.Attachments.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Attachments.js'] = (new Date()).getTime();