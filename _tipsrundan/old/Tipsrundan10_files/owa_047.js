self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.6.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[6],{245:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(148),o=null,i=3e4;function c(){return null==o&&(o=new r.Cache),o}function u(e){return c().get(e)}function a(e){return c().del(e)}function s(e,t){c().put(e,t,i)}},296:function(e,t,n){"use strict";var r=n(0),o=n(148),i=n(183),c=n(246);function u(e){return Object(r.__assign)({__type:"TokenRequest:#Exchange"},e)}var a=n(88),s=n(24);function l(e,t){return void 0===e||e.__type||(e=u(e)),Object(s.a)("GetAccessTokenforResource",e,t)}var d=n(83),f=1500,_="OWA_GetAccessTokenForResource";function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return t={isUserActivity:!1},[2,l(u({Resource:e}),t)]}))}))}function b(e,t,n,o){return void 0===o&&(o=f),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return t<1?(Object(d.h)(_,[e,t,n?n.toString():""]),[2,Promise.reject()]):[2,h(e).catch((function(n){return Object(a.a)(o).then((function(){return b(e,t-1,n,2*o)}))}))]}))}))}var v,p=n(51),g=n(386),O=3,j=500;function k(e){var t=this,n=null,o=null,i=new Promise((function(e,i){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return n=e,o=i,[2]}))}))})),c={onFulfilled:n,onRejected:o,resource:e};return(null==v&&(v=new g.a(O,w,j)),v).add(c),i}function w(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return R(e.resource).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var A=n(245);n.d(t,"d",(function(){return C})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return S})),n.d(t,"a",(function(){return R}));var T=1,m=12e4,y=3,I=null;function C(e){I=e}function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return null!=(t=D(x(),e))?[3,2]:[4,R(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:void 0]}}))}))}function S(e){var t=D(x(),e);if(t)return[t.AccessToken,void 0];if(Object(p.f)("auth-getAccessTokenQueueEnabled")){var n=Object(A.a)(e),r=void 0;return n?r=n:(r=k(e),Object(A.b)(e,r)),[void 0,r.then((function(t){return Object(A.c)(e),t.AccessToken})).catch((function(t){Object(A.c)(e),Object(d.h)(_,{category:"Promise_For_Token_Request_Failed",err:t?t.toString():"",message:t?t.message:"",stk:t?t.stack:"",resource:e})}))]}return[void 0,R(e).then((function(e){return e.AccessToken}))]}function R(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(p.f)("auth-getAccessTokenQueueEnabled")?[4,b(e,y)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,h(e)];case 3:n=r.sent(),r.label=4;case 4:return null!=(t=n)&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(t.ExpiresIn&&t.ExpiresIn>0&&(t.AccessTokenExpiry=Object(c.a)(Date.now(),t.ExpiresIn).toISOString()),(o=new Date(t.AccessTokenExpiry).getTime()-Date.now()-m)>0&&x().put(e,t,o,(function(e,t){R(e).catch((function(t){Object(d.h)(_,{category:"Cache_Expired",err:t?t.toString():"",message:t?t.message:"",stk:t?t.stack:"",resource:e})}))}))),[2,t]}}))}))}function D(e,t){var n=e.get(t),r=void 0;(null==n?void 0:n.AccessTokenExpiry)&&(Object(i.a)(new Date(n.AccessTokenExpiry),-T)>new Date(Date.now())&&(r=n));return r}function x(){return null==I&&(I=new o.Cache),I}},589:function(e,t,n){"use strict";n.r(t);var r=n(148),o=n(296);function i(e){Object(o.d)(new r.Cache),Object(o.b)(e.location.origin)}var c=n(0),u=n(59),a=n(75),s=n(246),l=n(83),d="OWA_GetDelegationAccessToken",f={};function _(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(c.__generator)(this,(function(r){switch(r.label){case 0:t=encodeURIComponent(e.client_id+e.scope+e.requestId),n={},r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,h(e,window,t)];case 2:return n=r.sent(),[3,5];case 3:return r.sent(),n.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",f[e]),t.document.body.removeChild(n),delete f[e])}(t,window),[7];case 5:return[2,n]}}))}))}function h(e,t,n){return Object(c.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(c.__generator)(this,(function(i){return r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+u.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((o=t.document.createElement("iframe")).src=r.toString(),o.style.display="none",o.id=n,t.document.body.appendChild(o),[2,new Promise((function(r,i){f[n]=function(n){var c={};try{o.contentWindow&&o.contentWindow.location.host==t.location.host&&(c=function(e,t){var n=u.parse(e),r={};n.access_token?(r.AccessToken=n.access_token,r.AccessTokenExpiry=Object(s.a)(Date.now(),parseInt(n.expires_in)).toISOString(),r.TokenResultCode=0):"login_required"==n.error||"interaction_required"==n.error||"consent_required"==n.error?(r.TokenResultCode=3,Object(l.h)(d+" MSA Failure Unauthorized",{error:n.error,param:e,requestId:t})):(r.TokenResultCode=2,Object(l.h)(d+" MSA Failure",{error:n.error,param:e,requestId:t}));return r}(o.contentWindow.location.hash.substring(1),e.requestId))}catch(t){Object(l.h)(d+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),c.TokenResultCode=2,i(c)}r(c)},o.addEventListener("load",f[n],!1)}))])}))}))}var b,v=n(51),p=n(245),g=n(386),O=3,j=500;function k(e){var t=this,n=null,r=null,o=new Promise((function(e,o){return Object(c.__awaiter)(t,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){return n=e,r=o,[2]}))}))})),i={onFulfilled:n,onRejected:r,options:e};return(null==b&&(b=new g.a(O,w,j)),b).add(i),o}function w(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){return _(e.options).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var A=n(301),T=n(448),m=null,y="OWA_GetDelegationAccessToken",I="https://login.live.com/oauth20_authorize.srf",C="/owa/auth/dt.aspx",E="292841";function S(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,s;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:n={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:t||Object(T.a)()},r=void 0,o=void 0,c.label=1;case 1:return c.trys.push([1,7,,8]),Object(v.f)("auth-disableGetAuthenticationCall")?[4,R(q(n))]:[3,3];case 2:return r=c.sent(),[3,6];case 3:return[4,Object(a.a)()];case 4:return 0!=(o=c.sent()).ResultCode||null==o.ImplicitGrantAuthorizationUrl||""==o.ImplicitGrantAuthorizationUrl?(Object(l.h)(y+" ImplicitGrantAuthorizationUrl is empty or null ",{scope:e,correlationId:n.requestId}),[2,r]):(i=u.parse(o.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(n.client_id=i.client_id,n.authorization_uri=o.ImplicitGrantAuthorizationUrl.split("?")[0],n.redirect_uri=i.redirect_uri,[4,R(n)]):[3,6];case 5:r=c.sent(),c.label=6;case 6:return[2,r];case 7:return s=c.sent(),Object(l.h)(y+" GetDelegationToken Operation failed ",{err:s.toString(),message:s.message,stk:s.stack||"",scope:e,requestId:n.requestId}),[2,r];case 8:return[2]}}))}))}function R(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o;return Object(c.__generator)(this,(function(i){switch(i.label){case 0:return t=e.client_id+e.scope,(null==(n=function(e,t){var n=e.get(t),r=void 0;if(null==n?void 0:n.AccessTokenExpiry){new Date(n.AccessTokenExpiry)>new Date(Date.now())&&(r=n)}return r}(x(),t))?void 0:n.AccessToken)?[2,n.AccessToken]:[3,1];case 1:return Object(v.f)("auth-getDelegationTokenQueueEnabled")?(r=Object(p.a)(t),o=void 0,r?o=r:(o=k(e),Object(p.b)(t,o)),[2,o.then((function(e){return D(t,e),Object(p.c)(t),e.AccessToken})).catch((function(n){Object(p.c)(t),Object(l.h)(y,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",scope:e.scope,requestId:e.requestId})}))]):[3,2];case 2:return[4,_(e)];case 3:return n=i.sent(),D(t,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}}))}))}function D(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&x().put(e,t,n)}}function x(){return null==m&&(m=new r.Cache),m}function q(e){return e.redirect_uri=Object(A.a)()+C,e.authorization_uri=I,e.client_id=E,e}var U=n(8),F=n(350);var P=!1;function z(e){P||(!function(e){var t=Object(F.a)("/owa",e);Object(U.b)({baseUrl:t})}(e),P=!0)}var G={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function W(e,t,n,r,o){n?e.acquireTokenPopup(t,null,n,o):e.acquireToken(t,(function(n,i){n&&n.indexOf(G.NoPreAuth)>=0&&r?e.acquireTokenPopup(t,null,null,o):o(n,i)}))}var N=n(77),L=new N.c((function(){return Promise.all([n.e(606),n.e(102)]).then(n.bind(null,13709))})),B=new N.a(L,(function(e){return e.createAdalAuthenticationContext}));var Q=function(e,t,n,r,o){return function(i,c){i||!c?o(i,null):(e.getCachedUser(),W(e,t,n,r,o))}},M="adalIdTokenFrame";function $(e,t,n,r,o){e.config.displayCall=function(i){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(i),window.detectUserCachedCallback=Q(e,t,n,r,o),function(e,t){e._addAdalFrame(M).src="about:blank",e._loadFrame(t+"&prompt=none",M)}(e,i)},e.login()}var H=n(20);function J(e,t,n,r,o,i){var u,a;return Object(c.__awaiter)(this,void 0,void 0,(function(){var s,l,d,f;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return"https://login.microsoftonline.com/",[4,B.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return s=c.sent(),l=Object(H.a)(),d=null===(u=l.SessionSettings)||void 0===u?void 0:u.UserPrincipalName,f=null===(a=l.SessionSettings)||void 0===a?void 0:a.UserEmailAddress,s._user={profile:{upn:d||f}},s.getCachedUser()?W(s,n,r,o,i):$(s,n,r,o,i),[2]}}))}))}n.d(t,"registerTokenProvider",(function(){return i})),n.d(t,"getAccessTokenforResource",(function(){return o.b})),n.d(t,"getAccessTokenforResourceAsLazy",(function(){return o.c})),n.d(t,"getDelegationToken",(function(){return R})),n.d(t,"getDelegationTokenForOwa",(function(){return S})),n.d(t,"bootstrap",(function(){return z})),n.d(t,"getAccessTokenOnBehalfOfResource",(function(){return J})),n.d(t,"AdalErrorCode",(function(){return G}))}}]);
//# sourceMappingURL=owa.6.js.map
self.scriptsLoaded['owa.6.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.6.js'] = (new Date()).getTime();