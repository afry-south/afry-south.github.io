self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[494],{1060:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(51);function c(){return Object(r.f)("rp-peopleSuggestionsTrie")&&Object(r.f)("rp-peopleSuggestionsCacheFirst")||Object(r.f)("rp-cacheFirstPeopleTrieSize300")||Object(r.f)("rp-cacheFirstPeopleTrieSize500")||Object(r.f)("rp-cacheFirstPeopleTrieSize700")||Object(r.f)("rp-peopleTrieOnTimeoutLow")||Object(r.f)("rp-peopleTrieOnTimeoutMed")||Object(r.f)("rp-peopleTrieOnTimeoutHigh")}},13725:function(t,e,n){"use strict";n.r(e);var r=n(4167),c=n(104),o=n(85),u=Object(c.action)("execute3SPrimeCall")((function(){Object(r.a)(Object(o.e)().userIdentity,null,!1)}));n.d(e,"execute3SPrimeCall",(function(){return u}))},147:function(t,e,n){"use strict";var r,c=n(4),o=Object(c.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),u=Object(c.action)("removeAccount",(function(t){return{userIdentity:t}})),i=Object(c.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),a=Object(c.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),s=Object(c.action)("accountIsInErrorState",(function(t){return{accountState:t}})),d=n(0),f=n(13),l=n(5),p=n(165);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TokenError=3]="TokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound"}(r||(r={})),Object(c.mutator)(o,(function(t){var e=t.account;e.accountState!=r.Valid&&Object(p.o)("OWAConnectedAccountStatusInvalid",{accountStatus_1:e.accountState}),b().accountsMap.set(e.userIdentity,e)})),Object(c.mutator)(u,(function(t){var e=t.userIdentity;b().accountsMap.delete(e)})),Object(c.mutator)(i,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,c=b().accountsMap.get(e);c.token=n,c.tokenExpiry=Object(l.j)(Object(l.Pb)(),parseInt(r))})),Object(c.mutator)(a,(function(t){var e=t.userIdentity,n=t.accountState,c=b().accountsMap.get(e);c.accountState==r.Valid&&n!=r.Valid&&Object(p.o)("OWAConnectedAccountStatusInvalid",{accountStatus_1:n}),c.accountState=n}));var b=Object(c.createStore)("OWAAccountsStore",{accountsMap:new f.ObservableMap({})}),O=n(222);function v(t){return void 0!==h(t)}function j(){return Object(d.__spread)(b().accountsMap.values())}function h(t){return b().accountsMap.get(t)}function y(t){return j().filter((function(e){return e.accountProviderType==t}))}function A(t){return v(t)?h(t).accountProviderType:null}function S(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(O.a)(t.accountProviderType)}function T(t,e){return function(n){var r=h(n);return r?r[t]:e}}T("accountUniqueId","0");var g=T("accountState",r.Valid),I=function(){return j().some((function(t){return!w(t.userIdentity)}))},_=T("accountProviderType",null),k=function(t){return"Outlook"==_(t)},w=function(t){return g(t)==r.Valid};n.d(e,"c",(function(){return o})),n.d(e,"n",(function(){return u})),n.d(e,"p",(function(){return i})),n.d(e,"o",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"h",(function(){return j})),n.d(e,"e",(function(){return h})),n.d(e,"i",(function(){return y})),n.d(e,"d",(function(){return A})),n.d(e,"g",(function(){return S})),n.d(e,"f",(function(){return g})),n.d(e,"j",(function(){return I})),n.d(e,"m",(function(){return k})),n.d(e,"l",(function(){return w})),n.d(e,"k",(function(){return v})),n.d(e,"a",(function(){return r}))},257:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function c(t){var e=t.requestOptions;return e||(e={headers:new Headers}),e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}))},330:function(t,e,n){"use strict";var r=n(0),c=n(515),o=n(147),u=n(452),i=n(52),a="X-AnchorMailbox",s="Authorization",d="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function l(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,l,p,b,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n={},!(l=Object(o.e)(t))||l.accountState!=o.a.AccountDeprovisioned&&l.accountState!=o.a.AccountNotFound?(e?(n[a]=e,n[f]=e):l&&(n[a]=l.anchorMailbox),l?(p=l.token,b=Object(u.g)(l.tokenExpiry),p||i.d.error("[getConnectedAccountHeaders] Invalid account token"),!b&&p?[3,2]:[4,c.a.importAndExecute(l.accountId,t)]):[3,3]):(Object(o.b)(l.accountState),[2,null]);case 1:(p=r.sent())||(p="",i.d.error("[getConnectedAccountHeaders] Token refresh failed")),r.label=2;case 2:O=void 0,"Outlook"==l.accountProviderType?(O='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[d]=1..toString()):"Google"!=l.accountProviderType&&"ICloud"!=l.accountProviderType||(O="Bearer "+p,n[d]=2..toString()),n[s]=O,r.label=3;case 3:return[2,n]}}))}))}var p=n(85),b=n(257);function O(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(b.a)(t),n=e,[4,v(t)];case 1:return n.headers=r.sent(),e.authNeededOnUnAuthorized=!1,e.datapoint=e.datapoint||{},e.datapoint.mailbox="Connected",[2,e]}}))}))}function v(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=new Headers,[4,l(t.userIdentity,t.type==p.a.GroupMailbox||t.type==p.a.TeamsMailbox?t.mailboxSmtpAddress:null)];case 1:return n=r.sent(),Object(b.b)(e,n),[2,e]}}))}))}n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return O}))},3762:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1060),c=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],o=c.concat(["FeatureData","GivenName","Alias"]),u=c.concat(["FeatureData"]);function i(t){return Object(r.a)()?0==t?o:u:c}},4167:function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n(0),c=n(147),o=n(330),u=n(51),i=n(448),a=n(190),s=n(196),d=n(206),f=n(3762),l=n(52),p=n(1060),b="/search/api/v1/init?",O="/search/api/v1/suggestions?",v="owa.react.compose",j="ClientSideRanker",h="ContextAwareServing",y="20",A="5";function S(t,e,n,c,o,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,d,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return null!=e?[3,1]:[2,T()];case 1:return[4,g(e,n,u)];case 2:return a=r.sent(),d=function(t,e){return{AppName:"OWA",Scenario:{Name:v},Cvid:e||Object(i.a)(),EntityRequests:[t]}}(a,null==o?void 0:o.conversationId),f=s.d,p=[O+_(e),d,c,!1],[4,k(t,null==o?void 0:o.clientSessionId)];case 3:return[2,f.apply(void 0,p.concat([r.sent(),!0,!0,!1])).then((function(t){return t})).catch((function(t){return l.d.info(t),null}))]}}))}))}function T(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=s.b,e=[b+_(),void 0,!0],[4,k(null)];case 1:return[2,t.apply(void 0,e.concat([n.sent(),!0,!1])).then((function(t){return Object(a.a)(t.status)?t.json():null})).catch((function(t){return t.networkError=!0,l.d.error(t),null}))]}}))}))}function g(t,e,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){return c={Query:{QueryString:t},EntityType:"People",Provenances:I(e),Size:e?y:A},n&&n.length>0&&(c.Context=function(t){var e={};t&&(e.RecipientsTo=t.toString());return e}(n)),c.Fields=Object(f.a)(1),[2,c]}))}))}function I(t){var e=["Mailbox"];return t&&!Object(d.a)()&&e.push("Directory"),e}function _(t){var e={scenario:v};return Object(p.a)()&&(e.setflight=j),Object(u.f)("rp-contextualZeroQuery")&&""==t&&(e.setflight=h),Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")}function k(t,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){return n={},e&&(n["client-session-id"]=e),t&&Object(c.k)(t)?[2,Object(o.a)(t).then((function(t){return Object.keys(t).forEach((function(e){return n[e]=t[e]})),n}))]:[2,n]}))}))}},515:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(77),c=new r.c((function(){return n.e(577).then(n.bind(null,791))})),o=new r.a(c,(function(t){return t.getAndUpdateAccessToken}))}}]);
//# sourceMappingURL=owa.SubstrateSuggestions.js.map
self.scriptsLoaded['owa.SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SubstrateSuggestions.js'] = (new Date()).getTime();