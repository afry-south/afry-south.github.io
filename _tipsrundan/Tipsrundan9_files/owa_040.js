self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[121,14,34,46,47],{1004:function(e,t,n){"use strict";var r,i=n(86),o=n(1043),a=n(1044),c=n(1867);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.Unknown="Unknown"}(r||(r={}));var u=n(1205),s=n(1180),d=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function l(e){var t=Object(s.a)(e);return t&&-1!==d.indexOf(t.source)}var f=n(1717);function p(e){var t=Object(s.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:l(e)?"newLink":"oldLink"}:null}var h=n(1868);function b(){return Object(h.a)().sharingLinks.size}n.d(t,"o",(function(){return v})),n.d(t,"s",(function(){return O})),n.d(t,"w",(function(){return g})),n.d(t,"u",(function(){return _})),n.d(t,"t",(function(){return w})),n.d(t,"r",(function(){return j})),n.d(t,"v",(function(){return I})),n.d(t,"q",(function(){return y})),n.d(t,"p",(function(){return k})),n.d(t,"y",(function(){return m})),n.d(t,"c",(function(){return o.a})),n.d(t,"d",(function(){return o.b})),n.d(t,"e",(function(){return o.c})),n.d(t,"g",(function(){return o.d})),n.d(t,"B",(function(){return o.f})),n.d(t,"x",(function(){return o.e})),n.d(t,"C",(function(){return a.e})),n.d(t,"D",(function(){return a.f})),n.d(t,"E",(function(){return a.g})),n.d(t,"A",(function(){return a.c})),n.d(t,"f",(function(){return a.b})),n.d(t,"z",(function(){return c.b})),n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"n",(function(){return u.c})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return f.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return b}));var m=new i.c((function(){return Promise.all([n.e(7),n.e(14),n.e(47),n.e(318)]).then(n.bind(null,13339))})),v=new i.b(m,(function(e){return e.addRecipientsIntoLink})),O=new i.b(m,(function(e){return e.removeRecipientsFromLink})),g=new i.b(m,(function(e){return e.updateRecipientPermissionInfos})),_=new i.b(m,(function(e){return e.setGetPermissionInfoFailure})),w=new i.b(m,(function(e){return e.resetSharingRecipientsInfo})),j=new i.b(m,(function(e){return e.ignoreSharingTip})),I=new i.b(m,(function(e){return e.setLinkActionStatus})),y=new i.b(m,(function(e){return e.getSharingTipRecipientInfo})),k=new i.b(m,(function(e){return e.createCloudFileFromSharingLink}))},1006:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},1011:function(e,t,n){"use strict";var r=n(2337),i=n(1721),o=n(2495),a=n(103);t.a=Object(a.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(o.a)(e)?Object(i.a)(e,!0):Object(i.a)(e,!1)}))},1043:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(4),i=Object(r.action)("ADD_SHARING_LINK",(function(e,t,n,r,i,o){return{linkId:e,url:t,sharingLinkIds:n,response:r,source:i,providerType:o}})),o=Object(r.action)("SHARING_LINK_REMOVED",(function(e,t){return{linkId:e,sharingLinkIds:t}})),a=Object(r.action)("DELETE_LINK",(function(e){return{linkId:e}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(e,t,n){return{linkId:e,providerId:t,isTryAgain:n}})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(function(e,t,n){return{linkId:e,recipientInfos:t,composeId:n}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(e,t){return{linkId:e,linkIdContainer:t}}))},1044:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(4),i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(e,t){return{linkId:e,sharingDialogResponse:t}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(e,t){return{linkId:e,newPermission:t}})),a=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(e,t,n,r){return{linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(e,t){return{linkId:e,actionStatus:t}})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(e,t,n,r,i,o,a,c){return{linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:i,providerType:o,composeId:a,recipientInfos:c}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(e,t){return{linkId:e,linkModel:t}})),d=Object(r.action)("TOKEN_UNAVAILABLE",(function(e){return{linkId:e}}))},1048:function(e,t,n){"use strict";var r=n(908),i=n(1015),o=n(1787),a=n(4),c=n(1164),u=n(1159),s={shouldShow:!1,viewState:Object(o.a)(),extendedViewState:{previewMode:r.b.Unsupported,attachmentId:null,selectionSource:c.a.MailList,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},editState:{mode:u.a.View,editAllowed:!1,itemId:null,isDraft:!1},customPreviewState:null,eventManager:new i.a,pendingPreviewOperation:null,pendingNavigation:null,readingPaneState:null,composeId:null,customization:null,isInvisible:!1,shouldUseFakeRightHandSide:!1,isUsingFakeRightHandSide:!1,shouldHideReadingPaneOutsideSxS:!1,attachmentViewStateIdFromListView:null,sessionPreviewCount:0,sessionStartTime:0,meetingMessageAddToCalendarStatus:1};s.viewState.previewPane=null;var d=Object(a.createStore)("sxsstore",s);t.a=d()},1058:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return f}));var r,i=n(1375),o=n(1171),a=n(844),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(o.a)(e+"_16x16"),small:Object(o.a)(e+"_20x20"),medium:Object(o.a)(e+"_32x32"),large:Object(o.a)(e+"_64x64"),cdn:Object(i.a)(e+"_16x16")},c[e])}var s="generic",d=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".apk":"exe",".application":"exe",".app":"exe",".appref-ms":"exe",".appx":"exe",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".ipa":"exe",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":s,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".msi":"exe",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xap":"exe",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),l=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"});function f(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(i.a)("folder_16x16")};var c=null,f=Object(a.b)(e);return f&&(c=d[f.toLowerCase()]),!c&&n&&n in l&&(c=l[n]),u(c||s)}},1118:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(991);function i(e){return a(e.type)}function o(e){return a(Object(r.a)(e))}function a(e){return 1===e||3===e}},1128:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1237),i=n(1304);function o(e){switch(e){case 3:return a;case 2:return c;case 0:return u;case 1:return s;case 5:return d;default:throw new Error("File provider "+e+" is not supported.")}}var a={providerType:3,create_shared_link_request:{requestUrlFormat:i.a+"/{0}/{1}",method:r.e,body:{shared_link:{access:"open",permissions:{can_download:!0,can_preview:!0}}},dataPointName:"BoxCreateLink"},get_file_info_request:{requestUrlFormat:i.a+"/shared_items",method:r.b,additional_headers:{BoxApi:"shared_link={0}"},dataPointName:"GetBoxFileInfo"}},c={providerType:2,get_shared_link_request:{requestUrlFormat:i.b+"/list_shared_links",method:r.d,body:{path:null,direct_only:!0},dataPointName:"DropboxCreateLink"},create_shared_link_request:{requestUrlFormat:i.b+"/create_shared_link_with_settings",method:r.d,body:{path:null,settings:{requested_visibility:"public"}},dataPointName:"DropboxCreateNewLink"},get_file_info_request:{requestUrlFormat:i.b+"/get_shared_link_metadata",method:r.d,body:{url:null},dataPointName:"GetDropboxFileInfo"}},u={providerType:0,create_shared_link_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/driveItem/invite",method:r.d,additional_headers:{prefer:"getDefaultLink"},dataPointName:"OneDriveProCreateLink"},get_file_info_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/?expand=sharepointIds,permission,driveItem(select=webDavUrl,name,folder,package)",method:r.b,dataPointName:"GetODBFileInfo"},get_shared_item_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/",method:r.b,dataPointName:"GetODBSharedItem",additional_headers:{prefer:"redeemSharingLinkIfNecessary"}}},s={providerType:1,create_shared_link_request:{requestUrlFormat:i.e+"/"+Object(i.i)(1)+"/items/{0}/action.createLink",method:r.d,body:{type:null},dataPointName:"OneDriveConsumerCreateLink"},change_link_permission_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/root/action.createLink",method:r.d,body:{type:null},dataPointName:"OneDriveConsumerChangeLinkPermission"},get_drive_item_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/driveItem",method:r.b,dataPointName:"GetODCDriveItem"},get_file_permission_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/driveItem/permissions",method:r.b,dataPointName:"GetODCFilePermission"}},d={providerType:5,get_file_info_request:{requestUrlFormat:i.d+"/{0}?fields=id,name,webViewLink,mimeType,capabilities,permissions,permissionIds",method:r.b,dataPointName:"GetGDriveFileInfo"},create_shared_link_request:{requestUrlFormat:i.d+"/{0}/permissions",method:r.d,body:{role:null,type:"anyone"},dataPointName:"GDriveCreateLink"},change_link_permission_request:{requestUrlFormat:i.d+"/{0}/permissions/{1}",method:r.c,body:{role:null},dataPointName:"GDriveChangeLinkPermission"}}},1129:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1237);function o(e,t,n,o,a,c,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s={method:o,mode:i.a,body:a,datapointNamePrefix:u},[4,Object(i.f)(e,t,c,s,n)];case 1:return[2,r.sent()]}}))}))}},1131:function(e,t,n){"use strict";var r=n(0),i=n(1841),o=n(1795),a=n(1011),c={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function d(e,t,n,r){var i=new u(e,t,n);c[r.Id]=i,i.start()}var l=n(2555),f=n(4);Object(f.orchestrator)(i.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=e.attachment,Object(a.a)(i,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,i){s(e,!0),Object(o.a)(n,i),Object(a.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var i}))}))}));var p=n(964),h=n(2110);function b(e){return Object(r.__assign)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var m=n(23);function v(e,t,n,r,i){var o,a,c=function(e,t,n,r,i){return b({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:i})}(e,t,n,r,i);return void 0===(o={requestObject:c}).requestObject||o.requestObject.__type||(o.requestObject=b(o.requestObject)),Object(m.a)("ConvertLocalToRefAttachment",o,a)}var O=n(191),g=n(864),_=n(1636),w=n(961),j=n(103),I={},y=Object(j.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=new O.a("AttachmentConvertClassicToCloudy"),function(e){Object(a.a)(e,5,8)}(e),o=function(t){if(C(e,t.ResultCode),S(i,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){C(e,1),n(!1,null),S(i,e.attachmentId,1,t)},[4,k(e.attachmentId,t,o,c)];case 1:return r.sent(),[2]}}))}))}));function k(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,c,u,s,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return[4,Object(_.a)(n)];case 1:o=r.__read.apply(void 0,[l.sent(),4]),a=o[0],c=o[1],u=o[2],s=o[3],I[e.Id]=a,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,v(e.Id,t,a,s,a)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),i(d.message),w.h.importAndExecute(c,u),[3,5];case 5:return[2]}}))}))}function C(e,t){switch(t){case 0:break;case 11:Object(a.a)(e,0,0);break;default:Object(a.a)(e,0,9)}delete I[e.attachmentId.Id]}function S(e,t,n,r){var i=Object(g.a)(t);e.addCosmosOnlyData(JSON.stringify({size:i.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var T={name:"CancelConvertClassicToCloudy"},P={name:"CancelConvertCloudyToClassic"};function x(e){return Object(r.__assign)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function A(e){var t,n,r=function(e){return x({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=x(t)),Object(m.a)("CancelConvertLocalToRefAttachment",t,n)}var E=n(84),L=Object(E.d)("cancelConvertClassicToCloudy",T)((function(e){var t,n=(t=e.attachmentId.Id,I[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(a.a)(e,5,10),A(n)})),N=n(1408),R=Object(j.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),D=n(2101),F=n(1722),M=(n(1721),n(1306)),U=n(1766),q=n(908),W=n(2005),B=n(2336),V=n(2775),z=n(1118),H=Object(j.action)("updateAttachment")((function(e,t,n,i,o){Object(B.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},i.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,i.Name&&(n.Name=i.Name),i.Size&&(n.Size=i.Size),i.ContentType&&(n.ContentType=i.ContentType),i.__type&&(n.__type=i.__type),n.IsInline&&(n.ContentId=i.ContentId),Object(z.b)(i)){var u=n;u.AttachLongPathName=i.AttachLongPathName,u.PermissionType=i.PermissionType,u.ProviderType=i.ProviderType,u.AttachmentThumbnailUrl=i.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=i.AttachmentPreviewUrl}if(Object(W.a)([{attachmentId:c,attachment:n,permissionInfo:o}],!1),e.attachmentId=c,Object(U.a)(e))Object(F.a)(e,1);else{Object(q.g)(e,!1),setTimeout((function(){R(e,1.1)}),500),Object(a.a)(e,0,0);var s=Object(g.a)(c);Object(M.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(V.a)(c,e.isReadOnly,!0)}}));function G(e){return Object(r.__assign)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function J(e,t,n,r,i,o,a,c){var u,s,d=function(e,t,n,r,i,o,a,c){return G({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:i,fullPathLocation:o,attachmentDataProviderId:c,PermissionLevel:a})}(e,t,n,r,i,o,a,c);return void 0===(u={requestObject:d}).requestObject||u.requestObject.__type||(u.requestObject=G(u.requestObject)),Object(m.a)("ConvertRefToLocalAttachment",u,s)}function Y(e){return $(Object(g.a)(e).model.Size)}function X(e){return 2856+.00145*e}function K(e){return 4*$(e)}function Q(e){return 4*$(e)}function Z(e){return 2*$(e)}function $(e){return Math.round(e/256)}var ee=n(2545),te={},ne=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,i,o){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:i,source:o}})),re=ne;function ie(e,t,n,i,o,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,d,l,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return[4,Object(_.a)(o)];case 1:c=r.__read.apply(void 0,[p.sent(),4]),u=c[0],s=c[1],d=c[2],l=c[3],te[e.Id]=u,p.label=2;case 2:return p.trys.push([2,4,,5]),[4,J(e.Id,t,u,l,u,n,i)];case 3:return p.sent(),[3,5];case 4:return f=p.sent(),a(f.message),w.h.importAndExecute(s,d),[3,5];case 5:return[2]}}))}))}function oe(e,t){switch(t){case 0:break;case 11:Object(a.a)(e,0,0);break;default:Object(a.a)(e,0,12)}delete te[e.attachmentId.Id]}function ae(e,t,n,r,i){var o,a=Object(g.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size,attachmentId:null===(o=a.model.AttachmentId)||void 0===o?void 0:o.Id})),e.addCustomData([n,i]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function ce(e){return Object(r.__assign)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function ue(e){var t,n,r=function(e){return ce({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=ce(t)),Object(m.a)("CancelConvertRefToLocalAttachment",t,n)}Object(f.orchestrator)(ne,(function(e){var t=e.attachment;!function(e,t,n,i,o,c){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new O.a("AttachmentConvertCloudyToClassic"),function(e){Object(a.a)(e,6,11)}(e),s=function(t){if(oe(e,t.ResultCode),ae(u,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=Object(ee.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});o(!0,n)}else o(!1,null);return!0},d=function(t){oe(e,1),o(!1,null),ae(u,e.attachmentId,1,t,c)},[4,ie(e.attachmentId,t,n,i,s,d)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),d(Y(t.attachmentId),.1,(function(e){R(t,e)}),t.attachmentId)}));var se=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(E.c)(P,{attachmentViewState:e})})),de=se;Object(f.orchestrator)(se,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,te[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(a.a)(e.attachmentViewState,6,10),ue(n)}));var le=n(960),fe=n(1300),pe=n(901);function he(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,fe.h.import()];case 1:return n.sent()(e.model.AttachLongPathName,0).then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(le.e)(e.model,!0),[4,pe.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return i=r.sent(),pe.m.importAndExecute(e.id,i),Object(pe.p)(e.id),[2]}}))}))})),[2]}}))}))}var be=n(54),me=n(844);function ve(e,t,n){if(e&&t===pe.a.providers.ONE_DRIVE_PRO&&(Object(be.f)("doc-SxS-jsApi-ODB-Base")||Object(be.f)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(be.f)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(me.e)(r)){case me.a.Word:return Object(be.f)("doc-SxS-jsApi-ODB-Word");case me.a.Excel:return Object(be.f)("doc-SxS-jsApi-ODB-Excel");case me.a.PowerPoint:return!Object(be.f)("doc-SxS-jsApi-ODB-Readonly")&&Object(be.f)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var Oe=n(1768),ge=n(955);function _e(e,t,n,r,i){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===i&&(i=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:ge.a.Inline,skipProcessInlineImage:i}}function we(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var je=n(1767);n(1932);n.d(t,"a",(function(){return p.a})),n.d(t,"h",(function(){return h.a})),n.d(t,"c",(function(){return L})),n.d(t,"e",(function(){return y})),n.d(t,"u",(function(){return N.a})),n.d(t,"w",(function(){return N.c})),n.d(t,"v",(function(){return N.b})),n.d(t,"D",(function(){return N.d})),n.d(t,"x",(function(){return R})),n.d(t,"y",(function(){return D.a})),n.d(t,"z",(function(){return F.a})),n.d(t,"A",(function(){return a.a})),n.d(t,"E",(function(){return H})),n.d(t,"r",(function(){return M.a})),n.d(t,"o",(function(){return M.b})),n.d(t,"d",(function(){return de})),n.d(t,"f",(function(){return re})),n.d(t,"m",(function(){return he})),n.d(t,"b",(function(){return ve})),n.d(t,"B",(function(){return d})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return X})),n.d(t,"l",(function(){return Q})),n.d(t,"q",(function(){return K})),n.d(t,"j",(function(){return Z})),n.d(t,"g",(function(){return Oe.a})),n.d(t,"i",(function(){return _e})),n.d(t,"p",(function(){return Y})),n.d(t,"t",(function(){return we})),n.d(t,"s",(function(){return U.a})),n.d(t,"n",(function(){return je.a}))},1153:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),i={};function o(e){var t;null===(t=i[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function a(e){var t;return i[e]=null!==(t=i[e])&&void 0!==t?t:new Map}function c(e,t,n){var i=r.useRef();r.useEffect((function(){return function(e,t,n){var r=a(e);0===r.size&&window.addEventListener(e,o),r.set(t,n)}(e,i,t),function(){return function(e,t){var n=a(e);n.delete(t),0===n.size&&window.removeEventListener(e,o)}(e,i)}}),n)}},1158:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}}))},1159:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.View=0]="View",e[e.EnteringEdit=1]="EnteringEdit",e[e.Edit=2]="Edit",e[e.Saving=3]="Saving"}(r||(r={}))},1164:function(e,t,n){"use strict";var r;!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(r||(r={})),t.a=r},1170:function(e){e.exports=JSON.parse('{"b":"Nca","d":"Oca","c":"Pca","a":"Qca"}')},1171:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2477),i="fileType-icon";function o(e){return r[function(e){return i+"-"+e}(e)]}},1176:function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(412),a=n(23);var c=n(19),u=n(191),s=n(48);n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return h}));var d=Object(o.b)({timeBetweenRetryInMS:function(){return 3e4}}),l=function(){function e(e,t,n){var o=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return Object(r.__awaiter)(o,void 0,void 0,(function(){function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Object(a.a)("GetAttachmentDownloadToken",{},n)];case 1:return[2,t.sent()];case 2:throw e=t.sent(),s.d.warn("Unable to get the download token "+e),e;case 3:return[2]}var n}))}))}var t,n,i,o,c=this;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=d((function(){return Object(r.__awaiter)(c,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}}))}))})).retriableFunc,i=new u.b("AttachmentRefreshDownloadToken"),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n()];case 2:return a.sent(),i.addCustomData([t]),i.end(),[3,4];case 3:return o=a.sent(),s.d.warn("Retry to refresh token failed: "+o),i.addCustomData([t]),i.endWithError("ServerError",o),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}}))}))},this.useDownloadUrlBase=!Object(i.f)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(c.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function f(){return l.getInstance().getDownloadToken()}function p(){return l.getInstance().getUseDownloadUrlBase()}function h(){return l.getInstance().getDownloadUrlBase()}},1180:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1868),i=n(1205);function o(e){var t=Object(r.a)(),n=Object(i.b)(e);return t.sharingLinks.get(n)}},1182:function(e,t,n){"use strict";var r=n(0),i=n(23);function o(e){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function a(e){var t,n,r=o({ProviderType:e});return void 0===(t=r)||t.__type||(t=o(t)),Object(i.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function c(e){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function u(e){var t,n,r=c({ProviderType:e});return void 0===(t=r)||t.__type||(t=c(t)),Object(i.a)("GetAttachmentDataProviderCreator",t,n)}var s=n(2363),d=n(1576);n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return w}));var l="code",f="token",p=3e3,h=3;function b(e){return{state:e}}function m(e){return e.state}function v(e){return e.code}function O(e,t,n,i,o){var c={providerType:e,getAuthUrlInfo:null,getCSRFToken:m,getOAuthCode:v};return function e(t,n,i,o,c,d,l){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,u(t)];case 1:return h=r.sent(),f=h.AttachmentDataProviderCreator.ProviderAppKey,i=h.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,a(t)];case 3:h=r.sent(),f=h.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(t,i,o,f,c,d),[3,6];case 5:return r.sent(),l>0&&setTimeout((function(){return e(t,n,i,o,c,d,--l)}),p),[3,6];case 6:return[2]}}))}))}(e,c,t,n,i,o,h),c}var g=null;function _(){if(!g){if(g={},Object(d.a)(3)&&(g[3]=O(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),l,b)),Object(d.a)(2)&&(g[2]=O(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),l,b)),Object(d.a)(6)){var e=O(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=m,e.getOAuthCode=function(e){return e.access_token},g[6]=e}if(Object(d.a)(5)){var t=O(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",l,(function(e){var t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},g[5]=t}Object(d.a)(1)&&(g[1]=O(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),l,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(d.a)(7)&&(g[7]=O(7,"",Object(s.c)(7),l,b)),Object(d.a)(8)&&(g[8]=O(8,"",Object(s.c)(8),l,b)),Object(d.a)(9)&&(g[9]=O(9,"",Object(s.c)(9),l,b))}return g}function w(e){var t=_();return e in t?t[e]:null}},1196:function(e,t,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1205:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(54),i="_ODSPPSL";function o(e){return Object(r.f)("doc-link-savePermission")&&e&&-1!==e.indexOf(i)?e.substring(0,e.length-i.length):e}function a(e){return!!Object(r.f)("doc-link-savePermission")&&e.lastIndexOf(i)===e.length-i.length}function c(e,t){return!Object(r.f)("doc-link-savePermission")||2!==t&&1!==t?e:e+i}},1234:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u}));var r=n(86),i=new r.c((function(){return Promise.all([n.e(13),n.e(17),n.e(79),n.e(65),n.e(285)]).then(n.bind(null,3037))})),ReactEditor=Object(r.d)(i,(function(e){return e.ReactEditor})),o=new r.b(i,(function(e){return e.setTableHeaderRow})),a=new r.b(i,(function(e){return e.operateContent})),c=new r.b(i,(function(e){return e.focusToEditor}));function u(e){c.import().then((function(t){return t(e)}))}},1235:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"n",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"p",(function(){return v})),n.d(t,"h",(function(){return O}));var r=100,i=1,o="PublicDL",a="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",d="ExternalMailbox",l="Mailbox",f="OneOff",p="Contact",h="ImplicitContact",b="PublicFolder",m="Other",v="Room",O="LinkedIn"},1236:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(0),i=n(1270),o=function(){return Object(r.__spread)(Object(i.a)().providers.values())},a=function(e){return Object(i.a)().providers.get(e)||null}},1237:function(e,t,n){"use strict";var r="POST",i=n(0),o=n(191),a=n(1406),c=n(188),u=n(1794),s=n(2289),d=n(48);function l(e,t,n,r,c){return Object(i.__awaiter)(this,void 0,void 0,(function(){var u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Object(a.d)(e,!1,n)];case 1:return u=i.sent(),[3,3];case 2:return i.sent(),[3,3];case 3:return u&&u.split(a.a)[1]?(Object(o.o)("fetchServiceViaDataProvider",[e]),d.d.info("fetchServiceViaDataProvider"),[4,f(t,u,r,c)]):[3,5];case 4:return[2,i.sent()];case 5:Object(o.o)("fetchServiceFailedToGetToken",[e]),i.label=6;case 6:return 0!==e?[3,8]:(Object(o.o)("fetchServiceViaOWAServer"),d.d.info("fetchServiceViaOWAServer"),[4,p(e,t,r,c)]);case 7:return[2,i.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function f(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,u,s;return Object(i.__generator)(this,(function(i){return a=n.datapointNamePrefix+"DataProvider",u=new o.a(a),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},r&&Object.keys(r).forEach((function(e){s[e]=r[e]})),[2,fetch(e,{method:n.method,mode:n.mode,headers:s,body:n.body}).then((function(e){if(Object(c.a)(e.status))return u.end(),e.json();var t=new Error(a+" : Response status = "+e.status+", body = "+e.body);throw u.endWithError("ServerError",t),t})).then((function(e){return JSON.stringify(e)}))]}))}))}function p(e,t,n,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){var d,l,f,p,h;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return d=n.datapointNamePrefix+"OWA",l=new o.a(d),f=Object(u.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(a),IsJsonPost:n.method===r}),[4,Object(s.a)(f)];case 1:if(p=i.sent(),Object(c.a)(p.Status))return l.end(),[2,p.Body];throw h=new Error(d+" : Response status = "+p.Status+", ServerTraceLog = "+p.ServerTraceLog),l.endWithError("ServerError",h),h}}))}))}function h(e){return"u!"+btoa(e).replace(/=+$/,"").replace("/","_").replace("+","-")}n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return"cors"})),n.d(t,"b",(function(){return"GET"})),n.d(t,"e",(function(){return"PUT"})),n.d(t,"c",(function(){return"PATCH"})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return h}))},1244:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},1261:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(0),i=n(1595),o=n(1461),a=n(1122),c=n(191),u="EditorRibbonUsage";function s(e,t){for(var n,o=[],c=2;c<arguments.length;c++)o[c-2]=arguments[c];var u=a.Editor.prototype[t];return Object(i.b)(e,(function(e){n=u.call.apply(u,Object(r.__spread)([e],o))}),null),n}function d(e,t,n,a){var s;void 0===n&&(n=[]),void 0===a&&(a=n);var d=o[t];return Object(i.b)(e,(function(e){s=d.apply(void 0,Object(r.__spread)([e],n)),(null==a?void 0:a.length)>0&&Object(c.o)(u+t,Object(r.__spread)(a.map((function(e){return JSON.stringify(e)})),[e.isDarkMode()]))}),null),s}},1270:function(e,t,n){"use strict";var r=n(4),i=n(14),o=n(1544),a={providers:new i.ObservableMap,loadState:o.a.NotLoaded,removalPending:new i.ObservableMap},c=Object(r.createStore)("fileProviderStore",a);t.a=c},1293:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(4),i=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),o=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),a=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},1300:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"g",(function(){return b})),n.d(t,"j",(function(){return m})),n.d(t,"l",(function(){return v}));var r=n(86),i=n(1542);n.d(t,"n",(function(){return i.a}));var o=n(1489);n.d(t,"a",(function(){return o.a}));n(1235);var a=n(1196);n.d(t,"d",(function(){return a.b})),n.d(t,"c",(function(){return a.a}));var c=n(1543);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(7),n.e(14),n.e(47),n.e(476)]).then(n.bind(null,3025))})),s=new r.b(u,(function(e){return e.getSharingInformation})),d=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),l=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),p=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),h=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),b=new r.b(u,(function(e){return e.getInvididualRecipients})),m=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),v=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1304:function(e,t,n){"use strict";var r=n(0),i="https://www.googleapis.com/drive/v3/files",o=n(1406);function a(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=n.forceTokenRefresh,a=n.requestInit||{},[4,Object(o.d)(t,i,e)];case 1:return c=r.sent(),a.headers||(a.headers=new Headers),a.headers.set("Authorization",c),[4,fetch(e,a)];case 2:return[2,r.sent()]}}))}))}function c(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(i+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o)}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}function u(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(i+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var s=n(221),d=n(1237),l=n(54),f=n(196),p=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function h(){return Object.keys(p).map((function(e){return p[e]})).join(",")}var b,m="_api/v2.0",v="/v1.0",O="root";function g(e){switch(e){case 1:return v;case 0:return m;default:return Object(s.a)(e)}}function _(e){return g(e)+"/drive"}function w(e){return g(e)+"/shares"}function j(e){return _(e)+"/items"}function I(e,t,n,i,o,c,u){return void 0===c&&(c=b.None),Object(r.__awaiter)(this,void 0,void 0,(function(){var m,v,g,_,w,I,y,k,C,S,T;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=o||O,m=function(e){switch(e){case 0:return p.name;case 1:return p.size;default:return p.lastModifiedDateTime}}(n),v=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(s.a)(e)}}(i),g=function(e,t,n){switch(e){case 0:return"folder,"+t+" "+n;case 1:return t+" "+n;default:return Object(s.a)(e)}}(t,m,v),_="expand=thumbnails(select=medium)&orderby="+g+"&select="+h(),c!==b.None&&(_=_+"&filter="+function(e){switch(e){case b.None:return"";case b.Folder:return"("+p.folder+" ne null)";default:return Object(s.a)(e)}}(c)),u&&(_=_+"&$top="+u.maxEntries,u.skipToken&&(_=_+"&$skiptoken="+u.skipToken)),w=e+"/"+j(t)+"/"+o+"/children?"+_,I={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},Object(l.f)("doc-attachment-uploadAndShareFallback")||Object(l.f)("doc-filePicker-getOneDriveItemsViaFetch")?(k=Response.bind,[4,Object(d.f)(t,encodeURI(w),w,{method:d.b,mode:d.a,datapointNamePrefix:"getOneDriveItems"},I)]):[3,2];case 1:return y=new(k.apply(Response,[void 0,r.sent()])),[3,4];case 2:return[4,a(w,t,{requestInit:{headers:new Headers(I)}})];case 3:y=r.sent(),r.label=4;case 4:return y.ok?[4,y.text()]:[3,6];case 5:return C=r.sent(),S=JSON.parse(C),T=S["@odata.nextLink"]?function(e){var t=Object(f.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(S["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:S.value,skipToken:T}}];case 6:return[2,{errorResponse:y,result:null}]}}))}))}function y(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,c,u,s,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=i||O,o="expand=thumbnails(select=medium)&select="+h(),c=t+"/"+j(e)+"/"+i+"/children?"+o,u={name:n,folder:{}},(s=new Headers).append("Content-Type","application/json"),s.append("Accept","application/json"),[4,a(c,e,{requestInit:{method:"POST",body:JSON.stringify(u),headers:s}})];case 1:return(d=r.sent()).ok?[4,d.text()]:[3,3];case 2:return l=r.sent(),[2,{errorResponse:null,result:JSON.parse(l)}];case 3:return[2,{errorResponse:d,result:null}]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(b||(b={}));var k=n(2952),C=n(188);var S=Object.freeze({folderInfo:{type:0,identifier:O},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function T(e,t,n){var i=this,o=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(r.__awaiter)(i,void 0,void 0,(function(){var i,c,u,f,p,h,b,m,v,O,g,w,I,y,T,A,E,L,N;return Object(r.__generator)(this,(function(R){switch(R.label){case 0:switch(function(e){Object.keys(S).forEach((function(t){e[t]=e[t]||S[t]}))}(n),i=n.fileToUpload,c=i.fileName,u=i.fileBlob,f=n.folderInfo,p=f.type,h=f.identifier,b=n.conflictBehavior,m=n.sliceSize,v=n.onProgress,p){case 0:O=t+"/"+j(e)+"/"+h+":/"+encodeURI(c)+":/createUploadSession";break;case 1:O=t+"/"+_(e)+"/"+h+":/"+encodeURI(c)+":/createUploadSession";break;default:Object(s.a)(p)}return g={item:{"@name.conflictBehavior":b}},w=new Headers({"Content-Type":"application/json",Accept:"application/json"}),Object(l.f)("doc-attachment-uploadAndShareFallback")?(y=Response.bind,[4,Object(d.f)(e,encodeURI(O),O,{method:d.d,mode:d.a,body:JSON.stringify(g),datapointNamePrefix:"createUploadSession"},null)]):[3,2];case 1:return I=new(y.apply(Response,[void 0,R.sent()])),[3,4];case 2:return[4,a(O,e,{requestInit:{method:d.d,body:JSON.stringify(g),headers:w}})];case 3:I=R.sent(),R.label=4;case 4:return I.ok?[4,I.text()]:[3,7];case 5:return T=R.sent(),A=JSON.parse(T),E=function(e,t,n,i){var o=this,a=e.uploadUrl,c=t.size,u=null,d=null,l=function(e,t,n,i,o,a){var c=this;return function(u,s){return Object(r.__awaiter)(c,void 0,void 0,(function(){var c,d,l,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=function(e,t,n){var r=P(e,t,n),i=r.rangeStart,o=r.rangeEnd;return new Headers({"Content-Range":"bytes "+i+"-"+o+"/"+n,Accept:"application/json"})}(s,t,n),d=function(e){var r=P(e,t,n).rangeStart;return function(e){var t=e.loaded;i({loaded:r+t,total:n})}}(s),[4,(h=e,b=d,m={method:"PUT",body:u,headers:c},void 0===m&&(m={method:"POST"}),new Promise((function(e,t){var n=m.method,r=m.body,i=m.headers,o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&e({status:o.status,text:function(){return Promise.resolve(o.responseText)}})},o.ontimeout=function(){t(new Error("Request timed out"))},o.onerror=function(){t(new Error("Request failed"))},o.onabort=function(){t(new Error("Request aborted"))},b&&(o.upload.onprogress=b),o.open(n,h,!0),new Headers(i).forEach((function(e,t){o.setRequestHeader(t,e)})),r?o.send(r):o.send()})))];case 1:return 201!==(l=r.sent()).status&&200!==l.status?[3,3]:[4,l.text()];case 2:f=r.sent(),p=JSON.parse(f),o(p),r.label=3;case 3:if(!Object(C.a)(l.status))throw a(l),new Error("Unable to upload file");return[2]}var h,b,m}))}))}}(a,n,c,i,(function(e){u=e}),(function(e){d=e})),f=Object(k.a)(t,l,{sliceSize:n,numberOfSlicesToParallelize:1}),p=f.onCompletePromise,h=f.cancel,b=Object(r.__awaiter)(o,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,p];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:d,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:d,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(s.a)(e)]}return[2]}}))}));return{uploadPromise:b,cancel:function(){return Object(r.__awaiter)(o,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:h(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,b];case 2:return e.sent(),[3,5];case 3:return[4,x(a)];case 4:return[2,e.sent()];case 5:return[2]}}))}))}}}(A,u,m,v),L=E.uploadPromise,N=E.cancel,o=N,[4,L];case 6:return[2,R.sent()];case 7:return[2,{errorResponse:I,result:null}]}}))})),cancel:function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,o()];case 1:return[2,e.sent()]}}))}))}}}function P(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function x(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object(C.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var A="https://api.dropboxapi.com/2/files";function E(e,t){switch(e){case 0:return t;case 1:return null;default:Object(s.a)(e)}return null}function L(e){return"file"===e[".tag"]}function N(e){return"folder"===e[".tag"]}function R(e){return"deleted"===e[".tag"]}function D(e){return"folder"===e.type}function F(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.path=e.path||"",t=A+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,a(t,2,{requestInit:n})];case 1:return(i=r.sent()).ok?[4,i.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:i,result:null}]}}))}))}var M,U="https://api.box.com/2.0",q=2e3;function W(e,t){return void 0===t&&(t=q),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(U+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(M||(M={}));var B=M,V="https://graph.facebook.com/v2.7",z=200;function H(e,t){return void 0===t&&(t=z),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(V+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).data}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}var G=n(527),J=n(528),Y=n(336),X=n(826),K=n(909),Q=n(387),Z=n(151),$=n(48);function ee(e,t){var n=function(e,t){return Object(J.a)({ParentFolderIds:[Object(Y.a)({Id:e})],ItemShape:Object(Q.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(G.a)({Header:Object(Z.a)(),Body:n})}function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(K.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,ee(e=e||Object(X.a)("inbox"),n)];case 1:return i=r.sent(),(o=i.Body.ResponseMessages.Items[0])&&"Success"===o.ResponseClass&&o.RootFolder.Items?[2,{errorResponse:null,result:o.RootFolder.Items}]:($.d.warn("Find Item Response of get mail messages failed with "+o),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return I})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"v",(function(){return T})),n.d(t,"i",(function(){return _})),n.d(t,"q",(function(){return w})),n.d(t,"e",(function(){return"https://api.onedrive.com"})),n.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"d",(function(){return i})),n.d(t,"p",(function(){return E})),n.d(t,"t",(function(){return L})),n.d(t,"u",(function(){return N})),n.d(t,"s",(function(){return R})),n.d(t,"j",(function(){return F})),n.d(t,"r",(function(){return D})),n.d(t,"h",(function(){return W})),n.d(t,"a",(function(){return U})),n.d(t,"c",(function(){return B})),n.d(t,"k",(function(){return H})),n.d(t,"n",(function(){return te}))},1306:function(e,t,n){"use strict";var r=n(2158),i=n(7),o=n(1795),a=n(1011);var c=n(964),u=n(1118),s=n(960),d=n(901),l=n(103);n.d(t,"b",(function(){return p}));var f=null;function p(){return f||(f=Object.keys(c.a).reduce((function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e}),[])),f}t.a=Object(l.action)("initializeAttachmentFullViewState")((function(e,t,n,l,f){var h;l&&0!==l.length||(h=t.model,l=Object(d.e)(h)?function(e){return 2===Object(d.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(h):p());var b=Object(s.e)(t.model,!0),m=Object(s.k)(),v=Object(u.a)(t),O=Object(r.a)(m,b,t.attachmentClass,t.model,v?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,l,e.isReadOnly,n,f);e.strategy=O,function(e,t,n){n&&!Object(i.f)(t.model.AttachmentOriginalUrl)&&(Object(o.a)(e,2),Object(a.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1315:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1334:function(e,t,n){"use strict";n.r(t),n.d(t,"EnteredEditModeEvent",(function(){return r})),n.d(t,"ExitedEditModeEvent",(function(){return i})),n.d(t,"PreviewLoadEvent",(function(){return o})),n.d(t,"PreviewErrorEvent",(function(){return a})),n.d(t,"PreviewLoadOrErrorEvent",(function(){return c})),n.d(t,"CloseEvent",(function(){return u})),n.d(t,"AnimationEndEvent",(function(){return s}));var r="EnteredEditMode",i="ExitedEditMode",o="PreviewLoad",a="PreviewError",c="PreviewLoadOrError",u="Close",s="AnimationEnd"},1348:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1359:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},1361:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r,i=n(1058),o=n(1375);function a(e,t,n,a,c){if(n)return r=r||{extraSmall:Object(i.b)("generic").extraSmall,small:Object(i.b)("generic").small,medium:Object(i.b)("blockedfile").medium,large:Object(i.b)("generic").large,cdn:Object(o.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":case"IPM.Schedule.Meeting.Request":case"IPM.Schedule.Meeting.Canceled":return Object(i.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(i.b)("calendar")}return a?Object(i.b)("sharedfolder"):Object(i.a)(e,!1,t)||Object(i.b)("generic")}},1364:function(e,t,n){"use strict";var r=n(221),i=n(7),o=n(24),a="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",p="pdfprint.aspx?id={0}&location={1}",h=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var b=n(1176),m=n(205),v=n(52),O=n(2);function g(e,t,n,c,s,l,f,b,m){var v;switch(void 0===s&&(s=0),void 0===l&&(l=0),void 0===f&&(f=!0),void 0===b&&(b=null),void 0===m&&(m=null),n){case 0:v=u;break;case 3:v=p;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&h.indexOf(t.toLowerCase())>=0}(b))return null;v=d;break;default:Object(r.a)(n)}var O=c?l:s;!O&&s&&(O=s);var g=Object(i.b)("{0}{1}{2}&permissionLevel={3}",a,m,Object(i.b)(v,encodeURIComponent(e.Id),encodeURIComponent(t)),O);f&&(g=g+"&X-OWA-CANARY="+Object(o.a)());return g}function _(e,t,n,u,d){var p;switch(void 0===u&&(u=!1),void 0===d&&(d=!0),n){case 0:p=c;break;case 1:p=s;break;case 2:p=l;break;case 3:p=f;break;default:return Object(r.a)(n)}return Object(i.f)(p)?null:Object(i.b)("{0}{1}{2}",function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var u=Object(i.b)(n,encodeURIComponent(t.Id));if(!Object(b.c)()||c&&"Firefox"===Object(v.a)().browser)return a+u+"&X-OWA-CANARY="+Object(o.a)();var s="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(m.a)()&&(s+="&isc=1");var d=Object(i.b)(s,Object(b.b)(),e,u,window.location.hostname,Object(O.g)()||"unofficial");return r&&(d+="&X-OWA-CANARY="+Object(o.a)(),d+="&token="+Object(b.a)()),d}(e,t,p,d,3===n),u?"&isDownload=true":"","&animation=true")}n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return _}))},1375:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=1;function i(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1394:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ConversationReadingPane=0]="ConversationReadingPane",e[e.ItemReadingPane=1]="ItemReadingPane"}(r||(r={}))},1395:function(e,t,n){"use strict";var r=n(0),i=n(1761),o=n(1889),a=n(221);var c=Object(i.a)((function(e){switch(e){case 0:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(o.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(a.a)(e)}})),u=c.getDataProviderInfo;c.getDefaultDataProviderInfo;t.a=u},1397:function(e,t,n){"use strict";var r=n(1364);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(1176);n.d(t,"c",(function(){return i.a}))},1406:function(e,t,n){"use strict";var r=n(0),i=n(2097),o=n.n(i),a=n(7),c=n(205),u=n(585),s=n(196),d=n(23);function l(e){return Object(r.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=l(e)),Object(d.a)("GetAccessTokenforDataProvider",e,t)}function p(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=l({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),o=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(a=new Headers).append("X-OWA-ActionName",o),[4,f(i,{headers:a,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(c=r.sent()).json()];case 2:return[2,{token:r.sent(),response:c}]}}))}))}var h="onedrive_implicit.access",b="Bearer ",m=n(54),v=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},O=function(e){return"TokenRetrievalError"===e._typeSpec},g=[],_={},w=1,j=30,I="",y="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function k(e){_[e]=null}function C(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(e,t,n)];case 1:return i=r.sent(),function(e,t,n){g=g.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var i="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,o=n.response.headers.get("x-tokenresult"),a=null!=o&&o.indexOf(y)>0;throw v(new Error(i),r.TokenResultCode,a)}var c=_[e]||{};c[t]=r,_[e]=c}(e,t,i),[2,i.token]}}))}))}function S(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){return i=I,0===e&&n&&(o=Object(s.parse)(n),i=Object(a.b)("{0}//{1}/",o.protocol,o.hostname)),Object(m.f)("doc-attachment-testAuthFallback")?[2,""]:[2,P(e,i,t,null)]}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,P(0,e,t,n)]}))}))}function P(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=_[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var i=new Date(r.AccessTokenExpiry),a=o()(new Date(Date.now()),w);return null!=i&&a<i}(e,t)?[3,1]:(a=_[e],c=a[t],o()(new Date(Date.now()),j)>new Date(c.AccessTokenExpiry)&&-1===g.indexOf(t)&&(g.push(t),C(e,t,i)),[2,c.AccessToken]);case 1:return[4,C(e,t,i)];case 2:return[2,(c=r.sent()).AccessToken]}}))}))}function x(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(h)]:[3,2];case 1:return i=r.sent(),[3,4];case 2:return[4,S(e,t,n)];case 3:i=r.sent(),r.label=4;case 4:return[2,b+i]}}))}))}n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return S})),n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return k})),n.d(t,"f",(function(){return O})),n.d(t,"a",(function(){return b}))},1408:function(e,t,n){"use strict";var r=n(0),i=n(191),o=n(3014),a=n(864),c=n(2412),u=n(2641),s=n(54),d=n(103),l=n(1932),f=n(1795),p=n(2158),h=n(1011),b=Object(d.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return _}));t.a=Object(d.action)("saveToCloud")((function(e,t,n,i){var o=Object(r.__read)(v(e,t,n,i,!1),2),a=o[0],c=o[1];Object(u.b)(e.attachmentId,null,a,c)}));function m(e,t,n,i,o){var a=Object(r.__read)(v(e,t,n,i,!0),2),c=a[0],s=a[1];Object(u.c)(e.attachmentId,c,s,o)}function v(e,t,n,r,o){var a=new i.a("AttachmentSaveToCloud");l.a.run(2,e.attachmentId),g(e,o);return[function(i){var o=0===i.ResultCode;return _(e,o,o?i.Item.Location:null),t(o),O(a,e.attachmentId,i.ResultCode,"ServerError",i.Exception,n,r),!0},function(i,o,c){_(e,!1,null),t(!1),O(a,e.attachmentId,o,c,i,n,r)}]}function O(e,t,n,r,o,u,d){var l=Object(a.a)(t);e.addCustomData({entryPoint:u,result:n}),e.addCosmosOnlyData(JSON.stringify({size:l.model.Size,fileType:Object(c.a)(l)})),0===n?e.end():e.endWithError(r,new Error(o)),Object(s.f)("doc-attachment-sigs")&&i.l.importAndExecute("AttachmentSaved",{itemId:null==d?void 0:d.Id,customProperties:{FileId:t.Id,Destination:"Cloud"}})}function g(e,t){void 0===t&&(t=!1);var n=t?18:1;Object(h.a)(e,2,n)}function _(e,t,n){if(t){Object(f.a)(e,2),Object(o.a)(e.attachmentId,n),l.a.run(3,e.attachmentId);var r=Object(p.b)(!1,!1,n);b(e,r)}else l.a.run(4,e.attachmentId);Object(h.a)(e,0,t?3:4)}},1414:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected",e[e.SelectedAndPending=3]="SelectedAndPending",e[e.SelectedAndSaving=4]="SelectedAndSaving",e[e.NotSelectedAndSaving=5]="NotSelectedAndSaving",e[e.OtherSaving=6]="OtherSaving",e[e.PendingNavigation=7]="PendingNavigation"}(r||(r={})),t.a=r},1426:function(e,t,n){"use strict";var r=n(86),i=n(1793),o=n(1745),a=(n(1270),n(1293)),c=n(1437),u=(n(2333),n(2283),n(1236));var s=n(1718),d=n(1544),l=n(1182);n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return h})),n.d(t,"k",(function(){return b})),n.d(t,"m",(function(){return m})),n.d(t,"b",(function(){return i.a})),n.d(t,"i",(function(){return o.a})),n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b})),n.d(t,"o",(function(){return a.c})),n.d(t,"a",(function(){return c.b})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b})),n.d(t,"j",(function(){return s.a})),n.d(t,"c",(function(){return d.a})),n.d(t,"f",(function(){return l.b}));var f=new r.c((function(){return Promise.all([n.e(14),n.e(30),n.e(236)]).then(n.bind(null,13383))})),p=new r.b(f,(function(e){return e.loadProviders})),h=new r.b(f,(function(e){return e.removeFileProvider})),b=new r.b(f,(function(e){return e.addFileProvider})),m=new r.b(f,(function(e){return e.removeAndAddFileProvider}))},1437:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var r,i=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var o=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(Object(i.__spread)(o,[0,4,10]))},1455:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(86),i=n(1058);n.d(t,"e",(function(){return i.a})),n.d(t,"b",(function(){return i.b}));var o=n(1361);n.d(t,"d",(function(){return o.a}));var a=n(1171);n.d(t,"c",(function(){return a.a}));var c=new r.c((function(){return n.e(233).then(n.bind(null,2803))})),u=Object(r.d)(c,(function(e){return e.CloudIconWithOverlay}))},146:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){o(t),a&&a(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var a=e[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&t++,a.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(o)if(e[a])continue;var c=r[a],u=c.expire-i;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1489:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1494:function(e,t,n){"use strict";var r=n(221),i=n(87),o=n(1397),a=n(24),c=n(1244);function u(e,t,n,a,u){var s;void 0===u&&(u=!0);var d=t,l=d.AttachmentId,f=d.Name,p=d.OriginalPermissionType,h=d.PermissionType,b=Object(c.a)(t),m=(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)===i.a.GroupMailbox?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return o.b(l,b,n,a,h,p,u,f,m);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:o.b(l,b,1,a,h,p,u,f,m);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),o.a(e.mailboxInfo.routingKey,e,t,n,r)}function d(e,t,n,r,i){void 0===i&&(i=!1);var c=n?u(e,t,1,r,!1):s(e,1,i,!1);if(n)return{url:c,init:{credentials:"include"}};var d=Object(o.c)(),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(a.a)()),{url:c,init:{headers:l}}}function l(e,t,n,r,i,o){return void 0===o&&(o=!1),r?u(e,t,n,i):s(e,n,o)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d}))},1519:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r={};function i(e,t){r[e]=t}function o(e){return e in r?r[e]:null}function a(e){r[e]=null}},1542:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1543:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1544:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},1566:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1576:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(19),i=n(205),o=n(221),a=n(54);function c(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.f)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.f)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.f)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.f)("doc-fileProvider-facebook");case 1:return!!Object(i.a)()||t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(a.f)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.f)("doc-fileProvider-wopiClient");default:return Object(o.a)(e)}}},1595:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));var r={};function i(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function o(e){delete r[e.editorId]}function a(e,t,n,i){if(e){var o=e.bodyType,a=void 0===o||"HTML"===o,c="Text"===o,u=r[e.editorId]||{},s=u.htmlEditor,d=u.plainTextEditor;a&&t&&(s&&!s.isDisposed()||i)?t(s):c&&n&&(d||i)&&n(d)}}},1616:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(23);function i(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},1636:function(e,t,n){"use strict";var r=n(0),i=n(445),o=n(961);function a(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=t||Object(i.a)(),a={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},c=function(t){e(t)&&o.h.importAndExecute(a,c)},[4,o.g.import()];case 1:return r.sent()(a,c),[4,o.b.import()];case 2:return u=r.sent()(),[2,[n,a,c,u]]}}))}))}n.d(t,"a",(function(){return a}))},1667:function(e,t,n){var r=n(1141);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},1678:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(4),i=Object(r.action)("tryProcessSharePointLink",(function(e,t){return{element:e,itemId:t}})),o=Object(r.action)("tryUndoProcessSharePointLink",(function(e){return{elements:e}})),a=Object(r.action)("previewLinkInSxS",(function(e,t){return{wacUrlGetter:e,itemId:t}}))},1717:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},1718:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1270);function i(){return Object(r.a)().loadState}},1721:function(e,t,n){"use strict";var r=n(103);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},1722:function(e,t,n){"use strict";var r=n(103);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},1745:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2489),i=n(2282),o=n(2400),a=n(7),c=n(221);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(a.a)(o.b);case 1:return Object(a.a)(o.a);case 2:case 9:return Object(a.a)(r.b);case 3:case 7:return Object(a.a)(r.a);case 5:return Object(a.a)(r.e);case 6:return Object(a.a)(r.d);case 4:return Object(a.a)(r.f);case 10:return Object(a.a)(i.b);case 8:return Object(a.a)(r.c);default:return Object(c.a)(e)}}},1760:function(e){e.exports=JSON.parse('{"a":"tia","c":"uia","b":"via"}')},1761:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(870),o=n(955),a=[0,1,3,2,6,5,7,8,4];function c(e){var t=null,n=function(n){var i=Object(o.b)(n);return null===i?null:function(){var n,i;if(!t){t={};try{for(var o=Object(r.__values)(a),c=o.next();!c.done;c=o.next()){var u=c.value;t[u]=e(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}return t}()[i]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?i.l:i.m)}}}},1766:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},1767:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),i=n(221),o=n(1761),a=n(205);var c=Object(o.a)((function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},t),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},e),{supportConvertCloudyToClassic:Object(a.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(i.a)(e)}var t})),u=c.getDataProviderInfo,s=c.getDefaultDataProviderInfo;t.a=u},1768:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(908),o=n(955);function a(e,t,n,a,c,u,s){void 0===c&&(c=o.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var d=Object(i.c)(e,t,a,u,c,s),l=d.strategy;return Object(r.__assign)(Object(r.__assign)({},d),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},1787:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1015),i=n(1359),o=n(1348);function a(){return{previewPane:{downloadUrl:null,mode:i.a.Blank},didAutoHideRightPane:!1,hideRightPane:!1,rightPaneSize:0,leftPaneSizePixels:0,rightPaneSizePixels:0,rightPaneDisplay:o.a.Initial,eventManager:new r.a}}},1793:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},1794:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},1795:function(e,t,n){"use strict";var r=n(103);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},1841:function(e,t,n){"use strict";var r=n(4),i=n(84),o=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(i.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=o},1867:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function i(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},1868:function(e,t,n){"use strict";var r=n(14),i=n(4),o={sharingLinks:new r.ObservableMap({})},a=Object(i.createStore)("sharingLinkStore",o);t.a=a},1889:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function i(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},1903:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];var n=[];if(0===t){var r=e;r.CanShareInternally&&(n.push(2),n.push(1)),r.CanCreateOrganizationEditLink&&n.push(6),r.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function i(e){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;default:return 0}}function o(e,t,n){var r=i(e);if(0===r)switch(t){case 2:return n?4:3;case 1:return n?6:5;case 5:return n?2:1;default:return 0}return r}var a=n(3142),c=n(7),u="OneDrivePro",s=n(221),d=n(19);function l(e,t){switch(e){case 3:return Object(c.a)(a.b);case 4:return Object(c.a)(a.a);case 6:return Object(c.a)(a.d);case 5:return Object(c.a)(a.e);case 1:return t===u?Object(c.a)(a.g):Object(c.a)(a.b);case 2:return t===u?Object(c.a)(a.f):Object(c.a)(a.a);case 0:return Object(c.a)(a.c);default:return Object(s.a)(e)}}function f(e,t){return 0===t?function(e){var t,n=null===(t=Object(d.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(c.a)(a.i);case 4:return Object(c.a)(a.h);case 6:return Object(c.b)(Object(c.a)(a.j),n);case 5:return Object(c.b)(Object(c.a)(a.k),n);case 1:return Object(c.a)(a.g);case 2:return Object(c.a)(a.f);case 0:return Object(c.a)(a.c);default:return Object(s.a)(e)}}(e):l(e,null)}function p(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p}))},1932:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=null,i={register:function(e){r=e},run:function(e,t){r&&r(e,t)}}},2005:function(e,t,n){"use strict";var r=n(7),i=n(2956),o=n(3184),a=n(1395),c=n(3143),u=n(2717),s=n(3013),d=n(1118),l=n(2630),f=n(960),p=n(19),h=n(48),b=n(103),m=n(952);var v=n(0),O=n(991);t.a=Object(b.action)("addAndInitializeAttachments")((function(e,t,n,g){void 0===n&&(n=!1),void 0===g&&(g=!1);var _=Object(m.a)();n||(e=e.filter((function(e){return!_.attachments.has(e.attachment.AttachmentId.Id)}))),e.map((function(e){var n=e.attachmentId,_=e.attachment,w=e.permissionInfo,j=e.modelInitializationValues,I=function(e,t){var n={id:e,type:Object(O.a)(t),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:t};return 1===n.type?Object(v.__assign)(Object(v.__assign)({},n),{type:1,openUrl:null,isFolder:t.AttachmentIsFolder,requiresFetchingSharingInformation:!1}):n}(n,_);return g||function(e,t,n){var v=Object(d.a)(e),O=Object(f.e)(e.model,!0),g=Object(o.a)(O,e.model);if(e.attachmentClass=g,e.info=Object(i.a)(O,g,e.model,v,v?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(u.a)(e.id,e.model,!0,!0)),v&&(e.openUrl=Object(s.a)(e.model,Object(p.a)()),!n)){var _=e.model,w=Object(a.a)(_.ProviderType);(null==w?void 0:w.requiresFetchingSharingInformation)&&!Object(r.f)(_.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)}if(Object(l.a)(e.model)){var j=e.id.Id;Object(c.a)(e.id,e.model,v).then(Object(b.action)("updateAttachmentThumbnailUrl")((function(e){Object(m.a)().attachments.has(j)&&(Object(m.a)().attachments.get(j).thumbnailImage.url=e)})),(function(e){h.d.warn(e)}))}}(I,w,t),function(e,t){t=t||{},Object.keys(t).forEach((function(n){t[n]&&(e[n]=t[n])}))}(I,j||{}),I})).forEach((function(e){_.attachments.set(e.id.Id,e)}))}))},2040:function(e,t,n){"use strict";function r(e,t,n){var r,i=e||((null===(r=null===window||void 0===window?void 0:window.navigator)||void 0===r?void 0:r.userAgent)?window.navigator.userAgent:""),o=-1!==i.indexOf("MSIE")||-1!==i.indexOf("rv:")&&-1!==i.indexOf("Trident"),a=-1===i.indexOf("Edge")&&-1!==i.indexOf("Chrome"),c=-1!==i.indexOf("Firefox"),u=-1!==i.indexOf("Edge");return a?function(e){return(e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins))&&"function"==typeof e.namedItem&&(null!==e.namedItem("Chrome PDF Viewer")||null!==e.namedItem("Microsoft Edge PDF Viewer"))}(n):o?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(t||function(e){return new ActiveXObject(e)}):!c&&!u}n.d(t,"a",(function(){return r}))},2097:function(e,t,n){var r=n(1667),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},2100:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function o(e,t){e.addCustomProperty("ErrorInformation",t)}function a(e,t){o(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a}))},2101:function(e,t,n){"use strict";var r=n(103);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2110:function(e,t,n){"use strict";var r=n(1306),i=n(0),o=n(993),a=n(891);var c=n(2629);function u(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==a.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===a.a.Wac&&(r.previewMethod=a.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter((function(e){return e!==o.a.Preview}))),n.label=2;case 2:return[2]}var r}))}))}var s=n(1768),d=n(955),l=n(1131),f=n(2005),p=n(864);function h(e,t,n,i,o,a,c,h,b){void 0===c&&(c=null),void 0===b&&(b=!1),Object(f.a)([{attachmentId:e,attachment:t}],n,o);var m=Object(p.a)(e),v=Object(s.a)(e,n,i,1===m.type,d.a.Unknown,!1,c);if(Object(r.a)(v,m,!1,h,a),b){var O=m.model.ProviderType;Object(l.b)(v.isCloudy,O,m.model.Name)||u(v)}return v}n.d(t,"a",(function(){return h}))},2138:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(870),i=n(1395),o=n(960);function a(e,t,n){var a=e.level!==o.b.Block&&e.directFileAccessEnabled;return a&&t.__type===r.n&&(a=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,n.host.indexOf(c,0)>0||n.search.indexOf(u,0)>0)return!1}if(r=e.ProviderType,o=Object(i.a)(r),(null==o?void 0:o.supportDownload)&&!e.AttachmentIsFolder)return!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);var r,o;return!1}(t,n)),a}var c="safelinks.protection.outlook.com",u="b7780972f918485c8cfc32b1ba7438eb"},2158:function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(960),a=n(964),c=n(221),u=n(908);function s(e){switch(e){case a.a.Download:return u.a.Download;case a.a.OpenInNewTab:return u.a.OpenInNewTab;case a.a.Preview:return u.a.Preview;case a.a.ImportCalendarEventAttachment:case a.a.ChangePermissions:case a.a.CopyLink:case a.a.SaveToCloud:case a.a.ViewInProvider:case a.a.ConvertClassicToCloudy:case a.a.ConvertCloudyToClassic:case a.a.MoveAttachmentToInline:case a.a.RefreshLink:case a.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function d(e){switch(e){case u.a.Download:return a.a.Download;case u.a.OpenInNewTab:return a.a.OpenInNewTab;case u.a.Preview:return a.a.Preview;case u.a.NoAction:return null;default:return Object(c.a)(e)}}var l=n(1767);var f=n(901),p=n(205);function h(e,t,n,i,a,c,p,h,m,v,O){var g=Object(u.d)(t,n,i,v);!function(e,t){var n=Object(o.g)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download})):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download&&e!==u.a.Preview})));var r=function(e,t,n){void 0===n&&(n=!1);var r=e.filter((function(e){return-1!==t.indexOf(e)}));return n&&(r=r.filter((function(e,t,n){return n.indexOf(e)===t}))),r}(e.supportedOpenActions.map(d).filter((function(e){return!!e})),t);e.supportedOpenActions=r.map(s)}(g,h);var _,w=function(e){return e.__type===f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(i),j=v&&function(e){return e.__type===f.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(i),I=Object(o.j)(i,w||j,m,O),y=w,k=b(w,j,c),C=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,w||j,m),S=function(e,t,n,r,i){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var o=Object(l.a)(i);return(null==o?void 0:o.supportConvertCloudyToClassic)||!1}return!1}(e,w,m,p,a),T=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,w,j,m);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:_=function(e,t,n,i,o,a,c,u){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:i,isViewingInProviderSupported:o,isConvertClassicToCloudySupported:a,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:u,showActionsMenu:!0,supportedMenuActions:[]})}(g,I,w||j,y,k,C,S,T);break;case 1:_=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(g);break;default:_=w?function(e,t,n,i){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:i,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(g,y,k,S):function(e,t,n,i){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(g,I,k,C)}return _.supportedMenuActions=h,_}function b(e,t,n){if(e||t)return!1;var r=Object(p.a)(),o=Object(l.b)(r);return!Object(i.f)(n)&&(r||(null==o?void 0:o.supportViewInProvider))}n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return b}))},2159:function(e,t,n){"use strict";var r="color",i="bgcolor",o="data-ogsc",a="data-ogac",c="data-ogsb",u="data-ogab";function s(e){return{attrColor:e.getAttribute(r)||null,attrBgColor:e.getAttribute(i)||null,styleColor:e.style.getPropertyValue("color"),styleBgColor:e.style.getPropertyValue("background-color")}}function d(e,t){return e.hasAttribute(t)?e.getAttribute(t)||null:void 0}function l(e){return{attrColor:d(e,a),attrBgColor:d(e,u),styleColor:d(e,o),styleBgColor:d(e,c)}}function f(e,t){void 0!==t.attrColor&&!e.hasAttribute(a)&&e.setAttribute(a,t.attrColor||""),void 0!==t.attrBgColor&&!e.hasAttribute(u)&&e.setAttribute(u,t.attrBgColor||""),void 0!==t.styleColor&&!e.hasAttribute(o)&&e.setAttribute(o,t.styleColor||""),void 0!==t.styleBgColor&&!e.hasAttribute(c)&&e.setAttribute(c,t.styleBgColor||"")}function p(e,t){void 0!==t.attrColor&&(null===t.attrColor?e.removeAttribute(r):e.setAttribute(r,t.attrColor||"")),void 0!==t.attrBgColor&&(null===t.attrBgColor?e.removeAttribute(i):e.setAttribute(i,t.attrBgColor||"")),void 0!==t.styleColor&&e.style.setProperty("color",t.styleColor||""),void 0!==t.styleBgColor&&e.style.setProperty("background-color",t.styleBgColor||"")}var h=n(152);function b(e){var t=e.currentTarget,n=t.getElementsByTagName("*"),r=Object(h.c)();r&&(t.style.backgroundColor="white",t.style.color="black");for(var i=[],o=0;o<n.length;o++){var a=n[o],c=l(a);i.push(s(a)),p(a,c)}window.requestAnimationFrame((function(){r&&(t.style.backgroundColor="",t.style.color="");for(var e=0;e<n.length;e++)p(n[e],i[e])}))}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return b}))},2181:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d}));var r=n(86),i=n(1678);n.d(t,"f",(function(){return i.a}));var o=new r.c((function(){return n.e(473).then(n.bind(null,3633))})),a=new r.b(o,(function(e){return e.tryProcessSharePointLink})),c=new r.b(o,(function(e){return e.tryUndoProcessSharePointLink})),u=new r.b(o,(function(e){return e.docLinkHadPreviewInfo})),s=new r.b(o,(function(e){return e.forceGetWacInfoOperation})),d=new r.b(o,(function(e){return e.getValidDocLinkPreviewInfo}))},2254:function(e,t,n){"use strict";var r=n(86),i=n(1519);n.d(t,"a",(function(){return i.a})),n.d(t,"d",(function(){return i.c}));var o=n(1182);n.d(t,"b",(function(){return o.b}));var a=n(1576);n.d(t,"c",(function(){return a.a}));var c=new r.c((function(){return n.e(235).then(n.bind(null,3637))})),u=new r.a(c,(function(e){return e.addFileProviderAfterAuthFinished}));"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=u);new r.b(c,(function(e){return e.getAddableFileProviderInfo})),new r.b(c,(function(e){return e.addFileProvider})),new r.b(c,(function(e){return e.createAddableFileProviderInfo})),new r.b(c,(function(e){return e.getAuthRedirectPageUrl}))},2255:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoOp=0]="NoOp",e[e.AlwaysHidden=1]="AlwaysHidden",e[e.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",e[e.LoadConversationReadingPane=3]="LoadConversationReadingPane",e[e.LoadItemReadingPane=4]="LoadItemReadingPane"}(r||(r={}))},2282:function(e){e.exports=JSON.parse('{"a":"Wia","b":"Xia"}')},2283:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2254);function i(e){return Object(r.c)(e)}},2289:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(23),i=n(1794);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},2291:function(e,t,n){"use strict";var r=null,i={register:function(e){r=e},available:function(){return!!r},run:function(){r&&r()}};t.a=i},2333:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1437),i="file provider is not addable";function o(e){return r.a.indexOf(e)>-1}},2336:function(e,t,n){"use strict";var r=n(952),i=n(103);t.a=Object(i.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2337:function(e,t,n){"use strict";var r=n(103);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2352:function(e,t,n){"use strict";var r=n(0),i=n(191),o=n(81),a=n(1128),c=n(1129);function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,d,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(3),i=t?"folders":"files",u=Object(o.a)(n.create_shared_link_request.requestUrlFormat,i,e),[4,Object(c.a)(n.providerType,u,null,n.create_shared_link_request.method,JSON.stringify(n.create_shared_link_request.body),null,n.create_shared_link_request.dataPointName)];case 1:return s=r.sent(),d=JSON.parse(s),l={webUrl:d.shared_link.url,type:O,scope:_},[2,{expirationDateTime:null,shareId:d.id,link:l}]}}))}))}function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.create_shared_link_request.body).path=e,[4,Object(c.a)(t.providerType,t.create_shared_link_request.requestUrlFormat,null,t.create_shared_link_request.method,JSON.stringify(n),null,t.create_shared_link_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function d(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.get_shared_link_request.body).path=e,[4,Object(c.a)(t.providerType,t.get_shared_link_request.requestUrlFormat,null,t.get_shared_link_request.method,JSON.stringify(n),null,t.get_shared_link_request.dataPointName)];case 1:return i=r.sent(),(o=JSON.parse(i).links[0])?[3,3]:[4,s(e)];case 2:o=r.sent(),r.label=3;case 3:return u={webUrl:o.url,type:O,scope:_},[2,{expirationDateTime:null,shareId:o.id,link:u}]}}))}))}function l(e){var t=function(e){var t=e.match(/\/d\/(.+)\//gm);return!t||t.length>1?"":t[0].substring(3).replace("/","")}(e);return Object(o.b)(t)&&(t=function(e){var t=e.match(/\/folders\/(.+)$/gm);return!t||t.length>1?"":t[0].substring(9)}(e)),t}function f(e){var t,n;if(e)try{for(var i=Object(r.__values)(e),o=i.next();!o.done;o=i.next()){var a=o.value;if("anyoneWithLink"===a.id)return a.role}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(5),n=Object(o.a)(t.get_file_info_request.requestUrlFormat,e),[4,Object(c.a)(t.providerType,n,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(l(e))];case 1:return(t=r.sent())&&t.permissionIds&&-1!==t.permissionIds.indexOf("anyoneWithLink")?(n=null,i=0,"reader"===(o=f(t.permissions))?(n=O,i=4):"writer"===o&&(n=g,i=5),[2,{ResultCode:0,FileName:t.name,MimeType:"application/vnd.google-apps.folder"===t.mimeType?j:t.mimeType,SharingLinkKind:i,BlocksDownload:t.capabilities.canDownload,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:null,OriginalUrl:null,Type:n,providerFileId:t.id}]):[2,null]}}))}))}function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(5),n=Object(o.a)(t.get_file_info_request.requestUrlFormat,e),[4,Object(c.a)(t.providerType,n,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),u=JSON.parse(i),s={webUrl:u.webViewLink,type:null,scope:_},(null==u?void 0:u.permissions)&&("reader"!==(d=f(u.permissions))&&"writer"!==d||(s.type="reader"===d?O:g)),[2,{expirationDateTime:null,shareId:u.id,link:s}]}}))}))}function m(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,b(e)];case 1:return null!=(t=r.sent()).link.type?[3,3]:(n=Object(a.a)(5),i=Object(o.a)(n.create_shared_link_request.requestUrlFormat,e),(u=n.create_shared_link_request.body).role="reader",[4,Object(c.a)(n.providerType,i,null,n.create_shared_link_request.method,JSON.stringify(u),null,n.create_shared_link_request.dataPointName)]);case 2:s=r.sent(),(d=JSON.parse(s))&&"reader"===d.role&&(t.link.type=O),r.label=3;case 3:return[2,t]}}))}))}var v=n(844),O="view",g="edit",_="anonymous",w="0001-01-01T00:00:00Z",j="text/directory";function I(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(1),i=Object(o.a)(n.create_shared_link_request.requestUrlFormat,e),u=!Object(v.f)(t),(s=n.change_link_permission_request.body).type=u?g:O,[4,Object(c.a)(n.providerType,i,null,n.create_shared_link_request.method,JSON.stringify(s),null,n.create_shared_link_request.dataPointName)];case 1:return d=r.sent(),[2,JSON.parse(d)]}}))}))}var y=n(1237),k=n(196);function C(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(0),null===(i=Object(k.parse)(e).hostname)&&t&&(i=Object(k.parse)(t).hostname,e="https://"+i+e),u=Object(o.a)(n.create_shared_link_request.requestUrlFormat,i,Object(y.g)(e)),[4,Object(c.a)(n.providerType,u,n.create_shared_link_request.additional_headers,n.create_shared_link_request.method,null,e,n.create_shared_link_request.dataPointName)];case 1:return s=r.sent(),[2,JSON.parse(s).value[0]]}}))}))}function S(e,t,n,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(Object(o.b)(n))throw new Error("CreateSharingLinkFromFileProvider should have valid location.");switch(s=null,e){case 1:return[3,1];case 0:return[3,3];case 2:return[3,5];case 3:return[3,7];case 5:return[3,9]}return[3,11];case 1:return[4,I(t,n)];case 2:return s=r.sent(),[3,12];case 3:return[4,C(n,c)];case 4:return s=r.sent(),[3,12];case 5:return[4,d(n)];case 6:return s=r.sent(),[3,12];case 7:return[4,u(t,a)];case 8:return s=r.sent(),[3,12];case 9:return[4,m(t)];case 10:return s=r.sent(),[3,12];case 11:throw new Error("File provider "+e+" is not supported.");case 12:return s.expirationDateTime&&Object(i.o)("expiration time found",[s.expirationDateTime]),[2,s]}}))}))}function T(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(3),n=t.get_file_info_request.requestUrlFormat,(i=JSON.parse(JSON.stringify(t.get_file_info_request.additional_headers))).BoxApi=Object(o.a)(i.BoxApi,e),[4,Object(c.a)(t.providerType,n,i,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return u=r.sent(),[2,{ResultCode:0,FileName:(s=JSON.parse(u)).name,MimeType:"folder"===s.type?j:null,SharingLinkKind:4,BlocksDownload:!s.shared_link.permissions.can_download,CanShareExternally:!0,ExpirationDate:null,OriginalUrl:null,Type:O,providerFileId:s.id,location:e}]}}))}))}function P(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.get_file_info_request.body).url=e,[4,Object(c.a)(t.providerType,t.get_file_info_request.requestUrlFormat,null,t.get_file_info_request.method,JSON.stringify(n),null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),[2,{ResultCode:0,FileName:(o=JSON.parse(i)).name,MimeType:"folder"===o[".tag"]?j:null,SharingLinkKind:4,BlocksDownload:!o.link_permissions.allow_download,CanShareExternally:!0,ExpirationDate:null,OriginalUrl:null,Type:O,providerFileId:o.id,location:e}]}}))}))}var x=n(48);function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(0),n=Object(k.parse)(e),i=Object(o.a)(t.get_file_info_request.requestUrlFormat,n.hostname,Object(y.g)(e)),[4,Object(c.a)(t.providerType,i,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return u=r.sent(),x.d.info(u),[2,null]}}))}))}function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(1),n=Object(o.a)(t.get_drive_item_request.requestUrlFormat,Object(y.g)(e)),[4,Object(c.a)(t.providerType,n,null,t.get_drive_item_request.method,null,null,t.get_drive_item_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function L(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(1),n=Object(o.a)(t.get_file_permission_request.requestUrlFormat,Object(y.g)(e)),[4,Object(c.a)(t.providerType,n,null,t.get_file_permission_request.method,null,null,t.get_file_permission_request.dataPointName)];case 1:if(i=r.sent(),JSON.parse(i).value.forEach((function(t){var n;(null===(n=t.link)||void 0===n?void 0:n.webUrl)===e&&(u=t)})),!u)throw new Error("GetODCSharingInfo failed to find the matching link");return[2,u]}}))}))}function N(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,E(e)];case 1:return t=r.sent(),[4,L(e)];case 2:return n=r.sent(),i=n.link.type===g?5:4,[2,{ResultCode:0,FileName:t.name,MimeType:t.file?t.file.mimeType:j,SharingLinkKind:i,BlocksDownload:!1,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:n.expirationDateTime===w?null:n.expirationDateTime,OriginalUrl:null,Type:n.link.type,providerFileId:t.id,location:e}]}}))}))}function R(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(t){case 0:return[2,A(e)];case 1:return[2,N(e)];case 2:return[2,P(e)];case 3:return[2,T(e)];case 5:return[2,h(e)];default:throw new Error("getFileInfo is not supported for "+t+".")}return[2]}))}))}function D(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t){case 4:case 3:break;default:throw new Error("We do not support this permission level for GDrive: "+t)}return n=l(e),i=Object(a.a)(5),u=Object(o.a)(i.change_link_permission_request.requestUrlFormat,n,"anyoneWithLink"),s=i.change_link_permission_request.body,d=4===t?"writer":"reader",s.role=d,[4,Object(c.a)(i.providerType,u,null,i.change_link_permission_request.method,JSON.stringify(s),null,i.change_link_permission_request.dataPointName)];case 1:return r.sent(),[2]}}))}))}function F(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t){case 4:case 3:break;default:throw new Error("OneDriveConsumer does not support this permission level: "+t)}return n=Object(a.a)(1),i=Object(o.a)(n.change_link_permission_request.requestUrlFormat,Object(y.g)(e)),(u=n.change_link_permission_request.body).type=4===t?g:O,[4,Object(c.a)(n.providerType,i,null,n.change_link_permission_request.method,JSON.stringify(u),null,n.change_link_permission_request.dataPointName)];case 1:return s=r.sent(),[2,JSON.parse(s)]}}))}))}function M(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(Object(o.b)(t))throw new Error("CreateSharingLinkFromFileProvider should have valid location.");return 1!==e?[3,2]:[4,F(t,n)];case 1:return[2,r.sent()];case 2:return 5!==e?[3,4]:[4,D(t,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}n(2930);n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return R})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return"organization"})),n.d(t,"c",(function(){return"user"})),n.d(t,"g",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"h",(function(){return M}))},2363:function(e,t,n){"use strict";var r=n(449),i=n(2);function o(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var a=Object(i.y)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.m)()+"/mail/"+n+t}function u(e){var t=Object(r.m)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return a+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,i,a){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=o(t,"client_id",r);if(c=o(c,"redirect_uri",n),c=o(c,"response_type",i),a){var u=a(e);c=Object.keys(u).reduce((function(e,t){return o(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2400:function(e){e.exports=JSON.parse('{"b":"yja","a":"zja"}')},2410:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("loadItemAttachment",(function(e,t){return{itemAttachmentId:e,perfDatapoint:t}}))},2412:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(844);function i(e){var t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}},2489:function(e){e.exports=JSON.parse('{"b":"sja","a":"tja","e":"uja","d":"vja","f":"wja","c":"xja"}')},2495:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2538:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,maxSize:e}}},2545:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FileAttachment:#Exchange"},e)}},2555:function(e,t,n){"use strict";var r=n(0),i=n(336),o=n(23);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(o.a)("ImportCalendarEvent",e,t)}var c=n(874),u=n(151),s=n(240);function d(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return o?[4,Object(s.e)(o)]:[3,2];case 1:l=f.sent(),d={headers:l.headers,authNeededOnUnAuthorized:l.authNeededOnUnAuthorized},f.label=2;case 2:return[2,a({Header:Object(u.a)(),Body:(p={Content:e,ImportedItemFolderId:Object(c.a)({BaseFolderId:Object(i.a)({Id:t})}),AttachmentId:n},Object(r.__assign)({__type:"ImportCalendarEventRequest:#Exchange"},p))},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},d)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))]}var p}))}))}n.d(t,"a",(function(){return d}))},2626:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f}));var r=n(86),i=n(979);n.d(t,"a",(function(){return i.c}));var o=n(2291);n.d(t,"c",(function(){return o.a}));var a=n(2255);n.d(t,"b",(function(){return a.a}));var c=n(2410);n.d(t,"h",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(7),n.e(14),n.e(34),n.e(46),n.e(120)]).then(n.bind(null,4606))})),s=new r.a(u,(function(e){return e.previewAttachment})),d=new r.a(u,(function(e){return e.previewAttachmentInSxS})),l=new r.a(u,(function(e){return e.previewImageInSxS})),f=new r.a(u,(function(e){return e.previewLinkInSxS}))},2629:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),i=n(191),o=n(2100),a=n(2715),c={},u={},s=[],d=0,l=2;function f(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,c;return Object(r.__generator)(this,(function(u){return a=new i.a("InitializeWacUrl"),n&&a.addCustomProperty("actionSource",n),(c=h(e,t,a))?[2,c]:[2,new Promise((function(i,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:a,resolve:i,reject:c};o?p(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!s.length)return[2];if(d>=l)return[2];t=s.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,p(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function p(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,s,d,l,f,p,b,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n=e.attachmentId,i=e.isEdit,s=e.actionSource,d=e.datapoint,l=e.resolve,f=e.reject,p=h(n,i,d))return l(p),[2];d.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(a.a)(n.Id,i,null,null===(t=n.mailboxInfo)||void 0===t?void 0:t.requestOptions,s)];case 2:return 0===(b=r.sent()).Status&&((i?u:c)[n.Id]={expireTime:(new Date).getTime()+36e5,value:b}),b.WacUrl||d.addCustomProperty("WacUrlIsEmpty",!0),d.addCustomProperty("WacAttachmentResponseStatus",b.Status.toString()),d.end(),l(b),[3,4];case 3:return m=r.sent(),Object(o.a)(m)&&Object(o.c)(d,m.response),Object(o.d)(d,m.toString()),d.endWithError("ServerError"),f(m),[3,4];case 4:return[2]}}))}))}function h(e,t,n){var r=t?u:c,i=r[e.Id];if(i){if(i.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),i.value;delete r[e.Id]}return null}},2630:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1395),i=n(1006),o=n(960),a=n(844),c=n(870);function u(e){if(!Object(o.e)(e,!0).directFileAccessEnabled||Object(i.b)(e.AttachmentId.Id))return!1;if(e.Thumbnail)return!0;var t=Object(a.f)(e.Name,e.ContentType,!1),n=Object(a.g)(e.Name);if((e.__type===c.e||e.__type===c.h)&&(t||n))return!0;if(e.__type===c.n){var u=e,s=Object(r.a)(u.ProviderType);if(u.AttachmentThumbnailUrl||t&&s&&s.supportImageThumbnail)return!0}return!1}},2641:function(e,t,n){"use strict";var r=n(0),i=n(901),o=n(191),a={},c=5e3,u=12;function s(e,t,n,s,l){var f=new o.a("SaveToCloudProgressManager"),p=setInterval((function(){!function(e,t,n,o,a,c,u){Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(s=u[e])?(s.counter++,s.counter>c?(d(e,u),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),a&&a(),[2]):[4,i.g.import()]):[2];case 1:return r.sent()(t,n,e,0,(function(e){o&&o(e.NotificationPayloads)})),[2]}}))}))}(n,e,t,s,l,u,a)}),c);a[n]={timer:p,counter:0,datapoint:f}}function d(e,t){void 0===t&&(t=null),t||(t=a);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}var l=n(4),f=Object(l.action)("cancelSaveAttachmentsToCloud",(function(e){return{operationId:e}}));Object(l.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return d(e.operationId),[2]}))}))}));var p=Object(l.action)("saveAttachmentsToCloud",(function(e,t,n,r,i,o,a,c,u){return{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:i,folderId:o,attachmentIds:a,showProgressBar:c,subscriptionId:u}})),h=n(87);function b(e){return Object(r.__assign)({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}var m=n(23);function v(e,t,n,r,i,o,a){var c,u,s=function(e,t,n,r,i,o,a){return b({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:i,channelId:r,folderItemId:o,attachmentIds:a})}(e,t,n,r,(null==i?void 0:i.type)===h.a.GroupMailbox?i.deprecatedMailboxId:null,o,a);return c={requestObject:s},u=null==i?void 0:i.requestOptions,void 0===c.requestObject||c.requestObject.__type||(c.requestObject=b(c.requestObject)),Object(m.a)("SaveAttachmentsToCloud",c,u)}var O=n(1636),g=n(961);Object(l.orchestrator)(p,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,a,c,u,l,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return t=!1!==e.showProgressBar,!(n=e.attachmentId||e.itemId)&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]),i=function(r){if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;var i=e.notificationHandler(r);return t&&i&&(d(n.Id),t=!1),i},o=e.subscriptionId,[4,Object(O.a)(i,o)];case 1:return a=r.__read.apply(void 0,[p.sent(),4]),c=a[0],u=a[1],l=a[2],f=a[3],function(e,t,n,i,o,a,c,u,s){Object(r.__awaiter)(this,void 0,void 0,(function(){var d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,v(e?e.Id:null,t?t.Id:null,n,a,_(t,e,s),u,s?s.map((function(e){return e.Id})):null)];case 1:return[2,r.sent()];case 2:return d=r.sent(),c(d,1,"ServerError"),g.h.importAndExecute(i,o),[2,null];case 3:return[2]}}))}))}(e.attachmentId,e.itemId,c,u,l,f,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&s(e.attachmentId,e.itemId,n.Id,(function(e){e.forEach((function(e){i(e)}))}),(function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")})),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,u,l),[2]}}))}))}));function _(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}function w(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=function(n){if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;var r=t(n);return r&&d(e.Id),r},[4,Object(O.a)(o,i)];case 1:return r.sent(),s(e,null,e.Id,(function(e){e.forEach((function(e){o(e)}))}),(function(){n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout")})),[2]}}))}))}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return w}))},2715:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1616);function i(e,t,n,i,o){if(o){var a="getWacAttachmentInfo"+o;(i=i||{}).headers=i.headers||new Headers,i.headers.set("X-OWA-ActionName",a)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},i)}},2716:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(1304),o=n(3012);function a(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(o.a)(e.AttachLongPathName),[4,Object(i.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.thumbnailLink)||null]}}))}))}},2717:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(870),i=n(1118),o=n(1494);function a(e,t,n,a){if(void 0===a&&(a=!1),Object(i.b)(t))switch(t.ProviderType){case r.c:return function(e){var t=e.AttachLongPathName,n=t.lastIndexOf("?");return t.substring(0,n)+"?dl=1"}(t)}return Object(o.a)(e,t,0,Object(i.b)(t),n,a)}},2775:function(e,t,n){"use strict";var r=n(864),i=n(2717),o=n(103);t.a=Object(o.action)("refreshDownloadUrl")((function(e,t,n){void 0===n&&(n=!1);var o=Object(r.a)(e),a=Object(i.a)(e,o.model,t,n);o.download.url=a}))},2930:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),i=n(1237),o=n(81),a=n(196),c=n(1128),u=n(1129);function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,s,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(c.a)(0),n=Object(a.parse)(e),s=Object(o.a)(t.get_shared_item_request.requestUrlFormat,n.hostname,Object(i.g)(e)),[4,Object(u.a)(t.providerType,s,t.get_shared_item_request.additional_headers,t.get_shared_item_request.method,null,null,t.get_shared_item_request.dataPointName)];case 1:return d=r.sent(),[2,JSON.parse(d)]}}))}))}},2939:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return l}));var r=n(86),i=new r.c((function(){return Promise.all([n.e(1),n.e(17),n.e(627),n.e(286)]).then(n.bind(null,5462))})),o=Object(r.d)(i,(function(e){return e.TextColorPicker})),a=Object(r.d)(i,(function(e){return e.BackColorPicker})),c=Object(r.d)(i,(function(e){return e.FontNamePicker})),u=Object(r.d)(i,(function(e){return e.FontSizePicker})),s=Object(r.d)(i,(function(e){return e.InsertTableCallout})),d=new r.b(i,(function(e){return e.displayInsertLinkDialog})),l=new r.b(i,(function(e){return e.showImageAltTextDialog}))},2952:function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=!1;return{task:function(){return new Promise((function(c,u){for(var s=0,d=0,l=0,f=function(){var p,h,b,m,v;a&&c(1),s<n&&l<t.length&&((p=l,h=t[p],b=h.start,m=h.end,v=e.slice(b,m),r(v,o(p),i)).then((function(){return s-=1,(d+=1)===t.length&&c(0),void f()})).catch(u),l+=1,s+=1)},p=0;p<n;p++)f()}))},cancelTask:function(){return a=!0}}}var i=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function o(e,t,n){void 0===n&&(n=i),function(e){e.sliceSize=e.sliceSize||i.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||i.numberOfSlicesToParallelize}(n);var o=n.sliceSize,u=n.numberOfSlicesToParallelize,s=Math.ceil(e.size/o),d=function(e,t,n){for(var r=[],i=0,o=0;o<e;o++){var a=Math.min(i+t,n);r.push({start:i,end:a}),i=a}return r}(s,o,e.size),l=r(e,[d[0]],1,t,s,(function(){return 0})),f=d.length>2?r(e,d.slice(1,d.length-1),u,t,s,(function(e){return e+1})):c(),p=d.length>1?r(e,[d[d.length-1]],1,t,s,(function(){return d.length-1})):c();return{onCompletePromise:l.task().then(a(f.task)).then(a(p.task)),cancel:function(){l.cancelTask(),f.cancelTask(),p.cancelTask()}}}function a(e){return function(t){return 0===t?e():Promise.resolve(t)}}function c(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}n.d(t,"a",(function(){return o}))},2956:function(e,t,n){"use strict";var r=n(1903),i=n(844),o=n(5),a=n(54);var c=n(2138),u=n(1395);function s(e,t,n,s,d,l){if(void 0===l&&(l=null),1===t)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};var f,p=Object(i.b)(n.Name),h=Object(c.a)(e,n,p),b=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;var r=Object(u.a)(t);return null==r?void 0:r.supportedPermissionLevels}(s,d,Object(r.a)(l,0)),m=(f=l)&&0===f.ResultCode?(Object(a.f)("doc-attachment-referenceAttachmentExpiration")||(f.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:f.BlocksDownload,canonicalUrl:f.CanonicalUrl,canShareInternally:f.CanShareInternally,canShareExternally:f.CanShareExternally,expirationDate:f.ExpirationDate?Object(o.lc)(f.ExpirationDate):null,canRefresh:!1,shareId:f.ShareId,siteUrl:f.SiteUrl,linkType:f.Type}):null;return s?function(e,t,n){return{allowDownload:e,supportedPermissionLevels:t,sharingInfo:n}}(h,b,m):function(e){return{allowDownload:e,supportedPermissionLevels:null,sharingInfo:null}}(h)}n.d(t,"a",(function(){return s}))},3012:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},3013:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),i=n(870),o=n(1903);function a(e){return Object(r.f)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function c(e,t){var n=e.AttachLongPathName;if(Object(o.f)(e.PermissionType)||e.ProviderType!==i.m)return n;var r=t.ApplicationSettings;if(null!==n&&null!==r){var c=void 0;null!==(c=a(r.VDirIsPublicProperty||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL))&&(n=function(e,t){var n,r,i,o=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),a=o.exec(e),c=o.exec(t);return a&&c&&a.length>=5&&c.length>=5&&(c[1]&&c[2]&&(i=c[1]+"://"+c[2],n=!0),c[3]&&(i+=c[3]),a[4]&&(r=!0,i+=a[4])),n&&r?i:null}(n,c))}return null!==n?n:e.AttachLongPathName}},3014:function(e,t,n){"use strict";var r=n(864),i=n(103);t.a=Object(i.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},3142:function(e){e.exports=JSON.parse('{"b":"GTa","a":"HTa","d":"ITa","e":"JTa","g":"KTa","f":"LTa","c":"MTa","i":"NTa","h":"OTa","j":"PTa","k":"QTa"}')},3143:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(870),o=n(2716),a=n(1494);function c(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n?(c=t).ProviderType===i.f&&c.AttachLongPathName?[4,Object(o.a)(c)]:[3,2]:[2,Object(a.a)(e,t,2,n,!0)];case 1:return[2,r.sent()];case 2:return[2,c.AttachmentThumbnailUrl||null]}}))}))}},3184:function(e,t,n){"use strict";var r=n(870),i=n(1395),o=n(844);function a(e){var t=Object(o.b)(e.Name);return t&&".pdf"===t.toLowerCase()}var c=[".mp3"];var u=[".ics",".ical",".ifb",".icalendar"];var s=[".eml",".msg"];var d=n(1889),l=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(o.f)(e.Name)||e.__type!==r.n&&function(e){if(e)return l.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var p=n(2040),h=n(960);function b(e,t){return!(!a(e)||!Object(p.a)())&&(!!t||Object(h.f)(e,!0).directFileAccessEnabled)}var m=[".txt",".xml",".log"];var v=[".mp4"],O=[".mov"];var g=n(205);function _(e,t){var n;t.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||t.__type===r.a.attachmentTypes.LINK_ATTACHMENT_TYPE?n=function(e){var t=Object(i.a)(e.ProviderType);return t&&t.supportPreview(e,Object(g.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(d.a)(t)?6:b(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0:n=t.__type===r.a.attachmentTypes.FILE_ATTACHMENT_TYPE?e.level===h.b.Block?1:e.level===h.b.AccessDisabled?0:f(t)?2:a(t)?function(e,t){if(!Object(h.k)().isPdfPreviewEnabled())return 1;if(b(t,!1))return 3;if(function(e){return a(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){var t=Object(o.b)(e.Name);return!!t&&c.indexOf(t.toLowerCase())>=0}(t)?5:function(e){var t=Object(o.b)(e.Name);return!!t&&s.indexOf(t.toLowerCase())>=0}(t)?10:function(e){var t=Object(o.b)(e.Name);return!!t&&m.indexOf(t.toLowerCase())>=0}(t)?11:function(e,t){var n,r=Object(o.b)(e.Name);if(r){var i=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),a=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome");return v.indexOf(r.toLowerCase())>=0||a&&O.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){var t=Object(o.b)(e.Name);return!!t&&-1!==u.indexOf(t.toLowerCase())}(t)?13:0:t.__type===r.a.attachmentTypes.ITEM_ATTACHMENT_TYPE?8:t.__type===r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE?9:0;return n}n.d(t,"a",(function(){return _}))},3306:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("SET_IS_CONTEXT_MENU_OPEN",(function(e,t){return{linkId:e,value:t}})),o=Object(r.action)("RESET_IS_CONTEXT_MENU_OPEN_FOR_LINKS",(function(){return{}})),a=Object(r.action)("UPDATE_COMPOSE_LINK_VIEW_STATE",(function(e,t,n){return{linkId:e,displayName:t,isLinkBeautified:n}})),c=Object(r.action)("REMOVE_COMPOSE_LINK_VIEW_STATE",(function(e){return{linkId:e}})),u=Object(r.action)("ADD_COMPOSE_LINK_VIEW_STATE",(function(e){return{linkId:e}})),s=Object(r.action)("REMOVE_ALL_COMPOSE_LINK_VIEW_STATES"),d=Object(r.action)("PREVIEW_SP_DOC_LINK_IN_SXS",(function(e,t,n){return{wacUrlGetter:e,linkId:t,readOnly:n}})),l=Object(r.action)("onLinkSelectionChange",(function(e,t){return{selectedLinkId:e,isSelectedLinkReadOnly:t}})),f={composeLinks:new(n(14).ObservableMap)({}),selectedLinkId:null,isSelectedLinkReadOnly:null},p=Object(r.createStore)("composeLinkViewStore",f),h=n(1004);function b(e){var t=p();return e=Object(h.i)(e),t.composeLinks.get(e)}Object(r.mutator)(u,(function(e){var t=p(),n=Object(h.i)(e.linkId),r={linkId:n,isContextMenuOpen:!1,isLinkBeautified:!1,displayName:null};t.composeLinks.set(n,r)})),Object(r.mutator)(c,(function(e){var t=p(),n=Object(h.i)(e.linkId);t.composeLinks.delete(n)})),Object(r.mutator)(s,(function(e){p().composeLinks.clear()})),Object(r.mutator)(a,(function(e){var t=b(e.linkId);t&&(t.displayName=e.displayName)})),Object(r.mutator)(h.E,(function(e){var t=b(e.linkId);t&&!t.isLinkBeautified&&t.displayName===e.oldLinkUrl&&(t.displayName=e.newLinkUrl)})),Object(r.mutator)(i,(function(e){b(e.linkId).isContextMenuOpen=e.value})),Object(r.mutator)(o,(function(e){p().composeLinks.forEach((function(e){return e.isContextMenuOpen=!1}))})),Object(r.mutator)(a,(function(e){b(e.linkId).isLinkBeautified=e.isLinkBeautified})),Object(r.mutator)(l,(function(e){var t=p(),n=e.selectedLinkId,r=e.isSelectedLinkReadOnly;t.selectedLinkId=n,t.isSelectedLinkReadOnly=r}));var m=n(148);Object(r.orchestrator)(h.g,(function(e){var t=document.getElementById(e.linkId);t&&(m.unmountComponentAtNode(t),t.remove(),c(e.linkId))}));var v="LinkContextMenu",O="style",g=";",_="rgb(58, 58, 58)",w="background-color: rgb(58, 58, 58) !important;",j=n(1);function I(e){var t=j.useRef();j.useEffect((function(){var e=t.current;m.unmountComponentAtNode(e),e.outerHTML=n()}),[]);var n=function(){return"\x3c!--"+e.text+"--\x3e"};return j.createElement("div",{ref:t})}var y=n(778),k=n(243),C=n(6063);function S(e){return j.createElement(y.a,{className:C.linkSpinner,size:k.a.xSmall})}function T(e){m.render(j.createElement(j.StrictMode,null,j.createElement(S,null)),e)}var P,x=n(0),A=n(29),E=n(443),L=n(56),N=n(191),R=n(221),D=n(3532),F=n(2181),M=n(54),U=n(1300);!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected"}(P||(P={}));var q,W=P,B=n(1131),V=n(7),z=n(4889);!function(e){e.contextMenu="contextMenu",e.sharingTip="sharingTip"}(q||(q={}));var H=n(2352),G=n(19);function J(e){var t;if(!Object(G.a)().AttachmentPolicy.ClassicAttachmentsEnabled||e.sharingInfo.blocksDownload)return!1;var n=e.mimeType;return(!n||"application/onenote"!==n&&n!==H.f)&&(null===(t=e.sharingInfo)||void 0===t?!0:!t.blocksDownload)}var Y=n(1426),X=n(81),K=n(48);function Q(e){var t=Object(h.l)(e),n=function(e,t){for(var n=0;n<e.length;n++)if(e[n].type===t)return e[n].model.Id;return K.d.error("createAttachmentFromLink: Could not get "+t.toString()+" provider ID. File will not upload."),""}(Object(Y.h)(),t.providerType);Object(X.b)(n)||Object(h.e)(e,n,!1)}var Z=["OneDrivePro","OneDriveConsumer","Dropbox","Box","Mailbox","GDrive","Facebook","WopiBox","WopiEgnyte","WopiDropbox","MailMessage"];var $=n(1903),ee=n(4531);function te(e,t,n){var r=[];return e.supportedPermissionLevels&&e.supportedPermissionLevels.forEach((function(i){if(1!==i&&2!==i){var o=Object($.e)(i,e.providerType);r.push({text:o,key:o,title:o,onClick:function(){Object(N.o)("AttachmentLinkViewChangePermission"),function(e,t,n,r){Object(x.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return Object(x.__generator)(this,(function(c){return e===t.permissionLevel?[2]:(i=function(e,t){if(0!==t.providerType)return null;switch(e){case 6:return t.sharingUrls.organizationEditLink;case 5:return t.sharingUrls.organizationViewLink;case 2:case 1:case 0:return t.sharingInfo.canonicalUrl;default:return null}}(e,t),o=null,0===t.providerType&&(a=t.sharingInfo,o=a.canonicalUrl),Object(h.f)(t.linkId,i,t.url,o,e,t.providerType,n,r),[2])}))}))}(i,e,t,n),Je()},isChecked:i===e.permissionLevel,canCheck:!0})}})),r.length>0?{items:r,className:ee.fixWidthContextMenu,directionalHintFixed:!0}:null}var ne=n(5350);function re(e,t,n,r,i){return Object(x.__awaiter)(this,void 0,void 0,(function(){var o,a,c;return Object(x.__generator)(this,(function(u){switch(u.label){case 0:return Je(),[4,ne.a.import()];case 1:return o=u.sent(),a=e.canonicalUrl,c=e.siteUrl,o(c,a,e.shareId,n).then((function(n){var o=n.shareId!==e.shareId;Object(h.C)(t,n),o&&Object(h.x)(t,i,r)})).catch((function(){})),[2]}}))}))}var ie=n(216),oe=n(4532),ae=n(405);var ce=n(4890),ue=n(3785),se=n(3786),de=n(41);function le(e){return Object(V.f)(e.href)?null:{name:Object(V.a)(ce.a),key:"CopyLink",onClick:function(){var t,n;t=e.href,n=Object(de.i)()?Object(V.a)(se.a):Object(V.a)(ue.a),window.prompt(n,t),Object(N.o)("AttachmentLinkViewCopyLink")}}}var fe=n(130);function pe(e){return{key:e,itemType:fe.a.Divider}}var he=n(6067);function be(e){var t="";if(null==e||"I"===e.nodeName)return"";if("#text"===e.nodeName)return e.textContent.trim();for(var n=0;n<e.childNodes.length;n++)t+=be(e.childNodes[n]);return t}var me=n(881),ve=n(2939);function Oe(e,t){return ve.f.import(),{name:Object(V.a)(he.a),key:"EditLink",onClick:function(){Object(N.o)("AttachmentLinkViewEditLink"),function(e,t){Object(x.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(x.__generator)(this,(function(i){switch(i.label){case 0:return n=be(e),r={LinkUrl:e.href,DisplayText:n,HasChanged:!1},[4,ve.f.import()];case 1:return[4,i.sent()(r,window)];case 2:if(i.sent()===me.a.ok&&r.HasChanged){if(r.LinkUrl===e.href&&Object(X.b)(r.DisplayText))return[2];t(r.LinkUrl,r.DisplayText.length>0?r.DisplayText:null)}return[2]}}))}))}(e,t)}}}var ge=n(4891);function _e(e,t,n){return n?null:{name:Object(V.a)(ge.a),key:"Preview",onClick:function(){!function(e,t){Object(x.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(x.__generator)(this,(function(i){switch(i.label){case 0:return Object(N.o)("PreviewLinkInSxS"),[4,F.c.import()];case 1:return n=i.sent(),(r=n(e))?[3,4]:[4,F.b.import()];case 2:return[4,i.sent()(e,!0)];case 3:r=i.sent(),i.label=4;case 4:return d((function(){return Promise.resolve(r.wacUrlInfo)}),t,r.wacUrlInfo.readOnly),[2]}}))}))}(e,t),Je()}}}var we=n(6068);var je=n(904),Ie=n(4892),ye=n(4893),ke=n(4281);var Ce=n(6069);function Se(e){return e===U.c.linkHasExpired||e===U.c.linkWillExpire}var Te=n(5);function Pe(e,t,n,r){switch(e){case U.c.externalRecipientCSL:case U.c.getSharingInfoFailed:case U.c.noPermissionSet:case U.c.noPermissionToShare:case U.c.noPermissionToShareExternally:case U.c.sharingWithLargeDL:return t;case U.c.linkHasExpired:case U.c.linkWillExpire:return function(e,t,n){if(t===h.b.refreshFailed)return Object(V.a)(Ce.e);if(e===U.c.linkHasExpired)return Object(V.a)(Ce.a);var r=Object(Te.Q)(n);return Object(V.b)(Object(V.a)(Ce.c),r)}(e,n,r);default:return Object(R.a)(e)}}var xe,Ae=n(6070),Ee=n(6071),Le=n(1153),Ne=n(6072),Re=n(405),De=Object(A.a)((function(e){var t=e.sharingLinkInfo.linkActionStatus;return Object(Le.a)("transitionend",(function(t){return Object(h.A)(e.sharingLinkInfo.linkId,h.b.none)}),[e.sharingLinkInfo.linkId]),Se(e.sharingIssue.id)&&t!==h.b.none&&t!==h.b.refreshFailed?t===h.b.refreshing?j.createElement("div",{className:Ne.overlay},j.createElement(y.a,{className:Ne.spinner,size:k.a.medium}),Object(V.a)(Ee.b)):t===h.b.refreshSucceeded?j.createElement("div",{className:Re(Ne.overlay,Ne.fadeOut)},j.createElement(ie.a,{iconName:"CheckMark",className:Ne.check}),Object(V.a)(Ee.a)):null:null})),Fe=n(4532),Me=n(6074),Ue=n(218).bind(Me),qe=Object(A.a)((function(e){var t,n,r=function(t){var n;Object(U.n)(e.sharingLinkInfo.linkId),n=e.sharingIssue.id,Object(N.o)("AttachmentLinkRefreshedSharingTip",[n]),t.stopPropagation()},i=function(t){var n;re(e.sharingLinkInfo.sharingInfo,e.sharingLinkInfo.linkId,e.sharingLinkInfo.permissionLevel,e.composeId,e.recipientInfos),n=e.sharingIssue.id,Object(N.o)("AttachmentLinkViewChangePermissionSharingDialog",[q.sharingTip,n]),t.stopPropagation()},o=function(t){var n;Q(e.sharingLinkInfo.linkId),n=e.sharingIssue.id,Object(N.o)("AttachmentLinkAttachAsACopy",[q.sharingTip,n]),Je(),t.stopPropagation()},a=function(t){var n;h.r.import().then((function(t){return t(e.sharingLinkInfo.linkId,e.sharingIssue.id)})),n=e.sharingIssue.id,Object(N.o)("AttachmentLinkSharingTipIgnored",[n]),t.stopPropagation()},c=e.sharingIssue,u=e.sharingLinkInfo,s={error:c.messageRank===je.b.Error},d=(t=c.id,n=u.linkActionStatus,Se(t)?n===h.b.refreshFailed?Object(V.a)(Ce.f):t===U.c.linkWillExpire?Object(V.a)(Ce.d):t===U.c.linkHasExpired?Object(V.a)(Ce.b):null:null);return j.createElement("div",{className:Fe.menuItemContainer,"aria-label":c.sharingTipString,"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:null,tabIndex:0},j.createElement(De,{sharingLinkInfo:u,sharingIssue:c}),j.createElement("div",{className:Fe.iconContainer},j.createElement(ie.a,{iconName:"Info",className:Ue(Me.sharingTipIcon,s),title:d})),function(e,t){var n=-1!==t.sharingTipActions.indexOf(U.b.ignore),c=-1!==t.sharingTipActions.indexOf(U.b.refreshExpiration)&&e.sharingInfo.canRefresh,u=e.linkActionStatus===h.b.refreshFailed?Object(V.a)(Ae.b):Object(V.a)(ke.a),s=e.sharingInfo.canShareExternally||e.sharingInfo.canShareInternally,d=-1!==t.sharingTipActions.indexOf(U.b.changePermission)&&s,l=-1!==t.sharingTipActions.indexOf(U.b.attachAsACopy)&&!d&&J(e),f=Pe(t.id,t.sharingTipString,e.linkActionStatus,e.sharingInfo.expirationDate),p=Object(M.f)("doc-link-permissionContextMenuNewString")||Object(M.f)("doc-link-permissionContextMenuAndDialogNewString")?Ie.b:Ie.a;return j.createElement("div",{className:Fe.text},j.createElement("span",{className:Me.paddingRight},f),c&&j.createElement(j.Fragment,null,j.createElement("button",{className:Me.actionButton,onClick:r},u),j.createElement("span",{className:Me.divider}," "," | "," ")),d&&j.createElement(j.Fragment,null,j.createElement("button",{className:Me.actionButton,onClick:i},Object(V.a)(p)),j.createElement("span",{className:Me.divider}," "," | "," ")),l&&j.createElement(j.Fragment,null,j.createElement("button",{className:Me.actionButton,onClick:o},Object(V.a)(Ae.a)),j.createElement("span",{className:Me.divider}," "," | "," ")),n&&j.createElement("button",{className:Me.actionButton,onClick:a},Object(V.a)(ye.a)))}(u,c))}));function We(e){var t=p();return e===t.selectedLinkId?!1===t.isSelectedLinkReadOnly?W.Edit:W.Selected:W.None}!function(e){e[e.SharingTip=0]="SharingTip",e[e.ChangePermission=1]="ChangePermission",e[e.Preview=2]="Preview",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.AttachACopy=4]="AttachACopy",e[e.RevertToFullUrl=5]="RevertToFullUrl",e[e.EditLink=6]="EditLink",e[e.CopyLinkToClipboard=7]="CopyLinkToClipboard"}(xe||(xe={}));var Be=n(4531),Ve=n(218).bind(Be),ze=Object(A.a)((function(e){var t=Object(h.l)(e.composeLinkViewState.linkId);if(!t||t.linkActionStatus===h.b.attachingAsACopy||t.linkActionStatus===h.b.pendingAttachAsACopy)return null;var n,r,i,o,a,c,u,s,d,l,f,p,b,m,v=Object(x.__read)((n=e.composeLinkViewState,r=e.anchorElement,i=e.editor,o=e.composeEditorViewState,a=e.operateContent,c=e.composeId,u=e.recipientInfo,s=e.isCalendar,d=!1,l=!1,f=[],p=Object.keys(xe).filter((function(e){return!isNaN(Number(xe[e]))})).map((function(e){return xe[e]})),b=Object(M.f)("doc-link-operateContent"),m=function(e,t){b?a(o,(function(n,i,o){return n.addUndoSnapshot((function(){return Ye(n,r,e,t)})),{selectionRange:null,changeSource:null}})):i.isDisposed()||i.addUndoSnapshot((function(){return Ye(i,r,e,t)}))},p.forEach((function(e){switch(e){case xe.SharingTip:var t=function(e,t,n){var r=U.i.tryImportForRender();if(!r)return null;var i=r(Object(h.k)(e.linkId),t);if(i.length>0){i.length>1&&Object(N.o)("AttachmentLinkMultipleSharingTipsShown");var o=[];return i.map((function(r){var i=Object(h.l)(e.linkId);o.push({key:"contextualSharingTip",onRender:function(e,o){return j.createElement(qe,{sharingIssue:r,sharingLinkInfo:i,composeId:n,recipientInfos:t})}})})),o}return null}(n,u,c);t&&t.length>0&&(d=!0,t.forEach((function(e,t){f.push(e),f.push(pe("divider_sharing "+t))})));break;case xe.OpenInNewTab:var i=Object(D.c)(Object(h.l)(n.linkId).url,(function(){Je(),Object(N.o)("OpenInNewTab",{entryPoint:"BeautifulLinkContextMenu"})}));i&&f.push(i);break;case xe.AttachACopy:var o=function(e){var t=Object(h.l)(e);if(!J(t))return null;var n=Object(B.n)(Z[t.providerType]);return(null==n?void 0:n.supportConvertCloudyToClassic)?{name:Object(V.a)(z.a),key:"AttachACopy",onClick:function(){Object(N.o)("AttachmentLinkAttachAsACopy",[q.contextMenu]),Je(),Q(e)}}:null}(n.linkId);o&&f.push(o);break;case xe.ChangePermission:var a=function(e,t,n){var r=Object(h.l)(e),i=r.sharingInfo;if(!r.accessTokenAvailable)return null;var o=function(){Object(N.o)("AttachmentLinkViewChangePermissionSharingDialog",[q.contextMenu]),re(i,r.linkId,r.permissionLevel,t,n)};return{key:"ChangePermissionsSharingDialog",onRender:function(e,t){return j.createElement("button",{className:ae(oe.menuItemContainer,oe.buttonStyles),"aria-label":Object($.e)(r.permissionLevel,0),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:o,tabIndex:0},j.createElement("div",{className:oe.iconContainer},j.createElement("img",{src:(n=r.permissionLevel,function(e){var t="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing";switch(e){case 2:case 3:return t+"/companyonly.svg";case 4:case 5:return t+"/anyone.svg";case 6:return t+"/directrecipients.svg";default:return t+"/existingaccess.svg?v2"}}(function(e){switch(e){case 4:return 5;case 3:return 4;case 6:return 3;case 5:return 2;case 2:case 1:return 6;default:return 1}}(n))),className:oe.permissionIcon})),j.createElement("div",{className:ae(oe.text,oe.paddingForChevron)},Object($.e)(r.permissionLevel,0)),j.createElement(ie.a,{iconName:"ChevronRight",className:ae(oe.chevronRight,"flipForRtl")}));var n}}}(n.linkId,c,u);if(a)f.push(a),f.push(pe("divider_perms")),l=!0;else{var p=function(e,t,n){var r=Object(h.l)(e.linkId);return{text:Object($.e)(r.permissionLevel,0),key:"changePermission",className:ee.smallFontContextMenu,subMenuProps:te(r,t,n)}}(n,c,u);p&&(f.push(p),f.push(pe("divider_perms")))}break;case xe.EditLink:if(n.isLinkBeautified){var b=Oe(r,m);b&&f.push(b)}break;case xe.RevertToFullUrl:n.isLinkBeautified&&f.push(function(e,t,n,r){return{name:Object(V.a)(we.a),key:"RevertToFullUrl",onClick:function(){Object(N.o)("AttachmentLinkViewRevertToFullUrl"),Je(),n(t.href,t.href)}}}(n.linkId,r,m));break;case xe.Preview:if(Object(M.f)("doc-SxS-jsApi-ODB-Links")){var v=F.a.tryImportForRender(),O=Object(h.l)(n.linkId).url;if(n.isLinkBeautified&&v&&v(O)&&We(n.linkId)===W.None){var g=_e(O,n.linkId,s);g&&f.push(g)}}break;case xe.CopyLinkToClipboard:var _=le(r);_&&f.push(_);break;default:Object(R.a)(e)}})),[f,d||l]),2),O=v[0],g={conditionalPadding:v[1]};return j.createElement(E.a,{className:Ve(g),target:e.anchorElement,shouldFocusOnMount:!0,onDismiss:Xe,items:O,directionalHint:L.DirectionalHint.bottomLeftEdge,gapSpace:2})})),He=null;function Ge(e,t,n,r,o,a,c){return Object(x.__awaiter)(this,void 0,void 0,(function(){var u,s,d,l,f,p,v;return Object(x.__generator)(this,(function(O){switch(O.label){case 0:return Je(),u=h.q.tryImportForRender(),s=[],u&&(s=u(a,c)),d=!a.some((function(e){return Object(h.z)(e)})),(He=document.createElement("span")).id="sharingLinkContextMenu",e.appendChild(He),l=Object(h.i)(e.id),m.render(j.createElement(j.StrictMode,null,j.createElement(ze,{composeLinkViewState:b(l),anchorElement:e,editor:t,composeEditorViewState:n,operateContent:r,composeId:o,recipientInfo:s,isCalendar:d})),He),i(l,!0),[4,U.i.import()];case 1:return f=O.sent(),p=Object(h.k)(l),v=f(p,s).length>0,Object(N.o)("LinkContextMenuOpened",{hasSharingIssue:v}),[2]}}))}))}function Je(){He&&(m.unmountComponentAtNode(He),He.parentNode&&He.parentNode.removeChild(He),He=null),o()}function Ye(e,t,n,r){m.unmountComponentAtNode(t);var i=document.createElement("a");i.href=n,i.innerText=r,e.replaceNode(t,i),e.select(i,-3),e.triggerContentChangedEvent(v)}function Xe(e){Je()}var Ke=n(1234);var Qe=n(1455);var Ze,$e=n(2),et=n(2159);!function(e){e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(Ze||(Ze={}));var tt=n(4533),nt=n.n(tt),rt=n(1261),it=n(4533),ot=n(218).bind(it),at=Object(A.a)((function(e){var t=Object(M.f)("doc-link-operateContent");j.useEffect((function(){if(t||!e.editor.isDisposed()){if(i(),e.viewState.isLinkBeautified&&n.current.setAttribute("contenteditable","false"),Object(M.f)("doc-link-errorAttribute")&&n.current.setAttribute("owa-btf-l-cmp-only",""),n.current.setAttribute(et.f,""),n.current.addEventListener("click",a),n.current.addEventListener("contextmenu",o),t)e.operateContent(e.composeEditorViewState,(function(t,r,i){var o=t.queryElements("#"+e.originalElement.id),a=!1;if(o&&1===o.length){K.d.info("operateContent replacing node with beautiful link"),t.replaceNode(o[0],n.current);var c=t.getSelectionRange();t.hasFocus()&&c&&c.startContainer===c.endContainer&&c.startContainer===n.current.parentNode&&(a=!0)}else o&&o.length>=1?K.d.error("Beautiful link has found more than one replace targets for "+e.originalElement.id):K.d.error("Beautiful link can not find the target to replace for "+e.originalElement.id);return{selectionRange:a?i.createRange(n.current,-3):null,changeSource:null}}));else{e.editor.replaceNode(e.originalElement,n.current);var r=e.editor.getSelectionRange();r&&r.startContainer===r.endContainer&&r.startContainer===n.current.parentNode&&e.editor.select(n.current,-3)}return function(){n.current&&(n.current.removeEventListener("click",a),n.current.removeEventListener("contextmenu",o))}}}),[]);var n=j.useRef(),r=j.useRef(),i=function(){if(e.originalElement&&"a"===e.originalElement.tagName.toLowerCase()){var t=function(e){var t=e.getAttribute(O);e.style.backgroundColor===_&&(t=t.replace(w,""));t&&t.length>0&&t.lastIndexOf(g)!==t.length-1&&(t+=g);return t}(e.originalElement);if(t+=n.current.getAttribute(O),e.isLinkPreviouslyBeautified){var r=e.originalElement.querySelector("SPAN");if(r){var i=r.getAttribute(O);i&&(i.lastIndexOf("width:")>=0?K.d.error("Ignore dangerous Span style ${spanStyle}"):t+=i)}}n.current.setAttribute(O,t);var o=e.originalElement.getAttribute("originalsrc");o&&o.length>0&&n.current.setAttribute("originalsrc",o)}},o=function(t){Ge(n.current,e.editor,e.composeEditorViewState,e.operateContent,e.composeId,e.getRecipientWells(),e.fromAddress),t.preventDefault()},a=function(t){Ge(n.current,e.editor,e.composeEditorViewState,e.operateContent,e.composeId,e.getRecipientWells(),e.fromAddress),t.preventDefault()},c=e.viewState?function(e,t,n,r){var i=n(),o=Object(h.k)(e);if(null===o)return Ze.None;var a=h.q.tryImportForRender(),c=U.i.tryImportForRender();if(a&&c){var u=c(o,a(i,r));if(u&&u.length>0)return u.some((function(e){return e.messageRank===je.b.Error}))?Ze.Error:Ze.Warning}return Ze.None}(e.viewState.linkId,e.viewState.isLinkBeautified,e.getRecipientWells,e.fromAddress):Ze.None;Object(M.f)("doc-SxS-jsApi-ODB-Links")?r.current=We(e.sharingLink.linkId):r.current=W.None;var u={attachingAsACopy:e.sharingLink.linkActionStatus===h.b.attachingAsACopy||e.sharingLink.linkActionStatus===h.b.pendingAttachAsACopy,link:e.viewState.isLinkBeautified};return u[function(e){switch(e){case W.Edit:return"edit";case W.Selected:return"selected";case W.None:return"none";default:return Object(R.a)(e)}}(r.current)]=!0,j.createElement("a",{ref:function(e){return n.current=e},href:e.sharingLink.url,onMouseOver:function(){n.current&&e.viewState.isLinkBeautified&&(n.current.style.backgroundColor="rgb(237,235,233)")},onMouseLeave:function(){n.current&&e.viewState.isLinkBeautified&&(n.current.style.backgroundColor="rgb(243,242,241)")},style:function(n){if(!t&&e.editor.isDisposed())return null;var r=ut(t,e.composeEditorViewState,e.editor),i={};return e.viewState.isLinkBeautified&&(i={padding:"0 1px",backgroundColor:"rgb(244,244,244)",borderRadius:"2px",userSelect:"all"}),n===Ze.Error&&r&&(i=Object(x.__assign)(Object(x.__assign)({},i),{color:nt.a.linkErrorColor})),i}(c),id:Object(h.h)(e.sharingLink.linkId,e.sharingLink.permissionLevel),className:ot("OWAAutoLink",function(n){if(!t&&e.editor.isDisposed())return null;var r=ut(t,e.composeEditorViewState,e.editor);return n!==Ze.Error||r?void 0:Object(M.f)("doc-link-errorAttribute")?it.linkWithSharingIssueAttribute:it.linkWithSharingIssue}(c),u)},e.viewState.isLinkBeautified&&Object(M.f)("doc-SxS-jsApi-ODB-Links")?j.createElement(j.Fragment,null,j.createElement(I,{text:D.b}),j.createElement(ie.a,{className:r.current===W.Edit?it.editLinkIcon:it.hidden,iconName:"Edit"}),j.createElement(I,{text:D.a})):null,e.viewState.isLinkBeautified&&e.hasValidFileName&&j.createElement("img",{src:e.fileIcon,style:{width:"16px",height:"16px",verticalAlign:"middle",padding:"1px 2px 2px 0"},alt:"",role:"presentation"}),e.viewState.displayName,function(t){return e.viewState.isLinkBeautified?j.createElement(j.Fragment,null,j.createElement(I,{text:D.b}),j.createElement("img",{alt:"",role:"presentation",src:ct(t),hidden:t===Ze.None,style:{width:"12px",height:"12px",verticalAlign:"top"}}),j.createElement(I,{text:D.a})):null}(c))}));function ct(e){return e===Ze.Error?Object(V.b)("{0}{1}",Object($e.q)(),"resources/images/redinfo_24.png"):e===Ze.Warning?Object(V.b)("{0}{1}",Object($e.q)(),"resources/images/greyinfo_24.png"):""}function ut(e,t,n){return e?Object(rt.a)(t,"isDarkMode")||!1:n.isDarkMode()}function st(e,t,n,r,i,o,c,u,s,d){return Object(x.__awaiter)(this,void 0,void 0,(function(){var l,f,p,h,v,O;return Object(x.__generator)(this,(function(g){switch(g.label){case 0:return K.d.info("createSharingLinkView for id="+o.id+" isLinkPreviouslyBeautified="+d),l=s||d,f=u||d,p=function(e,t,n){if(e&&t){var r=Object(Qe.e)(e,n===H.f,n);return r.cdn?r.cdn:(K.d.error("Failed to get cdn fileicon for "+e),"")}return""}(d?be(o):c.fileName,l,c.mimeType),h=document.createElement("span"),v=function(e,t,n,r,i){return i?be(e):n&&r?t.fileName:e.innerText}(o,c,f,s,d),a(c.linkId,v,l),[4,Ke.c.import()];case 1:return O=g.sent(),m.render(j.createElement(j.StrictMode,null,j.createElement(at,{viewState:b(c.linkId),getRecipientWells:n,fromAddress:r,sharingLink:c,fileIcon:p,hasValidFileName:f,editor:e,composeEditorViewState:t,originalElement:o,composeId:i,isLinkPreviouslyBeautified:d,operateContent:O})),h),[2]}}))}))}n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return"OWAAutoLink"})),n.d(t,"f",(function(){return"originalsrc"})),n.d(t,"g",(function(){return"SPAN"})),n.d(t,"b",(function(){return"contextmenu"})),n.d(t,"a",(function(){return"click"})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return l})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return s})),n.d(t,"e",(function(){return I})),n.d(t,"k",(function(){return T})),n.d(t,"i",(function(){return Je})),n.d(t,"j",(function(){return st}))},3382:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("previewAttachment",(function(e){return{context:e}}))},3405:function(e){e.exports=JSON.parse('{"a":"yha"}')},3475:function(e,t,n){"use strict";n.d(t,"j",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(4),i=Object(r.action)("tryQueueGetWacInfo",(function(e){return{url:e}})),o=Object(r.action)("queueGetWacInfo",(function(e){return{url:e}})),a=Object(r.action)("processGetWacInfoQueue"),c=Object(r.action)("getWacInfoQueueShift"),u=Object(r.action)("onStartGetWacInfoOperation",(function(e){return{url:e}})),s=Object(r.action)("onFinishGetWacInfoOperation",(function(e){return{url:e}})),d=Object(r.action)("pushSupressedUrl",(function(e){return{url:e}})),l=Object(r.action)("onGetWacInfoSuccess",(function(e,t){return{url:e,wacUrlInfo:t}})),f=Object(r.action)("addGenericLinkClickListener",(function(e,t,n){return{element:e,isSafeLinkWrapped:t,isSafeLinkVerified:n}})),p=Object(r.action)("addOpenDocumentPreviewEventListener",(function(e,t,n,r,i){return{element:e,href:t,itemId:n,isSafeLinkWrapped:r,isSafeLinkVerified:i}}))},3476:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"i",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return l}));var r=108e6,i=2,o="SP_LINK_CLICK_EVENT_LISTENER",a="SP_LINK_MOUSEUP_EVENT_LISTENER",c="originalsrc",u="shash",s="data-auth",d="&reserved=0",l="Verified"},3532:function(e,t,n){"use strict";var r=n(3405),i=n(7);function o(e,t){return{name:Object(i.a)(r.a),key:"OpenInNewTab",onClick:function(){window.open(e,"_blank"),t&&t()}}}n.d(t,"a",(function(){return"owa-attachment-remove-on-send-end"})),n.d(t,"b",(function(){return"owa-attachment-remove-on-send-start"})),n.d(t,"c",(function(){return o}))},3785:function(e){e.exports=JSON.parse('{"a":"ZXa"}')},3786:function(e){e.exports=JSON.parse('{"a":"XXa"}')},384:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},3959:function(e,t,n){"use strict";var r=n(14),i=n(4),o={activeGetWacInfoOperations:[],getWacInfoQueue:[],suppressedUrls:[],docLinkPreviewInfoMap:new r.ObservableMap},a=Object(i.createStore)("sharePointDocLinkPreview",o);t.a=a()},412:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,o=function(a,c){i?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return a(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return o(a,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return o(e,t)}))},cancel:function(){return i=!0}}}}function i(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},4281:function(e){e.exports=JSON.parse('{"a":"sca"}')},4531:function(e,t,n){var r=n(6065),i=n(71);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4532:function(e,t,n){var r=n(6066),i=n(71);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4533:function(e,t,n){var r=n(6076),i=n(71);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4889:function(e){e.exports=JSON.parse('{"a":"YXa"}')},4890:function(e){e.exports=JSON.parse('{"a":"WXa"}')},4891:function(e){e.exports=JSON.parse('{"a":"VXa"}')},4892:function(e){e.exports=JSON.parse('{"a":"RXa","b":"SXa"}')},4893:function(e){e.exports=JSON.parse('{"a":"rca"}')},506:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},5166:function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(4),a=n(2),c=n(196);var u=n(85),s={am:"am-et","be-by":"be",cy:"cy-gb",en:"en-us",fil:"fil-ph","gd-gb":"gd","lo-la":"lo","mn-mn":"mn",no:"nn-no",or:"or-in","pa-in":"pa",prs:"prs-af",pt:"pt-br",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","ug-cn":"ug",uz:"uz-latn-uz","zh-hant":"zh-cn","zh-hans":"zh-tw"};function d(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return p=Object(u.a)(Object(i.d)().currentLocale).locale.toLocaleLowerCase(),e=s[p]||p,t=["items-view","items-view-addon-sp","items-view-utilities","odsp-datasources","odsp-list-utilities","odsp-shared-sharing","odsp-utilities","utilities-custom-formatter","utilities-date-time","utilities-office-apps"],[4,Promise.all(t.map((function(t){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(c.resolve)(Object(a.q)(),"resources/"+e+"/locale/"+t+".json"),[4,fetch(n)];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}}))}))}(t,e)})))];case 1:return n=f.sent(),window.ItemsViewStrings=n.reduce((function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),t)}),{}),l||(Object(o.orchestrator)(i.g,d),l=!0),[2]}var p}))}))}var l=!1;n.d(t,"a",(function(){return d}))},527:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(23),i=n(506);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,t)}},528:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},5300:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(191);function i(e,t,n){Object(r.o)("SharePointLinkClick",{newTabReason:e,isSafeLinkWrapped:t,isSafeLinkVerified:n})}},5301:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(3476),i=n(3959);function o(e){return a(e).docLinkPreviewInfo||null}function a(e){var t=i.a.docLinkPreviewInfoMap.get(e);return t?t.time+r.h>Date.now()?{docLinkPreviewInfo:t}:{reason:"Expired"}:i.a.getWacInfoQueue.some((function(t){return t===e}))||i.a.activeGetWacInfoOperations.some((function(t){return t===e}))?{reason:"InQueue"}:i.a.suppressedUrls.some((function(t){return t===e}))?{reason:"FileTypeNotSupportedOrSuppressedAfterError"}:{reason:"Unknown"}}},5350:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(0),i=n(791),o=n(86),a=n(5166),c=new o.c((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(a.a)()];case 1:return t.sent(),[4,Promise.all([n.e(1),n.e(4),n.e(5),n.e(6),n.e(477)]).then(n.bind(null,8402))];case 2:return e=t.sent(),Object(i.initializeIcons)(),[2,e]}}))}))})),u=new o.b(c,(function(e){return e.sharingDialog}))},5935:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3476);function i(e){return e.hasAttribute(r.b)&&e.hasAttribute(r.d)&&e.hasAttribute(r.a)}},6062:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(86),i=(n(191),new r.c((function(){return n.e(309).then(n.bind(null,8450))}))),o=new r.a(i,(function(e){return e.loadItemAttachment})),a=new r.b(i,(function(e){return e.loadItemAttachmentFromServer}))},6063:function(e,t,n){var r=n(6064),i=n(71);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},6064:function(e,t,n){(t=e.exports=n(70)(!1)).push([e.i,".zlTOIqgXrUeoE4QgaYR88{vertical-align:middle;width:14px;height:14px;display:inline-block}",""]),t.locals={linkSpinner:"zlTOIqgXrUeoE4QgaYR88"}},6065:function(e,t,n){(t=e.exports=n(70)(!1)).push([e.i,"._17WyMAb7kE3GVOOwb-TpZ2{width:380px}.iji84L-TYfQ1OzoQCLarU{font-size:12px;font-weight:400}html[dir=ltr] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-left:40px}html[dir=rtl] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-right:40px}",""]),t.locals={fixWidthContextMenu:"_17WyMAb7kE3GVOOwb-TpZ2",smallFontContextMenu:"iji84L-TYfQ1OzoQCLarU",conditionalPadding:"kYi6jPW-Twz-7yNjFuas7"}},6066:function(e,t,n){(t=e.exports=n(70)(!1)).push([e.i,'._1FXMYQgOMl3amdWxRszOtq{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;max-width:340px;width:100%}html[dir] ._1FXMYQgOMl3amdWxRszOtq{background:transparent;padding:4px 0;margin:1px}html[dir=ltr] ._1FXMYQgOMl3amdWxRszOtq{text-align:left}html[dir=rtl] ._1FXMYQgOMl3amdWxRszOtq{text-align:right}._1FXMYQgOMl3amdWxRszOtq:focus{outline:dotted 1px}._2J6rsM7M0QVkdfFCwf00JE{cursor:pointer}html[dir] ._2J6rsM7M0QVkdfFCwf00JE:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}._3C9hg6ajHb65GB2Yn3bZfl{word-wrap:break-word;max-width:286px}html[dir=ltr] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 16px 8px 0}html[dir=rtl] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 0 8px 16px}._T68wDSYHk9rU_lDLi9YG{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;min-width:44px}._T68wDSYHk9rU_lDLi9YG,._3ocYJJXdgtwVydxjhLdwEm{display:-webkit-box;display:-ms-flexbox;display:flex}._3ocYJJXdgtwVydxjhLdwEm{width:24px}html[dir=ltr] ._3ocYJJXdgtwVydxjhLdwEm{left:10px}html[dir=rtl] ._3ocYJJXdgtwVydxjhLdwEm{right:10px}._1aMX_W4LfwQ1uTeRkbETcG{display:inline-block;height:32px;line-height:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;font-size:12px}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG{text-align:center}html[dir=ltr] ._1aMX_W4LfwQ1uTeRkbETcG{right:8px}html[dir=rtl] ._1aMX_W4LfwQ1uTeRkbETcG{left:8px}._1aMX_W4LfwQ1uTeRkbETcG,._3ocYJJXdgtwVydxjhLdwEm,._2RFcp9Zl9UWOAAPCKGSCKd{position:absolute;top:50%}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG,html[dir] ._3ocYJJXdgtwVydxjhLdwEm,html[dir] ._2RFcp9Zl9UWOAAPCKGSCKd{-webkit-transform:translateY(-50%);transform:translateY(-50%)}html[dir=ltr] .G28wWLVhUsHo2YnnrMEFD{padding-right:28px}html[dir=rtl] .G28wWLVhUsHo2YnnrMEFD{padding-left:28px}',""]),t.locals={menuItemContainer:"_1FXMYQgOMl3amdWxRszOtq",buttonStyles:"_2J6rsM7M0QVkdfFCwf00JE",text:"_3C9hg6ajHb65GB2Yn3bZfl",iconContainer:"_T68wDSYHk9rU_lDLi9YG",permissionIcon:"_3ocYJJXdgtwVydxjhLdwEm",chevronRight:"_1aMX_W4LfwQ1uTeRkbETcG",verticalCenter:"_2RFcp9Zl9UWOAAPCKGSCKd",paddingForChevron:"G28wWLVhUsHo2YnnrMEFD"}},6067:function(e){e.exports=JSON.parse('{"a":"UXa"}')},6068:function(e){e.exports=JSON.parse('{"a":"TXa"}')},6069:function(e){e.exports=JSON.parse('{"e":"LXa","a":"MXa","c":"NXa","f":"OXa","d":"PXa","b":"QXa"}')},6070:function(e){e.exports=JSON.parse('{"b":"JXa","a":"KXa"}')},6071:function(e){e.exports=JSON.parse('{"b":"HXa","a":"IXa"}')},6072:function(e,t,n){var r=n(6073),i=n(71);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},6073:function(e,t,n){(t=e.exports=n(70)(!1)).push([e.i,'._15uyY13ASl7ioBzQ_C4EWc{position:absolute;z-index:2;width:100%;height:calc(100% - 10px);opacity:.9;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;color:"[theme:themePrimary, default:#0078D4]";font-size:14px}html[dir] ._15uyY13ASl7ioBzQ_C4EWc{background-color:"[theme:white, default:#ffffff]"}._3d_DdC8WbZ8lVAv_uGMON8{color:#107c10}html[dir=ltr] ._3d_DdC8WbZ8lVAv_uGMON8{padding-right:4px}html[dir=rtl] ._3d_DdC8WbZ8lVAv_uGMON8{padding-left:4px}html[dir=ltr] ._2Atp1TsvFekBpdmnwjlUMU{padding-right:8px}html[dir=rtl] ._2Atp1TsvFekBpdmnwjlUMU{padding-left:8px}._3FqcARyIY48vWIbTdVE2SJ{opacity:0}html[dir] ._3FqcARyIY48vWIbTdVE2SJ{-webkit-transition:opacity 4s cubic-bezier(.95,.05,.5,.12);transition:opacity 4s cubic-bezier(.95,.05,.5,.12)}',""]),t.locals={overlay:"_15uyY13ASl7ioBzQ_C4EWc",check:"_3d_DdC8WbZ8lVAv_uGMON8",spinner:"_2Atp1TsvFekBpdmnwjlUMU",fadeOut:"_3FqcARyIY48vWIbTdVE2SJ"}},6074:function(e,t,n){var r=n(6075),i=n(71);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},6075:function(e,t,n){(t=e.exports=n(70)(!1)).push([e.i,'._1j7cMKJzK3hDG-6d1x8z6x{font-size:14px;color:"[theme:neutralSecondary, default:#666666]"}._1j7cMKJzK3hDG-6d1x8z6x.NCCd4mtRtnDhwXkQV3Z_P{color:#c50e2e}._1XTgRlvIFVAMWCwk3N1Mrd{font-size:12px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";cursor:pointer}html[dir] ._1XTgRlvIFVAMWCwk3N1Mrd{background:transparent}html[dir=ltr] ._1lAZM-j0_dTiprJU8qtsOC{padding-right:5px}html[dir=rtl] ._1lAZM-j0_dTiprJU8qtsOC{padding-left:5px}._2A5MU0_Ldq3YiUz9_7eSp0{position:relative;top:-1px}',""]),t.locals={sharingTipIcon:"_1j7cMKJzK3hDG-6d1x8z6x",error:"NCCd4mtRtnDhwXkQV3Z_P",actionButton:"_1XTgRlvIFVAMWCwk3N1Mrd",paddingRight:"_1lAZM-j0_dTiprJU8qtsOC",divider:"_2A5MU0_Ldq3YiUz9_7eSp0"}},6076:function(e,t,n){(t=e.exports=n(70)(!1)).push([e.i,'._3Yr2UU45BKqj8cd21wO--0,.MEvaZK33-uzHgSrR3sZ2B[owa-btf-l-cmp-only]{color:#c50e2e}._3iLgzr8un7L5GebClucrpV{display:inline-block}._3BQT8e_ffVCDX0mocATk3h{opacity:.3}html[dir] ._1qJHlPfY83WgqLBJTIZPj{border-radius:2px}html[dir] ._1qJHlPfY83WgqLBJTIZPj:focus,html[dir] ._1qJHlPfY83WgqLBJTIZPj:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1Bl3Epd8DW0Ci3uZDqSnP5,._12rPxFFSJYfi0v4-eMstQ7,._2m59mwUb8f5uts16JkmmuW{color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5,html[dir] ._12rPxFFSJYfi0v4-eMstQ7,html[dir] ._2m59mwUb8f5uts16JkmmuW{border-width:1px;background-color:"[theme:themeLight, default:#C7E0F4]"!important;border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5{border-style:dashed;background-color:"[theme:themeLighterAlt, default:#EFF6FC]"!important}html[dir] ._12rPxFFSJYfi0v4-eMstQ7{border-style:solid}._28V6s2qWpjnFBjP3O5_ZUO{font-size:14px;font-weight:400;position:relative;top:-1px;color:"[theme:themePrimary, default:#0078D4]";vertical-align:middle;text-decoration:underline;-webkit-text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]";text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir=ltr] ._28V6s2qWpjnFBjP3O5_ZUO{padding-right:4px;padding-left:3px}html[dir=rtl] ._28V6s2qWpjnFBjP3O5_ZUO{padding-left:4px;padding-right:3px}.qfTvShXNrHnAq_ovV3Leq{display:none}._7uvXE6H5Cmt5xolh9xVtj{vertical-align:middle;width:14px;height:14px;display:inline-block}',""]),t.locals={linkErrorColor:"#c50e2e",linkWithSharingIssue:"_3Yr2UU45BKqj8cd21wO--0",linkWithSharingIssueAttribute:"MEvaZK33-uzHgSrR3sZ2B",link:"_3iLgzr8un7L5GebClucrpV",attachingAsACopy:"_3BQT8e_ffVCDX0mocATk3h",none:"_1qJHlPfY83WgqLBJTIZPj",edit:"_1Bl3Epd8DW0Ci3uZDqSnP5",selected:"_12rPxFFSJYfi0v4-eMstQ7",withBorder:"_2m59mwUb8f5uts16JkmmuW",editLinkIcon:"_28V6s2qWpjnFBjP3O5_ZUO",hidden:"qfTvShXNrHnAq_ovV3Leq",linkSpinner:"_7uvXE6H5Cmt5xolh9xVtj"}},6922:function(e,t,n){"use strict";n.r(t);var r=n(54),i=n(4),o=n(3475),a=n(1678),c=n(3476),u=n(7495),s=n(5301),d=n(5935),l=n(5300),f=n(7496);Object(i.orchestrator)(o.b,(function(e){var t=e.element,n=e.href,i=e.itemId,p=e.isSafeLinkWrapped,h=e.isSafeLinkVerified;Object(o.j)(n);var b=function(e){!function(e,t,n,i){var o=null;if(!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){var u=e.currentTarget,p=null;p=Object(r.f)("doc-SxS-jsApi-ODB-Links")&&Object(d.a)(u)?u.getAttribute(c.b):u.href;var h=Object(s.b)(p),b=h.docLinkPreviewInfo,m=h.reason;if(b)return Object(a.a)((function(){return Promise.resolve(b.wacUrlInfo)}),t),e.preventDefault(),void Object(l.a)(null,n,i);o=m}Object(f.a)(e,n,i,o)}(e,i,p,h)};t.addEventListener("click",b),t[c.e]=b;var m=function(e){Object(u.a)(e,p,h)};t.addEventListener("mouseup",m),t[c.f]=m}));var p=n(2626),h=n(86),b=new h.c((function(){return Promise.all([n.e(1),n.e(660),n.e(7),n.e(14),n.e(494)]).then(n.bind(null,13380))})),m=new h.a(b,(function(e){return e.insertSxSV2IntoDomIfNeeded}));p.c.register(m.importAndExecute);var v=n(6062);Object(i.orchestrator)(p.h,(function(e){var t=e.itemAttachmentId,n=e.perfDatapoint;v.a.importAndExecute(t,n)}));var O=n(3382);Object(i.orchestrator)(O.a,(function(e){var t=e.context;p.d.importAndExecute(t)}));var g=n(3306),_=n(979);Object(i.orchestrator)(g.m,(function(e){var t=e.wacUrlGetter,n=e.linkId,r=e.readOnly;p.g.importAndExecute(t,null,p.a.ComposeDocLink,{method:p.b.CopyMailReadingPaneContainer},null,n,r)})),Object(i.orchestrator)(_.E,(function(e){var t=e.selectedLinkId,n=e.isSelectedLinkReadOnly;Object(g.l)(t,n)}));var w=n(2181);Object(i.orchestrator)(w.f,(function(e){var t=e.wacUrlGetter,n=e.itemId;p.g.importAndExecute(t,n,p.a.ReadingPaneDocLink,{method:p.b.CopyMailReadingPaneContainer},null,null,null)}))},7495:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5300),i=1,o=2;function a(e,t,n){e.button===i?Object(r.a)("MouseMiddleButton",t,n):e.button===o&&Object(r.a)("MouseRightButton",t,n)}},7496:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(191),i=n(445),o=n(3476),a=n(5935),c=n(5300);function u(e,t,n,u){var s,d,l=Date.now(),f=new r.a("ServiceGeneratedLinkClickHandler"),p="CT="+l+"&OR=OWA-"+(e?e.ctrlKey||1===e.button?"NTB":e.shiftKey?"NW":"NT":"NT")+"&CID="+Object(i.a)(),h=e.currentTarget,b=(d=new URL(h.href),["CID","OR","CT"].forEach((function(e){d.searchParams.get(e)&&d.searchParams.delete(e)})),d);if(Object(a.a)(h)){var m=b.href,v=m.indexOf(o.c);if(-1===v)return;var O=encodeURIComponent(btoa(p));s=m.substr(0,v)+"&xdata="+O+o.c}else{var g=b.href.indexOf("?")>=0?"&":"?";s=b.href+g+p}f.end(),window.open(s),e.preventDefault(),Object(c.a)(u||(e.altKey?"AltKey":e.ctrlKey?"CtrlKey":e.metaKey?"MetaKey":e.shiftKey?"ShiftKey":"Default"),t,n)}},844:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){var t=r(e);return t?t.replace(".",""):null}function o(e){var t;return(null===(t=i(e))||void 0===t?void 0:t.substring(0,4))||""}var a=n(1170),c=n(7);function u(e){var t;return e>=1073741824?(e/=1073741824,t=Object(c.a)(a.b)):e>=1048576?(e/=1048576,t=Object(c.a)(a.d)):e>=1024?(e/=1024,t=Object(c.a)(a.c)):t=Object(c.a)(a.a),Object(c.b)(t,Math.round(e))}function s(e){return t=e||"",(n=l.exec(t))&&n.length>1&&d[n[1].toLowerCase()];var t,n}var d={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},l=/^\s*([^;\s]*)(?:;|\s|$)/;var f=n(41),p=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],h=[".tiff",".tif"];function b(e,t,n){void 0===n&&(n=!0);var i=r(e)||s(t);return!!i&&(p.indexOf(i.toLowerCase())>=0||n&&h.indexOf(i.toLowerCase())>=0&&(Object(f.d)()||Object(f.c)()||Object(f.g)()||Object(f.f)()&&!Object(f.i)()))}var m,v=n(54),O=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function g(e){if(!Object(v.f)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&O.indexOf(t.toLowerCase())>=0}function _(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return m.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return m.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return m.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(m||(m={})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return g})),n.d(t,"e",(function(){return _})),n.d(t,"a",(function(){return m}))},851:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc"}(r||(r={}))},864:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(952);function i(e){return Object(r.a)().attachments.get(e.Id)}},870:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"n",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return b})),n.d(t,"o",(function(){return m})),n.d(t,"p",(function(){return v})),n.d(t,"q",(function(){return O})),n.d(t,"a",(function(){return g}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange",u="Box",s="Dropbox",d="Facebook",l="GDrive",f="Mailbox",p="MailMessage",h="OneDriveConsumer",b="OneDrivePro",m="WopiBox",v="WopiDropbox",O="WopiEgnyte",g={providers:{BOX:u,DROPBOX:s,FACEBOOK:d,GDRIVE:l,MAILBOX:f,ONE_DRIVE_CONSUMER:h,ONE_DRIVE_PRO:b,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:m,WOPI_EGNYTE:O},attachmentTypes:{FILE_ATTACHMENT_TYPE:r,ITEM_ATTACHMENT_TYPE:i,ITEM_ID_ATTACHMENT_TYPE:o,REFERENCE_ATTACHMENT_TYPE:a,LINK_ATTACHMENT_TYPE:c}}},891:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},901:function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"n",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"m",(function(){return h})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"i",(function(){return v})),n.d(t,"g",(function(){return O})),n.d(t,"o",(function(){return g}));var r=n(86),i=n(1158);n.d(t,"p",(function(){return i.a}));var o=n(952);n.d(t,"b",(function(){return o.a}));var a=n(991);n.d(t,"c",(function(){return a.a}));var c=n(1006);n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return c.b}));var u=n(870);n.d(t,"a",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(7),n.e(14),n.e(34),n.e(118)]).then(n.bind(null,2297))})),d=new r.a(s,(function(e){return e.addAndInitializeAttachments})),l=new r.a(s,(function(e){return e.setPreviewImageUrl})),f=new r.a(s,(function(e){return e.refreshDownloadUrl})),p=new r.a(s,(function(e){return e.createAttachmentInfo})),h=new r.a(s,(function(e){return e.setAttachmentInfo})),b=new r.a(s,(function(e){return e.refreshThumbnailImageUrl})),m=new r.a(s,(function(e){return e.refreshPreviewImageUrl})),v=new r.b(s,(function(e){return e.getAttachment})),O=new r.b(s,(function(e){return e.checkPendingAttachmentOperation})),g=new r.b(s,(function(e){return e.shouldShowImageView}))},904:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},908:function(e,t,n){"use strict";var r=n(993),i=n(891),o=n(901),a=n(54);function c(e,t,n,c){if(Object(o.e)(n))return function(e){return 2===Object(o.c)(e)?d():u()}(n);if(3===Object(o.c)(n)&&!c)return s();var l;switch(t){case 2:l={allowEdit:!1,previewMethod:i.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:l={allowEdit:!1,previewMethod:i.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:l={allowEdit:!1,previewMethod:i.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:l={allowEdit:e.wacEdit,previewMethod:i.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:l={allowEdit:!1,previewMethod:i.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:l={allowEdit:!1,previewMethod:i.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:l=d();break;case 11:l={allowEdit:!1,previewMethod:i.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:l={allowEdit:!1,previewMethod:i.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:l={allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]};break;case 13:l=Object(a.f)("cal-ics-preview")?{allowEdit:!1,previewMethod:i.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]}:u();break;default:l=function(e){return e.__type===o.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||e.__type===o.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(n)?s():u()}return l}function u(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.Download]}}function s(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function d(){return{allowEdit:!1,previewMethod:i.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var l=n(103),f=(Object(l.action)("setPreviewLoaded")((function(e,t){e.previewLoaded=t})),Object(l.action)("setIsPlaceholderAttachment")((function(e,t){e.isPlaceholderAttachment=t}))),p=Object(l.action)("setThumbnailLoadState")((function(e,t){e.thumbnailLoadState=t}));function h(e,t,n,r,o,a){return void 0===a&&(a=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]},parentItemId:a,fileType:o}}var b=n(19);function m(){return Object(b.a)().SessionSettings.CompanyName}function v(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return r.a}))},952:function(e,t,n){"use strict";var r=n(14),i=n(4),o={attachments:new r.ObservableMap({})},a=Object(i.createStore)("attachment",o);t.a=a},955:function(e,t,n){"use strict";var r=n(851),i=n(844);function o(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(i.b)(e.url)||"",size:0,uri:e.url}}))}var a=n(48);function c(e,t,n){if(e.length!=t.length)return a.d.error("The sizes of subjects and latestItemIds are different"),null;for(var i=[],o=0;o<e.length;o++){var c={fileType:r.a.MailItem,name:e[o],size:(null==n?void 0:n[o])||0,itemId:t[o]};i.push(c)}return i}function u(e,t,n){var i=[],o={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return i.push(o),i}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],o={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(o)}return t}function d(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function l(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var f={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function p(e){switch(e?e.toLowerCase():null){case f.ONE_DRIVE_PRO.toLowerCase():return 0;case f.GDRIVE.toLowerCase():return 5;case f.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case f.DROPBOX.toLowerCase():return 2;case f.BOX.toLowerCase():return 3;case f.WOPI_BOX.toLowerCase():return 7;case f.WOPI_EGNYTE.toLowerCase():return 8;case f.MAILBOX.toLowerCase():return 4;case f.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return r.a}))},958:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(1048),i=n(87);function o(){return r.a.shouldShow}function a(){return r.a.shouldShow&&r.a.shouldHideReadingPaneOutsideSxS}function c(e){return o()&&Object(i.f)(e,r.a.extendedViewState.attachmentId)}function u(e){return o()&&(e&&e.composeId===r.a.composeId||!e&&r.a.composeId)}},960:function(e,t,n){"use strict";var r,i=[0,1],o=n(844),a=n(19);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));var c=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,i){e&&(e=e.toLowerCase());var o=this.getFileAccessLevel(e,t),a=!1,c=!1,u=!1,s="ReferenceAttachment:#Exchange"===i;return o!==r.Block&&n&&(this.isWacViewingEnabled(e)&&(a=!0),!this.directFileAccessEnabled&&s&&(a=!1),c=this.isForceBrowserViewingFirst(a),a&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(u="FileAttachment:#Exchange"===i?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),a||this.directFileAccessEnabled||(o=r.AccessDisabled)),{directFileAccessEnabled:this.directFileAccessEnabled,level:o,useWac:a,forceBrowserViewingFirst:c,wacEdit:u}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;var i=this.mimeTypeToPolicyMap[t];return i===r.Block?r.Block:n===r.ForceSave||i===r.ForceSave?r.ForceSave:n===r.Allow||i===r.Allow?r.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach((function(t){e[t]=n}))},e.prototype.createPolicyMap=function(e,t,n){var i={};return this.addPolicyIntoMap(i,n,r.Allow),this.addPolicyIntoMap(i,t,r.ForceSave),this.addPolicyIntoMap(i,e,r.Block),i},e}(),u=null,s=null;function d(){if(!u){var e=Object(a.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;u=new c(t,n),n&&(s=u)}return u}function l(e,t){var n=Object(o.b)(e.Name),r=e.ContentType;return d().getPolicyInfo(n,r,t,e.__type)}function f(e,t){var n=Object(o.b)(e.Name),r=e.ContentType;return function(){if(!s){var e=Object(a.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return d();s=new c(e.AttachmentPolicy,!0)}return s}().getPolicyInfo(n,r,t,e.__type)}function p(e,t,n,i){if(i)return!1;var o=l(e,!0),a=d();return o.level!==r.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}var h=n(1760),b=n(7),m=n(221),v=n(904);function O(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:v.c.Compose,rank:v.b.Error,message:Object(b.a)(h.b),messageParts:[Object(b.a)(h.b),g()],color:v.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:v.c.Compose,rank:v.b.Error,message:Object(b.a)(h.c),messageParts:[Object(b.a)(h.c),g()],color:v.a.Red};default:return Object(m.a)(e)}}function g(){return{text:Object(b.a)(h.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var _=n(1566);function w(e){var t=e.AttachmentPolicy;return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}function j(){return w(Object(a.a)())}function I(e){var t=Object(a.a)();return e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!function(e){return e.__type===_.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t}))}(e)?w(t):[]}function y(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(m.a)(e)}}function k(){var e=Object(a.a)().AttachmentPolicy;return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled&&!e.PrintWithoutDownloadEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"a",(function(){return i})),n.d(t,"j",(function(){return p})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return O})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return I})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return k}))},961:function(e,t,n){"use strict";var r=n(86),i=n(1015),o={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return o}));var a=new r.c((function(){return Promise.all([n.e(639),n.e(372)]).then(n.bind(null,13359))})),c=new r.a(a,(function(e){return e.subscribe})),u=new r.a(a,(function(e){return e.unsubscribe})),s=new r.b(a,(function(e){return e.getChannelId})),d=new r.b(a,(function(e){return e.getChannelReady})),l=new r.a(a,(function(e){return e.setup})),f=new r.a(a,(function(e){return e.initializeNotificationManager})),p=new r.b(a,(function(e){return e.getNotificationEmitter}));i.a},964:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},965:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(4),i=Object(r.action)("reloadReadingPaneAfterClosingSxS"),o=Object(r.action)("onSxSChangeOrClose",(function(e,t){return{selectedLinkId:e,isSelectedLinkReadOnly:t}})),a=Object(r.action)("showSxS",(function(e,t,n,r){return{customization:e,extendedViewState:t,editState:n,selectedLinkId:r}})),c=Object(r.action)("closeSxS")},979:function(e,t,n){"use strict";var r=n(1334),i=n(86),o=n(965);n(0);var a,c=n(1048),u=(n(908),n(958));function s(){return Object(u.a)()}!function(e){e[e.Mail=0]="Mail",e[e.FilesHub=1]="FilesHub",e[e.DeepLink=2]="DeepLink",e[e.GroupFilesHub=3]="GroupFilesHub"}(a||(a={}));var d=n(1394),l=n(1159),f=n(1164),p=n(1414);n.d(t,"C",(function(){return b})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"o",(function(){return O})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return _})),n.d(t,"r",(function(){return w})),n.d(t,"s",(function(){return j})),n.d(t,"t",(function(){return I})),n.d(t,"u",(function(){return y})),n.d(t,"y",(function(){return k})),n.d(t,"v",(function(){return C})),n.d(t,"w",(function(){return S})),n.d(t,"x",(function(){return T})),n.d(t,"z",(function(){return P})),n.d(t,"A",(function(){return x})),n.d(t,"B",(function(){return A})),n.d(t,"D",(function(){return E})),n.d(t,"F",(function(){return o.c})),n.d(t,"E",(function(){return o.b})),n.d(t,"G",(function(){return o.d})),n.d(t,"g",(function(){return o.a})),n.d(t,"H",(function(){return c.a})),n.d(t,"e",(function(){return r})),n.d(t,"i",(function(){return u.a})),n.d(t,"j",(function(){return u.b})),n.d(t,"k",(function(){return u.c})),n.d(t,"l",(function(){return u.d})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return d.a})),n.d(t,"b",(function(){return l.a})),n.d(t,"c",(function(){return f.a})),n.d(t,"a",(function(){return p.a}));var h=new i.c((function(){return Promise.all([n.e(1),n.e(660),n.e(7),n.e(14),n.e(494)]).then(n.bind(null,13329))})),b=new i.b(h,(function(e){return e})),m=new i.b(h,(function(e){return e.canCloseSxS})),v=new i.b(h,(function(e){return e.closeComposeInSxS})),O=new i.b(h,(function(e){return e.createImageGalleryFromAttachmentViewStateIds})),g=new i.b(h,(function(e){return e.editAndReply})),_=new i.b(h,(function(e){return e.editInDraft})),w=new i.b(h,(function(e){return e.forceCloseSxS})),j=new i.a(h,(function(e){return e.logUsageWithSxSCustomData})),I=new i.b(h,(function(e){return e.onBeforeImageGalleryItemSelected})),y=new i.b(h,(function(e){return e.onChangeByImageGallery})),k=new i.b(h,(function(e){return e.onSxSReadingPaneChange})),C=new i.b(h,(function(e){return e.onPendingNavigation})),S=new i.b(h,(function(e){return e.onPreviewOperationFinished})),T=new i.b(h,(function(e){return e.onPreviewOperationStart})),P=new i.b(h,(function(e){return e.openComposeInSxS})),x=new i.b(h,(function(e){return e.reloadTextPreview})),A=new i.b(h,(function(e){return e.showSxS})),E=new i.a(h,(function(e){return e.tryCloseSxS}));new i.b(h,(function(e){return e.tryExitSxSEditMode}))},991:function(e,t,n){"use strict";var r=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)},i=n(7),o=n(870);function a(e){switch(e.__type){case o.e:return 0;case o.n:return e.IsLink?3:1;case o.i:return 3;case o.g:return 2;case o.h:var t=e;return r(e.EmbeddedItemClass)||Object(i.f)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}n.d(t,"a",(function(){return a}))},993:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r}}]);
//# sourceMappingURL=owa.AttachmentPreviewSxSInitialize.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxSInitialize.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();