self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[360],{1018:function(e,t,n){"use strict";n.d(t,"r",(function(){return d})),n.d(t,"u",(function(){return l})),n.d(t,"e",(function(){return b})),n.d(t,"p",(function(){return f})),n.d(t,"i",(function(){return O})),n.d(t,"o",(function(){return j})),n.d(t,"b",(function(){return v})),n.d(t,"m",(function(){return m})),n.d(t,"f",(function(){return I})),n.d(t,"q",(function(){return p})),n.d(t,"t",(function(){return _})),n.d(t,"s",(function(){return y})),n.d(t,"g",(function(){return T})),n.d(t,"j",(function(){return R})),n.d(t,"k",(function(){return A})),n.d(t,"n",(function(){return S})),n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return h})),n.d(t,"h",(function(){return w})),n.d(t,"l",(function(){return g})),n.d(t,"a",(function(){return C}));var r=n(0),o=n(84),a=n(820),c=n(833),i=n(4),u=n(950),s=n(19),d=Object(i.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){var a=M(r,e,t);return Object(o.c)({name:a?"SelectMailItem":"SelectMailItemNonCritical",options:{isQos:a}},{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(i.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){var a=M(r,e,t);return Object(o.c)({name:a?"SelectMailItem":"SelectMailItemNonCritical",options:{isQos:a}},{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),b=Object(i.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r}})),f=Object(i.action)("SET_SELECTION_ON_ROW",(function(e,t,n){return{rowKey:e,tableViewId:t,shouldSelect:n}})),O=Object(i.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),j=Object(i.action)("SET_LIST_VIEW_EXPANSION_LOADING_STATE",(function(e){return{shouldBeExpanded:e}})),v=Object(i.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),m=Object(i.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),I=Object(i.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),p=Object(i.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r}})),_=Object(i.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),y=Object(i.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),T=Object(i.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),R=Object(i.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),A=Object(i.action)("RESET_SELECTION",(function(e){return{tableView:e}})),S=Object(i.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){var r=M(n,e,void 0,t);return Object(o.c)({name:r?"SelectMailItem":"SelectMailItemNonCritical",options:{isQos:r}},{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),E=Object(i.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),h=Object(i.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),w=Object(i.action)("RESET_BUS_STOP_STATE_MAP"),g=Object(i.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}})),C=Object(i.action)("INIT_TABLE_SELECTION_ON_LOAD",(function(e){return{tableView:e}}));function M(e,t,n,o){return!(function(e){return e===c.b.MailListItemRichPreview||e===c.b.KeyboardShiftEnter||e===c.b.MailListItemBodyDoubleClick}(e)||Object(u.q)()&&!function(e){var t;return e===c.b.KeyboardEnter||e===c.b.MailListItemBody||e===c.b.RouteHandler||e===c.b.CommandBarArrows||e===c.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(u.q)())return!1;if(e===c.b.KeyboardUpDown){var i=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==i&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return o===a.d.Next?s===i+1||s===t.rowKeys.length-1&&i===t.rowKeys.length-1:s===i-1||0===s&&0===i}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}},10360:function(e){e.exports=JSON.parse('{"a":"zUa","b":"AUa","c":"BUa","d":"CUa"}')},10361:function(e){e.exports=JSON.parse('{"a":"vUa","b":"wUa","c":"xUa","d":"yUa"}')},10362:function(e){e.exports=JSON.parse('{"a":"rUa","b":"sUa","c":"tUa","d":"uUa"}')},1209:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return s})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return l})),n.d(r,"getCount",(function(){return b})),n.d(r,"getTombstonedReasons",(function(){return f})),n.d(r,"clearMapForFolder",(function(){return O})),n.d(r,"removeRowsFromTombstone",(function(){return j}));var o=n(0),a=n(4),c=Object(a.createStore)("tombstone",{folderTombstoneMap:{}}),i=(c(),n(191)),u=n(103),s=Object(u.action)("tombstoneOperations.add")((function(e,t,n){var r=c().folderTombstoneMap;t in r||(r[t]={});var o=r[t];e.forEach((function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]}))})),d=Object(u.action)("tombstoneOperations.remove")((function(e,t,n){var r=c().folderTombstoneMap;if(t in r){var o=r[t],a=o[e],i=a?a.indexOf(n):-1;if(-1==i)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");a.splice(i,1),0==a.length&&delete o[e],0==Object.keys(o).length&&delete r[t]}})),l=Object(u.action)("tombstoneOperations.removeAll")((function(){c().folderTombstoneMap={},Object(i.p)("TnS_RemoveAllFromTombstone")})),b=function(e,t){var n=c().folderTombstoneMap;if(!(e in n))return 0;var r=0,o=n[e];return Object.values(o).forEach((function(e){e==t&&r++})),r},f=function(e,t){var n=c().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},O=Object(u.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=c().folderTombstoneMap;t[e]&&(Object(i.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),j=Object(u.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,a=c().folderTombstoneMap;if(t in a){var i=a[t];try{for(var u=Object(o.__values)(e),s=u.next();!s.done;s=u.next()){var d=s.value;d in i&&delete i[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}0==Object.keys(i).length&&delete a[t]}}));t.a=r},1425:function(e,t,n){"use strict";var r=n(86),o=n(1874),a=n(87),c=n(820),i=n(833),u=n(826),s=n(824),d=n(830);function l(e,t){return e&&!Object(c.s)()&&t&&t.type===a.a.UserMailbox&&!Object(i.p)(e)&&e!=Object(u.a)("recoverableitemsdeletions")&&!Object(s.C)(e,d.j)}n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"d",(function(){return o.c})),n.d(t,"c",(function(){return l}));var b=new r.c((function(){return n.e(520).then(n.bind(null,13245))})),f=new r.a(b,(function(e){return e.undo}))},1428:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},1530:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},1689:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1782:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1097);function o(e,t){return e.map((function(e){return Object(r.getInstrumentationContext)(e,t)})).filter((function(e){return e}))}},1792:function(e){e.exports=JSON.parse('{"a":"tca"}')},1874:function(e,t,n){"use strict";var r,o=n(4),a=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),c=n(1209),i=n(103),u=n(84);n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return b}));var s=Object(i.action)("addActionToUndoStack")(Object(i.select)({store:function(){return a}})((function(e,t,n){null!==e&&(r=e,n.store.hasUndoableAction=!0,n.store.undoableActionFolderId=t)}))),d=Object(i.action)("clearLastUndoableAction")(Object(i.select)({store:function(){return a}})((function(e){r=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null}))),l=Object(i.select)({store:function(){return a}})((function(e){return e.store.hasUndoableAction})),b=Object(u.d)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})((function(e){a.undoableActionFolderId?c.a.clearMapForFolder(a.undoableActionFolderId):c.a.removeAll();null!==r&&(r(),d())}))},1930:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},1986:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(4),o=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),a=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2054:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return u}));var r=n(86),o=n(1930);n.d(t,"d",(function(){return o.a}));var a=new r.c((function(){return n.e(326).then(n.bind(null,3977))})),c=new r.a(a,(function(e){return e.onKeyboardUpDown})),i=new r.a(a,(function(e){return e.onOpenEmail})),u=new r.a(a,(function(e){return e.onKeyboardToggleSelect}))},2058:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l}));var r=n(0),o=n(838),a=n(1344),c=n(989),i=n(19),u=n(1099);function s(e){var t,n,i=(null==e?void 0:e.itemIds)?e.itemIds.length:0;if(0==i)return[null,!1,!1];var s=null,d=2==Object(c.c)().type||!Object(c.b)();if(1==i){if(!(s=o.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||s.ParentFolderId&&s.ParentFolderId.Id==Object(c.b)()}else{var l=null;try{for(var b=Object(r.__values)(e.itemIds),f=b.next();!f.done;f=b.next()){var O=f.value,j=o.a.items.get(O);if(!j)return[null,!1,!1];if(j.ParentFolderId&&j.ParentFolderId.Id==Object(c.b)()){s=j,d=!0;break}Object(u.a)(j.ParentFolderId.Id,"sentitems")&&(l=j)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=b.return)&&n.call(b)}finally{if(t)throw t.error}}s||(s=l||o.a.items.get(e.itemIds[0]))}return[s,d,Object(a.a)(s.ParentFolderId.Id)]}function d(e,t,n){var r=Object(i.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&t&&!n)}function l(e){var t=o.a.conversationNodes.get(e),n=Object(r.__read)(s(t),3),a=n[0],c=n[1];return d(a,n[2],c)?a:null}},2113:function(e,t,n){"use strict";var r=n(23),o=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2143:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2322:function(e){e.exports=JSON.parse('{"a":"Kxa","c":"Lxa","e":"Mxa","b":"Nxa","d":"Oxa"}')},2383:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(824),o=n(830);function a(e){return Object(r.C)(e,o.j)}},2509:function(e,t,n){"use strict";var r=n(4853),o=n(0),a=n(3611),c=n(3612);function i(e,t,n,r,i){return e.then((function(e){if(Object(a.a)(t,n,i),e.ResponseMessages){var u=function(e,t){var n,r;try{for(var a=Object(o.__values)(e),i=a.next();!i.done;i=a.next()){var u=i.value;if(u&&"Success"!=u.ResponseClass){Object(c.a)(t);var s=new Error("ResponseCode="+u.ResponseCode+", Stacktrace="+u.StackTrace);return s.fetchErrorType="ServerFailure",s}}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return u?Promise.reject(u):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))})).catch((function(e){return Object(a.a)(t,n,i),Object(c.a)(r),Promise.reject(e)}))}var u=n(3969);n.d(t,"d",(function(){return r.a})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return u.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return c.a}))},2770:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1689),o=n(834),a=n(1530);function c(e,t){var n;return Object(a.a)({Path:Object(o.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},2884:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},3076:function(e){e.exports=JSON.parse('{"a":"DUa"}')},3134:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ApplyConversationActionRequest:#Exchange"},e)}},3135:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){return Object(r.__assign)({__type:"ConversationAction:#Exchange"},e)}},3189:function(e,t,n){"use strict";var r=n(0),o=n(327),a=n(23);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ApplyConversationActionJsonRequest:#Exchange"},n)),Object(a.a)("ApplyConversationAction",e,t)}function i(e,t,n){if(void 0===t&&(t=Object(o.b)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var a=Object(r.__assign)({},n),i=a.headers?new Headers(a.headers):new Headers;return i.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),a.headers=i,c({Header:t,Body:e},a).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}n.d(t,"a",(function(){return i}))},327:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u}));var r=n(182),o=n(211),a=n(210),c=n(207);function i(e){return Object(r.a)({RequestServerVersion:"Exchange2015",TimeZoneContext:Object(o.a)({TimeZoneDefinition:Object(a.a)({Id:null!=e?e:"Pacific Standard Time"})})})}function u(e,t,n){return Object(c.a)({PropertySetId:e,PropertyName:t,PropertyType:n})}},3611:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1209);function o(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}},3612:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2884);function o(e){e&&Object(r.a)(e)}},3968:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(336),o=n(874);function a(e){return e?Object(o.a)({BaseFolderId:Object(r.a)({Id:e})}):null}},3969:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(833);function a(e){var t,n;if(!e)return Promise.reject(c("500","Server returned a null response!"));var a=Array.isArray(e)?e:[e];try{for(var i=Object(r.__values)(a),u=i.next();!u.done;u=i.next()){var s=u.value;if(s&&!Object(o.c)(s))return Promise.reject(c(s.ResponseCode,s.StackTrace))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return Promise.resolve()}function c(e,t){var n=new Error("ResponseCode="+e+", Stacktrace="+t);return n.fetchErrorType="ServerFailure",n}},4263:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",(function(){return r}))},4264:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(987);function o(e,t){var n={};return e.forEach((function(e){var o,a=null===(o=Object(r.a)(e,t))||void 0===o?void 0:o.itemIds;a&&a.forEach((function(e){n[e]||(n[e]=!0)}))})),Object.keys(n)}},4853:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3611),o=n(3612),a=n(3969);function c(e,t,n,c,i){return e.then((function(e){return Object(r.a)(t,n,i),Object(a.a)(e)})).catch((function(e){return Object(r.a)(t,n,i),Object(o.a)(c),Promise.reject(e)}))}},5150:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(820),a={markConversationAsRead:{name:function(e,t,n,r,o,a,c){var i="TnS_MarkConversation";return i+=n?"Read":"Unread",r||(i+="Background"),i},options:function(e,t,n,r,o,a,c){return r?{isCore:!0}:{}},customData:function(e,t,n,r,a,c,i){return[a,e.length,Object(o.l)(t),Object(o.K)(t)]},cosmosOnlyData:function(e,t,n,a,c,i,u){var s,d,l=[],b=Object(o.A)(e,t);try{for(var f=Object(r.__values)(b),O=f.next();!O.done;O=f.next()){var j=O.value;l.push(o.b.getItemIds(j,t))}}catch(e){s={error:e}}finally{try{O&&!O.done&&(d=f.return)&&d.call(f)}finally{if(s)throw s.error}}return JSON.stringify({itemIds:l,conversationIds:e})}},markItemReadUnread:{name:function(e,t,n,r,o,a){var c="TnS_MarkItem";return c+=n?"Read":"Unread",r||(c+="Background"),c},options:function(e,t,n,r,o,a){return r?{isCore:!0}:{}},customData:function(e,t,n,r,a,c){var i=e?e.tableQuery.type:null,u=e?Object(o.l)(e):null,s=e?Object(o.K)(e):null;return[i,t.length,u,s]},cosmosOnlyData:function(e,t,n,r,o,a){return JSON.stringify({itemIds:t})},actionSource:function(e,t,n,r,o){return o}}},c=n(103),i=n(4),u=Object(i.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),s=Object(c.action)("AddMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return u}})((function(e,t){e.forEach((function(e){return t.store.suppressedItemIdsMap[e]=!0}))}))),d=Object(c.action)("RemoveMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return u}})((function(e,t){e.forEach((function(e){return delete t.store.suppressedItemIdsMap[e]}))}))),l=Object(c.action)("ClearMarkReadSuppressedMap")(Object(c.select)({store:function(){return u}})((function(e){e.store.suppressedItemIdsMap={}})));function b(e){for(var t=0;t<e.length;t++)if(!u.suppressedItemIdsMap[e[t]])return!1;return!0}var f=n(4263),O=n(3968),j=n(3134),v=n(3135),m=n(447),I=n(3189);function p(e,t,n){var r=Object(O.a)(n),o=e.map((function(e){return function(e,t,n){return Object(v.a)({Action:"SetReadState",ConversationId:Object(m.a)({Id:e.conversationId}),IsRead:t,ConversationLastSyncTime:Object(f.a)(e.conversationLastSyncTimeStamp),SuppressReadReceipts:!0,ContextFolderId:n})}(e,t,r)}));return Object(j.a)({ConversationActions:o,ReturnMovedItemIds:!1})}var _=n(5960),y=n(2054),T=n(2080),R=n(1609),A=n(977),S=n(48),E=n(84),h=n(2509);var w=n(838);var g=n(2770),C=n(19),M=n(1428),k=n(2113),x=n(2143),N=n(151);function U(e,t,n){var r=function(e,t){var n="AlwaysSend"!=Object(C.a)().UserOptions.ReadReceipt,r=Object(g.a)("IsRead",t),o=[];return e.forEach((function(e){return o.push(Object(M.a)({Updates:[r],ItemId:Object(m.a)({Id:e})}))})),Object(x.a)({ItemChanges:o,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:n})}(e,t);return Object(k.a)({Header:Object(N.a)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var L=n(2081),V=Object(E.d)("markItemsAsReadBasedOnItemIds",a.markItemReadUnread)((function(e,t,n,a,c,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,b,f;return Object(r.__generator)(this,(function(r){return 0==(u=function(e,t){var n=[];return e.forEach((function(e){var r=w.a.items.get(e);Object(o.Q)(r)&&r.IsRead!=t&&n.push(e)})),n}(t,n)).length?[2,Promise.resolve()]:(n?d(u):a?s(u):S.d.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(L.a)(u,n,a,l),_.a.import().then((function(t){t(e?e.tableQuery:null,!1,n,c,u)})),n?a?Object(y.d)("MarkAsRead",i):Object(y.d)("MarkAsReadImplicit",i):Object(y.d)("MarkAsUnread",i),b=Object(A.b)(e).requestOptions,f=e?Object(o.A)(u,e):[],[2,P(e,f,u,n,b)])}))}))}));function P(e,t,n,r,o){return U(n,r,o).then((function(e){return Object(h.a)(e)})).catch((function(n){var r=e?e.serverFolderId:null;return Object(h.b)(t,r,!0),Promise.reject(n)}))}var D=Object(E.d)("markConversationsAsReadBasedOnConversationIds",a.markConversationAsRead)((function(e,t,n,a,c,i,u){var d=function(e,t,n){var r=[];return e.forEach((function(e){var a=Object(o.G)(e,t);a&&a.unreadCount>0===n&&r.push(e)})),r}(u,t.id,n);if(0==d.length)return Promise.resolve();if(1==e.length&&1==t.selectedRowKeys.size){var b=o.b.getRowIdString(d[0],t),f=Object(o.G)(Object(r.__spread)(t.selectedRowKeys.keys())[0],t.id);if(b==f.id){var O=f.itemIds;n?l():a?s(O):S.d.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(T.a)(e,t.id,n,a),_.a.import().then((function(r){r(t.tableQuery,!1,n,c,e)})),n?a?Object(y.d)("MarkAsRead",i):Object(y.d)("MarkAsReadImplicit",i):Object(y.d)("MarkAsUnread",i);var j=Object(A.b)(t).requestOptions;return Object(o.e)(t)?function(e,t,n,a){var c=[];return t.forEach((function(t){c.push.apply(c,Object(r.__spread)(o.b.getItemIds(t,e)))})),P(e,t,c,n,a)}(t,d,n,j):function(e,t,n,r,a){var c=Object(R.a)(e),i=function(e,t,n,r){var o=p(e,t,n);return Object(I.a)(o,void 0,r)}(t.map((function(t){return Object(o.h)(t,e.id)})),n,c,a),u=Object(o.V)(e,n,r);return Object(h.d)(i,t,c,e,u)}(t,d,n,a,j)}));var K=n(987),F=Object(c.action)("autoMarkConversationAsRead")(Object(c.select)({items:function(){return w.a.items}})((function(e,t,n){var r=Object(o.A)([e],t),a=Object(K.a)(r[0],t.id);if(a&&Object(o.f)(t)){var c=a.itemIds;b(c)||(0==Object.keys(u.suppressedItemIdsMap).length?D([e],t,!0,!1,null,[],r):c.forEach((function(e){!b([e])&&n.items.get(e)&&V(t,[e],!0,!1,null,[])})),l())}}))),B=Object(c.action)("autoMarkItemAsRead")((function(e,t){Object(o.f)(t)&&(b([e])||(V(t,[e],!0,!1,null,[]),l()))}));function q(e,t){if("OnSelectionChange"===Object(C.a)().UserOptions.PreviewMarkAsRead){var n=o.b.getRowIdString(e,t);switch(t.tableQuery.listViewType){case 0:F(n,t);break;case 1:B(n,t)}}}var Q=n(950),G=Object(c.action)("onReadingPaneClosed")((function(e,t){Object(Q.q)()||S.d.error("onReadingPaneClosed should only be called in single line view."),q(e,t)})),W=Object(c.action)("onSingleSelectionChanged")((function(e,t,n){Object(Q.q)()||n&&q(e,t)}));function J(e,t,n){0==e.length||Object(Q.q)()||1!==e.length||"Unread"===Object(o.K)(n)||q(e[0],t)}var H=Object(i.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",(function(e,t,n,r,o){return{nodeIds:e,tableViewId:t,isReadValueToSet:n,isExplicit:r,actionSource:o}})),X=Object(c.action)("markItemAsReadFromReadingPane")((function(e,t,n,r,a){var c=[],i=null;if(t){if(1==t.tableQuery.listViewType)c=Object(o.A)([e],t);else{var u=w.a.items.get(e).ConversationId.Id;c=Object(o.A)([u],t)}i=Object(o.k)(t)}V(t,[e],n,!0,a,r).then((function(){t&&Object(h.b)(c,i)})).catch((function(e){t&&(Object(h.b)(c,i),Object(h.c)(t))}))})),z=n(1782),Y=Object(c.action)("markConversationsAsReadFromTable")((function(e,t,n,r){var a=Object(o.y)(e,t.id),c=Object(z.a)(e,t);return D(a,t,n,!0,r,c,e)})),Z=Object(c.action)("markItemsReadFromTable")((function(e,t,n,r,a){var c=Object(o.y)(e,t.id),i=Object(z.a)(e,t),u=V(t,c,n,r,a,i),s=Object(o.k)(t),d=Object(o.V)(t,n,r);u.then((function(t){Object(h.b)(e,s,d)})).catch((function(n){Object(h.b)(e,s,d),Object(h.c)(t)}))})),$=n(1986),ee=Object(c.action)("toggleRowReadState")((function(e,t,n){var r=o.S.tableViews.get(t),a=o.b.getUnreadCount(e,r)>0;switch(r.tableQuery.listViewType){case 0:Y([e],r,a,n);break;case 1:Z([e],r,a,!0,n)}Object($.b)()})),te=Object(c.action)("onNavigateAwayViaUpDown")((function(e,t){q(e,t)})),ne=Object(i.action)("onKeyboardMarkAsRead",(function(e,t,n,r,o,a){return{tableView:e,selectedNodeIds:t,isInVirtualSelectAllMode:n,rowKeysToActOn:r,exclusionList:o,isReadValueToSet:a}})),re=n(191),oe=n(881),ae=n(5),ce=n(824),ie=n(7),ue=n(1792),se=n(1828),de=n(4264);var le=n(23);function be(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"MarkAllItemsAsReadJsonRequest:#Exchange"},n)),Object(le.a)("MarkAllItemsAsRead",e,t)}var fe=n(5961),Oe=n(2383),je=n(1425),ve=n(5215),me=n(2322),Ie=n(3076),pe=n(10360),_e=n(10361),ye=n(10362);var Te=n(347),Re=n(54),Ae=Object(c.action)("markAsReadInTable")((function(e,t,n,a,c,i,u){var s=this;if(c.length&&n)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(t.length&&!n)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var d=i.tableQuery.folderId,l=ce.e.folderTable.get(d),b=i.isInVirtualSelectAllMode&&t.length>0,f=Object(o.K)(i),O="ContextFolder"===e||"CommandBar"===e&&n&&!i.isInCheckedMode&&!Object(o.N)(i,f),j=c.length>0&&!n,v=n&&l&&l.UnreadCount>=fe.b,I=function(e,t,n,r,a,c,i,u){if(e){if(Object(Re.f)("tri-categoryUnreadCount")){var s=Object(o.J)(c);if(s)return Object(Te.n)(s)}return null==n?void 0:n.UnreadCount}if(Object(o.q)(c)||t||Object(o.N)(c,i)&&u)return c.totalRowsInView-r;return a}(O,b,l,t.length,c.length,i,f,n),p=v||I>=fe.b,y={headerText:"",bodyText:""};if(p){var T=Object(o.o)(i.tableQuery.type,i,l&&Object(ce.k)(l));y=function(e,t,n,r,o,a,c,i){var u,s="",d="",l=1===t,b=e||l;return n<0&&(S.d.warn("totalCount in getMarkAsReadUnreadAllConfirmText should not be negative."),s=b?o?Object(ie.a)(ve.e):Object(ie.a)(me.e):o?Object(ie.a)(ve.c):Object(ie.a)(me.c)),1==n&&(s=o?Object(ie.a)(Ie.a):Object(ie.a)(me.a)),u=n<fe.a?n:"10000+",s=b?o?Object(ie.b)(Object(ie.a)(ve.d),u):Object(ie.b)(Object(ie.a)(me.d),u):o?Object(ie.b)(Object(ie.a)(ve.b),u):Object(ie.b)(Object(ie.a)(me.b),u),d=e?o?Object(ie.b)(Object(ie.a)(_e.b),r):Object(ie.b)(Object(ie.a)(ye.b),r):a||c?l?o?Object(ie.b)(Object(ie.a)(_e.d),r):Object(ie.b)(Object(ie.a)(ye.d),r):o?Object(ie.b)(Object(ie.a)(_e.c),r):Object(ie.b)(Object(ie.a)(ye.c),r):l?o?Object(ie.b)(Object(ie.a)(_e.b),r):Object(ie.b)(Object(ie.a)(ye.b),r):o?Object(ie.b)(Object(ie.a)(_e.a),r):Object(ie.b)(Object(ie.a)(ye.a),r),i&&(d=l?o?Object(ie.a)(pe.b):Object(ie.a)(pe.d):o?Object(ie.a)(pe.a):Object(ie.a)(pe.c)),{headerText:s,bodyText:d}}(O,i.tableQuery.listViewType,I,T,a,b,j,2===i.tableQuery.type)}Object(oe.b)(y.headerText,y.bodyText,!p,{delayCallbackAfterAnimation:!0,okText:Object(ie.a)(ue.a)}).then((function(u){return Object(r.__awaiter)(s,void 0,void 0,(function(){var s,l,b,f;return Object(r.__generator)(this,(function(O){if(u===oe.a.ok)if(je.b(),n){switch(s=Object(C.a)().UserOptions.ReadReceipt,l="DoNotAutomaticallySend"==s||"NeverSend"==s||Object(Oe.a)(d),b=Object(o.O)(d)?Object(ae.m)(o.S.inboxPausedDateTime):null,function(e,t,n){var r="TnS_MarkAllAs";r+=t?"Read":"Unread",Object(re.o)(r,[e,Object(o.l)(n),n.isInCheckedMode])}(e,a,i),_.a.import().then((function(t){t(i.tableQuery,!0,a,e)})),f=[],i.tableQuery.listViewType){case 0:f=Object(de.a)(t,i.id);break;case 1:f=Object(o.y)(t,i.id)}Object(se.a)(i,a,f),function(e,t,n,o,a,c){var i,u=null!=n?n.map((function(e){return Object(m.a)({Id:e})})):void 0;be({Header:Object(N.a)(),Body:(i={ReadFlag:t,SuppressReadReceipts:o,FromFilter:null,FolderIds:[e],ItemIdsToExclude:u,ClientLastSyncTime:c&&c.toISOString()},Object(r.__assign)({__type:"MarkAllItemsAsReadRequest:#Exchange"},i))},a).then((function(e){return e.Body.ResponseMessages.Items[0]}))}(Object(o.j)(i),a,f,l,Object(A.b)(i).requestOptions,b)}else switch(i.tableQuery.listViewType){case 0:Y(c,i,a,e);break;case 1:Z(c,i,a,!0,e)}return[2]}))}))}))}));var Se=n(988),Ee=Object(c.action)("setAutoMarkAsReadTimer")(Object(c.select)({markAsReadDelaytime:function(){return Object(C.a)().UserOptions.MarkAsReadDelaytime},store:function(){return u},userOptions:function(){return Object(C.a)().UserOptions}})((function(e,t,n){var r=Object(Se.a)();if(r&&Object(o.f)(r)){var a=n.markAsReadDelaytime,c=n.store;"Delayed"==n.userOptions.PreviewMarkAsRead&&(c.markAsReadTimerTask=setTimeout((function(){we(e,r,t)}),1e3*a))}}))),he=Object(c.action)("clearAutoMarkAsReadTimer")(Object(c.select)({store:function(){return u}})((function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)}))),we=Object(c.action)("setMarkAsReadTimer:timeout")((function(e,t,n){if(he(),n)B(e,t);else switch(t.tableQuery.listViewType){case 0:F(e,t);break;case 1:B(e,t)}})),ge=n(2377),Ce=n(86),Me=Object(Ce.e)(ge.b,"CLONE_ON_ITEM_PART_DESELECTED",(function(e){var t=e.itemId,n=e.tableView;n&&"OnSelectionChange"==Object(C.a)().UserOptions.PreviewMarkAsRead&&B(t,n)})),ke=n(5331),xe=(Object(i.orchestrator)(H,(function(e){var t=Object(ke.a)(e.nodeIds),n=o.S.tableViews.get(e.tableViewId);V(n,t,e.isReadValueToSet,e.isExplicit,e.actionSource,null)})),n(1018)),Ne=n(2058),Ue=n(1950);Object(i.orchestrator)(xe.q,(function(e){var t=Object(Ne.b)(e.nodeIdToSelect);t&&(Ue.a.importAndExecute(),Ue.j.importAndExecute(t.ItemId.Id,!0))}));Object(i.orchestrator)(ne,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.isInVirtualSelectAllMode,o=e.rowKeysToActOn,a=e.exclusionList,c=e.isReadValueToSet;n.length>0?H(n,t.id,c,!0,"Keyboard"):Ae("Keyboard",a,r,c,o,t)}));n.d(t,"onReadingPaneClosed",(function(){return G})),n.d(t,"onSingleSelectionChanged",(function(){return W})),n.d(t,"markReadOnTableViewChange",(function(){return J})),n.d(t,"markItemsAsReadBasedOnNodeIds",(function(){return H})),n.d(t,"markItemAsReadFromReadingPane",(function(){return X})),n.d(t,"toggleRowReadState",(function(){return ee})),n.d(t,"onNavigateAwayViaUpDown",(function(){return te})),n.d(t,"onKeyboardMarkAsRead",(function(){return ne})),n.d(t,"markAsReadInTable",(function(){return Ae})),n.d(t,"clearAutoMarkAsReadTimer",(function(){return he})),n.d(t,"setAutoMarkAsReadTimer",(function(){return Ee})),n.d(t,"onItemPartDeselectedOrchestrator",(function(){return Me}))},5215:function(e){e.exports=JSON.parse('{"a":"mUa","c":"nUa","e":"oUa","b":"pUa","d":"qUa"}')},5331:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(2058);function a(e){var t,n,a=[];try{for(var c=Object(r.__values)(e),i=c.next();!i.done;i=c.next()){var u=i.value,s=Object(o.b)(u);s&&a.push(s.ItemId.Id)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a}},5960:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i}));var r=n(86),o=new r.c((function(){return n.e(278).then(n.bind(null,8896))})),a=new r.b(o,(function(e){return e.addMarkAsReadDiagnostics})),c=new r.b(o,(function(e){return e.addUnreadCountNotificationDiagnostics})),i=new r.b(o,(function(e){return e.addUnreadCountSubscriptionDiagnostics}))},5961:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=1e4,o=25}}]);
//# sourceMappingURL=owa.MarkRead.js.map
self.scriptsLoaded['owa.MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MarkRead.js'] = (new Date()).getTime();