self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ItemActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[309],{12864:function(e){e.exports=JSON.parse('{"f":"v6b","d":"w6b","k":"x6b","j":"y6b","i":"z6b","e":"A6b","h":"B6b","l":"C6b","b":"D6b","c":"E6b","g":"F6b","a":"G6b"}')},12865:function(e,t,n){var o=n(12866),a=n(64);"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)a.loadStyles(o[r][1],!1);o.locals&&(e.exports=o.locals)},12866:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'.tZW9JCrS32YC2HkVN-WyY{display:block!important}.Isabp7l92KgYue--mXACT{width:auto;height:32px}html[dir] .Isabp7l92KgYue--mXACT{border-radius:2px;background:transparent}html[dir] .Isabp7l92KgYue--mXACT:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] .Isabp7l92KgYue--mXACT:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc{background-color:"[theme:themeLighter, default:#DEECF9]"}.Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc.ms-Button .ms-Button-menuIcon,.Isabp7l92KgYue--mXACT:active.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT:active.ms-Button .ms-Button-menuIcon,.Isabp7l92KgYue--mXACT:hover.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] .bW0ipvHhaLslVzcuqolhK{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"!important}.aX3RmEGx8HrdPL1yktLRm{width:230px}html[dir] .aX3RmEGx8HrdPL1yktLRm{background-color:"[theme:white, default:#ffffff]"}._3EVsmMkXoUVhUDeorDNq-T{max-height:400px;overflow-x:hidden}._3dfPy9ayr523z3j8V0vi53{overflow:hidden}._3nLjv484RsToOL5jRMWQLH{height:44px}html[dir=ltr] ._3nLjv484RsToOL5jRMWQLH{padding-left:12px}html[dir=rtl] ._3nLjv484RsToOL5jRMWQLH{padding-right:12px}html[dir] ._3nLjv484RsToOL5jRMWQLH:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}',""]),t.locals={likeCustomButtonLabel:"tZW9JCrS32YC2HkVN-WyY",likeIconButtonCustom:"Isabp7l92KgYue--mXACT",isChecked:"_3i2_PWR38mmJG6N-oVvSc",likeCustomButtonActive:"bW0ipvHhaLslVzcuqolhK",callout:"aX3RmEGx8HrdPL1yktLRm",scrollContainer:"_3EVsmMkXoUVhUDeorDNq-T",personaCollection:"_3dfPy9ayr523z3j8V0vi53",persona:"_3nLjv484RsToOL5jRMWQLH"}},12867:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'html[dir=ltr] ._2opPWe6KuVFhEI52_XY6Tw{padding-right:2px}html[dir=rtl] ._2opPWe6KuVFhEI52_XY6Tw{padding-left:2px}._3tBxnKAWFWDe41Zarl9mN{width:100%;min-width:0;height:40px;display:inline-block;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;position:relative;top:1px}html[dir=ltr] ._3tBxnKAWFWDe41Zarl9mN{left:2px}html[dir=rtl] ._3tBxnKAWFWDe41Zarl9mN{right:2px}._20q0GP-4M43aJdIUNdbHS_{font-size:14px;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._20q0GP-4M43aJdIUNdbHS_{background:transparent}._3CHzUb8E75dSDcMFHT_8Qx{height:32px}html[dir] ._3CHzUb8E75dSDcMFHT_8Qx{background-color:transparent;padding:4px 0}.eeijf3m13i_oYyGsPmueH{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._3ODQEP4a8av7UYmYAIFIRW{height:100%;min-width:32px}html[dir] ._3ODQEP4a8av7UYmYAIFIRW{background-color:transparent;margin:0 2px}._2O1OZ_6q64cOi7BcKWHTR7.ms-ContextualMenu-icon,._2i4F3Q0eiaJ5u4aiXx5D3w:not(._20q0GP-4M43aJdIUNdbHS_),._3ODQEP4a8av7UYmYAIFIRW .ms-Button-label{display:none}._1MncjFzxk89g--zyj1v5O5{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5{border-radius:2px;background:transparent}._1MncjFzxk89g--zyj1v5O5.ms-Button{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] ._1MncjFzxk89g--zyj1v5O5:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN{background-color:"[theme:themeLighter, default:#DEECF9]"}._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}.aZVJsA6Ilr8olDTFGKR6T{color:"[theme:themePrimary, default:#0078D4]"}._3DE4Hx2dldBiXVAxb2jkoh{color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._3of7CI7D6gm5OF90xXEWK0{background-color:transparent}',""]),t.locals={surfaceActionsCommandBarCharms:"_2opPWe6KuVFhEI52_XY6Tw",surfaceActionsCommandBarContainer:"_3tBxnKAWFWDe41Zarl9mN",surfaceActionsCommandBarOverflowIcon:"_20q0GP-4M43aJdIUNdbHS_",surfaceActionsCommandBar:"_3CHzUb8E75dSDcMFHT_8Qx",surfaceActionsCommandBarPrimarySet:"eeijf3m13i_oYyGsPmueH",surfaceActionsCommandBarButton:"_3ODQEP4a8av7UYmYAIFIRW",commandBarIcon:"_2O1OZ_6q64cOi7BcKWHTR7",commandBarMenuIcon:"_2i4F3Q0eiaJ5u4aiXx5D3w",iconButton:"_1MncjFzxk89g--zyj1v5O5",isChecked:"_37fr-TjgFabRfitZmzNqlN",enabledIconButton:"aZVJsA6Ilr8olDTFGKR6T",disabledIconButton:"_3DE4Hx2dldBiXVAxb2jkoh",disabledReplyActionButton:"_3of7CI7D6gm5OF90xXEWK0"}},13820:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(453),r=n(1393),i=n(565),s=n(51),c=n(893),u=n(786),d=n(160),l=n(452),m=n(931),p=n(1),b=n(12864),f=n(8),h=n(18),I=100;function O(e){try{if(e.LikeCount&&e.Likers){var t=Object(h.a)().SessionSettings.UserEmailAddress,n=!!e.Likers&&e.Likers.some((function(e){return e.EmailAddress===t}));switch(e.LikeCount){case 1:return n?Object(f.a)(b.f):Object(f.b)(Object(f.a)(b.d),e.Likers[0].Name);case 2:return n?Object(f.b)(Object(f.a)(b.k),e.Likers.filter((function(e){return e.EmailAddress!==t}))[0].Name):Object(f.b)(Object(f.a)(b.j),e.Likers[0].Name,e.Likers[1].Name);case 3:return n?Object(f.b)(Object(f.a)(b.i),e.Likers[0].Name,Object(f.a)(b.e)):Object(f.b)(Object(f.a)(b.h),e.Likers[0].Name,e.Likers[1].Name,Object(f.a)(b.e));default:return n?e.LikeCount>=I?Object(f.b)(Object(f.a)(b.l),I-1):Object(f.b)(Object(f.a)(b.b),e.Likers[0].Name,Object(f.b)(Object(f.a)(b.c),e.LikeCount-2)):e.LikeCount>=I?Object(f.b)(Object(f.a)(b.g),I-1):Object(f.b)(Object(f.a)(b.a),e.Likers[0].Name,e.Likers[1].Name,Object(f.b)(Object(f.a)(b.c),e.LikeCount-2))}}}catch(e){return null}return null}function g(e){return e.LikeCount?e.LikeCount<I?e.LikeCount.toString():I-1+"+":null}var v=n(1049),j=n(12865),k=n(7006),S=n(410),y=function(e){function t(t){var n=e.call(this,t)||this;return n.onDismissCallOut=function(){n.setState(Object(o.__assign)(Object(o.__assign)({},n.state),{isMouseOverButton:!1,isMouseOverLikersList:!1}))},n.onLikeClicked=function(e){var t=e;n.props.surfaceActionItem.onClick(t,n.props.surfaceActionItem),t.stopPropagation()},n.handleMouseOver=function(){n.state.isMouseOverButton||n.setState({isMouseOverButton:!0})},n.handleMouseLeave=function(){n.state.isMouseOverButton&&n.setState({isMouseOverButton:!1})},n.handleLikersListMouseOver=function(){n.state.isMouseOverLikersList||n.setState({isMouseOverLikersList:!0})},n.handleLikersListMouseLeave=function(){n.state.isMouseOverLikersList&&n.setState({isMouseOverLikersList:!1})},n.state={isMouseOverButton:!1,isMouseOverLikersList:!1},n}return Object(o.__extends)(t,e),t.prototype.IsLikersListShown=function(){return this.state.isMouseOverLikersList},t.prototype.render=function(){var e=this.props,t=e.surfaceActionItem,n=e.message,o=n.LikeCount&&n.Likers&&(this.state.isMouseOverButton||this.state.isMouseOverLikersList),a="likeButtonId"+Object(l.a)();return p.createElement(u.a,{content:t.name},p.createElement(r.a,{id:a,role:"menuitem",ariaLabel:t.name,ariaDescription:O(n),iconProps:t.iconProps,styles:{root:S(k.surfaceActionsCommandBarButton,j.likeIconButtonCustom,o&&j.likeCustomButtonActive),label:n.LikeCount&&j.likeCustomButtonLabel,rootChecked:k.checkedCommandBarButton,rootDisabled:k.disabledReplyActionButton,icon:k.enabledIconButton,iconDisabled:k.disabledIconButton,menuIcon:k.commandBarMenuIcon},onClick:this.onLikeClicked,onMouseEnter:this.handleMouseOver,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,text:g(n)}),o&&p.createElement(i.a,{className:j.callout,onDismiss:this.onDismissCallOut,target:"#"+a,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(d.a)()?s.DirectionalHint.bottomLeftEdge:s.DirectionalHint.bottomRightEdge},p.createElement("div",{className:S(j.scrollContainer,"customScrollBar"),onMouseEnter:this.handleLikersListMouseOver,onMouseOver:this.handleLikersListMouseOver,onMouseLeave:this.handleLikersListMouseLeave},p.createElement("div",{className:j.personaCollection},n.Likers.map((function(e){return p.createElement(A,{key:e.EmailAddress,emailAddress:e.EmailAddress,name:e.Name,mailBoxType:e.MailboxType,disableHover:!0,clientScenario:"Liker"},p.createElement(m.a,{className:j.persona,key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:c.c.size32,showPersonaDetails:!0,mailboxType:e.MailboxType}))}))))))},t=Object(o.__decorate)([a.observer],t)}(p.Component);function A(e){var t=Object(v.a)(e);return p.createElement(t,null,p.createElement("div",null,e.children))}var x=n(6675),C=n(833);function M(e){var t,n,o=Object(C.Q)(e)?e:null;if(null==o)return null;var a=null===(t=o.Sender)||void 0===t?void 0:t.Mailbox;if(a){var r=_(a);if(r)return r}var i=null===(n=o.From)||void 0===n?void 0:n.Mailbox;if(i){var s=_(i);if(s)return s}return null}function _(e){return"GroupMailbox"==e.MailboxType||Object(f.f)(e.EmailAddress)?null:Object(f.f)(e.Name)?e.EmailAddress:e.Name}var P=n(12),w=n(25),B=n(2603),R=n(134),T=n(42),D=n(909),N=n(7772),F=n(960),L=n(193),E=n(78),H=n(37),z=n(836),G=n(4501),U=n(3541),J=n(3542),K=n(3543),W=n(3544),V=n(4213),q=n(3187),Y=n(2389),X=n(5557),Q=n(3219),Z=n(9276),$=n(9277),ee=n(2463),te=n(3303),ne=n(4035),oe=n(3703),ae=n(2210),re=n(1353),ie=n(6692),se=n(4218),ce=n(3526),ue=n(6236),de=n(2004),le=n(7007),me=n(3354),pe=n(8044),be=n(4542),fe=n(6880),he=n(6911),Ie=n(93),Oe=Object(Ie.action)("toggleAmpPreference")((function(e){e.preferAmp=!e.preferAmp})),ge=n(4103),ve=n(74),je=Object(ve.d)("toggleUndoDarkMode",{name:function(e){return e.undoDarkMode?"ToggleDarkModeOn":"ToggleDarkModeOff"},actionSource:"ReadingPane"})((function(e){e&&(e.undoDarkMode=!e.undoDarkMode)})),ke=n(3005),Se=n(7004),ye=n(4227),Ae=n(6233),xe=n(4833),Ce=n(4106),Me=n(2850),_e=n(391),Pe=n(1267),we=n(1111),Be=n(208),Re=n(1444),Te=n(3704),De=n(1239),Ne=n(6769),Fe=n(7008),Le=n(1030),Ee=n(842),He=n(1448),ze=n(2653),Ge=n(860),Ue=n(7006),Je=n(218).bind(Ue),Ke="ReadingPane",We=5,Ve=function(e){function t(t){var n=e.call(this,t)||this;return n.commandBarHiddenOverflowItems=[],n.commandBarDividerKey=0,n.likeButtonClickCount=0,n.likeUnlikeInProgress=!1,n.forcePinnedSurfaceActions=new Set,n.getHandler=function(e,t,o){return function(a,r){Object(ze.l)(!1,o,r,n.getActionSource(r)),t?(n.updateSelectItemPart(),e(a,r)):a.which==T.a.enter&&(a.preventDefault(),a.stopPropagation(),n.updateSelectItemPart(),e(a,r))}},n.updateSelectItemPart=function(){n.props.viewState.isConversationItemPart&&Object(ge.a)(n.props.viewState,!1)},n.getRef=function(e){n.commandBar=e},n.ItemHeaderToolbarButton=Object(w.a)((function(e){return p.createElement(r.a,Object(o.__assign)({},e,{menuProps:e.menuProps&&Object(o.__assign)(Object(o.__assign)({},e.menuProps),{directionalHint:s.DirectionalHint.bottomAutoEdge}),onMenuClick:n.updateSelectItemPart,styles:Object(o.__assign)(Object(o.__assign)({},e.styles),{root:Je(Ue.surfaceActionsCommandBarButton,Ue.iconButton),rootChecked:Ue.checkedCommandBarButton,rootDisabled:Ue.disabledReplyActionButton,icon:Ue.enabledIconButton,iconDisabled:Ue.disabledIconButton,menuIcon:Ue.commandBarMenuIcon}),role:"button"}))})),n.ItemHeaderToolbarOverflowButton=Object(w.a)((function(e){var t=n.ItemHeaderToolbarButton;return p.createElement(u.a,{content:Object(f.a)(X.a)},p.createElement(t,Object(o.__assign)({},e)))})),n.onCommandBarReduceData=function(e){var t=e.primaryItems,a=e.overflowItems,r=e.cacheKey,i=t[0];if(void 0!==i)return n.commandBarHiddenOverflowItems=Object(o.__spread)([i],n.commandBarHiddenOverflowItems),t=t.slice(1),r=n.computeCommandBarCacheKey(t),Object(o.__assign)(Object(o.__assign)({},e),{primaryItems:t,overflowItems:a,cacheKey:r})},n.onCommandBarGrowData=function(e){var t=e.primaryItems,a=e.overflowItems,r=e.cacheKey,i=n.commandBarHiddenOverflowItems[0];if(void 0!==i)return n.commandBarHiddenOverflowItems=n.commandBarHiddenOverflowItems.slice(1),t=Object(o.__spread)([i],t),r=n.computeCommandBarCacheKey(t),Object(o.__assign)(Object(o.__assign)({},e),{primaryItems:t,overflowItems:a,cacheKey:r})},n.onResize=function(){n.commandBar&&n.commandBar.remeasure()},n.onPopout=function(e,t){e.stopPropagation();var a=Object(_e.e)(n.props.item.MailboxInfo,n.props.viewState.itemId);Object(_e.c)("mail",a,(function(){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,ie.a.import()];case 1:return[2,e.sent()(Object(C.C)())]}}))}))}))},n.replyByIm=function(e,t){n.replyByImInternal(!1)},n.replyAllByIm=function(e,t){n.replyByImInternal(!0)},n.onReply=function(e,t){n.onReplyReplyAllInternal(e,!1,t)},n.onReplyAll=function(e,t){n.onReplyReplyAllInternal(e,!0,t)},n.onReplyReplyAllInternal=function(e,t,a){e.stopPropagation();var r=n.props.item.ConversationId?n.props.item.ConversationId.Id:null,i=Object(H.f)("cmp-inlineTranslation")&&n.props.item.TranslationData&&(n.props.item.TranslationData.isShowingTranslation||n.props.item.TranslationData.isShowingForwardContentTranslation);Le.t.importAndExecute({referenceItemId:Object(o.__assign)(Object(o.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),isReplyAll:t,useFullCompose:!i&&!n.props.viewState.isConversationItemPart,actionSource:Ke,instrumentationContexts:[n.props.instrumentationContext],conversationId:r,suppressServerMarkReadOnReplyOrForward:Object(C.W)(Object(C.C)())})},n.onForward=function(e,t){e.stopPropagation(),Le.m.importAndExecute(Object(o.__assign)(Object(o.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),Ke,[n.props.instrumentationContext],Object(C.W)(Object(C.C)()))},n.onReplyByMeeting=function(e,t){e.stopPropagation();var o=Object(C.Q)(n.props.item)?n.props.item:null;Object(fe.a)(n.props.item.ItemId.Id,null,!1,Ke,null,null==o?void 0:o.InternetMessageId)},n.onLikeUnLike=function(){return function(e,t){e.stopPropagation(),!n.likeUnlikeInProgress&&t&&(n.likeUnlikeInProgress=!0,n.asyncLikeItem(t))}},n.asyncLikeItem=function(e){return Object(o.__awaiter)(n,void 0,void 0,(function(){var e;return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,He.p.import()];case 1:return e=t.sent(),this.likeButtonClickCount++,e(Object(o.__assign)(Object(o.__assign)({},this.props.item.ItemId),{mailboxInfo:this.props.item.MailboxInfo}),this.props.item,Object(C.C)(),this.likeButtonClickCount>=We,this.props.instrumentationContext),this.likeUnlikeInProgress=!1,[2]}}))}))},n.onDelete=function(e,t){e.stopPropagation();var o=n.getConversationId();if(o){var a=Object(pe.b)(o,n.props.viewState);He.i.importAndExecute([n.props.item.ItemId.Id],Object(ye.a)(n.props.item.ItemId.Id),[n.props.instrumentationContext],Ke,n.props.item.MailboxInfo,!0).then((function(){Object(he.a)(a,o)}))}else He.i.importAndExecute([n.props.item.ItemId.Id],Object(ye.a)(n.props.item.ItemId.Id),[n.props.instrumentationContext],Ke,n.props.item.MailboxInfo).then((function(){Object(ee.a)()}))},n.onToggleJunkNotjunk=function(){return function(e,t){e.stopPropagation(),He.r.importAndExecute(n.props.item.ItemId.Id,Object(C.C)(),Ke,[n.props.instrumentationContext]).then((function(){Object(ee.a)()})),re.b.importAndExecute()}},n.onPhishing=function(e,t){e.stopPropagation(),He.q.importAndExecute(n.props.item.ItemId.Id,Object(C.C)(),Ke).then((function(){Object(ee.a)()})),re.b.importAndExecute()},n.onReportAbuse=function(e,t){e.stopPropagation(),Ae.b.importAndExecute(n.props.item,Object(C.C)(),[n.props.instrumentationContext],Ke),re.b.importAndExecute()},n.onBlock=function(e,t){e.stopPropagation(),He.e.importAndExecute(n.props.item.ItemId.Id,[n.props.instrumentationContext],Ke),re.b.importAndExecute()},n.onToggleReadMenuItem=function(e,t){e.stopPropagation();var o=n.props.item;de.c.importAndExecute(n.props.item.ItemId.Id,Object(C.C)(),!o.IsRead,[n.props.instrumentationContext],Ke)},n.onToggleFlagMenuItem=function(e,t){var o;e.stopPropagation(),o="Flagged"!=n.props.item.Flag.FlagStatus?"Flagged":"NotFlagged",He.K.importAndExecute([n.props.item.ItemId.Id],[n.props.instrumentationContext],{FlagStatus:o},Object(C.D)(),Ke)},n.onAddToSafeSenders=function(e,t){e.stopPropagation();var o=n.props.item;He.b.import().then((function(e){e(o.Sender.Mailbox,o.ItemId.Id,n.getActionSource(t))}))},n.onCreateRule=function(e,t){e.stopPropagation();var o=n.props.item;se.a.import().then((function(e){e(o,n.getActionSource(t))}))},n.onPrint=function(e,t){e.stopPropagation(),Object(be.a)(Object(o.__assign)(Object(o.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),Ke)},n.onTranslate=function(e,t){e.stopPropagation(),ue.f.importAndExecute(n.props.item.ItemId.Id,Object(Se.a)(),n.props.viewState.isConversationItemPart,!0)},n.onShowInImmersiveReader=function(e,t){e.stopPropagation(),Object(G.d)(Object(o.__assign)(Object(o.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),Ke,n.getActionSource(t))},n.onViewMessageSource=function(e,t){e.stopPropagation(),Object(L.o)("ViewMessageSource",{subActionSource:n.getActionSource(t)},{actionSource:Ke}),Object(x.a)(n.props.item)},n.onToggleAmp=function(e){e.stopPropagation(),Oe(n.props.viewState.ampViewState)},n.onToggleUndoDarkMode=function(e,t){e.stopPropagation(),je(n.props.viewState)},n.renderLikeCustomButtonMenuItem=function(e){return p.createElement(y,{surfaceActionItem:e,message:n.props.item})},n.state={addinsInitializedState:0},n}return Object(o.__extends)(t,e),t.prototype.disableTranslate=function(e,t){return Object(le.a)(e)||!t.TranslationData||!t.TranslationData.userLanguage||t.TranslationData.isShowingTranslation||t.TranslationData.isTranslating},t.prototype.shouldAddBlockSafeSenderMenuItemForFolder=function(e){return!Object(we.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(Ce.a)(e.Sender.Mailbox.EmailAddress)&&null!=M(e)},t.prototype.shouldAddAssignPolicyMenuItem=function(e){return!this.isGroupItem()&&(Object(z.C)(e,Ee.h)||Object(z.C)(e,Ee.c)||Object(z.C)(e,"favorites"))},t.prototype.blockMenuItemName=function(e){return Object(f.b)(Object(f.a)(U.a),M(e))},t.prototype.createCommandBarItems=function(e,t){var n=this;this.commandBarHiddenOverflowItems=[];var a=[],r=[],i=Object(ze.i)(),s=this.props.customizedSubsetActionKeys&&this.props.customizedSubsetActionKeys.length>0?i.filter((function(e){return n.props.customizedSubsetActionKeys.indexOf(e.key)>-1})):i,c=Object(o.__read)(Object(me.a)(this.props.item,this.props.viewState.isConversationItemPart),3),u=c[0],d=c[1],l=c[2];return s.forEach((function(i){var s=n.tryCreateStaticActionCommandBarItem(i,e,t,u,d,l);if(s){var c=i.key;if(n.props.hideSurfaceButton)n.addItemToCommandBarOverflow(c,r,s);else{var m=s,p=Object(ze.o)(c,n.props.item)||n.forcePinnedSurfaceActions.has(c);p&&!Object(ze.j)(c)&&n.forcePinnedSurfaceActions.add(c),p&&(m=Object(o.__assign)({},s),n.addItemToCommandBarSurface(c,a,s)),n.addItemToCommandBarOverflow(c,r,m)}}})),this.tryCreateAddinsCommandBarItems(a,r),{items:this.props.hideSurfaceButton?[]:a,overflowItems:r}},t.prototype.addItemToCommandBarSurface=function(e,t,n){n.isPinned=!0,Object(ze.p)(e)?t.push(n):t.unshift(n)},t.prototype.addItemToCommandBarOverflow=function(e,t,n){n.renderedInOverflow=!0,n.onRender=null,"-"==e?this.tryAddDivider(t,n):t.push(n)},t.prototype.tryAddDivider=function(e,t){var n=e.length;n>0&&e[n-1].displayName!=ze.a&&e.push(t)},t.prototype.tryCreateStaticActionCommandBarItem=function(e,t,n,o,a,r){if(e.hideInGroup&&this.isGroupItem()||e.hideInSxS&&this.props.isItemAttachment)return null;var i,s=e.key,c=Object(ze.g)(s),u=Object(ze.h)(s).iconName,d=null,l=!1,m=null,p=e.key,b=this.props.item;switch(s){case"LikeUnlike":if(!Object(Be.a)()&&!Object(z.C)(b.ParentFolderId.Id,Ee.j)){var I=Object(h.a)().SessionSettings.UserEmailAddress,O=!!b.Likers&&b.Likers.some((function(e){return e.EmailAddress===I}));i=this.onLikeUnLike(),O&&(u="LikeSolid",c=Object(f.a)(Fe.e)),Object(ze.o)(s,this.props.item)&&(m=this.renderLikeCustomButtonMenuItem)}break;case"ToggleAmp":var g=this.props.viewState.ampViewState,v=g.preferAmp,j=g.ampAvailability;Object(oe.a)()&&j==ne.a.AmpValidated&&(c=v?Object(f.a)($.a):Object(f.a)(Z.a),p=v?"ViewAsOriginal":"ViewAsDynamic",i=this.onToggleAmp);break;case"Reply":i=this.onReply,l=o;break;case"ReplyAll":i=this.onReplyAll,l=a;break;case"Forward":i=this.onForward,l=r;break;case"ReplyByMeeting":i=this.onReplyByMeeting,l=n;break;case"Popout":i=this.onPopout;break;case"Delete":!this.props.isItemAttachment&&Object(ae.b)(9)&&(i=this.onDelete,l=!!this.isGroupItem()&&!b.CanDelete);break;case"MarkReadUnread":this.isGroupPopout()||(c=b.IsRead?Object(f.a)(Y.a):Object(f.a)(q.a),p=b.IsRead?"MarkItemUnread":"MarkItemRead",i=this.onToggleReadMenuItem,b.IsRead||(u="Read"));break;case"FlagUnflag":if(Object(ae.b)(11)){var k=!b.Flag||"Flagged"!=b.Flag.FlagStatus;c=k?Object(f.a)(J.a):Object(f.a)(Fe.d),p=k?"FlagItem":"UnflagItem",i=this.onToggleFlagMenuItem}break;case"AssignPolicy":if(this.shouldAddAssignPolicyMenuItem(b.ParentFolderId.Id)){i=this.onAssignPolicy;var S=Object(C.C)(),y=xe.a.tryImportForRender(),A=void 0;y&&(A=y(null==S?void 0:S.id,"RPCSAOverflow",this.props.item)),d=A}break;case"AddToSafeSenders":this.shouldAddBlockSafeSenderMenuItemForFolder(b)&&(i=this.onAddToSafeSenders);break;case"MarkJunkNotJunk":Object(ae.g)()&&Object(z.E)(b.ParentFolderId.Id)&&(c=this.isInJunkFolder?Object(f.a)(Fe.b):Object(f.a)(W.a),p=this.isInJunkFolder?"MarkItemNotjunk":"MarkItemJunk",i=this.onToggleJunkNotjunk());break;case"MarkAsPhishing":i=this.onPhishing;break;case"Block":this.shouldAddBlockSafeSenderMenuItemForFolder(b)&&Object(z.E)(b.ParentFolderId.Id)&&(c=this.blockMenuItemName(b),i=this.onBlock);break;case"ReportAbuse":Object(H.f)("tri-reportAbuse")&&(c=Object(f.a)(Q.a),i=this.onReportAbuse);break;case"CreateRule":Object(ce.a)()&&this.itemHasSenderSMTP()&&Object(z.E)(b.ParentFolderId.Id)&&(i=this.onCreateRule);break;case"Print":i=this.onPrint,l=!t.PrintAllowed;break;case"Translate":i=this.onTranslate,l=this.disableTranslate(t,this.props.item);break;case"ShowInImmersiveReader":i=this.onShowInImmersiveReader;break;case"ViewMessageSource":this.isSentItem||(i=this.onViewMessageSource);break;case"ToggleDarkMode":var x=this.props.viewState.undoDarkMode;c=x?Object(f.a)(Fe.a):Object(f.a)(K.a),u=x?"ClearNight":"Sunny",p=x?"ToggleDarkModeOn":"ToggleDarkModeOff",i=this.onToggleUndoDarkMode;break;case"ReplyByIM":i=this.replyByIm,l=!Object(Re.b)();break;case"ReplyAllByIM":i=this.replyAllByIm,l=!Object(Re.b)();break;case"AddToProjectSpace":var M=Ne.a.tryImportForRender();M&&(i=this.onAddToProjectSpace,d=M(this.props.item.ItemId.Id,this.props.item));break;case"-":return{key:(this.commandBarDividerKey++).toString(),displayName:ze.a,itemType:R.a.Divider,onClick:null}}return i?{key:s,name:c,iconProps:{iconName:u,className:Ue.commandBarIcon},onRender:m,disabled:l,onClick:this.getHandler(i,!0,p),onKeyDown:this.getHandler(i,!1,p),iconOnly:!0,ariaLabel:c,role:"menuitem",subMenuProps:d}:null},t.prototype.tryCreateAddinsCommandBarItems=function(e,t){var n=this;if(2==this.state.addinsInitializedState){var a,r=[],i=[],s=Object(Ge.d)(Ge.a.SurfaceActions);if(this.props.viewState.isConversationItemPart){var c=Object(ke.b)();a=null==c?void 0:c.itemId}this.props.shouldIncludeFullInfo&&Object(N.a)(F.a.MessageRead,this.props.item,a||this.props.item.ItemId.Id,s.readSurfaceAddins,r,i,!0,this.commandBarDividerKey,null,!0),Object(o.__spread)(r,i).forEach((function(e){if(e.onClick){var t=e.onClick;e.onClick=n.getHandler(t,!0,"Addins"),e.onKeyDown=n.getHandler(t,!1,"Addins")}})),e.unshift.apply(e,Object(o.__spread)(r)),t.push.apply(t,Object(o.__spread)(i))}},t.prototype.componentDidMount=function(){Pe.a.importAndExecute(this.onResize),this.initailizeAddinsIfNeeded()},t.prototype.componentWillUnmount=function(){Pe.c.importAndExecute(this.onResize),this.deInitializeAddins()},t.prototype.componentDidUpdate=function(){this.initailizeAddinsIfNeeded()},t.prototype.render=function(){var e=!this.props.item.ParentFolderId||!Object(we.a)(this.props.item.ParentFolderId.Id,"notes");return p.createElement("div",{className:Ue.surfaceActionsCommandBarContainer},e&&this.renderCommandBar())},t.prototype.renderCommandBar=function(){if(!this.props.viewState)return null;var e=Object(Me.a)(this.props.item),t=Object(De.a)(this.props.item),n=this.createCommandBarItems(e,t);return p.createElement(B.a,{componentRef:this.getRef,items:n.items,overflowItems:n.overflowItems,overflowButtonProps:{iconProps:{iconName:"More"},menuIconProps:{iconName:"More",styles:{root:Object(f.f)(this.props.seeMoreStyles)?Ue.surfaceActionsCommandBarOverflowIcon:Je(Ue.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(f.a)(V.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:ze.n,onDataGrown:ze.m,styles:{root:Ue.surfaceActionsCommandBar,primarySet:Ue.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(f.a)(Fe.c),onReduceData:this.onCommandBarReduceData,onGrowData:this.onCommandBarGrowData})},t.prototype.computeCommandBarCacheKey=function(e){return[e.reduce((function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)}),""),"","overflow"].join(" ")},t.prototype.getConversationId=function(){return this.props.viewState.isConversationItemPart&&this.props.item.ConversationId?this.props.item.ConversationId.Id:null},t.prototype.isGroupPopout=function(){return this.props.isDeeplink&&this.isGroupItem()},t.prototype.isGroupItem=function(){return!!this.props.item.MailboxInfo&&this.props.item.MailboxInfo.type===E.a.GroupMailbox},Object.defineProperty(t.prototype,"isInJunkFolder",{get:function(){var e=this.props.item;return Object(we.a)(e.ParentFolderId.Id,"junkemail")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSentItem",{get:function(){var e=this.props.item;return Object(we.a)(e.ParentFolderId.Id,"sentitems")},enumerable:!0,configurable:!0}),t.prototype.replyByImInternal=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,a,r,i;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return t=this.props.item,[4,Le.n.import()];case 1:return[4,s.sent()(t,e)];case 2:return n=o.__read.apply(void 0,[s.sent(),2]),a=n[0],r=n[1],(i=Object(o.__spread)(a,r).map((function(e){return e.SipUri?e.SipUri:"sip:"+e.EmailAddress}))).length>0&&Re.e.import().then((function(n){return n(i,t.Subject,e?3:2)})),[2]}}))}))},t.prototype.onAssignPolicy=function(e,t){e.stopPropagation()},t.prototype.itemHasSenderSMTP=function(){var e,t=Object(C.Q)(this.props.item)?this.props.item:null;return!!(null===(e=null==t?void 0:t.From)||void 0===e?void 0:e.Mailbox)},t.prototype.onAddToProjectSpace=function(e,t){e.stopPropagation()},t.prototype.shouldAddinsPopulate=function(){var e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&this.props.shouldIncludeFullInfo;return Object(H.f)("rp-addins")&&e&&!Object(Le.b)(this.getConversationId())&&!this.props.isItemAttachment&&Object(D.S)(this.props.item)&&!this.isGroupItem()&&!Object(Te.a)(this.props.item)},t.prototype.initailizeAddinsIfNeeded=function(){var e=this;0==this.state.addinsInitializedState&&this.shouldAddinsPopulate()&&(this.setState({addinsInitializedState:1}),setTimeout((function(){e.initializeAddins()}),1))},t.prototype.initializeAddins=function(){var e=this;Object(H.f)("rp-addins")&&te.b.import().then((function(t){var n=t(e.props.item,e.props.viewState);D.w.import().then((function(t){t(Object(D.q)(e.props.item.ItemId.Id),n),e.setState({addinsInitializedState:2})}))}))},t.prototype.deInitializeAddins=function(){var e=this;0!=this.state.addinsInitializedState&&Object(H.f)("rp-addins")&&D.v.import().then((function(t){t(Object(D.q)(e.props.item.ItemId.Id))}))},t.prototype.getActionSource=function(e){var t="RPCSAPinned";return(null==e?void 0:e.renderedInOverflow)&&(t=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),this.props.actionSource&&(t=this.props.actionSource),t},Object(o.__decorate)([P.computed],t.prototype,"isInJunkFolder",null),Object(o.__decorate)([P.computed],t.prototype,"isSentItem",null),t=Object(o.__decorate)([a.observer],t)}(p.Component);function qe(e,t){var n="RPCSAPinned";return(null==e?void 0:e.renderedInOverflow)&&(n=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),t&&(n=t),n}function Ye(e){e.isConversationItemPart&&Object(ge.a)(e,!1)}function Xe(e,t,n,o,a){return function(r,i){Object(ze.l)(!1,n,i,qe(i,a)),t?(Ye(o),e(r,i)):r.which==T.a.enter&&(r.preventDefault(),r.stopPropagation(),Ye(o),e(r,i))}}var Qe=null;function Ze(){return Qe||(Qe={},Object(ze.i)().forEach((function(e){Qe[e.key]=e}))),Qe}function $e(e){return e.MailboxInfo&&e.MailboxInfo.type===E.a.GroupMailbox}function et(e){return Object(we.a)(e.ParentFolderId.Id,"junkemail")}function tt(e){return!Object(we.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(Ce.a)(e.Sender.Mailbox.EmailAddress)&&null!=M(e)}var nt="ReadingPane";function ot(e,t){var n;return e.isConversationItemPart?null===(n=t.ConversationId)||void 0===n?void 0:n.Id:null}var at=n(4),rt=Object(at.mutatorAction)("incrementLikeButtonCount",(function(e){e.likeUnlikeTracker&&e.likeUnlikeTracker.likeButtonClickCount++})),it=Object(at.mutatorAction)("updateLikeUnlikeInProgress",(function(e,t){e.likeUnlikeTracker&&(e.likeUnlikeTracker.likeUnlikeInProgress=t)}));var st,ct=function(e,t,n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var a,r;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return[4,He.p.import()];case 1:return a=i.sent(),rt(n),a(Object(o.__assign)(Object(o.__assign)({},e.ItemId),{mailboxInfo:e.MailboxInfo}),e,Object(C.C)(),(null===(r=n.likeUnlikeTracker)||void 0===r?void 0:r.likeButtonClickCount)>=5,t),it(n,!1),[2]}}))}))};function ut(e,t,n,a,r){e.stopPropagation();var i=r.ConversationId?r.ConversationId.Id:null,s=Object(H.f)("cmp-inlineTranslation")&&r.TranslationData&&(r.TranslationData.isShowingTranslation||r.TranslationData.isShowingForwardContentTranslation);Le.t.importAndExecute({referenceItemId:Object(o.__assign)(Object(o.__assign)({},r.ItemId),{mailboxInfo:r.MailboxInfo}),isReplyAll:t,useFullCompose:!s&&!a.isConversationItemPart,actionSource:nt,instrumentationContexts:[n],conversationId:i,suppressServerMarkReadOnReplyOrForward:Object(C.W)(Object(C.C)())})}function dt(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,a,r,i;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return[4,Le.n.import()];case 1:return[4,s.sent()(t,e)];case 2:return n=o.__read.apply(void 0,[s.sent(),2]),a=n[0],r=n[1],(i=Object(o.__spread)(a,r).map((function(e){return e.SipUri?e.SipUri:"sip:"+e.EmailAddress}))).length>0&&Re.e.import().then((function(n){return n(i,t.Subject,e?3:2)})),[2]}}))}))}var lt=((st={}).Reply=function(e,t){var n,o,a,r=Object(me.a)(e.item,e.viewState.isConversationItemPart);t.isDisabled=r[0],t.clickHandler=(n=e.instrumentationContext,o=e.viewState,a=e.item,function(e){ut(e,!1,n,o,a)})},st.ReplyAll=function(e,t){var n,o,a,r=Object(me.a)(e.item,e.viewState.isConversationItemPart);t.isDisabled=r[1],t.clickHandler=(n=e.instrumentationContext,o=e.viewState,a=e.item,function(e){ut(e,!0,n,o,a)})},st.Forward=function(e,t){var n,a,r=Object(me.a)(e.item,e.viewState.isConversationItemPart);t.isDisabled=r[2],t.clickHandler=(n=e.item,a=e.instrumentationContext,function(e){e.stopPropagation(),Le.m.importAndExecute(Object(o.__assign)(Object(o.__assign)({},n.ItemId),{mailboxInfo:n.MailboxInfo}),nt,[a],Object(C.W)(Object(C.C)()))})},st.ReplyByMeeting=function(e,t){var n;t.isDisabled=Object(De.a)(e.item),t.clickHandler=(n=e.item,function(e){e.stopPropagation();var t=Object(C.Q)(n)?n:null;Object(fe.a)(n.ItemId.Id,null,!1,nt,null,null==t?void 0:t.InternetMessageId)})},st.OtherReplyActions=function(e,t){t.clickHandler=mt,t.subMenuActionKeys=["ReplyByMeeting","ReplyByIM","ReplyAllByIM","LikeUnlike"]},st.MessageSafety=function(e,t){t.clickHandler=mt,t.subMenuActionKeys=["AddToSafeSenders","MarkJunkNotJunk","MarkAsPhishing","Block","ReportAbuse"]},st.ReplyByIM=function(e,t){var n;t.clickHandler=(n=e.item,function(e){dt(!1,n)}),t.isDisabled=!Object(Re.b)()},st.ReplyAllByIM=function(e,t){var n;t.clickHandler=(n=e.item,function(e){dt(!0,n)}),t.isDisabled=!Object(Re.b)()},st.MarkJunkNotJunk=function(e,t){var n,o,a=e.item;Object(ae.g)()&&Object(z.E)(a.ParentFolderId.Id)&&(t.displayName=et(a)?Object(f.a)(Fe.b):Object(f.a)(W.a),t.datapointName=et(a)?"MarkItemNotjunk":"MarkItemJunk",t.clickHandler=(n=e.item,o=e.instrumentationContext,function(e){e.stopPropagation(),He.r.importAndExecute(n.ItemId.Id,Object(C.C)(),nt,[o]).then((function(){Object(ee.a)()})),re.b.importAndExecute()}))},st.Delete=function(e,t){if(!e.isItemAttachment&&Object(ae.b)(9)){var n=e.item;t.clickHandler=(o=e.viewState,a=e.item,r=e.instrumentationContext,function(e){e.stopPropagation();var t=ot(o,a);if(t){var n=Object(pe.b)(t,o);He.i.importAndExecute([a.ItemId.Id],Object(ye.a)(a.ItemId.Id),[r],nt,a.MailboxInfo,!0).then((function(){Object(he.a)(n,t)}))}else He.i.importAndExecute([a.ItemId.Id],Object(ye.a)(a.ItemId.Id),[r],nt,a.MailboxInfo).then((function(){Object(ee.a)()}))}),t.isDisabled=$e(e.item)&&!n.CanDelete}var o,a,r},st.MarkReadUnread=function(e,t){if(!e.isDeeplink||!$e(e.item)){var n=e.item;t.displayName=n.IsRead?Object(f.a)(Y.a):Object(f.a)(q.a),t.datapointName=n.IsRead?"MarkItemUnread":"MarkItemRead",n.IsRead||(t.iconName="Read"),t.clickHandler=(o=e.item,a=e.instrumentationContext,function(e){e.stopPropagation();var t=o;de.c.importAndExecute(o.ItemId.Id,Object(C.C)(),!t.IsRead,[a],nt)})}var o,a},st.FlagUnflag=function(e,t){if(Object(ae.b)(11)){var n=e.item,o=!n.Flag||"Flagged"!=n.Flag.FlagStatus;t.displayName=o?Object(f.a)(J.a):Object(f.a)(Fe.d),t.datapointName=o?"FlagItem":"UnflagItem",t.clickHandler=(a=e.item,r=e.instrumentationContext,function(e){e.stopPropagation();var t="Flagged"!=a.Flag.FlagStatus?"Flagged":"NotFlagged";He.K.importAndExecute([a.ItemId.Id],[r],{FlagStatus:t},Object(C.D)(),nt)})}var a,r},st.Print=function(e,t){var n,a=Object(Me.a)(e.item);t.clickHandler=(n=e.item,function(e){e.stopPropagation(),Object(be.a)(Object(o.__assign)(Object(o.__assign)({},n.ItemId),{mailboxInfo:n.MailboxInfo}),nt)}),t.isDisabled=!a.PrintAllowed},st.View=function(e,t){t.clickHandler=mt,t.subMenuActionKeys=["Popout","Translate","ShowInImmersiveReader","ViewMessageSource"]},st.AdvancedActions=function(e,t){t.clickHandler=mt,t.subMenuActionKeys=["CreateRule","AssignPolicy"]},st.Popout=function(e,t){t.clickHandler=function(e,t){var n=this;return function(a){a.stopPropagation();var r=Object(_e.e)(e.MailboxInfo,t.itemId);Object(_e.c)("mail",r,(function(){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,ie.a.import()];case 1:return[2,e.sent()(Object(C.C)())]}}))}))}))}}(e.item,e.viewState)},st.CreateRule=function(e,t){var n,o=Object(C.Q)(e.item)?e.item:null;Object(ce.a)()&&(null===(n=null==o?void 0:o.From)||void 0===n?void 0:n.Mailbox)&&Object(z.E)(null==o?void 0:o.ParentFolderId.Id)&&(t.clickHandler=function(e,t){return function(n,o){n.stopPropagation(),se.a.import().then((function(n){n(e,qe(o,t))}))}}(e.item,e.actionSource))},st.AddToSafeSenders=function(e,t){var n=e.item;tt(n)&&(t.clickHandler=function(e,t){return function(n,o){n.stopPropagation(),He.b.import().then((function(n){n(e.Sender.Mailbox,e.ItemId.Id,qe(o,t))}))}}(n,e.actionSource))},st.MarkAsPhishing=function(e,t){var n;t.clickHandler=(n=e.item,function(e){e.stopPropagation(),He.q.importAndExecute(n.ItemId.Id,Object(C.C)(),nt).then((function(){Object(ee.a)()})),re.b.importAndExecute()})},st.Block=function(e,t){var n,o,a=e.item;tt(a)&&Object(z.E)(a.ParentFolderId.Id)&&(t.displayName=Object(f.b)(Object(f.a)(U.a),M(a)),t.clickHandler=(n=e.item,o=e.instrumentationContext,function(e){e.stopPropagation(),He.e.importAndExecute(n.ItemId.Id,[o],nt),re.b.importAndExecute()}))},st.ReportAbuse=function(e,t){var n,o;Object(H.f)("tri-reportAbuse")&&(t.displayName=Object(f.a)(Q.a),t.clickHandler=(n=e.item,o=e.instrumentationContext,function(e){e.stopPropagation(),Ae.b.importAndExecute(n,Object(C.C)(),[o],nt),re.b.importAndExecute()}))},st.Translate=function(e,t){var n,o,a=Object(Me.a)(e.item);t.clickHandler=(n=e.item,o=e.viewState,function(e){e.stopPropagation(),ue.f.importAndExecute(n.ItemId.Id,Object(Se.a)(),o.isConversationItemPart,!0)}),t.isDisabled=function(e,t){return Object(le.a)(e)||!t.TranslationData||!t.TranslationData.userLanguage||t.TranslationData.isShowingTranslation||t.TranslationData.isTranslating}(a,e.item)},st.ShowInImmersiveReader=function(e,t){var n,a;t.clickHandler=(n=e.item,a=e.actionSource,function(e,t){e.stopPropagation(),Object(G.d)(Object(o.__assign)(Object(o.__assign)({},n.ItemId),{mailboxInfo:n.MailboxInfo}),nt,qe(t,a))})},st.ViewMessageSource=function(e,t){var n,o,a=e.item;Object(we.a)(a.ParentFolderId.Id,"sentitems")||(t.clickHandler=(n=e.item,o=e.actionSource,function(e,t){e.stopPropagation(),Object(L.o)("ViewMessageSource",{subActionSource:qe(t,o)},{actionSource:nt}),Object(x.a)(n)}))},st.AssignPolicy=function(e,t){var n,o=e.item;if(n=o.ParentFolderId.Id,!$e(e.item)&&(Object(z.C)(n,Ee.h)||Object(z.C)(n,Ee.c)||Object(z.C)(n,"favorites"))){var a=Object(C.C)(),r=xe.a.tryImportForRender(),i=void 0;r&&(i=r(null==a?void 0:a.id,"RPCSAOverflow",e.item)),t.clickHandler=mt,t.subMenuProps=i}},st.ToggleDarkMode=function(e,t){var n,o=e.viewState.undoDarkMode;t.displayName=o?Object(f.a)(Fe.a):Object(f.a)(K.a),t.iconName=o?"ClearNight":"Sunny",t.datapointName=o?"ToggleDarkModeOn":"ToggleDarkModeOff",t.clickHandler=(n=e.viewState,function(e){e.stopPropagation(),je(n)}),t.isPinnedOnly=!0},st.Addins=function(e,t){t.clickHandler=mt},st.AddToProjectSpace=function(e,t){var n=Ne.a.tryImportForRender();n&&(t.clickHandler=mt,t.subMenuProps=n(e.item.ItemId.Id,e.item))},st["-"]=function(e,t){t.clickHandler=mt},st.LikeUnlike=function(e,t){var n,o,a,r=e.item;Object(Be.a)()||Object(z.C)(r.ParentFolderId.Id,Ee.j)||(t.clickHandler=(n=e.item,o=e.instrumentationContext,a=e.viewState,function(e){var t;e.stopPropagation(),(null===(t=a.likeUnlikeTracker)||void 0===t?void 0:t.likeUnlikeInProgress)||(it(a,!0),ct(n,o,a))}),function(e){var t=Object(h.a)().SessionSettings.UserEmailAddress;return!!e.Likers&&e.Likers.some((function(e){return e.EmailAddress===t}))}(r)&&(t.iconName="LikeSolid",t.displayName=Object(f.a)(Fe.e)),Object(ze.o)("LikeUnlike",r)&&(t.customRender=function(e){return p.createElement(y,{surfaceActionItem:e,message:r})}))},st.ToggleAmp=function(e,t){var n,o=e.viewState.ampViewState,a=o.preferAmp,r=o.ampAvailability;Object(oe.a)()&&r==ne.a.AmpValidated&&(t.displayName=a?Object(f.a)($.a):Object(f.a)(Z.a),t.datapointName=a?"ViewAsOriginal":"ViewAsDynamic",t.clickHandler=(n=e.viewState,function(e){e.stopPropagation(),Oe(n.ampViewState)}),t.isPinnedOnly=!0)},st);function mt(e){e.stopPropagation()}var pt=n(7006);function bt(e,t){if(!e||e.hideInGroup&&$e(t.item)||e.hideInSxS&&t.isItemAttachment)return null;var n,o,a,r=(n=e.key,a=Object(ze.g)(n),{key:n,displayName:a,iconName:null===(o=Object(ze.h)(n))||void 0===o?void 0:o.iconName,customRender:null,isDisabled:!1,clickHandler:null,subMenuActionKeys:null,subMenuProps:null,datapointName:n,isPinnedOnly:!1});lt[e.key](t,r);var i=function(e,t){if(!e)return null;var n=Ze(),o=[];return e.forEach((function(e){var a=bt(n[e],t);a&&o.push(a)})),o.length>0?o:null}(r.subMenuActionKeys,t);return r.subMenuActionKeys&&!i?null:function(e,t,n){if(!e.clickHandler)return null;return{key:e.key,text:e.displayName,iconProps:{iconName:e.iconName,className:pt.commandBarIcon},onRender:e.customRender,disabled:e.isDisabled,onClick:Xe(e.clickHandler,!0,e.datapointName,n.viewState,n.actionSource),onKeyDown:Xe(e.clickHandler,!1,e.datapointName,n.viewState,n.actionSource),iconOnly:!0,ariaLabel:e.displayName,subMenuProps:e.subMenuProps?e.subMenuProps:t?{items:t}:null,isPinnedOnly:e.isPinnedOnly}}(r,i,t)}var ft=["Reply","ReplyAll","Forward","OtherReplyActions","-","Delete","MarkReadUnread","FlagUnflag","AddToProjectSpace","MessageSafety","-","Print","View","-","Addins","AdvancedActions","ToggleDarkMode","ToggleAmp"];var ht=Object(at.mutatorAction)("initializeLikeUnlikeTracker",(function(e){e.likeUnlikeTracker={likeButtonClickCount:0,likeUnlikeInProgress:!1}})),It=n(5504),Ot=n(7006),gt=n(218).bind(Ot),vt=function(e){function t(t){var n=e.call(this,t)||this;return n.commandBarHiddenOverflowItems=[],n.commandBarDividerKey=0,n.forcePinnedSurfaceActions=new Set,n.onMenuClickCallback=function(){Ye(n.props.viewState)},n.getRef=function(e){n.commandBar=e},n.ItemHeaderToolbarButton=Object(w.a)((function(e){return p.createElement(r.a,Object(o.__assign)({},e,{menuProps:e.menuProps&&Object(o.__assign)(Object(o.__assign)({},e.menuProps),{directionalHint:s.DirectionalHint.bottomAutoEdge}),onMenuClick:n.onMenuClickCallback,styles:Object(o.__assign)(Object(o.__assign)({},e.styles),{root:gt(Ot.surfaceActionsCommandBarButton,Ot.iconButton),rootChecked:Ot.checkedCommandBarButton,rootDisabled:Ot.disabledReplyActionButton,icon:Ot.enabledIconButton,iconDisabled:Ot.disabledIconButton,menuIcon:Ot.commandBarMenuIcon}),role:"button"}))})),n.ItemHeaderToolbarOverflowButton=Object(w.a)((function(e){var t=n.ItemHeaderToolbarButton;return p.createElement(u.a,{content:Object(f.a)(X.a)},p.createElement(t,Object(o.__assign)({},e)))})),n.onCommandBarReduceData=function(e){var t=e.primaryItems,a=e.overflowItems,r=e.cacheKey,i=t[0];if(void 0!==i)return i.isPinnedOnly&&function(e,t){t.forEach((function(t){"View"!==t.key||t.subMenuProps.items.includes(e)||t.subMenuProps.items.push(e)}))}(i,a),n.commandBarHiddenOverflowItems=Object(o.__spread)([i],n.commandBarHiddenOverflowItems),t=t.slice(1),r=n.computeCommandBarCacheKey(t),Object(o.__assign)(Object(o.__assign)({},e),{primaryItems:t,overflowItems:a,cacheKey:r})},n.onCommandBarGrowData=function(e){var t=e.primaryItems,a=e.overflowItems,r=e.cacheKey,i=n.commandBarHiddenOverflowItems[0];if(void 0!==i)return i.isPinnedOnly&&function(e,t){t.forEach((function(t){if("View"===t.key){var n=t.subMenuProps.items.indexOf(e);n>-1&&t.subMenuProps.items.splice(n,1)}}))}(i,a),n.commandBarHiddenOverflowItems=n.commandBarHiddenOverflowItems.slice(1),t=Object(o.__spread)([i],t),r=n.computeCommandBarCacheKey(t),Object(o.__assign)(Object(o.__assign)({},e),{primaryItems:t,overflowItems:a,cacheKey:r})},n.onResize=function(){n.commandBar&&n.commandBar.remeasure()},n.state={addinsInitializedState:0},ht(n.props.viewState),n}return Object(o.__extends)(t,e),t.prototype.createCommandBarItems=function(){var e,t=this;this.commandBarHiddenOverflowItems=[];var n=[],a=[],r=Ze(),i=[];return((null===(e=this.props.customizedSubsetActionKeys)||void 0===e?void 0:e.length)>0?this.props.customizedSubsetActionKeys:ft).forEach((function(e){r[e]&&i.push(r[e])})),i.forEach((function(e){var r,i,s;"Addins"!==e.key?(s=bt(e,t.props))&&(null===(i=null===(r=s.subMenuProps)||void 0===r?void 0:r.items)||void 0===i||i.forEach((function(e){t.shouldAddItemToSurface(e)&&t.addItemToCommandBarSurface(n,Object(o.__assign)({},e))})),t.addItemToCommandBar(s,a,n)):t.tryCreateAddinsCommandBarItems(n,a,e)})),{items:this.props.hideSurfaceButton?[]:n,overflowItems:a}},t.prototype.addItemToCommandBar=function(e,t,n){var a=e;this.shouldAddItemToSurface(e)&&(this.addItemToCommandBarSurface(n,e),a=Object(o.__assign)({},e)),this.addItemToCommandBarOverflow(t,a)},t.prototype.addItemToCommandBarSurface=function(e,t){var n=t.key;Object(ze.j)(n)||this.forcePinnedSurfaceActions.add(n),t.isPinned=!0,Object(ze.p)(n)?e.push(t):e.unshift(t)},t.prototype.addItemToCommandBarOverflow=function(e,t){var n,o;if(!t.isPinnedOnly){var a=t.key;t.onRender=null,null===(o=null===(n=t.subMenuProps)||void 0===n?void 0:n.items)||void 0===o||o.forEach((function(e){e.onRender=null})),t.renderedInOverflow=!0,"-"==a?Object(It.b)(e,this.commandBarDividerKey++):e.push(t)}},t.prototype.shouldAddItemToSurface=function(e){if(this.props.hideSurfaceButton)return!1;var t=e.key;return Object(ze.o)(t,this.props.item)||this.forcePinnedSurfaceActions.has(t)},t.prototype.componentDidMount=function(){Pe.a.importAndExecute(this.onResize),this.initailizeAddinsIfNeeded()},t.prototype.componentWillUnmount=function(){Pe.c.importAndExecute(this.onResize),this.deInitializeAddins()},t.prototype.componentDidUpdate=function(){this.initailizeAddinsIfNeeded()},t.prototype.render=function(){var e=!this.props.item.ParentFolderId||!Object(we.a)(this.props.item.ParentFolderId.Id,"notes");return p.createElement("div",{className:Ot.surfaceActionsCommandBarContainer},e&&this.renderCommandBar())},t.prototype.renderCommandBar=function(){if(!this.props.viewState)return null;var e=this.createCommandBarItems();return p.createElement(B.a,{componentRef:this.getRef,items:e.items,overflowItems:e.overflowItems,overflowButtonProps:{iconProps:{iconName:"More"},menuIconProps:{iconName:"More",styles:{root:Object(f.f)(this.props.seeMoreStyles)?Ot.surfaceActionsCommandBarOverflowIcon:gt(Ot.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(f.a)(V.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:ze.n,onDataGrown:ze.m,styles:{root:Ot.surfaceActionsCommandBar,primarySet:Ot.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(f.a)(Fe.c),onReduceData:this.onCommandBarReduceData,onGrowData:this.onCommandBarGrowData})},t.prototype.computeCommandBarCacheKey=function(e){return[e.reduce((function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)}),""),"","overflow"].join(" ")},t.prototype.tryCreateAddinsCommandBarItems=function(e,t,n){var a=this;if(2==this.state.addinsInitializedState){var r=[],i=[],s=Object(Ge.d)(Ge.a.SurfaceActions),c=n.key;this.props.shouldIncludeFullInfo&&Object(It.a)(F.a.MessageRead,this.props.item,this.getFocusedItemId||this.props.item.ItemId.Id,s.readSurfaceAddins,r,i,!0,this.commandBarDividerKey,null,!0),Object(o.__spread)(r,i).forEach((function(e){if(e.onClick){var t=e.onClick;e.onClick=Xe(t,!0,c,a.props.viewState,a.props.actionSource),e.onKeyDown=Xe(t,!1,c,a.props.viewState,a.props.actionSource)}})),e.unshift.apply(e,Object(o.__spread)(r)),t.push.apply(t,Object(o.__spread)(i))}},t.prototype.shouldAddinsPopulate=function(){var e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&this.props.shouldIncludeFullInfo;return Object(H.f)("rp-addins")&&e&&!Object(Le.b)(ot(this.props.viewState,this.props.item))&&!this.props.isItemAttachment&&Object(D.S)(this.props.item)&&!$e(this.props.item)&&!Object(Te.a)(this.props.item)},t.prototype.initailizeAddinsIfNeeded=function(){var e=this;0==this.state.addinsInitializedState&&this.shouldAddinsPopulate()&&(this.setState({addinsInitializedState:1}),setTimeout((function(){e.initializeAddins()}),1))},t.prototype.initializeAddins=function(){var e=this;Object(H.f)("rp-addins")&&te.b.import().then((function(t){var n=t(e.props.item,e.props.viewState);D.w.import().then((function(t){t(Object(D.q)(e.props.item.ItemId.Id),n).then((function(){e.setState({addinsInitializedState:2})}))}))}))},t.prototype.deInitializeAddins=function(){var e=this;0!=this.state.addinsInitializedState&&Object(H.f)("rp-addins")&&D.v.import().then((function(t){t(Object(D.q)(e.props.item.ItemId.Id))}))},Object.defineProperty(t.prototype,"getFocusedItemId",{get:function(){if(this.props.viewState.isConversationItemPart){var e=Object(ke.b)();return null==e?void 0:e.itemId}return null},enumerable:!0,configurable:!0}),Object(o.__decorate)([P.computed],t.prototype,"getFocusedItemId",null),t=Object(o.__decorate)([a.observer],t)}(p.Component);n.d(t,"ItemActions",(function(){return Ve})),n.d(t,"ItemActionsMenu",(function(){return vt}))},2200:function(e){e.exports=JSON.parse('{"a":"OJb"}')},2389:function(e){e.exports=JSON.parse('{"a":"Hba","c":"Iba","e":"Jba","b":"Kba","d":"Lba"}')},2485:function(e,t,n){"use strict";n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return g}));var o=n(2),a=n(199),r=n(156),i="resources/images/surfaceActions",s=i+"/attach.svg",c=i+"/attachDark.svg",u=i+"/inlineimage.svg",d=i+"/inlineimageDark.svg",l=i+"/emoji.svg",m=i+"/showribbon.svg",p=i+"/showribbonDark.svg",b=i+"/dictate.svg",f=i+"/dictationLanguage.svg",h=i+"/spelling.svg";function I(e){var t,n,i=!1;switch(e){case"AddAttachment":t=Object(a.resolve)(Object(o.q)(),Object(r.c)()?c:s),n=Object(a.resolve)(Object(o.q)(),s),i=!0;break;case"AddInlineImage":t=Object(a.resolve)(Object(o.q)(),Object(r.c)()?d:u),n=Object(a.resolve)(Object(o.q)(),u),i=!0;break;case"AddEmoji":t=Object(a.resolve)(Object(o.q)(),l),i=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"ToggleDictation":t=Object(a.resolve)(Object(o.q)(),b),i=!0;break;case"SetDictationLanguage":t=Object(a.resolve)(Object(o.q)(),f),i=!0;break;case"ToggleRibbon":t=Object(a.resolve)(Object(o.q)(),Object(r.c)()?p:m),n=Object(a.resolve)(Object(o.q)(),m),i=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;case"ProofingOptions":t=Object(a.resolve)(Object(o.q)(),h),i=!0;break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:i}}function O(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t="ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function g(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},2635:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(18),a=n(208),r=n(37);function i(){return Object(a.a)()?Object(r.f)("cmp-encryption")&&Object(o.a)().SessionSettings.IsPremiumConsumerMailbox:Object(o.a)().SegmentationSettings.Irm}},2653:function(e,t,n){"use strict";var o=n(73),a=n(3711);function r(e){return a.a.addinOptionSurfaceItems[e]}var i=n(8),s=n(2707),c=n(3539),u=n(3188),d=n(3189),l=n(3712),m=n(3540),p=n(3e3),b=n(2566),f=n(2849),h=n(3713),I=n(3217),O=n(3714),g=n(3541),v=n(3542),j=n(2688),k=n(3543),S=n(3544),y=n(3218),A=n(2690),x=n(2689),C=n(3353),M=n(2389),_=n(2312),P=n(3351),w=n(3095),B=n(3219),R=n(3715),T=n(3545),D=n(3716),N=n(3546),F=n(3352),L=n(3717),E=n(3547),H=n(208),z=n(3842);function G(e){switch(e){case"AddAttachment":return Object(i.a)(l.a);case"AddInlineImage":return Object(i.a)(I.a);case"AddEmoji":return Object(i.a)(z.b);case"ToggleRibbon":return Object(i.a)(h.a);case"SaveDraft":return Object(i.a)(R.a);case"InsertSignature":return Object(i.a)(O.a);case"ShowFrom":return Object(i.a)(N.a);case"SetImportance":return Object(i.a)(D.a);case"ShowMessageOptions":return Object(i.a)(L.a);case"SwitchBodyType":return Object(i.a)(E.a);case"SensitivityMenu":return Object(i.a)(T.a);case"ProtectMessage":return Object(i.a)(m.a);case"AccChecker":return Object(i.a)(s.a);case"ToggleDarkCompose":return Object(i.a)(z.t);case"ToggleDictation":return Object(i.a)(z.u);case"SetDictationLanguage":return Object(i.a)(z.r);case"ProofingOptions":return Object(i.a)(z.n);default:return""}}function U(e){switch(e){case"LikeUnlike":return Object(i.a)(z.e);case"Reply":return Object(i.a)(A.a);case"ReplyAll":return Object(i.a)(x.a);case"Forward":return Object(i.a)(j.a);case"ReplyByMeeting":return Object(i.a)(z.g);case"ReportAbuse":return Object(i.a)(B.a);case"Popout":return Object(i.a)(w.a);case"Delete":return Object(i.a)(z.d);case"MarkReadUnread":return Object(i.a)(M.a);case"FlagUnflag":return Object(i.a)(v.a);case"AssignPolicy":return Object(i.a)(d.a);case"AddToSafeSenders":return Object(i.a)(z.c);case"MarkJunkNotJunk":return Object(i.a)(S.a);case"MarkAsPhishing":return Object(i.a)(z.f);case"Block":return Object(i.b)(Object(i.a)(g.a),"");case"CreateRule":return Object(i.a)(p.a);case"Print":return Object(i.a)(y.a);case"Translate":return Object(i.a)(C.a);case"ShowInImmersiveReader":return Object(i.a)(F.a);case"ViewMessageSource":return Object(H.a)()?Object(i.a)(z.i):Object(i.a)(z.h);case"ToggleDarkMode":return Object(i.a)(k.a);case"ReplyByIM":return Object(i.a)(z.q);case"ReplyAllByIM":return Object(i.a)(z.p);case"ToggleAmp":return Object(i.a)(z.s);case"AddToProjectSpace":return Object(i.a)(c.a);case"OtherReplyActions":return Object(i.a)(z.m);case"MessageSafety":return Object(i.a)(z.j);case"View":return Object(i.a)(z.v);case"AdvancedActions":return Object(i.a)(z.a);case"Addins":return Object(i.a)(z.l);default:return""}}function J(e){switch(e){case"None":return Object(i.a)(z.k);case"Delete":return Object(i.a)(b.a);case"Archive":return Object(i.a)(u.a);case"PinUnpin":return Object(i.a)(P.a);case"ReadUnread":return Object(i.a)(z.o);case"FlagUnflag":return Object(i.a)(f.a);case"Move":return Object(i.a)(_.a);default:return""}}var K=n(2485),W=n(3548),V=n(3718),q=n(2635),Y=n(37),X=n(860),Q=n(18),Z=n(156),$=n(35);function ee(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Y.f)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(Y.f)("outlookSpaces-enabled")&&e.push({key:"AddToProjectSpace",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Q.a)().SessionSettings.IsShadowMailbox||(e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0}),Object(Y.f)("tri-reportAbuse")&&e.push({key:"ReportAbuse",hideInGroup:!Object(H.a)(),hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1})),Object(H.a)()||e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Q.a)().SessionSettings.IsShadowMailbox||e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0}),e.push({key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(Y.f)("rp-inlineTranslation")&&Object(Y.f)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(Z.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(Y.f)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(H.a)()||e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(Y.f)("rp-amp")&&Object(H.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),Object(Y.f)("rp-menuShort")&&e.push({key:"OtherReplyActions",hideInMailSurfaceSettings:!0},{key:"MessageSafety",hideInMailSurfaceSettings:!0},{key:"View",hideInMailSurfaceSettings:!0},{key:"AdvancedActions",hideInMailSurfaceSettings:!0},{key:"Addins",hideInMailSurfaceSettings:!0}),e}function te(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return e.push({key:"AddEmoji",hideInGroup:!1}),Object(W.a)()&&e.push({key:"ProofingOptions",hideInGroup:!1}),(Object($.d)()||Object($.e)()||Object($.b)())&&Object(Y.f)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object(Y.f)("cmp-clp")&&!Object(H.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(q.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(V.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e}function ne(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function oe(e){return-1!==Object(X.d)(X.a.SurfaceActions).readSurfaceActions.indexOf(e)}function ae(e,t){return oe(e)||!(!Object(Y.f)("rp-csaPinnedLikes")||"LikeUnlike"!==e||!t.LikeCount)||!(!Object(Y.f)("rp-menuShort")||"ToggleDarkMode"!==e||!Object(Z.c)())||!!(Object(Y.f)("rp-menuShort")&&"ToggleAmp"===e&&Object(Y.f)("rp-amp")&&Object(H.a)())}var re=n(193);function ie(e,t,n,o){var a;o?a=o:(a="Pinned",(null==n?void 0:n.renderedInOverflow)&&(a=n.isPinned?"Overflow":"NotPinned")),Object(re.o)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,a,Object(Y.f)("rp-menuShort")])}function se(e){e.subMenuProps&&e.subMenuProps.items.forEach((function(e){e.renderedInOverflow=!0}))}function ce(e){e.subMenuProps&&e.subMenuProps.items.forEach((function(e){e.renderedInOverflow=!1}))}n.d(t,"k",(function(){return de})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return G})),n.d(t,"g",(function(){return U})),n.d(t,"f",(function(){return J})),n.d(t,"a",(function(){return"-"})),n.d(t,"d",(function(){return K.a})),n.d(t,"h",(function(){return K.c})),n.d(t,"e",(function(){return te})),n.d(t,"i",(function(){return ee})),n.d(t,"p",(function(){return ne})),n.d(t,"o",(function(){return ae})),n.d(t,"j",(function(){return oe})),n.d(t,"l",(function(){return ie})),n.d(t,"n",(function(){return se})),n.d(t,"m",(function(){return ce}));var ue=new o.c((function(){return n.e(490).then(n.bind(null,14159))})),de=new o.a(ue,(function(e){return e.setAddinOptionSurfaceItems}))},2707:function(e){e.exports=JSON.parse('{"a":"Cna"}')},2849:function(e){e.exports=JSON.parse('{"a":"tna"}')},3e3:function(e){e.exports=JSON.parse('{"a":"vna"}')},3001:function(e,t,n){"use strict";var o=n(4);t.a=Object(o.action)("SHOW_IN_IMMERSIVE_READER",(function(e,t,n){return{itemId:e,actionSource:t,subActionSource:n}}))},301:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o,a=n(167);n.d(t,"b",(function(){return a.ResponsiveMode})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(o||(o={}))},3095:function(e){e.exports=JSON.parse('{"a":"ina"}')},3187:function(e){e.exports=JSON.parse('{"a":"Gba"}')},3188:function(e){e.exports=JSON.parse('{"a":"Ana"}')},3189:function(e){e.exports=JSON.parse('{"a":"zna"}')},3217:function(e){e.exports=JSON.parse('{"a":"rna"}')},3219:function(e){e.exports=JSON.parse('{"a":"hna"}')},3351:function(e){e.exports=JSON.parse('{"a":"jna"}')},3352:function(e){e.exports=JSON.parse('{"a":"cna"}')},3353:function(e){e.exports=JSON.parse('{"a":"lna"}')},3539:function(e){e.exports=JSON.parse('{"a":"Bna"}')},3540:function(e){e.exports=JSON.parse('{"a":"wna","b":"xna"}')},3541:function(e){e.exports=JSON.parse('{"a":"pna"}')},3542:function(e){e.exports=JSON.parse('{"a":"ona"}')},3543:function(e){e.exports=JSON.parse('{"a":"nna"}')},3544:function(e){e.exports=JSON.parse('{"a":"mna"}')},3545:function(e){e.exports=JSON.parse('{"a":"fna"}')},3546:function(e){e.exports=JSON.parse('{"a":"dna"}')},3547:function(e){e.exports=JSON.parse('{"a":"ana"}')},3548:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(37),a=n(35);function r(){return Object(o.f)("mc-officeEditorBX")&&(Object(a.b)()||Object(a.c)())}},3711:function(e,t,n){"use strict";var o=n(4),a=Object(o.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=a},3712:function(e){e.exports=JSON.parse('{"a":"yna"}')},3713:function(e){e.exports=JSON.parse('{"a":"sna"}')},3714:function(e){e.exports=JSON.parse('{"a":"qna"}')},3715:function(e){e.exports=JSON.parse('{"a":"gna"}')},3716:function(e){e.exports=JSON.parse('{"a":"ena"}')},3717:function(e){e.exports=JSON.parse('{"a":"bna"}')},3718:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(65);function a(){return!Object(o.t)()}},3842:function(e){e.exports=JSON.parse('{"a":"Gma","b":"Hma","e":"Ima","g":"Jma","d":"Kma","c":"Lma","f":"Mma","i":"Nma","h":"Oma","j":"Pma","k":"Qma","l":"Rma","m":"Sma","n":"Tma","o":"Uma","q":"Vma","p":"Wma","r":"Xma","s":"Yma","t":"Zma","u":"_ma","v":"$ma"}')},4106:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(44),a=n(18);function r(e){var t=Object(a.a)().SessionSettings,n=t.UserEmailAddress;return n?!e||(e.toLowerCase()==n.toLowerCase()||t.UserProxyAddresses&&t.UserProxyAddresses.some((function(t){return t.toLowerCase()==e}))):(o.d.error("User email address from session data is null."),!1)}},4218:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var o=n(73),a=new o.c((function(){return Promise.all([n.e(1),n.e(4),n.e(6),n.e(83),n.e(302)]).then(n.bind(null,7117))})),r=(new o.a(a,(function(e){return e.openCreateEditRuleSettingsPage})),new o.b(a,(function(e){return e.createRuleFromItem}))),i=new o.b(a,(function(e){return e.createRuleFromRow}))},4410:function(e,t,n){"use strict";var o=n(4),a=Object(o.createStore)("AddinsSurfaceActionsStore",{isAddinObserverLoaded:!1})();t.a=a},4501:function(e,t,n){"use strict";var o=n(0),a=n(4834),r=n(8),i=n(4),s=n(3001),c=function(e){return new Promise((function(t){return setTimeout((function(){t()}),e)}))},u=n(4835),d=n.n(u);function l(e,t,n,o){return d()({itemId:e,sessionId:t,version:n},o)}var m=n(193),p=n(896),b=n(454),f=n.n(b),h=(Object(i.orchestrator)(s.a,(function(e){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,s,u,d,b,g,v,k,S,y,A,x;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:if(t=e.itemId,n=j(),!t||n.isLoading||0!==n.immersiveReaderFrameState)return[2];(i=new m.a("ShowInImmersiveReader")).addCustomData({sessionId:n.sessionId,subAction:e.subActionSource}),i.addActionSource(e.actionSource),h(!0),I(!0),s=(new Date).getUTCMilliseconds(),u=!0,d=null,b=null,o.label=1;case 1:return o.trys.push([1,7,8,9]),[4,l(f()({Id:t.Id}),n.sessionId,"2.0",null===(x=t.mailboxInfo)||void 0===x?void 0:x.requestOptions)];case 2:if(g=o.sent(),i.addCheckmark("ImmersiveReaderProcessText_Done"),g&&g.ReaderModelJson?d=JSON.parse(g.ReaderModelJson):(u=!1,b="Response from service call was null or did not contain a ReaderModelJson"),!u)return[3,6];v=(new Date).getUTCMilliseconds(),k=(v-s).toString(),null,d.launchToPostMessageSentDurationInMs=k,O({messageType:"LinguisticModel",messageValue:d}),S=120,y=0,o.label=3;case 3:return y<S&&1===j().immersiveReaderFrameState?[4,c(500)]:[3,5];case 4:return o.sent(),y++,[3,3];case 5:1===j().immersiveReaderFrameState&&(u=!1,b="Frame never got to Ready state"),o.label=6;case 6:return[3,9];case 7:return A=o.sent(),u=!1,i.addCheckmark("CaughtException"),b=A.toString(),[3,9];case 8:return h(!1),[7];case 9:return u?i.end():(I(!1),i.endWithError("ServerError",new Error(b)),Object(p.b)(Object(r.a)(a.b),Object(r.a)(a.a),!1,{hideCancelButton:!0})),[2]}}))}))})),Object(i.mutatorAction)("toggleImmersiveReaderLoadingState",(function(e){j().isLoading=e}))),I=Object(i.mutatorAction)("toggleImmersiveReaderShowingState",(function(e){j().immersiveReaderFrameState=e?1:0})),O=Object(i.mutatorAction)("setImmersiveReaderApiResponse",(function(e){j().apiResponse=e})),g=n(452),v={sessionId:Object(g.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},j=Object(i.createStore)("immersivereader",v),k=j(),S=Object(i.mutatorAction)("setImmersiveReaderFrameReady",(function(){j().immersiveReaderFrameState=2})),y=Object(i.mutatorAction)("closeImmersiveReader",(function(){var e=j();e.immersiveReaderFrameState=0,e.apiResponse=null}));n.d(t,"e",(function(){return k})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return S})),n.d(t,"a",(function(){return y})),n.d(t,"d",(function(){return s.a}))},470:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(0),a=n(1),r=n(166),i=n(153),s=Object(r.a)(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,o=e.theme;return this._classNames=s(n,{theme:o,className:t}),a.createElement("div",{className:this._classNames.actions},a.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return a.Children.map(this.props.children,(function(t){return t?a.createElement("span",{className:e._classNames.action},t):null}))},t}(i.a)},474:function(e,t,n){"use strict";var o=n(295),a=n(470),r=n(9),i={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",(function(){return s}));var s=Object(o.a)(a.a,(function(e){var t=e.className,n=e.theme,o=Object(r.getGlobalClassNames)(i,n);return{actions:[o.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[o.action,{margin:"0 4px"}],actionsRight:[o.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}),void 0,{scope:"DialogFooter"})},475:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var o=n(0),a=n(1),r=n(166),i=n(145),s=n(301),c=n(643),u=n(167),d=n(477),l=Object(r.a)(),m={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},p={type:s.a.normal,className:"",topButtonsProps:[]},b=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,o=e.modalProps,a=e.dialogContentProps,r=e.subText,i=t||o&&o.subtitleAriaId;return i||(i=(r||a&&a.subText)&&n._defaultSubTextId),i},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,o=e.modalProps,a=e.dialogContentProps,r=e.title,i=t||o&&o.titleAriaId;return i||(i=(r||a&&a.title)&&n._defaultTitleTextId),i},n._id=Object(i.a)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return o.__extends(t,e),t.prototype.render=function(){var e,t,n=this.props,r=n.className,i=n.containerClassName,s=n.contentClassName,u=n.elementToFocusOnDismiss,b=n.firstFocusableSelector,f=n.forceFocusInsideTrap,h=n.styles,I=n.hidden,O=n.ignoreExternalFocusing,g=n.isBlocking,v=n.isClickableOutsideFocusTrap,j=n.isDarkOverlay,k=n.isOpen,S=n.onDismiss,y=n.onDismissed,A=n.onLayerDidMount,x=n.responsiveMode,C=n.subText,M=n.theme,_=n.title,P=n.topButtonsProps,w=n.type,B=n.minWidth,R=n.maxWidth,T=n.modalProps,D=o.__assign({},T?T.layerProps:{onLayerDidMount:A});A&&!D.onLayerDidMount&&(D.onLayerDidMount=A),T&&T.dragOptions&&!T.dragOptions.dragHandleSelector?(e="ms-Dialog-draggable-header",t=o.__assign({},T.dragOptions,{dragHandleSelector:"."+e})):t=T&&T.dragOptions;var N=o.__assign({},m,T,{layerProps:D,dragOptions:t}),F=o.__assign({},p,this.props.dialogContentProps,{draggableHeaderClassName:e}),L=l(h,{theme:M,className:r||N.className,containerClassName:i||N.containerClassName,hidden:I,dialogDefaultMinWidth:B,dialogDefaultMaxWidth:R});return a.createElement(c.a,o.__assign({elementToFocusOnDismiss:u,firstFocusableSelector:b,forceFocusInsideTrap:f,ignoreExternalFocusing:O,isClickableOutsideFocusTrap:v,onDismissed:y,responsiveMode:x},N,{isDarkOverlay:void 0!==j?j:N.isDarkOverlay,isBlocking:void 0!==g?g:N.isBlocking,isOpen:void 0!==k?k:!I,className:L.root,containerClassName:L.main,onDismiss:S||N.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),a.createElement(d.a,o.__assign({titleId:this._defaultTitleTextId,subTextId:this._defaultSubTextId,title:_,subText:C,showCloseButton:void 0!==g?!g:!N.isBlocking,topButtonsProps:P||F.topButtonsProps,type:void 0!==w?w:F.type,onDismiss:S||F.onDismiss,className:s||F.className},F),this.props.children))},t.defaultProps={hidden:!0},t=o.__decorate([u.withResponsiveMode],t)}(a.Component)},476:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(0),a=n(1),r=n(166),i=n(153),s=n(301),c=n(486),u=n(474),d=n(167),l=Object(r.a)(),m=a.createElement(u.a,null).type,p=function(e){function t(t){return e.call(this,t)||this}return o.__extends(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,r=t.className,i=t.closeButtonAriaLabel,u=t.onDismiss,d=t.subTextId,m=t.subText,p=t.titleId,b=t.title,f=t.type,h=t.styles,I=t.theme,O=t.draggableHeaderClassName,g=l(h,{theme:I,className:r,isLargeHeader:f===s.a.largeHeader,isClose:f===s.a.close,draggableHeaderClassName:O}),v=this._groupChildren();return m&&(e=a.createElement("p",{className:g.subText,id:d},m)),a.createElement("div",{className:g.content},a.createElement("div",{className:g.header},a.createElement("p",{className:g.title,id:p,role:"heading","aria-level":2},b),a.createElement("div",{className:g.topButton},this.props.topButtonsProps.map((function(e,t){return a.createElement(c.a,o.__assign({key:e.uniqueId||t},e))})),(f===s.a.close||n&&f!==s.a.largeHeader)&&a.createElement(c.a,{className:g.button,iconProps:{iconName:"Cancel"},ariaLabel:i,onClick:u,title:i}))),a.createElement("div",{className:g.inner},a.createElement("div",{className:g.innerContent},e,v.contents),v.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return a.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===m?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=o.__decorate([d.withResponsiveMode],t)}(i.a)},477:function(e,t,n){"use strict";var o=n(295),a=n(476),r=n(9),i={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"};n.d(t,"a",(function(){return s}));var s=Object(o.a)(a.a,(function(e){var t,n,o,a=e.className,s=e.theme,c=e.isLargeHeader,u=e.isClose,d=e.hidden,l=e.isMultiline,m=e.draggableHeaderClassName,p=s.palette,b=s.fonts,f=s.effects,h=s.semanticColors,I=Object(r.getGlobalClassNames)(i,s);return{content:[c&&[I.contentLgHeader,{borderTop:"4px solid "+p.themePrimary}],u&&I.close,{flexGrow:1,overflowY:"hidden"},a],subText:[I.subText,b.medium,{margin:"0 0 24px 0",color:h.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:r.FontWeights.regular}],header:[I.header,{position:"relative",width:"100%",boxSizing:"border-box"},u&&I.close,m&&[m,{cursor:"move"}]],button:[I.button,d&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:h.buttonText,fontSize:r.IconFontSizes.medium}}}],inner:[I.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+r.ScreenWidthMinSmall+"px) and (max-width: "+r.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[I.content,{position:"relative",width:"100%"}],title:[I.title,b.xLarge,{color:h.bodyText,margin:"0",padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+r.ScreenWidthMinSmall+"px) and (max-width: "+r.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},n)},c&&{color:h.menuHeader},l&&{fontSize:b.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(o={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:h.buttonText},".ms-Dialog-button:hover":{color:h.buttonTextHovered,borderRadius:f.roundedCorner2}},o["@media (min-width: "+r.ScreenWidthMinSmall+"px) and (max-width: "+r.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},o)}]}}),void 0,{scope:"DialogContent"})},4833:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(73),a=new o.c((function(){return n.e(453).then(n.bind(null,9425))})),r=new o.b(a,(function(e){return e.onArchiveTagForFolderChanged})),i=new o.b(a,(function(e){return e.onDeleteTagForFolderChanged})),s=new o.b(a,(function(e){return e.getRetentionPolicyMenuItem})),c=new o.b(a,(function(e){return e.getAssignPolicyPropertiesForMailContextMenu}))},4834:function(e){e.exports=JSON.parse('{"b":"nja","a":"oja"}')},4835:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(38),a=n(454);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=a.default(e.itemId)),o.makeServiceRequest("ImmersiveReaderProcessText",e,t)}},5363:function(e,t,n){"use strict";var o,a=n(4410),r=n(93),i=Object(r.action)("setAddinObserverLoaded ")((function(){a.a.isAddinObserverLoaded=!0})),s=n(909);function c(e,t){return a.a.isAddinObserverLoaded&&o?o(e,t).get():null}n.d(t,"a",(function(){return c})),s.s.import().then((function(e){o=e,i()}))},5504:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var o=n(0),a=n(5363),r=n(134),i=n(960),s=n(836),c=n(842),u=n(2653),d=n(909);function l(e,t){var n=e.length;n>0&&e[n-1].displayName!=u.a&&e.push({key:"addinDivider_"+t,displayName:u.a,itemType:r.a.Divider,onClick:null})}function m(e,t,n,u,m,p,b,f,h,I,O,g){var v;O=O||function(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(s.C)(t,c.j)}(t);var j=Object(a.a)(e,O);v=j?j.sectionProps.items:[];var k=e==i.a.MessageRead?Object(d.q)(n):Object(d.o)(n),S=!0;v.forEach((function(e){Object(d.m)(k,e);var t=e;if(t.iconOnly=!0,h&&(t.className=h),t.disabled=!!g,u.indexOf(e.key)>=0){var n=t;I&&(n=Object(o.__assign)({},t)),null!=n.name&&null!=n.title&&n.name.trim()!=n.title.trim()&&(n.name=n.ariaLabel),n.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach((function(e){e.isPinned=!0})),n?e.unshift(t):e.push(t)}(m,n,b)}(-1==u.indexOf(e.key)||I)&&(S&&(l(p,f++),S=!1),t.renderedInOverflow=!0,t.subMenuProps&&t.subMenuProps.items.forEach((function(e){e.renderedInOverflow=!0})),(t.itemType!==r.a.Divider||0!==p.length&&p[p.length-1].itemType!==r.a.Divider)&&p.push(t))}))}},5557:function(e){e.exports=JSON.parse('{"a":"tDb"}')},6253:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(1099),a=n(1095),r=n(392),i=n.n(r);function s(e){var t;return Object(o.a)([e.ItemId.Id],i()({BaseShape:"IdOnly"}),"MessageDetails","V2016_06_24",null===(t=e.MailboxInfo)||void 0===t?void 0:t.requestOptions).then((function(e){return function(e){if(Object(a.a)(e[0])){var t=e[0].Items[0];if(null!=t.ExtendedProperty&&t.ExtendedProperty.length>=1)return t.ExtendedProperty[0].Value}return null}(e)}))}},6675:function(e,t,n){"use strict";var o=n(0),a=n(25),r=n(8083),i=n(2200),s=n(8),c=n(343),u=n(787),d=n(301),l=n(474),m=n(6253),p=n(1099),b=n(1095),f=n(392),h=n.n(f);function I(e){var t;return Object(p.a)([e.ItemId.Id],h()({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",null===(t=e.MailboxInfo)||void 0===t?void 0:t.requestOptions).then((function(e){return function(e){return Object(b.a)(e[0])?e[0].Items[0].MimeContent:null}(e)}))}var O=n(208),g=n(1),v=n(152);n.d(t,"a",(function(){return y}));var j=n(410),k=n(8084),S=Object(a.a)((function(e,t){var n=Object(o.__read)(g.useState(""),2),a=n[0],m=n[1];g.useImperativeHandle(t,(function(){return{setContent:function(e){null!==e&&0!==e.length||(e=Object(s.a)(r.a)),m(e)}}}),[]);var p=function(){e.onClose()};return g.createElement(u.a,{hidden:!1,containerClassName:k.container,dialogContentProps:{showCloseButton:!1,title:Object(O.a)()?Object(s.a)(r.c):Object(s.a)(r.b),type:d.a.normal},onDismiss:p},g.createElement("div",{className:j(k.content,"allowTextSelection"),tabIndex:-1},a),g.createElement(l.a,null,g.createElement(c.a,{onClick:p,className:k.button},Object(s.a)(i.a))))}),{forwardRef:!0});function y(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(o.__generator)(this,(function(o){return(t=document.createElement("div")).id="ViewMessageSourceDialog",document.body.appendChild(t),n=function(){v.unmountComponentAtNode(t),document.body.removeChild(t)},a=g.createRef(),v.render(g.createElement(S,{onClose:n,ref:a}),t),Object(O.a)()?e.MimeContent?a.current.setContent(atob(e.MimeContent.Value)):I(e).then((function(t){e.MimeContent=t,a.current.setContent(atob(e.MimeContent.Value))})):Object(m.a)(e).then((function(e){a.current.setContent(e)})),[2]}))}))}},6692:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(73),a=new o.c((function(){return n.e(248).then(n.bind(null,9496))})),r=new o.b(a,(function(e){return e.preparePopoutDataForReadingPane}))},6769:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(73),a=new o.c((function(){return n.e(509).then(n.bind(null,9453))})),r=new o.b(a,(function(e){return e.getSpacesContextMenuItems}))},7004:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(950);function a(){return o.a.conversationReadingPaneViewState?o.a.conversationReadingPaneViewState.conversationSubject:null}},7006:function(e,t,n){var o=n(12867),a=n(64);"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)a.loadStyles(o[r][1],!1);o.locals&&(e.exports=o.locals)},7007:function(e,t,n){"use strict";function o(e){return!(e.CopyAllowed&&e.ForwardAllowed&&e.ReplyAllAllowed&&e.ReplyAllowed&&e.PrintAllowed)}n.d(t,"a",(function(){return o}))},7008:function(e){e.exports=JSON.parse('{"e":"o6b","d":"p6b","b":"q6b","a":"r6b","c":"s6b"}')},7772:function(e,t,n){"use strict";n(4410),n(5363);var o=n(5504);n.d(t,"a",(function(){return o.a}))},787:function(e,t,n){"use strict";var o=n(295),a=n(475),r=n(9),i={root:"ms-Dialog"};n.d(t,"a",(function(){return s}));var s=Object(o.a)(a.a,(function(e){var t,n=e.className,o=e.containerClassName,a=e.dialogDefaultMinWidth,s=void 0===a?"288px":a,c=e.dialogDefaultMaxWidth,u=void 0===c?"340px":c,d=e.hidden,l=e.theme;return{root:[Object(r.getGlobalClassNames)(i,l).root,l.fonts.medium,n],main:[{width:s,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+r.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:u,minWidth:s},t)},!d&&{display:"flex"},o]}}),void 0,{scope:"Dialog"})},8083:function(e){e.exports=JSON.parse('{"c":"b7b","b":"c7b","a":"d7b"}')},8084:function(e,t,n){var o=n(8085),a=n(64);"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)a.loadStyles(o[r][1],!1);o.locals&&(e.exports=o.locals)},8085:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._1pVbbNWoU3A2KPJ5mTx9ss{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2o7RMkbYm39CgXru8bzVk{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre-line}._3c9eatHmfdZHfX00YKzcP4{color:"[theme:white, default:#ffffff]"!important}html[dir] ._3c9eatHmfdZHfX00YKzcP4{background-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._3c9eatHmfdZHfX00YKzcP4:hover{background-color:"[theme:themeDark, default:#0D62AA]"}html[dir] ._3c9eatHmfdZHfX00YKzcP4:active{background-color:"[theme:themeDarker, default:#004578]"}',""]),t.locals={container:"_1pVbbNWoU3A2KPJ5mTx9ss",content:"_2o7RMkbYm39CgXru8bzVk",button:"_3c9eatHmfdZHfX00YKzcP4"}},9276:function(e){e.exports=JSON.parse('{"a":"u6b"}')},9277:function(e){e.exports=JSON.parse('{"a":"t6b"}')}}]);
//# sourceMappingURL=owa.ItemActions.js.map
self.scriptsLoaded['owa.ItemActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ItemActions.js'] = (new Date()).getTime();