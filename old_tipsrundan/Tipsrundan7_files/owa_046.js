self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.7.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[7],{248:function(e,t,n){"use strict";var r=n(0),o=n(150),i=n(184),c=n(244),u=n(412),a=n.n(u),s=n(69),l=n(467),d=n.n(l),f=n(74),h=500,_="OWA_GetAccessTokenForResource";function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return t={isUserActivity:!1},[2,d()(a()({Resource:e}),t)]}))}))}function v(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return t<1?(Object(f.h)(_,[e,t,n?n.toString():""]),[2,Promise.reject()]):[2,b(e).catch((function(n){return Object(s.a)(h).then((function(){return v(e,t-1,n)}))}))]}))}))}var p,O=n(37),g=n(389),j=3,w=500;function A(e){var t=this,n=null,o=null,i=new Promise((function(e,i){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return n=e,o=i,[2]}))}))})),c={onFulfilled:n,onRejected:o,resource:e};return(null==p&&(p=new g.a(j,k,w)),p).add(c),i}function k(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return D(e.resource).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var T=n(288);n.d(t,"e",(function(){return E})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return R})),n.d(t,"a",(function(){return D})),n.d(t,"d",(function(){return x}));var m=1,C=12e4,I=3,y=null;function E(e){y=e}function S(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return null!=(t=x(q(),e))?[3,2]:[4,D(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:void 0]}}))}))}function R(e){var t=x(q(),e);if(t)return[t.AccessToken,void 0];if(Object(O.f)("auth-getAccessTokenQueueEnabled")){var n=Object(T.a)(e),r=void 0;return n?r=n:(r=A(e),Object(T.b)(e,r)),[void 0,r.then((function(t){return Object(T.c)(e),t.AccessToken}))]}return[void 0,D(e).then((function(e){return e.AccessToken}))]}function D(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(O.f)("auth-getAccessTokenQueueEnabled")?[4,v(e,I)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,b(e)];case 3:n=r.sent(),r.label=4;case 4:return null!=(t=n)&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(t.ExpiresIn&&t.ExpiresIn>0&&(t.AccessTokenExpiry=Object(c.a)(Date.now(),t.ExpiresIn).toISOString()),(o=new Date(t.AccessTokenExpiry).getTime()-Date.now()-C)>0&&q().put(e,t,o,(function(e,t){D(e).catch((function(t){Object(f.h)(_,{category:"Cache_Expired",err:t?t.toString():"",message:t?t.message:"",stk:t?t.stack:"",resource:e})}))}))),[2,t]}}))}))}function x(e,t){var n=e.get(t),r=void 0;(null==n?void 0:n.AccessTokenExpiry)&&(Object(i.a)(new Date(n.AccessTokenExpiry),-m)>new Date(Date.now())&&(r=n));return r}function q(){return null==y&&(y=new o.Cache),y}},288:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return a}));var r=n(150),o=null;function i(){return null==o&&(o=new r.Cache),o}function c(e){return i().get(e)}function u(e){return i().del(e)}function a(e,t){i().put(e,t)}},593:function(e,t,n){"use strict";n.r(t);var r=n(150),o=n(248);function i(e){Object(o.e)(new r.Cache),Object(o.b)(e.location.origin)}var c=n(0),u=n(52),a=n(99),s=n.n(a),l=n(244),d=n(74),f="OWA_GetDelegationAccessToken",h={};function _(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o;return Object(c.__generator)(this,(function(i){switch(i.label){case 0:t=e.client_id+e.scope,n=encodeURIComponent(t),r={},i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,b(e,window)];case 2:return r=i.sent(),[3,5];case 3:return o=i.sent(),r.TokenResultCode=2,Object(d.h)(f+" Token fetch failure ",{err:o.toString(),message:o.message,stk:o.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",h[e]),t.document.body.removeChild(n),delete h[e])}(n,window),[7];case 5:return[2,r]}}))}))}function b(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var n,r,o;return Object(c.__generator)(this,(function(i){return n=encodeURIComponent(e.client_id+e.scope),r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+u.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((o=t.document.createElement("iframe")).src=r.toString(),o.style.display="none",o.id=n,t.document.body.appendChild(o),[2,new Promise((function(r,i){h[n]=function(n){var c={};try{o.contentWindow&&o.contentWindow.location.host==t.location.host&&(c=function(e,t){var n=u.parse(e),r={};n.access_token?(r.AccessToken=n.access_token,r.AccessTokenExpiry=Object(l.a)(Date.now(),parseInt(n.expires_in)).toISOString(),r.TokenResultCode=0):"login_required"==n.error||"interaction_required"==n.error||"consent_required"==n.error?(r.TokenResultCode=3,Object(d.h)(f+" MSA Failure Unauthorized",{error:n.error,param:e,requestId:t})):(r.TokenResultCode=2,Object(d.h)(f+" MSA Failure",{error:n.error,param:e,requestId:t}));return r}(o.contentWindow.location.hash.substring(1),e.requestId))}catch(t){Object(d.h)(f+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),c.TokenResultCode=2,i(c)}r(c)},o.addEventListener("load",h[n],!1)}))])}))}))}var v,p=n(37),O=n(288),g=n(389),j=3,w=500;function A(e){var t=this,n=null,r=null,o=new Promise((function(e,o){return Object(c.__awaiter)(t,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){return n=e,r=o,[2]}))}))})),i={onFulfilled:n,onRejected:r,options:e};return(null==v&&(v=new g.a(j,k,w)),v).add(i),o}function k(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){return _(e.options).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var T=n(303),m=n(452),C=null,I="OWA_GetDelegationAccessToken",y="https://login.live.com/oauth20_authorize.srf",E="/owa/auth/dt.aspx",S="292841";function R(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:n={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:t||Object(m.a)()},r=void 0,o=void 0,c.label=1;case 1:return c.trys.push([1,7,,8]),Object(p.f)("auth-disableGetAuthenticationCall")?[4,D(U(n))]:[3,3];case 2:return r=c.sent(),[3,6];case 3:return[4,s()()];case 4:return 0!=(o=c.sent()).ResultCode||null==o.ImplicitGrantAuthorizationUrl||""==o.ImplicitGrantAuthorizationUrl?(Object(d.h)(I+" ImplicitGrantAuthorizationUrl is empty or null ",{scope:e,correlationId:n.requestId}),[2,r]):(i=u.parse(o.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(n.client_id=i.client_id,n.authorization_uri=o.ImplicitGrantAuthorizationUrl.split("?")[0],n.redirect_uri=i.redirect_uri,[4,D(n)]):[3,6];case 5:r=c.sent(),c.label=6;case 6:return[2,r];case 7:return a=c.sent(),Object(d.h)(I+" GetDelegationToken Operation failed ",{err:a.toString(),message:a.message,stk:a.stack||"",scope:e,requestId:n.requestId}),[2,r];case 8:return[2]}}))}))}function D(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return t=e.client_id+e.scope,(null==(n=Object(o.d)(q(),t))?void 0:n.AccessToken)?[2,n.AccessToken]:[3,1];case 1:return Object(p.f)("auth-getDelegationTokenQueueEnabled")?(r=Object(O.a)(t),i=void 0,r?i=r:(i=A(e),Object(O.b)(t,i)),[2,i.then((function(e){return x(t,e),Object(O.c)(t),e.AccessToken}))]):[3,2];case 2:return[4,_(e)];case 3:return n=c.sent(),x(t,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}}))}))}function x(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&q().put(e,t,n)}}function q(){return null==C&&(C=new r.Cache),C}function U(e){return e.redirect_uri=Object(T.a)()+E,e.authorization_uri=y,e.client_id=S,e}var P=n(30),z=n(353);var F=!1;function G(e){F||(!function(e){var t=Object(z.a)("/owa",e);Object(P.updateServiceConfig)({baseUrl:t})}(e),F=!0)}var W={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function N(e,t,n,r,o){n?e.acquireTokenPopup(t,null,n,o):e.acquireToken(t,(function(n,i){n&&n.indexOf(W.NoPreAuth)>=0&&r?e.acquireTokenPopup(t,null,null,o):o(n,i)}))}var L=n(73),B=new L.c((function(){return Promise.all([n.e(600),n.e(104)]).then(n.bind(null,14126))})),Q=new L.a(B,(function(e){return e.createAdalAuthenticationContext}));var M=function(e,t,n,r,o){return function(i,c){i||!c?o(i,null):(e.getCachedUser(),N(e,t,n,r,o))}},$="adalIdTokenFrame";function H(e,t,n,r,o){e.config.displayCall=function(i){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(i),window.detectUserCachedCallback=M(e,t,n,r,o),function(e,t){e._addAdalFrame($).src="about:blank",e._loadFrame(t+"&prompt=none",$)}(e,i)},e.login()}function J(e,t,n,r,o,i,u){return Object(c.__awaiter)(this,void 0,void 0,(function(){var a;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return"https://login.microsoftonline.com/",[4,Q.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return a=c.sent(),a.getCachedUser()?N(a,n,r,o,u):i?H(a,n,r,o,u):u(W.NoPreAuth,void 0),[2]}}))}))}n.d(t,"registerTokenProvider",(function(){return i})),n.d(t,"getAccessTokenforResource",(function(){return o.b})),n.d(t,"getAccessTokenforResourceAsLazy",(function(){return o.c})),n.d(t,"getDelegationToken",(function(){return D})),n.d(t,"getDelegationTokenForOwa",(function(){return R})),n.d(t,"bootstrap",(function(){return G})),n.d(t,"getAccessTokenOnBehalfOfResource",(function(){return J})),n.d(t,"AdalErrorCode",(function(){return W}))}}]);
//# sourceMappingURL=owa.7.js.map
self.scriptsLoaded['owa.7.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.7.js'] = (new Date()).getTime();