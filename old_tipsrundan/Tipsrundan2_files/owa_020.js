self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwsGateway.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[403],{1435:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return a}));var r=n(49),i=n(32);function o(){var t=Object(r.getCookie)("targetServer"),e="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.getCookie)(e)}function u(){var t="",e=Object(i.a)().pathname.split("/").filter((function(t){return t.length}));return e.length>=2&&e[1].match(/.+@.+/)&&(t=e[1]),t}function a(){var t=u();return t||(t=o()),t}},150:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,i=!1;function o(e){r--,delete t[e]}this.put=function(e,n,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var a=t[e];a?clearTimeout(a.timeout):r++;var c={value:n,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(e),u&&u(e,n)}.bind(this),i)),t[e]=c,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(e),n},this.clear=function(){for(var o in t)clearTimeout(t[o].timeout);r=0,t=Object.create(null),i&&(e=0,n=0)},this.get=function(o){var u=t[o];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&e++,u.value;i&&n++,r--,delete t[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),i=Date.now(),o=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(o)if(t[u])continue;var a=r[u],c=a.expire-i;if(c<=0){this.del(u);continue}c=c>0?c:void 0,this.put(u,a.value,c)}return this.size()}}t.exports=new r,t.exports.Cache=r},184:function(t,e,n){"use strict";var r=n(22);e.a=function(t,e){return new Date(+t+e*r.g)}},190:function(t,e,n){"use strict";var r=n(465);n.d(e,"a",(function(){return r.a}))},22:function(t,e,n){"use strict";n.d(e,"i",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return o})),n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return a})),n.d(e,"l",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return f})),n.d(e,"j",(function(){return d})),n.d(e,"c",(function(){return l})),n.d(e,"k",(function(){return p})),n.d(e,"d",(function(){return h}));var r=6048e5,i=864e5,o=36e5,u=6e4,a=1e3,c=12,s=30,f=365,d=-864e13,l=864e13,p=Date.UTC(1601,0,1),h=Date.UTC(4501,0,1)},244:function(t,e,n){"use strict";var r=n(22);e.a=function(t,e){return new Date(+t+e*r.h)}},303:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(32);function i(){var t=Object(r.a)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}},3210:function(t,e,n){"use strict";n.d(e,"f",(function(){return g})),n.d(e,"d",(function(){return y})),n.d(e,"c",(function(){return R})),n.d(e,"e",(function(){return C})),n.d(e,"b",(function(){return I})),n.d(e,"a",(function(){return S}));var r=n(0),i=n(37),o=n(190),u=n(3),a=n(456),c=n(1435),s=n(36),f=n(108),d=n.n(f),l=n(105),p=n.n(l),h=n(593),b=n(44),O=n(65),m=n(106),v=n(540),j=n(390),k=2048,w=null;function g(t,e,n,o,u,c,s,f,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,p,b,O,m,v,j,k;return Object(r.__generator)(this,(function(w){switch(w.label){case 0:return l="object"==typeof n&&n.customHeaders||s,p=l?Object.keys(l).reduce((function(t,e){return t[e.toLowerCase()]=l[e],t}),{}):void 0,b="object"==typeof n?Object(r.__assign)(Object(r.__assign)({},n),{customHeaders:p}):{returnFullResponse:n,correlationId:u,requestObject:c,customHeaders:p,throwServiceError:f,includeCredentials:d},"authorization",b.customHeaders&&b.customHeaders.authorization?[3,3]:(m=Object(a.m)(),v=Object(r.__read)(Object(h.getAccessTokenforResourceAsLazy)(m),2),j=v[0],k=v[1],j?[3,2]:[4,k]);case 1:j=w.sent(),w.label=2;case 2:O=j,void 0===b.includeCredentials&&(b.includeCredentials=!Object(i.f)("auth-authzHeaderNoCookies")),w.label=3;case 3:return[2,T(t,e,O,b,o)]}}))}))}function T(t,e,n,f,l){var h;return Object(r.__awaiter)(this,void 0,void 0,(function(){var g,T,y,R,C,I,S,_,x,N,P,U,D,q,E,A,z,H,M,L,F,G,J,B;return Object(r.__generator)(this,(function(r){return g=f.returnFullResponse,T=f.correlationId,y=f.requestObject,R=f.customHeaders,C=f.throwServiceError,I=f.sendPayloadAsBody,S=f.isThrottled,_=f.includeCredentials,x=/\/(.+?)\//.exec((null===(h=null===window||void 0===window?void 0:window.location)||void 0===h?void 0:h.pathname)||""),N=x&&x.length>0&&" "+x[1]||"",(P=new Headers).append("X-OWA-CANARY",Object(s.getOwaCanaryCookie)()),P.append("X-MS-AppName","owa-react"+N),U={n:d()().toString()},T&&(P.append("client-request-id",T),U.cri=T),R&&Object.keys(R).forEach((function(t){P.append(t,R[t])})),(D=Object(m.getCorrelationVector)())&&(P.append(m.correlationVectorHeaderName,D),U.cv=D),n&&("Authorization",Object(i.f)("fwk-devTools")&&(3==(q=n.split(".")).length&&0!==q[2].length||b.d.error("BearerTokenIncomplete "+q.length)),P.append("Authorization","Bearer  "+n)),"x-anchormailbox",R&&R["x-anchormailbox"]||(E=Object(c.b)(),Object(i.f)("fwk-puidBasedRouting")&&0===E.length&&(null==(A=Object(O.h)())?void 0:A.SessionSettings)&&(z=A.SessionSettings.ExternalDirectoryTenantGuid,(H=A.SessionSettings.UserPuid)&&z&&(E="PUID:"+H+"@"+z)),0===E.length&&(E=Object(c.a)()),E&&E.length>0&&P.append("X-AnchorMailbox",E)),M={method:e,credentials:!1!==_?"same-origin":"omit"},y&&(P.append("Content-Type","application/json"),L=JSON.stringify(y),F=t.search(/ows\/|owa\//i)>=0,Object(i.f)("fwk-emptyPost")&&F&&"POST"==e&&!I&&(G=encodeURIComponent(L)).length<k?P.append("X-OWA-UrlPostData",G):M.body=L),M.headers=P,J=function(t,e){var n=function(t,e){var n=Object(a.v)(t,e),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(a.f)(r[0],window.location.pathname),n=r.join("/"));return Object(a.a)(n)}(Object(i.f)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",t),r=Object(a.m)()+n;if(Object(i.f)("fwk-devTools")&&Object(u.d)(j.b)&&(Object(u.a)(j.a)==t||!Object(u.d)(j.a))&&(null==w&&(w=confirm("A query param '"+j.b+"' is set to redirect some of calls to '"+Object(u.a)(j.b)+"'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.")),w)){var o=t.split("/");o.length>0&&"ows"==o.shift()&&(t=o.join("/")),r=Object(u.a)(j.b)+"/"+t}return Object(a.t)(r,e)}(t,U),B=S?p()(J,M):fetch(J,M),Object(v.a)(M,f,B,l,J),[2,B.then((function(n){if(g)return n;if(Object(o.a)(n.status))return n.text().then((function(t){return t?JSON.parse(t):{}}));throw new Error(e+" request to "+t+" failed, http error:"+n.status)})).catch((function(t){if(b.d.warn(t),C)throw{stack:t.stack,message:t.message,correlationVector:D,correlationId:f.correlationId};return[]}))]}))}))}function y(t,e,n,r,i,o,u,a,c,s){return g(t,"POST",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:i,throwServiceError:o,sendPayloadAsBody:u,includeCredentials:a,datapoint:s},c)}function R(t,e,n,r,i,o,u,a){return g(t,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:i,throwServiceError:o,isThrottled:u,includeCredentials:a})}function C(t,e,n,r,i,o,u,a){return g(t,"PUT",r,u,n,e,i,o,a)}function I(t,e,n,r,i,o,u){return g(t,"GET",n,u,e,void 0,r,i,o)}function S(t,e,n,r,i,o,u,a){return g(t,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:i,throwServiceError:o,isThrottled:u,includeCredentials:a})}},334:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(32),i=n(17),o=n(303);function u(t){var e=Object(r.a)(),n=Object(o.a)()+Object(i.a)("/owa",e.pathname)+"/",u=e.search&&e.search.length>0;n+=u?e.search:"?";for(var a=Object.keys(t),c=u,s=0;s<a.length;s++)c?n+="&":c=!0,n+=a[s]+"="+t[a[s]];return n}},353:function(t,e,n){"use strict";function r(t,e){var n=t;if(e){var r=e.split("/").filter((function(t){return t.length}));if(r.length>=2){var i=parseInt(r[1]);isNaN(i)||(n+="/"+i)}}return n}n.d(e,"a",(function(){return r}))},389:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.runTask=function(){var t=this,e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()},t}();n.d(e,"a",(function(){return r}))},412:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"TokenRequest:#Exchange"},t)}},452:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function u(t){return r.test(t)}},456:function(t,e,n){"use strict";var r=n(353),i=(n(482),n(17)),o=n(10);function u(t,e){var n=t;if(e){var r=e.split("/").filter((function(t){return t.length}));r.length>=2&&r[1].match(/.+@.+/)&&(n=Object(o.a)(n,r[1]))}return Object(o.b)(n)}var a=n(75),c=n(32);function s(t){return Object(o.b)(Object(o.c)(Object(o.a)(Object(a.a)(Object(c.a)())||"",t)))}var f,d,l,p=n(334);function h(t,e){var n=-1!==t.indexOf("?");return(t+=n?"&":"?")+Object.keys(e).map((function(t,n){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}function b(){return f||(f=Object(i.a)("/calendar",Object(c.a)().pathname)+"/"),f}function O(){return d||(d=Object(i.a)("/mail",Object(c.a)().pathname)+"/"),d}function m(){return l||(l=Object(i.a)("/files",Object(c.a)().pathname)+"/"),l}var v,j,k,w=n(514);function g(t){return v&&j===t||(j=t,v=t?Object(i.a)("/people/group/owner",Object(c.a)().pathname)+"/":Object(i.a)("/people/group/member",Object(c.a)().pathname)+"/"),v}function T(){return k||(k=Object(i.a)("/people/group/deleted",Object(c.a)().pathname)+"/"),k}var y=n(18);function R(){var t=Object(y.a)().UserOptions;return(null==t?void 0:t.ReactOptinSettings)&&t.ReactOptinSettings.CalendarEnabled||!1}function C(t){if(R())return b()+"deeplink/compose/"+encodeURIComponent(t);var e={viewmodel:"IComposeCalendarItemViewModelFactory",ItemID:encodeURIComponent(t),ispopout:"1"};return Object(p.a)(e)}function I(t){return window.location.origin+b()+"showPeek/item/"+encodeURIComponent(t)}function S(t){if(R())return b()+"item/"+encodeURIComponent(t);var e={viewmodel:"ICalendarItemDetailsViewModelFactory",ItemID:encodeURIComponent(t),ispopout:"1"};return Object(p.a)(e)}var _=n(0),x=n(199),N=n(478),P=n(52),U=Object(N.a)().split("/").slice(1).join("/")+"deeplink/";function D(t,e,n,r){var i=Object(c.a)().search;if(n&&((r=r||{}).minus=""),r){var o=Object(P.parse)((i||"").substr(1));Object.keys(r).forEach((function(t){return o[t]=r[t]})),i="?"+function(t){return Object.entries(t).map((function(t){var e=Object(_.__read)(t,2),n=e[0],r=e[1];return r?encodeURIComponent(n)+"="+encodeURIComponent(r):encodeURIComponent(n)})).join("&")}(o)}var u={pathname:"/"+t+"/"+U+e,search:i};return x.format(u)}var q,E=n(483),A="https://to-do.microsoft.com";function z(){var t,e,n=Object(y.a)(),r=n.UserOptions,i=null===(t=n.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,o=A;return(null===(e=null==r?void 0:r.ReactOptinSettings)||void 0===e?void 0:e.TasksRedirectUrl)&&(o=r.ReactOptinSettings.TasksRedirectUrl,i&&(o=h(r.ReactOptinSettings.TasksRedirectUrl,{auth_upn:i}))),o}function H(){return q||(q=Object(i.a)("/spaces",Object(c.a)().pathname)+"/"),q}var M=n(303);n.d(e,"j",(function(){return r.a})),n.d(e,"r",(function(){return i.a})),n.d(e,"f",(function(){return u})),n.d(e,"l",(function(){return s})),n.d(e,"v",(function(){return o.a})),n.d(e,"a",(function(){return o.b})),n.d(e,"o",(function(){return p.a})),n.d(e,"t",(function(){return h})),n.d(e,"e",(function(){return b})),n.d(e,"k",(function(){return O})),n.d(e,"g",(function(){return m})),n.d(e,"p",(function(){return w.a})),n.d(e,"i",(function(){return g})),n.d(e,"h",(function(){return T})),n.d(e,"b",(function(){return C})),n.d(e,"c",(function(){return I})),n.d(e,"d",(function(){return S})),n.d(e,"q",(function(){return D})),n.d(e,"u",(function(){return E.b})),n.d(e,"s",(function(){return z})),n.d(e,"n",(function(){return H})),n.d(e,"m",(function(){return M.a}))},465:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},467:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(38),i=n(412);e.default=function(t,e){return void 0===t||t.__type||(t=i.default(t)),r.makeServiceRequest("GetAccessTokenforResource",t,e)}},478:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(75),o=n(32),u=n(17);function a(){if(!r){var t=Object(i.a)(Object(o.a)());r=(r=Object(u.a)("/"+t,Object(o.a)().pathname.replace(/\/$/,""))+"/").replace(/^\//,"")}return r}},482:function(t,e,n){"use strict";function r(t){if(t){var e=t.split("/").filter((function(t){return t.length}));if(e.length>=2&&!isNaN(parseInt(e[1])))return!0}return!1}n.d(e,"a",(function(){return r}))},483:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}));var r="deeplink";function i(t){var e=t||window.location;return(e?e.pathname:"").split("/").indexOf(r)>=0}},514:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(17),o=n(32);function u(){return r||(r=Object(i.a)("/people",Object(o.a)().pathname)+"/"),r}},796:function(t,e,n){"use strict";n.r(e);var r=n(3210);n.d(e,"makeOwsPrimeRequest",(function(){return r.f})),n.d(e,"makePostRequest",(function(){return r.d})),n.d(e,"makePatchRequest",(function(){return r.c})),n.d(e,"makePutRequest",(function(){return r.e})),n.d(e,"makeGetRequest",(function(){return r.b})),n.d(e,"makeDeleteRequest",(function(){return r.a}))}}]);
//# sourceMappingURL=owa.OwsGateway.js.map
self.scriptsLoaded['owa.OwsGateway.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwsGateway.js'] = (new Date()).getTime();