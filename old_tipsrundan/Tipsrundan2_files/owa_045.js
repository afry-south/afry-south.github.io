self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ActionableMessageMail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[100],{1167:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),a={};function i(e){var t;null===(t=a[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function o(e){var t;return a[e]=null!==(t=a[e])&&void 0!==t?t:new Map}function s(e,t,n){var a=r.useRef();r.useEffect((function(){return function(e,t,n){var r=o(e);0===r.size&&window.addEventListener(e,i),r.set(t,n)}(e,a,t),function(){return function(e,t){var n=o(e);n.delete(t),0===n.size&&window.removeEventListener(e,i)}(e,a)}}),n)}},12880:function(e){e.exports=JSON.parse('{"a":"i3b"}')},12881:function(e){e.exports=JSON.parse('{"a":"W2b","b":"X2b","c":"Y2b","d":"Z2b"}')},12882:function(e){e.exports=JSON.parse('{"b":"n3b","a":"o3b","c":"p3b"}')},12883:function(e){e.exports=JSON.parse('{"a":"m3b"}')},12884:function(e){e.exports=JSON.parse('{"d":"r3b","c":"s3b","a":"t3b","b":"u3b"}')},12885:function(e,t,n){var r=n(12886),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},12886:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,'._2pRM5MH2wQSL6KJYv7DZjH{width:calc(100% - 25px);position:absolute;height:calc(100% - 64px)}html[dir=ltr] ._2pRM5MH2wQSL6KJYv7DZjH{margin-left:-20px;margin-right:-35px}html[dir=rtl] ._2pRM5MH2wQSL6KJYv7DZjH{margin-right:-20px;margin-left:-35px}._36_sivvBA_3QDLOOHcFq0k{width:100%;height:100%}html[dir] ._36_sivvBA_3QDLOOHcFq0k{border-width:0}._3CW7BF2coKNui2HaKAh3Zw{font-size:21px;font-weight:100;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={opayFlexPaneContainer:"_2pRM5MH2wQSL6KJYv7DZjH",opayAppIFrameStyle:"_36_sivvBA_3QDLOOHcFq0k",flexPaneHeader:"_3CW7BF2coKNui2HaKAh3Zw"}},12887:function(e,t,n){(t=e.exports=n(63)(!1)).push([e.i,"html[dir] ._3uEvU5UAdRqP1z24N4hRkz{margin-top:12px}html[dir=ltr] ._3uEvU5UAdRqP1z24N4hRkz{margin-left:52px}html[dir=rtl] ._3uEvU5UAdRqP1z24N4hRkz{margin-right:52px}.cmC6MemIKYrJJ77Z_ZD4n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3FcySUHYRo6OeOulzvvAzX{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3FcySUHYRo6OeOulzvvAzX{margin-top:8px}._3FcySUHYRo6OeOulzvvAzX ._36SOH4LiYsn62sG0PC93OB{font-size:8px}",""]),t.locals={container:"_3uEvU5UAdRqP1z24N4hRkz",cardArea:"cmC6MemIKYrJJ77Z_ZD4n",bodyToggleButton:"_3FcySUHYRo6OeOulzvvAzX",icon:"_36SOH4LiYsn62sG0PC93OB"}},13808:function(e,t,n){"use strict";n.r(t);var r,a=n(4783),i=n(44),o=n(8),s=n(0),c=n(1303),d=function(e){function t(t){var n=e.call(this)||this;return n.preserveBody=t,n}return Object(s.__extends)(t,e),t.prototype.internalPrepareForExecution=function(t){var n=this.body;e.prototype.internalPrepareForExecution.call(this,t),this.preserveBody&&(this.body=n)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(c.HttpAction),u=n(12880),l="Action.Http",p="HttpPOST",f="Action.Submit";!function(e){e.None="none",e.ConnnectorMessage="connectorMessage",e.ExplicitMessageCard="explicitMessageCard",e.RecommendationCard="recommendationCard",e.AddInRecommendationCard="addInRecommendationCard",e.CardHighlight="cardHighlight",e.AdaptiveCard="adaptiveCard",e.ListViewExtractedAction="listViewExtractedAction"}(r||(r={}));var g=n(106),b=n(2),C=n(18),m="WAC_Outlook_React";function h(e,t,n,a,i,o){var c,d=0,u=Object(C.a)(),l=u.UserOptions.MailboxTimeZoneOffset;l&&l.length>0&&l[0].OffsetRanges&&l[0].OffsetRanges.length>0&&(d=l[0].OffsetRanges[0].Offset,c=l[0].TimeZoneId);var p=u.SessionSettings.UserCulture,f={clientType:m,eventName:e,culture:p,uiCulture:p,mailboxType:n?"Group":"User",correlationVector:i||Object(g.getCorrelationVector)(),clientVersion:Object(b.g)(),externalDirectoryUserGuid:u.SessionSettings.ExternalDirectoryUserGuid,externalDirectoryTenantGuid:u.SessionSettings.ExternalDirectoryTenantGuid,timeZone:{type:"Windows",id:c,offsetInMinutes:d},originator:t.card.originator,providerAccountUniqueId:t.providerAccountUniqueId,messageType:t.isAdaptiveCard?r.AdaptiveCard.toString():r.ExplicitMessageCard.toString(),messageCardExtensionContext:t.messageCardExtensionContext,messageCardContext:t.card.messageCardContext,genericInfo:o};if(a){var h=function(e,t){var n={};e&&(n.senderAddress=e.senderAddress,n.isGroupEscalationMessage=e.isGroupEscalationMessage,t?(n.threadId=e.conversationId,n.conversationId=n.conversationId,n.postId=e.itemId,n.messageId=n.itemId):(n.messageId=e.itemId,n.conversationId=e.conversationId));return n}(a,n);f=Object(s.__assign)(Object(s.__assign)({},f),h)}return f}var v=n(193),y=n(78),O=n(4790),A=n(8423),I=n(8424),M=n(36),S="30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",j="HttpPOST",x="userid",T="/actions/{0}/messages/{1}/executeAction?culture={2}",k="/actions/{0}/messages/{1}/adaptiveCard/executeAction?culture={2}",w="/actions/{0}/threads/{1}/posts/{2}/executeAction?culture={3}",E="/actions/{0}/threads/{1}/posts/{2}/adaptiveCard/executeAction?culture={3}",D="InlineAdaptiveCard",_="ActionCardHttpPostActionClicked",R="SingleClickHttpPostActionClicked",P="AutoInvokeActionClicked";function N(e,t,n,r,a){var i=e["@id"]?e["@id"]:e.id,d={"@type":j,name:e.title,target:e.url,body:e.body,"@id":i,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(d.headers=e.headers);var u=Object(C.a)(),p=[];if(t)for(var f=0;f<t.length;f++){var g=t[f],b=new c.ValidationResults;if(g.internalValidateProperties(b),b.failures.length>0)return Promise.resolve({success:!1,displayMessage:b.failures[0].errors[0].message});if(g){var m=void 0;m=g instanceof c.DateInput?{id:g.id,value:g.value,usertimezone:u.UserOptions.TimeZone}:{id:g.id,value:g.value},p.push(m)}}var v,O={type:l,url:e.url,body:e.body,method:e.method,id:e.id?e.id:S,headers:e.headers},A=u.SessionSettings.UserCulture,I=h(function(e,t){if(t)return P;if(e.parent){var n=e.parent.constructor;return D===n.name?_:R}return R}(e,a),n,r.mailboxInfo.type===y.a.GroupMailbox,r);return I.actionId=i,I.actionType=e.type,n.isAdaptiveCard?v={httpAction:O,inputParameters:p,connectorSenderGuid:n.connectorSenderGuid,SmtpAddressesSerialized:n.smtpAddressesSerialized,adaptiveCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:I,adaptiveCardHash:n.cardHash,senderAddress:r.senderAddress}:(d=Object(s.__assign)(Object(s.__assign)({},e.originalJsonPayload),d),v={inputParameters:p,connectorSenderGuid:n.connectorSenderGuid,potentialAction:JSON.stringify(d),SmtpAddressesSerialized:n.smtpAddressesSerialized,messageCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:I,tenantObjectId:u.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:n.cardHash,senderAddress:r.senderAddress,culture:A,uiCulture:A}),L(function(e,t,n){var r=e.mailboxInfo.type===y.a.UserMailbox?x:e.mailboxInfo.deprecatedMailboxId,a=e.odataItemId,i=e.odataConversationId;switch(e.mailboxInfo.type){case y.a.UserMailbox:return n?Object(o.b)(k,r,a,t):Object(o.b)(T,r,a,t);case y.a.GroupMailbox:case y.a.TeamsMailbox:return n?Object(o.b)(E,r,i,a,t):Object(o.b)(w,r,i,a,t)}}(r,A,n.isAdaptiveCard),JSON.stringify(v),"HttpAction",null,function(e){try{return e.card.messageCardContext.correlationId}catch(e){return""}}(n))}function L(e,t,n,r,a){return new Promise((function(s){var c=r||Object(g.getCorrelationVector)(),d={correlationVector:c,cardCorrelationId:a,requestType:n};Object(O.a)().then((function(n){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&s(function(e,t){try{var n=JSON.parse(t),r=!!e&&((a=n.status)&&"completed"===a.toLowerCase());return{success:r,displayMessage:n.displayMessage?n.displayMessage:r?Object(o.a)(I.a):Object(o.a)(A.a),performedAt:n.performedAt,newCardPayload:n.refreshCardSerialized,newCardSignature:n.refreshCardSignature,removeCard:n.removeCard,showOriginalCard:n.showOriginalCard,hideCard:n.hideCard}}catch(e){return{success:!1,displayMessage:Object(o.a)(A.a)}}var a}(200===r.status,r.responseText))},r.ontimeout=function(){s({success:!1,displayMessage:Object(o.a)(u.a)}),Object(v.m)("ActionableMessageConnectorsPostRequestTimeout",void 0,void 0,void 0,d)},r.open("POST",e,!0),r.timeout=15e3,r.setRequestHeader("MS-CV",c),r.setRequestHeader("X-OWA-CANARY",Object(M.getOwaCanaryCookie)()),r.setRequestHeader("Authorization","Bearer "+n),r.send(t)})).catch((function(e){i.d.info("Error getting auth token: "+e),s({success:!1,displayMessage:Object(o.a)(A.a)}),Object(v.m)("ActionableMessageConnectorsPostRequestErrorGettingToken",void 0,void 0,e,d)}))}))}var U="actionContext",F="AutoInvokeAction",H="{0}Clicked";var B=n(5);function z(e){var t=Object(B.w)(e.currentCardCheckpoints.cardRenderEnd,e.loadStart),n=Object(B.w)(e.currentCardCheckpoints.cardCreateEnd,e.currentCardCheckpoints.cardCreateStart),r=e.initialCardCheckpoints?Object(B.w)(e.initialCardCheckpoints.cardCreateEnd,e.initialCardCheckpoints.cardCreateStart):0,a=Object(B.w)(e.currentCardCheckpoints.cardRenderEnd,e.currentCardCheckpoints.cardRenderStart),i=e.initialCardCheckpoints?Object(B.w)(e.initialCardCheckpoints.cardRenderEnd,e.initialCardCheckpoints.cardRenderStart):0,o=Object(B.w)(e.autoInvokeActionEnd,e.autoInvokeActionStart),s=Object(B.w)(e.currentCardCheckpoints.themeLoadTotalEnd,e.currentCardCheckpoints.themeLoadTotalStart),c=e.initialCardCheckpoints?Object(B.w)(e.initialCardCheckpoints.themeLoadTotalEnd,e.initialCardCheckpoints.themeLoadTotalStart):0,d=e.currentCardCheckpoints.totalFetchTime,u=e.initialCardCheckpoints?e.initialCardCheckpoints.totalFetchTime:0,l=Object(B.w)(e.currentCardCheckpoints.cardLibraryRenderEnd,e.currentCardCheckpoints.cardLibraryRenderStart),p=e.initialCardCheckpoints?Object(B.w)(e.initialCardCheckpoints.cardLibraryRenderEnd,e.initialCardCheckpoints.cardLibraryRenderStart):0,f=Object(B.w)(e.currentCardCheckpoints.prepareCardEnd,e.currentCardCheckpoints.prepareCardStart),g=e.initialCardCheckpoints?Object(B.w)(e.initialCardCheckpoints.prepareCardEnd,e.initialCardCheckpoints.prepareCardStart):0,b=[];return b.TCRT=t,b.FCRT=a,b.ICRT=i,b.FCPT=n,b.AIT=o,b.ICRT=r,b.FCTT=s,b.ICTT=c,b.FCFT=d,b.ICFT=u,b.FCHT=l,b.ICHT=p,b.FCPT=f,b.ICPT=g,function(e){var t="[";return Object.keys(e).forEach((function(n,r){0!==r&&(t+=", "),t+='"'+n+'": "'+e[n]+'"'})),t+="]"}(b)}var J="/actions/{0}/clientTelemetry/",W="mailboxId";function G(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,L(t?Object(o.b)(J,t):Object(o.b)(J,W),JSON.stringify(e),"Telemetry",e.correlationVector)];case 1:return n.sent(),[2]}}))}))}function q(e){var t=new d(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach((function(e){t.headers.push(new c.HttpHeader(e.name,e.value))}))),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}var V=n(37),Y=n(208);var Q,Z,K=n(11),X=function(){return!!Object(K.b)(window)&&!!Object(K.a)(window,"ActionableMessages.ClientConfiguration")},$=n(4);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(Q||(Q={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(Z||(Z={}));var ee={cache:{data:null,state:Z.Empty,time:null},requestState:Q.UnResolved},te=Object($.createStore)("amClientConfigurationStore",ee)(),ne=function(){return te.cache.state!==Z.Empty},re=function(){var e=Date.now()-te.cache.time;return te.cache.state===Z.Success&&e>=432e6||te.cache.state===Z.Error&&e>=864e5},ae=Object($.mutatorAction)("updateRequestState",(function(e){te.requestState=e})),ie=function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),e="/actions/v1.0/"+Object(y.d)()+"/clientConfigs/WAC_Outlook_React?clientVersion="+Object(b.g)()+"&clientColorScheme=default&$expand=providerConfigs",[4,Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return e=new Headers,[4,Object(O.a)()];case 1:return t=n.sent(),e.set("Authorization",function(e){return"Bearer "+e}(t)),e.set("MS-CV",Object(g.getCorrelationVector)()),[2,e]}}))}))];case 1:return t=a.sent(),n=new Request(e,{method:"GET",headers:t}),[4,fetch(n)];case 2:return(r=a.sent()).ok?[4,r.json()]:[3,4];case 3:return[2,a.sent()];case 4:throw r;case 5:return[3,7];case 6:throw a.sent();case 7:return[2]}}))}))},oe=Object($.mutatorAction)("setClientConfiguration",(function(e){te.cache=e})),se=function(e,t){return{data:e,state:t,time:Date.now()}},ce=Object($.action)("loadClientConfiguration");Object($.orchestrator)(ce,(function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:ae(Q.InProgress),e=null,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,ie()];case 2:return t=n.sent(),e=se(t,Z.Success),[3,5];case 3:return n.sent(),e=se(null,Z.Error),[3,5];case 4:return oe(e),function(e){if(Object(K.b)(window))try{Object(K.d)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){i.d.info("[MessageCardDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),ae(Q.Resolved),[7];case 5:return[2]}}))}))}));var de=ce,ue=function(){te.requestState!==Q.InProgress&&de()},le=function(){return X()?JSON.parse(Object(K.a)(window,"ActionableMessages.ClientConfiguration")):null},pe=function(){return te.cache.state},fe=function(){return ne()?(re()&&ue(),pe()===Z.Success):X()?(oe(le()),ae(Q.Resolved),re()&&ue(),pe()===Z.Success):(ue(),!1)},ge=function(){return te.cache},be=function(){var e,t,n=!1;if(fe()){var r=ge();(null===(t=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(n=!0)}return n},Ce="data:",me="blob:";function he(e,t){var n=e.querySelectorAll('img:not([src^="cid:"])');if(n)for(var r=0;r<n.length;r++)0!==n[r].src.indexOf(Ce)&&0!==n[r].src.indexOf(me)&&ve(n[r],t.deprecatedMailboxId)}function ve(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(O.b)()];case 1:return r.sent(),e.src="/actions/"+t+"/th?u="+encodeURIComponent(e.src),[3,3];case 2:return n=r.sent(),i.d.warn("[fixSrcForExternalImage] Error setting src value. Exception: "+n.message),[3,3];case 3:return[2]}}))}))}var ye="20000101001",Oe=window.location.origin+"/actions/theme";function Ae(e){return void 0===e&&(e="default"),Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,i,o;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,Object(O.b)()];case 1:t=s.sent(),n=function(e,t){var n={},r=Object(b.g)()?Object(b.g)():ye;return r=r.replace(/[^\d]/g,""),n.method="GET",n.headers=new Headers,n.headers.set("X-ClientType","owa"),n.headers.set("X-ClientVersion","16."+r.substr(0,4)+"."+r.substr(4,4)+"."+r.substr(8)),n.headers.set("X-ClientColorScheme",t),n.headers.set("Authorization","Bearer "+e),n}(t,e),r=void 0,s.label=2;case 2:return s.trys.push([2,7,,8]),[4,fetch(Oe,n)];case 3:return(a=s.sent())&&200==a.status?(i=Ie,[4,a.text()]):[3,5];case 4:return[2,i.apply(void 0,[s.sent()])];case 5:r=a?a.status+"-"+a.statusText:"No response",s.label=6;case 6:return[3,8];case 7:return o=s.sent(),r=o.message,[3,8];case 8:throw r}}))}))}function Ie(e){var t={};try{var n=JSON.parse(e).connectors;Object.keys(n).forEach((function(e){var r={themeConfigUrl:n[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};t[e]=r}))}catch(e){i.d.warn("downloadThemeDefinition: error parsing response: "+e)}return t}var Me={logTelemetry:function(e){var t,n=e.mailboxInfo,r=e.eventName,a=e.cardDetails,o=e.messageContext,s=e.correlationVector,c=e.actionContext,d=e.perfCheckpoints,u=n.type===y.a.GroupMailbox;if(d)try{t=z(d)}catch(e){i.d.warn("Actionable Message Cards: exception when calculating genericInfo datapoint: "+e.message)}var l=h(r,a,u,o,s,t);return l.connectorSenderGuid=a.connectorSenderGuid,c&&(l.actionContext=c),Object(v.o)("AdaptiveCardLogger-"+r,{CorrelationVector:s}),G(l,u?n.deprecatedMailboxId:null),i.d.info("[logTelemetry] Log telemetry triggered"),l.correlationVector}},Se={registerActions:function(){c.AdaptiveCard.actionTypeRegistry.unregisterType(f),c.AdaptiveCard.actionTypeRegistry.registerType(l,(function(){return new d(!1)}))},executeAction:function(e,t,n,r,a,s,c){var u={mailboxInfo:a.mailboxInfo,messageContext:a,actionContext:e[U],cardDetails:t,eventName:Object(o.b)(H,c?F:e.getJsonTypeName())};return e instanceof d&&(s.logTelemetry(u),N(e,n,t,a,c).then((function(e){i.d.info("[ActionableMessageCard] onExecuteAction: executeHttpAction response: "+e),r(e)})),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return q(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===l||e["@type"]===p){var n=void 0;return t.isAdaptiveCard?((n=new d(!1)).parse(e),n.hideCardOnInvoke=e.hideCardOnInvoke):n=q(e),n}return null},registerHostCapabilities:function(e){Object(V.f)("rp-actionableMessages-aad-token")&&!Object(Y.a)()&&(e.AADAuthentication="*")}},je="CardLinkInteraction";function xe(e,t,n,r){i.d.info("[logAdaptiveCardLinkInteraction] Log event captured for link interaction on an adaptive card");var o=Object(a.d)(n);n.card&&o?Me.logTelemetry({mailboxInfo:t,cardDetails:n,eventName:je+"_"+o,messageContext:r}):i.d.warn("[logAdaptiveCardLinkInteraction] Cannot log link interaction - message card context is undefined")}var Te=n(3043),ke=n(8425),we=Object($.mutatorAction)("setCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails=t})),Ee=n(2570),De="00000000-0000-0000-0000-000000000000",_e="Highlight_";function Re(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,c,d,u,l,p;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:try{t=JSON.parse(e)}catch(t){throw new Error("[ActionableMessageCard] parseCardProperty: unable to parse card data: "+e)}return n={connectorSenderGuid:t.ConnectorSenderGuid?t.ConnectorSenderGuid:De,smtpAddressesSerialized:t.SmtpAddressesSerialized,providerAccountUniqueId:t.ProviderAccountUniqueId,messageCardExtensionContext:t.MessageCardExtensionContext},r=[],t.AdaptiveCardSerialized?(c=(o=r).push,[4,a.e.import().then((function(e){return e(n,t.AdaptiveCardSerialized,t.AdaptiveCardSignature,!0)}))]):[3,2];case 1:return c.apply(o,[s.sent()]),[3,5];case 2:return t.MessageCardSerialized?(u=(d=r).push,[4,a.e.import().then((function(e){return e(n,t.MessageCardSerialized,t.MessageCardSignature,!1)}))]):[3,4];case 3:return u.apply(d,[s.sent()]),[3,5];case 4:return i.d.info("[ActionableMessageCard] parseCardProperty: No serialized card present"),[2,[]];case 5:return p=(l=r).concat,[4,Pe(t,n)];case 6:return[2,p.apply(l,[s.sent()])]}}))}))}function Pe(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return n=[],[4,Promise.all(Object.keys(e).map((function(o){return Object(s.__awaiter)(r,void 0,void 0,(function(){var r,c,d,u;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:if(!e.hasOwnProperty(o)||0!==o.indexOf(_e))return[3,4];r=e[o],s.label=1;case 1:return s.trys.push([1,3,,4]),c=JSON.parse(r),[4,a.e.import().then((function(e){return e(t,c.card,null)}))];case 2:return(d=s.sent()).isContextual=!0,d.key=c.id,d.highlightTerm=c.text,n.push(d),[3,4];case 3:return u=s.sent(),i.d.warn("[ActionableMessageCard] RenderCard: unable to render hightlight card: "+u.message),[3,4];case 4:return[2]}}))}))})))];case 1:return o.sent(),[2,n]}}))}))}function Ne(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,Le(e)];case 1:return t=n.sent()||[],e.adaptiveCardDetails&&0!==e.adaptiveCardDetails.length?i.d.info("[MessageCardDebug] initCardDetailsOnItem: not replacing existing details"):(i.d.info("[MessageCardDebug] initCardDetailsOnItem: setting card details on item"),we(e,t)),[2]}}))}))}function Le(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Te.c.import()];case 2:return[4,r.sent()(e.ItemId.Id,ke.c)];case 3:return t=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return t?(n=Object(Ee.a)(t,null,ke.a))?[4,Re(n)]:[3,7]:[3,8];case 6:return[2,r.sent()];case 7:return i.d.info("[loadCardDetailsForItem] extendedProperty could not be retrieved"),[2,null];case 8:return[2,null]}}))}))}function Ue(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return e.adaptiveCardDetails?[2,e.adaptiveCardDetails]:[4,Ne(e)];case 1:return t.sent(),[2,e.adaptiveCardDetails]}}))}))}var Fe=n(25),He=Object($.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:i.d.warn("[setShowBodyWithMessageCard] viewState undefined")})),Be=Object($.action)("showCardLoading",(function(e,t){return{viewState:e,showCardLoading:t}})),ze=(Object($.mutator)(Be,(function(e){e.viewState.showCardLoading=e.showCardLoading})),n(1484)),Je=n(857),We="cid:",Ge=/url\("(.*)"\)/g,qe='url("{0}")',Ve='img[src^="cid:"]',Ye="div[style*='background-image: url(\"cid:']";function Qe(e,t,n){var r=e.querySelectorAll(Ve);if(r)for(var a=0;a<r.length;a++)Ze(r[a],t,n);var i=e.querySelectorAll(Ye);if(i)for(a=0;a<i.length;a++)Ke(i[a],t,n)}function Ze(e,t,n){if(e.src&&0===e.src.indexOf(We)){var r=Xe(e.src,t,n);r&&(e.src=r)}}function Ke(e,t,n){var r=e.style.backgroundImage,a=Ge.exec(r);if(a&&a.length>1&&a[1]){var i=Xe(a[1],t,n);i&&(e.style.backgroundImage=Object(o.b)(qe,i))}}function Xe(e,t,n){if(!t.Attachments)return null;for(var r,a=$e(e.substring(We.length)),o=0;o<t.Attachments.length;o++){var c=t.Attachments[o];if(a===$e(c.Name)||a===$e(c.ContentId)){r=c.AttachmentId;break}}if(!r)return i.d.error("fixSrcForImage: attachment id not found for cid: "+a),null;var d=Object(ze.b)(Object(s.__assign)(Object(s.__assign)({},r),{mailboxInfo:n}),1);return d||(i.d.error("fixSrcForImage: could not create attachment url for image with cid: "+a+" and attachment id: "+r),null)}function $e(e){if(Object(Je.f)(e)){var t=Object(Je.b)(e);return e.substring(0,e.length-t.length)}return e}var et=n(6908),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayAppointmentForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(c.Action),nt="Action.InvokeAddInCommand",rt="Action.DisplayReplyAllForm",at="Action.DisplayAppointmentForm",it="Action.DisplayMessageForm",ot="Action.StartBotConversation",st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return it},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(c.Action),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayReplyAllForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(c.Action),dt=function(e){function t(){var t=e.call(this)||this;return t.addinId="",t.desktopCommandId="",t.initializationContext="",t}return Object(s.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.addinId=t.addInId?t.addInId:t.addinid,this.desktopCommandId=t.desktopCommandId?t.desktopCommandId:t.desktopcommandid,this.initializationContext=t.initializationContext?JSON.stringify(t.initializationContext):JSON.stringify(t.initializationcontext)},t.prototype.getJsonTypeName=function(){return nt},t}(c.Action),ut=function(e){function t(){var t=e.call(this)||this;return t.botId="",t.initialMessage="",t.botName="",t}return Object(s.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.botId=t.botId,this.botName=t.botName,this.initialMessage=t.initialMessage},t.prototype.getJsonTypeName=function(){return ot},t}(c.Action),lt=n(909),pt=n(960),ft=n(8404),gt=n(1030),bt=n(2943),Ct=n(5666),mt=n(1385),ht="MessageCardInvokeAddinCommandClicked",vt="DisplayAppointmentFormClicked",yt="DisplayMessageFormClicked",Ot="actionContext";var At={registerActions:function(){c.AdaptiveCard.actionTypeRegistry.registerType(nt,(function(){return new dt})),c.AdaptiveCard.actionTypeRegistry.registerType(rt,(function(){return new ct})),c.AdaptiveCard.actionTypeRegistry.registerType(at,(function(){return new tt})),c.AdaptiveCard.actionTypeRegistry.registerType(it,(function(){return new st})),Object(V.f)("mc-botConversation")&&c.AdaptiveCard.actionTypeRegistry.registerType(ot,(function(){return new ut}))},executeAction:function(e,t,n,r,a,o,s){var d={mailboxInfo:a.mailboxInfo,cardDetails:t,messageContext:a,actionContext:e[Ot],eventName:void 0};if(e instanceof ct){i.d.info("[ActionableMessageCard] onExecuteAction: reply all with: "+e.title);var u=mt.HtmlSanitizer.sanitizeHtml(e.title);gt.t.importAndExecute({referenceItemId:{Id:a.itemId,mailboxInfo:a.mailboxInfo},isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:a.conversationId,body:u})}else if(e instanceof tt){i.d.info("[ActionableMessageCard] onExecuteAction: display appointment form for itemId: "+e.itemId),d.eventName=vt,o.logTelemetry(d);var l="/calendar/item/"+encodeURIComponent(e.itemId);window.open(l,"_blank")}else if(e instanceof st)i.d.info("[AdaptiveCard] DisplayMessageFormAction executed"),d.eventName=yt,o.logTelemetry(d),Object(bt.a)(e.itemId);else if(e instanceof dt){i.d.info("[AdaptiveCard] InvokeAddinCommandAction executed"),d.eventName=ht,o.logTelemetry(d);var p=e,f=Object(lt.q)(a.itemId);lt.y.import().then((function(e){e(f,p.addinId.toLowerCase(),p.desktopCommandId,pt.a.MessageRead,p.initializationContext)}))}else if(e instanceof ut){var g=e,b=g.botId,C=g.botName,m=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);i.d.info("[ActionableMessageCard] StartBotConversation executed with message: "+b),ft.a.import().then((function(e){return e(a.mailboxInfo,{friendlyBotName:C,botId:b,botData:m,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")})),o.logTelemetry(d)}else{if(!(e instanceof c.OpenUrlAction))return!1;if("mailto:"===(l=new URL(e.url)).protocol.toLowerCase()){var h=Object(Ct.a)(l.href).composeInitProps;gt.r.importAndExecute(h,2)}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return n=e,(r=new ct).title=n.name,r.htmlBody=n.htmlBody,r;case"invokeaddincommand":return function(e){var t=new dt;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e)}var n,r;return null},processAutoInvokeAction:function(e,t){if(Object(V.f)("mc-botConversation")&&e.type===ot){var n=new ut;return n.parse(e),n}return null},registerHostCapabilities:null},It=n(519),Mt=n(12881),St=n(12882),jt=n(12883),xt=n(245);var Tt,kt=n(1),wt=n(12884),Et=n(4081),Dt=n(51),_t=n(1016),Rt=n(2041),Pt="ActionableMessageTeachingUI",Nt=""+Pt,Lt={CLICK:Nt+"_BtnClicked",GOTITCUSTOM:Nt+"_GotItClicked",LEARN:Nt+"_LearnMoreClicked",TRIGGERED:Nt+"_Triggered",DISMISSED:{BTNSCT:Nt+"_DismisByAction",UNMNT:Nt+"_DismissByUnmount"},SCOPE:{MOUNTED:Nt+"_Mounted",UNMNTED:Nt+"_Unmounted"},DISABLED:Nt+"_FlightDisabled",RENDERED:Nt+"_Rendered"},Ut={Transaction:"https://support.office.com/en-us/article/pay-bills-and-invoices-in-outlook-using-microsoft-pay-1196e7e6-c096-44f1-a18a-9df3af832a48"};function Ft(e,t){Object(v.o)(e,t),G(Object(s.__assign)({eventName:e,clientVersion:t.owaVersion,clientType:"WAC_Outlook_React"},t),null)}function Ht(e){if(e)try{i.d.info("[ActionableMessageTeachingUI] Corelation telemetry trace function called"),function(e){Tt=Tt||{correlationVector:"",adaptiveCardCorrelationId:"",owaVersion:"",messageId:"",lightningAction:"",tuiType:""},Object(Rt.a)(Tt,e)}(e)}catch(e){i.d.warn("[ActionableMessageTeachingUI] Failed complete the logging of the telemetry - "+e.message)}return Tt&&(Tt.correlationVector=Tt?Object(g.getCorrelationVector)():void 0),Tt}var Bt=Object(_t.c)(Object(Fe.a)((function(e){e=Object(s.__assign)({hasSmallIcon:!0,hasSmallHeadline:!0,hasCloseIcon:!0,isWide:!0},e);var t=Object(s.__read)(kt.useState(!0),2),n=t[0],r=t[1];kt.useEffect((function(){return i.d.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble DidMount"),Ft("TeachingBubble_"+Lt.SCOPE.MOUNTED,Ht()),function(){i.d.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble WillUnmountMount"),Ft("TeachingBubble_"+Lt.SCOPE.UNMNTED,Ht())}}),[]);var a=function(t){void 0===t&&(t="Primary"),"Secondary"==t?(i.d.info("[ActionableMessageTeachingUI:TeachingBubble] teacing bubble dismissed by user interaction"),Ft("TeachingBubble_"+Lt.CLICK,Ht({lightningAction:t}))):(i.d.info("[ActionableMessageTeachingUI:TeachingBubble] teaching bubble passively dismissed"),Ft("TeachingBubble_"+Lt.DISMISSED.UNMNT,Ht({lightningAction:t}))),Object(_t.d)(e.lid,t),r(!1)};return n&&(i.d.info("[ActionableMessageTeachingUI:TeachingBubble] Using TeachingBubble for ActionableMessageTeachingUI"),Ft("TeachingBubble_"+Lt.RENDERED,Ht())),n&&kt.createElement(Et.a,Object(s.__assign)({calloutProps:{beakWidth:15,directionalHint:Dt.DirectionalHint.leftCenter,minPagePadding:50},targetElement:e.target(),primaryButtonProps:Object(s.__assign)(Object(s.__assign)({},e.gotItBtn),{onClick:function(){Ft("TeachingBubble_"+Lt.GOTITCUSTOM,Ht({lightningAction:"Secondary"})),a("Secondary")}}),secondaryButtonProps:Object(s.__assign)(Object(s.__assign)({},e.learnMoreBtn),{onClick:function(){Ft("TeachingBubble_"+Lt.LEARN,Ht({lightningAction:"Secondary"})),window.open(e.learnMoreBtnUri,"_blank"),a("Secondary")}}),onDismiss:function(){return e.onClose||a("Primary")}},e,{target:void 0}),e.bodyText)}))),zt=n(2102),Jt=(n(199),Object(Fe.a)((function(e){kt.useEffect((function(){var t;t={adaptiveCardCorrelationId:e.acCorrelationId,messageId:e.messageId,tuiType:e.actionType},Nt=Pt+"_",Ht({adaptiveCardCorrelationId:t.adaptiveCardCorrelationId,messageId:t.messageId,owaVersion:Object(b.g)(),lightningAction:"",tuiType:t.tuiType})}),[]);var t;return"Transaction"==e.actionType&&kt.createElement(Bt,{target:e.target,when:function(e){Ft(Lt.TRIGGERED,Ht()),e()},gotItBtn:(t="TeachingBubble",{buttonType:zt.a.primary,children:Object(o.a)(wt.a),onClick:t}),learnMoreBtn:Wt("TeachingBubble"),learnMoreBtnUri:Ut[e.actionType]||void 0,headline:Object(o.a)(wt.d),bodyText:Object(o.a)(wt.c),hasSmallHeadline:!0,lid:_t.b.ActionableMessageTeachingUiTeachingBubblePolicy})})));function Wt(e){return{buttonType:zt.a.normal,children:Object(o.a)(wt.b),onClick:e}}var Gt=n(5558),qt=n(9281),Vt=(Object($.mutator)(qt.a,(function(e){var t=Gt.a.cards.get(e.cardId);t&&(t.autoInvokeActionAlreadyRan=e.autoInvokeActionAlreadyRan)})),n(73)),Yt={XeroOpay:"Transaction"};function Qt(e){var t,n,r,a=void 0;if(i.d.info("[getCardTypeFromCardDetails] Fetching the card type"),null===(t=e.card)||void 0===t?void 0:t.messageCardContext){var o=e.card.messageCardContext;n=o.oamAppName,(r=Yt[n])||i.d.warn("[getCardType] Unable to fetch cardType for OamAppName "+n),a=r||"Unknown"}else i.d.warn("[getCardTypeFromCardDetails] Cannot extract the context of an invalid CardDetails object");return a}var Zt=n(9282);var Kt=function(){function e(e,t,n,r){this.perfCheckpoints={currentCardCheckpoints:{},initialCardCheckpoints:{}},this.telemetryProvider=e,this.mailboxInfo=t,this.messageContext=n,this.perfData=r}return e.prototype.stampPerfCheckpoint=function(e,t){!function(e,t,n){var r=n||Object(B.Qb)();switch(t){case Zt.a.LoadStart:e.loadStart=r;break;case Zt.a.AutoInvokeActionStart:e.autoInvokeActionStart=r;break;case Zt.a.AutoInvokeActionEnd:e.autoInvokeActionEnd=r;break;case Zt.a.CardRenderStart:e.currentCardCheckpoints.cardRenderStart=r;break;case Zt.a.CardRenderEnd:e.currentCardCheckpoints.cardRenderEnd=r;break;case Zt.a.ThemeLoadTotalStart:e.currentCardCheckpoints.themeLoadTotalStart=r;break;case Zt.a.ThemeLoadTotalEnd:e.currentCardCheckpoints.themeLoadTotalEnd=r;break;case Zt.a.ThemeDefinitionsLoadStart:e.currentCardCheckpoints.themeDefinitionsLoadStart=r;break;case Zt.a.ThemeDefinitionsLoadEnd:e.currentCardCheckpoints.themeDefinitionsLoadEnd=r;break;case Zt.a.ThemeResolveStart:e.currentCardCheckpoints.themeResolveStart=r;break;case Zt.a.ThemeResolveEnd:e.currentCardCheckpoints.themeResolveEnd=r;break;case Zt.a.CardCreateStart:e.currentCardCheckpoints.cardCreateStart=r;break;case Zt.a.CardCreateEnd:e.currentCardCheckpoints.cardCreateEnd=r;break;case Zt.a.CardLibraryRenderStart:e.currentCardCheckpoints.cardLibraryRenderStart=r;break;case Zt.a.CardLibraryRenderEnd:e.currentCardCheckpoints.cardLibraryRenderEnd=r;break;case Zt.a.PrepareCardStart:e.currentCardCheckpoints.prepareCardStart=r;break;case Zt.a.PrepareCardEnd:e.currentCardCheckpoints.prepareCardEnd=r;break;default:i.d.info("Actionable Message Card: markPerfCheckpointMutator called with unespected PerfMarker")}}(this.perfCheckpoints,e,t)},e.prototype.logTelemetryProvider=function(e,t,n,r){var a=this.getTelemetryDetailsForEvent(e,t,n,r);this.telemetryProvider.logTelemetry(a)},e.prototype.setTotalFetchTimeForCard=function(){this.perfCheckpoints&&this.perfCheckpoints.currentCardCheckpoints&&(this.perfCheckpoints.currentCardCheckpoints.totalFetchTime=Object(B.w)(this.perfData.fetchEndTime,this.perfData.fetchStartTime))},e.prototype.getTelemetryDetailsForEvent=function(e,t,n,r){return{mailboxInfo:this.mailboxInfo,messageContext:this.messageContext,cardDetails:e,eventName:t,actionContext:n,correlationVector:r,perfCheckpoints:this.perfCheckpoints}},e.prototype.updatePerfCheckpointsBeforeAutoInvoke=function(){this.perfCheckpoints&&(this.perfCheckpoints.initialCardCheckpoints=this.perfCheckpoints.currentCardCheckpoints,this.perfCheckpoints.currentCardCheckpoints={})},e}();n(452);var Xt=new Vt.c((function(){return Promise.all([n.e(6),n.e(8),n.e(19),n.e(26),n.e(99)]).then(n.bind(null,13833))})),$t=Object(Vt.d)(Xt,(function(e){return e.ActionableMessageCardWrapper})),en=(new Vt.b(Xt,(function(e){return e.parseCardFromStringOrObject})),"TransactionCardDisabled"),tn="messageCardContext";function nn(e,t,n,r,i){var o=e.card;if(o&&o.hasOwnProperty(tn)){if(!o.messageCardContext)return!1;var s=Object(a.d)(e)===a.b.XeroOpay&&n;return s&&i.logTelemetry({mailboxInfo:t,messageContext:r,eventName:en,cardDetails:e}),s}return!1}var rn="Action.Transaction",an=n(1232),on=n(71),sn=n(12885),cn={PPE:"https://interactive-ppe.outlook.com/ux/app",PROD:"https://interactive.outlook.com/ux/app",DEV:"https://opay-dev-wc-svc.cloudapp.net/ux/app"},dn=function(e){function t(){var t=e.call(this)||this;return t.environment="prod",t.triggerContext=null,t.intent="",t.merchantId="",t.displayId="",t}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return rn},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,t.initializationContext?(this.intent=t.initializationContext.intent,this.merchantId=t.initializationContext.merchantId,this.displayId=t.initializationContext.displayId,this.productContext=t.initializationContext.productContext,this.environment=t.initializationContext.environment):(this.intent=t.intent,this.merchantId=t.merchantId,this.displayId=t.displayId,this.productContext=t.productContext,this.environment=t.environment),this.triggerContext={MerchantId:this.merchantId,DisplayId:this.displayId,CorrelationId:Object(g.getCorrelationVector)(),Culture:Object(C.a)().SessionSettings.UserCulture,Market:Object(an.g)(),Environment:this.environment},on.set("DefaultAnchorMailbox",on.get("DefaultAnchorMailbox"),{path:"/actions/"}),Object(V.f)("ring-dogfood")&&on.set("DefaultAnchorMailbox",on.get("DefaultAnchorMailbox"),{path:"/opay/"})},t.prototype.execute=function(){e.prototype.execute.call(this),this.triggerContext.CorrelationId=Object(g.getCorrelationVector)()},t.prototype.getIFrameElement=function(){var e=Object(V.f)("rp-opay-modelb-endpoint")?window.location.origin+"/opay":this.getSvcEndpoint(),t=encodeURIComponent(JSON.stringify(this.productContext)),n=e+"/?triggerContext="+encodeURIComponent(JSON.stringify(this.triggerContext))+"&productContext="+t;return kt.createElement("div",{className:sn.opayFlexPaneContainer},kt.createElement("iframe",{id:"opay_iframe",className:sn.opayAppIFrameStyle,src:n}))},t.prototype.getSvcEndpoint=function(){return this.environment?0===this.environment.indexOf("dev")?cn.DEV:"ppe"===this.environment.toLowerCase()?cn.PPE:cn.PROD:cn.PROD},t}(c.Action),un={shouldShowModalFlexPane:!1,modalFlexPaneContent:void 0},ln=Object($.createStore)("OPayPanel",un)(),pn=Object($.mutatorAction)("SHOW_OPAY_PANEL",(function(e){ln.shouldShowModalFlexPane=!0,ln.modalFlexPaneContent=e})),fn="MessageCardInvokeOPayClicked",gn="actionContext";var bn={registerActions:function(){c.AdaptiveCard.actionTypeRegistry.registerType(rn,(function(){return new dn}))},executeAction:function(e,t,n,r,a,o,s){if(!(e instanceof dn))return!1;i.d.info("[AdaptiveCard] Transaction executed");var c=e;return o.logTelemetry({mailboxInfo:a.mailboxInfo,cardDetails:t,eventName:fn,actionContext:e[gn],messageContext:a,correlationVector:c.triggerContext.CorrelationId}),pn(c.getIFrameElement()),!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"Transaction":return n=e,(r=new dn).parse(n),r.title=n.name,r}var n,r;return null},registerHostCapabilities:function(e){e.Transaction="*",e["Transaction.MSA"]="*"}},Cn=n(2200),mn=n(816),hn=n(179),vn=n(1167),yn=Object($.mutatorAction)("HIDE_OPAY_PANEL",(function(){ln.shouldShowModalFlexPane=!1,ln.modalFlexPaneContent=void 0})),On=Object(Fe.a)((function(e){return Object(vn.a)("message",(function(t){var n=t.origin.toLowerCase();if(Object.keys(cn).some((function(e){return 0!==cn[e].indexOf(n)}))){var r=null;try{r=JSON.parse(t.data)}catch(e){i.d.warn("Unable to parse post message data: "+t.data)}if(r){var a=r.action;if(a)switch(a){case"close":yn();break;case"token":Object(O.a)().then((function(t){var r=document.querySelector("#opay_iframe");r&&r.contentWindow.postMessage(JSON.stringify({action:"token",token:t,messageContext:{messageId:e.odataItemId,smtpAddressesSerialized:e.smtpAddressesSerialized},result:"Success"}),n)})).catch((function(){window.postMessage(JSON.stringify({action:"token",result:"Failed"}),n)}))}}}})),kt.createElement(mn.a,{key:"modalFlexPane",onDismiss:function(){yn()},isOpen:ln.shouldShowModalFlexPane,type:hn.a.smallFixedFar,closeButtonAriaLabel:Object(o.a)(Cn.a)},ln.modalFlexPaneContent)})),An=n(9283),In=Object(Fe.a)((function(e){var t=this;kt.useEffect((function(){return i.d.info("[MessageCardDebug] ActionableMessageMailWrapper mount"),function(){i.d.info("[MessageCardDebug] ActionableMessageMailWrapper unmount")}}),[]),kt.useEffect((function(){i.d.info("[MessageCardDebug] ActionableMessageMailWrapper update"),b()}));var n=kt.useRef(Object(et.a)(e.item)),r=kt.useRef({loadStartTime:Object(B.Qb)()}),a=kt.useRef([]),c=kt.useRef(),d=Object(s.__read)(kt.useState(!1),2),u=d[0],l=d[1],p=Object(s.__read)(kt.useState(null),2),f=p[0],g=p[1],b=function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t,n,a,o,d,u,l,p;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return c.current?(i.d.info("[MessageCardDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt"),[2]):(t=e.item,r.current.fetchStartTime=Object(B.Qb)(),n=t.adaptiveCardDetails,[4,Object(It.a)()]);case 1:if(a=s.sent(),o=a.SmtpActionableMessagesEnabled,(null==n?void 0:n[0])&&o)return i.d.info("[MessageCardDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),r.current.fetchEndTime=Object(B.Qb)(),[2];d=new v.a("MCActionableCardGetProperty"),s.label=2;case 2:return s.trys.push([2,4,,5]),c.current=!0,i.d.info("[MessageCardDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),[4,Ue(t)];case 3:return(u=s.sent())&&u.length>0&&o?(d.end(),r.current.fetchEndTime=Object(B.Qb)(),i.d.info("[MessageCardDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+u[0].cardId),we(t,u),c.current=!1):(l=o?"getCardProperties error getting card details from the server":"smtp Actionable Messages is disabled for org config",i.d.info("[MessageCardDebug] ActionableMessageMailWrapper "+l),He(e.viewState,!0),Be(e.viewState,!1),d.endWithError("ServerError")),[3,5];case 4:return p=s.sent(),i.d.info("[MessageCardDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),i.d.warn("[ActionableMessageMailWrapper] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+p.message),He(e.viewState,!0),Be(e.viewState,!1),d.endWithError("ClientError"),c.current=!1,[3,5];case 5:return[2]}}))}))},C=function(e){return e.filter((function(e){return!e.isContextual}))},m=function(t){var s=C(t),c={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(i.d.info("ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(a.current),a.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(i.d.info("ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),a.current.push(t);var o=t.querySelectorAll(r.cssSelector);if(o)for(var s=0;s<o.length;s++){var c=o.item(s);r.handler(c),a.current.push(c)}}else i.d.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}},d=new Kt(Me,e.item.MailboxInfo,n.current,r.current);return i.d.info("[MessageCardDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+s[0].cardId),s&&1===s.length?kt.createElement("div",{className:An.container},kt.createElement($t,{key:s[0].cardId,cardDetails:s[0],showMessageBodyCallback:h,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[At,Se,bn],adjustCardElementBeforeRenderCallback:A,onCardRendered:I,downloadThemeCallback:Ae,onCardDetailsUpdated:y,actionableMessageContentHandler:c,actionableMessageCardStrings:{cardDefinitionsStrings:{format:o.b,actionInProgressMessage:Object(o.a)(Mt.a),defaultPlaceholderTextInput:Object(o.a)(Mt.b),warningMessageForInvalidInput:Object(o.a)(Mt.c),warningMessageForMissingRequiredInput:Object(o.a)(Mt.d),warningMessageForInputNumberNotNumeric:Object(o.a)(St.c),warningMessageForInputNumberLessThanMax:Object(o.a)(St.a),warningMessageForInputNumberMoreThanMin:Object(o.a)(St.b),warningMessageForRequiredField:Object(o.a)(jt.a)},dateStrings:Object(xt.a)()},telemetryHandler:d})):(i.d.info("Did not find expected number of cards on the message"),h(!0),kt.createElement("div",null))},h=function(t){i.d.info("[MessageCardDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),He(e.viewState,t),t&&Be(e.viewState,!1)},y=function(t){i.d.info("[MessageCardDebug] ActionableMessageMailWrapper updateCardOnItem"),we(e.item,t)},O=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Qt(t[0]),messageId:e.item.ItemId.Id,target:function(){return f}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return f}}}return null},A=function(t){i.d.info("[MessageCardDebug] ActionableMessageMailWrapper fixInlineImages"),he(t,e.item.MailboxInfo),Qe(t,e.item,e.item.MailboxInfo)},I=function(t){i.d.info("[MessageCardDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),f!==t&&(l(!0),g(t)),e.viewState.showCardLoading&&Be(e.viewState,!1)},M=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(i.d.info("[ActionableMessageCard] TeachingUI triggered"),kt.createElement(Jt,Object(s.__assign)({},e))):null},S=e.item.adaptiveCardDetails;return i.d.info("[MessageCardDebug] ActionableMessageMailWrapper render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==S?void 0:S[0])?S[0].cardId:"undefined")),S&&S.length>0&&0===function(t){var r=C(t);return 0!=(r=r.filter((function(t){return nn(t,e.item.MailboxInfo,Object(V.f)("rp-acDisableTransactionCard"),n.current,Me)}))).length&&(He(e.viewState,!0),Be(e.viewState,!1)),r}(S).length?function(e){return kt.createElement(kt.Fragment,null,kt.createElement("div",{className:An.cardArea},m(e)),kt.createElement(On,{odataItemId:n.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),u&&M(e?O():null))}(S):kt.createElement("div",null)})),Mn=n(1665),Sn="62242e1d-c39a-4f8a-a66e-1d39c0a336b0";var jn=n(9283),xn=Object(Fe.a)((function(e){var t=this;kt.useEffect((function(){return i.d.info("[MessageCardDebug] ActionableMessageContent mount"),function(){i.d.info("[MessageCardDebug] ActionableMessageContent unmount")}}),[]),kt.useEffect((function(){i.d.info("[MessageCardDebug] ActionableMessageContent update"),y()})),kt.useEffect((function(){return l.current=setTimeout((function(){i.d.info("[MessageCardDebug] ActionableMessageContent card load timed out"),Object(v.o)("actionableMessageContentLoadTimeout"),p.current=!0,k(!0)}),4e3),function(){return clearTimeout(l.current)}}),[]);var n=kt.useRef(Object(et.a)(e.item)),r=kt.useRef(Object(B.Qb)()),o=kt.useRef(),c=kt.useRef(),d=kt.useRef([]),u=kt.useRef(),l=kt.useRef(),p=kt.useRef(),f=Object(s.__read)(kt.useState(!1),2),g=f[0],b=f[1],C=Object(s.__read)(kt.useState(null),2),m=C[0],h=C[1],y=function(){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t,n,r,a,d,l,p,f;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return u.current?(i.d.info("[MessageCardDebug] ActionableMessageContent getCardProperties fetch already in process. Aborting this attempt"),[2]):(t=e.item,o.current=Object(B.Qb)(),n=t.adaptiveCardDetails,[4,Object(It.a)()]);case 1:if(r=s.sent(),a=r.SmtpActionableMessagesEnabled,(null==n?void 0:n[0])&&a)return i.d.info("[MessageCardDebug] ActionableMessageContent getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),c.current=Object(B.Qb)(),[2];d=new v.a("MCActionableCardGetProperty"),s.label=2;case 2:return s.trys.push([2,4,,5]),u.current=!0,i.d.info("[MessageCardDebug] ActionableMessageContent getCardProperties fetching cardDetails from the server"),[4,Ue(t)];case 3:return(l=s.sent())&&l.length>0&&a?(d.end(),c.current=Object(B.Qb)(),i.d.info("[MessageCardDebug] ActionableMessageContent getCardProperties got card details from the server. cardId: "+l[0].cardId),we(t,l),u.current=!1):(p=a?"getCardProperties error getting card details from the server":"smtp Actionable Messages is disabled for org config",i.d.info("[MessageCardDebug] ActionableMessageContent "+p),k(!0),d.endWithError("ServerError")),[3,5];case 4:return f=s.sent(),i.d.info("[MessageCardDebug] ActionableMessageContent getCardProperties error getting card details from the server"),i.d.warn("[ActionableMessageContent] ActionableMessageContent getCardProperties: exception during getCardDetails: "+f.message),k(!0),d.endWithError("ClientError"),u.current=!1,[3,5];case 5:return[2]}}))}))},O=function(e){return e.filter((function(e){return!e.isContextual}))},A=function(t){var s=O(t),u={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(i.d.info("ActionableMessageContent: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(d.current),d.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(i.d.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),d.current.push(t);var a=t.querySelectorAll(r.cssSelector);if(a)for(var o=0;o<a.length;o++){var s=a.item(o);r.handler(s),d.current.push(s)}}else i.d.info("ActionableMessageCard: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}};return s&&1===s.length?(i.d.info("[MessageCardDebug] ActionableMessageContent renderCardFromDetails. cardId: "+s[0].cardId),kt.createElement("div",{className:jn.container},kt.createElement(a.a,{key:s[0].cardId,cardDetails:s[0],mailboxInfo:e.item.MailboxInfo,messageContext:n.current,showMessageBodyCallback:I,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[At,Se,bn],telemetryProvider:Me,adjustCardElementBeforeRenderCallback:j,onCardRendered:x,downloadThemeCallback:Ae,onCardDetailsUpdated:M,perfData:{loadStartTime:r.current,fetchStartTime:o.current,fetchEndTime:c.current},actionableMessageContentHandler:u}))):(i.d.info("Did not find expected number of cards on the message"),I(!0),kt.createElement("div",null))},I=function(t){i.d.info("[MessageCardDebug] ActionableMessageContent setShowMessageBody: "+t),He(e.viewState,t),t&&Be(e.viewState,!1),k(t)},M=function(t){i.d.info("[MessageCardDebug] ActionableMessageContent updateCardOnItem"),we(e.item,t)},S=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Object(a.d)(t[0]),messageId:e.item.ItemId.Id,target:function(){return m}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return m}}}return null},j=function(t){i.d.info("[MessageCardDebug] ActionableMessageContent fixInlineImages"),he(t,e.item.MailboxInfo),Qe(t,e.item,e.item.MailboxInfo)},x=function(t){i.d.info("[MessageCardDebug] ActionableMessageContent onCardRendered. Updating loading state"),m!==t&&(b(!0),h(t),k(!1)),e.viewState.showCardLoading&&Be(e.viewState,!1)},T=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(i.d.info("[ActionableMessageCard] TeachingUI triggered"),kt.createElement(Jt,Object(s.__assign)({},e))):null},k=function(t){l.current&&(clearTimeout(l.current),l.current=null);var n=e.viewState;Be(n,!1),t&&He(n,!0)},w=e.item.adaptiveCardDetails;i.d.info("[MessageCardDebug] ActionableMessageContent render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==w?void 0:w[0])?w[0].cardId:"undefined"));var E,D=w&&w.length>0,_=D&&(E=w[0].connectorSenderGuid,!Object(V.f)(Mn.b)&&E===Sn);return D?_||0!==function(t){var r=O(t);return 0!=(r=r.filter((function(t){return nn(t,e.item.MailboxInfo,Object(V.f)("rp-acDisableTransactionCard"),n.current,Me)}))).length&&k(!0),r}(w).length?(k(!0),kt.createElement("div",null)):function(e){return!p.current&&kt.createElement(kt.Fragment,null,kt.createElement("div",{className:jn.cardArea},A(e)),kt.createElement(On,{odataItemId:n.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),g&&T(e?S():null))}(w):kt.createElement("div",null)}));n.d(t,"logAdaptiveCardLinkInteraction",(function(){return xe})),n.d(t,"getCardDetails",(function(){return Ue})),n.d(t,"ActionableMessageMailWrapper",(function(){return In})),n.d(t,"ActionableMessageContent",(function(){return xn})),n.d(t,"doesActionableMessageEnabled",(function(){return be}))},1665:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="cal-txp-invoice",a="cal-txp-serviceReservationAdaptive"},203:function(e){e.exports=JSON.parse('{"k":"t2a","h":"u2a","m":"v2a","j":"w2a","l":"x2a","i":"y2a","d":"z2a","b":"A2a","f":"B2a","g":"C2a","e":"D2a","a":"E2a","c":"F2a"}')},2200:function(e){e.exports=JSON.parse('{"a":"OJb"}')},245:function(e,t,n){"use strict";var r=n(507),a=n(508),i=n(509),o=n(510),s=n(511),c=n(512),d=n(513),u=n(495),l=n(496),p=n(497),f=n(498),g=n(499),b=n(500),C=n(501),m=n(502),h=n(503),v=n(504),y=n(505),O=n(506),A=n(203),I=n(536),M=n(522),S=n(523),j=n(524),x=n(525),T=n(526),k=n(527),w=n(528),E=n(529),D=n(530),_=n(531),R=n(532),P=n(533),N=n(8),L=n(12),U=function(){return F.get()},F=Object(L.computed)((function(){return{months:[Object(N.a)(O.a),Object(N.a)(y.a),Object(N.a)(v.a),Object(N.a)(h.a),Object(N.a)(m.a),Object(N.a)(C.a),Object(N.a)(b.a),Object(N.a)(g.a),Object(N.a)(f.a),Object(N.a)(p.a),Object(N.a)(l.a),Object(N.a)(u.a)],shortMonths:[Object(N.a)(P.a),Object(N.a)(R.a),Object(N.a)(_.a),Object(N.a)(D.a),Object(N.a)(E.a),Object(N.a)(w.a),Object(N.a)(k.a),Object(N.a)(T.a),Object(N.a)(x.a),Object(N.a)(j.a),Object(N.a)(S.a),Object(N.a)(M.a)],days:[Object(N.a)(d.a),Object(N.a)(c.a),Object(N.a)(s.a),Object(N.a)(o.a),Object(N.a)(i.a),Object(N.a)(a.a),Object(N.a)(r.a)],shortDays:[Object(N.a)(A.d),Object(N.a)(A.b),Object(N.a)(A.f),Object(N.a)(A.g),Object(N.a)(A.e),Object(N.a)(A.a),Object(N.a)(A.c)],goToToday:Object(N.a)(I.a),prevMonthAriaLabel:Object(N.a)(A.k),nextMonthAriaLabel:Object(N.a)(A.h),prevYearAriaLabel:Object(N.a)(A.m),nextYearAriaLabel:Object(N.a)(A.j),prevYearRangeAriaLabel:Object(N.a)(A.l),nextYearRangeAriaLabel:Object(N.a)(A.i)}})),H=n(65),B=function(e,t){return e?e.tz:t||Object(H.p)()},z=n(5),J=function(e,t){return Object(z.Qb)(e,t.getFullYear(),t.getMonth(),t.getDate())};n.d(t,"a",(function(){return U})),n.d(t,"c",(function(){return B})),n.d(t,"b",(function(){return J}))},2943:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(391),i=n(37),o=n(860);function s(e,t,n,s){var c=Object(a.e)(n,e,null,t),d=Object(r.__assign)(Object(r.__assign)({},s),{includeBohemiaOnPopout:Object(o.d)(o.a.Bohemia).bohemiaEnabled&&Object(i.f)("rp-prague")});Object(a.c)("mail",c,d,{resizable:!0})}},4712:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6414),a=n(12),i=[{id:"ja7lKjj2NnQ.cwA.Krg.hfkh3ftaMUOb57AnI3gEJw-TZrkxQd1glDepIPKj6yo",tokenType:r.a.ConnectorsLTI},{id:"hXP0lB4sF4E.ihaAU12Q9puBSDe5dMnr8RITJalvWkCqiQadGVOHmIc",tokenType:r.a.AAD}],o=Object(a.computed)((function(){var e=new a.ObservableMap;return i.forEach((function(t){e.set(t.id,t)})),e}))},536:function(e){e.exports=JSON.parse('{"a":"s2a"}')},5558:function(e,t,n){"use strict";var r=n(12),a=n(4),i={themeStore:{loadStatus:0,themeMapping:{}},cards:new r.ObservableMap},o=Object(a.createStore)("ActionableMessageV2",i);t.a=o()},6414:function(e,t,n){"use strict";var r;!function(e){e.NoAuth="NoAuth",e.ConnectorsLTI="ConnectorsLTI",e.AAD="AAD"}(r||(r={})),t.a=r},8404:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(73),a=(n(4712),new r.c((function(){return Promise.all([n.e(4),n.e(8),n.e(37),n.e(74),n.e(388)]).then(n.bind(null,9424))}))),i=new r.b(a,(function(e){return e.openBotConversation})),o=new r.b(a,(function(e){return e.openCortanaConversation}));new r.a(a,(function(e){return e.setEditorInterface}))},8423:function(e){e.exports=JSON.parse('{"a":"obb"}')},8424:function(e){e.exports=JSON.parse('{"a":"pbb"}')},8425:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(37),a=n(851),i=n(331),o=n(6232),s="MessageCard",c="IOpenTypedFacet.Com.Microsoft.Graph.MessageCard",d=Object(i.getExtendedPropertyUri)("E550B918-9859-47B9-8095-97E4E72F1926",c,"String"),u={featureId:s,propertyPaths:[d],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return!!(null==t?void 0:t.adaptiveCardDetails)},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(r.f)("rp-actionableMessages"))return!1;var n=a.a.items.get(e);return Object(o.a)(n)}};t.b=u},9281:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("setAutoInvokeActionAlreadyRan",(function(e,t){return{cardId:e,autoInvokeActionAlreadyRan:t}}))},9282:function(e,t,n){"use strict";var r;!function(e){e[e.LoadStart=0]="LoadStart",e[e.AutoInvokeActionStart=1]="AutoInvokeActionStart",e[e.AutoInvokeActionEnd=2]="AutoInvokeActionEnd",e[e.CardRenderStart=3]="CardRenderStart",e[e.CardRenderEnd=4]="CardRenderEnd",e[e.ThemeLoadTotalStart=5]="ThemeLoadTotalStart",e[e.ThemeLoadTotalEnd=6]="ThemeLoadTotalEnd",e[e.ThemeDefinitionsLoadStart=7]="ThemeDefinitionsLoadStart",e[e.ThemeDefinitionsLoadEnd=8]="ThemeDefinitionsLoadEnd",e[e.ThemeResolveStart=9]="ThemeResolveStart",e[e.ThemeResolveEnd=10]="ThemeResolveEnd",e[e.CardCreateStart=11]="CardCreateStart",e[e.CardCreateEnd=12]="CardCreateEnd",e[e.CardLibraryRenderStart=13]="CardLibraryRenderStart",e[e.CardLibraryRenderEnd=14]="CardLibraryRenderEnd",e[e.PrepareCardStart=15]="PrepareCardStart",e[e.PrepareCardEnd=16]="PrepareCardEnd"}(r||(r={})),t.a=r},9283:function(e,t,n){var r=n(12887),a=n(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.ActionableMessageMail.js.map
self.scriptsLoaded['owa.ActionableMessageMail.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ActionableMessageMail.js'] = (new Date()).getTime();