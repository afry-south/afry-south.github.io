self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFunctionalBoot~PostMailDeeplinkBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[67],{1141:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(51),i=t(930),o=t(74);function u(){return(Object(r.f)("grp-shareable-crud-integrationv2")||Object(i.a)().isSensitivityLabelsEnabled)&&!Object(o.t)()}},1146:function(n,e,t){"use strict";var r=t(0);function i(n){return n>0}var o=t(4),u=t(83),c=Object(o.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(n,e,t,r,i,o){return Object(u.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:n}},{unsubscribeSourceType:n,smtpAddress:e,smtpIdentifier:t,unsubscribeSilentUris:r,unsubscribeHttpUri:i,completedCallback:o})})),a=Object(o.action)("AFTER_UNSUBSCRIBE",(function(n,e,t,r,i){return{smtpIdentifier:n,unsubscribeSourceType:e,responseType:t,debugMessage:r,completedCallback:i}})),s=t(7),d=t(196),f="ows/api/beta/subscriptions/{0}/unsubscribe";var l,b=function(n,e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(d.c)(Object(s.b)(f,n),{unsubscribeSilentUris:e},null,!0)];case 1:return[2,t.sent()]}}))}))};!function(n){n[n.Fail=0]="Fail",n[n.Success=1]="Success"}(l||(l={}));var p=l,O=t(13),v=Object(o.createStore)("BrandSubscription",{subscriptions:new O.ObservableMap({}),unsubscribedSubscriptions:new O.ObservableMap({})})();function m(n){return n&&v.subscriptions.has(n.toLowerCase())?v.subscriptions.get(n.toLowerCase()):null}var j=Object(o.mutatorAction)("unsubscribeFromCache",(function(n){var e=Object(r.__assign)({},m(n));e?(v.subscriptions.delete(n.toLowerCase()),v.unsubscribedSubscriptions.set(n.toLowerCase(),e)):h()})),w=t(190);Object(o.orchestrator)(c,(function(n){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e,t,o,u,c,s,d,f,l,O,v,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=n.unsubscribeSourceType,t=n.smtpAddress,o=n.smtpIdentifier,u=n.unsubscribeSilentUris,c=n.unsubscribeHttpUri,s=n.completedCallback,c&&0!==c.length||u&&0!==u.length?(u&&i(u.length)||!c?d="No unsubscribe URIs provided":(window.open(c,"_blank"),d="Opened unsubscribe URI in new tab"),[4,b(o,u)]):(d="No unsubscribe URIs or SilentURIs provided",f=p.Fail,a(o,e,f,d,s),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return l=r.sent(),O=null,Object(w.a)(l.status)?(d="Unsubscribe service called successfully. "+d,f=p.Success,j(t),[3,4]):[3,2];case 2:return d="Unsubscribe service failed. "+d,f=p.Fail,[4,l.text().then((function(n){return n?JSON.parse(n):{}}))];case 3:v=r.sent(),(O=new Error("ResponseCode="+l.status+", ErrorMessage="+(null===(m=null==v?void 0:v.error)||void 0===m?void 0:m.message))).fetchErrorType="ServerFailure",r.label=4;case 4:return a(o,e,f,d,s),O?[2,Promise.reject(O)]:[2,Promise.resolve()]}}))}))}));Object(o.mutator)(a,(function(n){var e=n.unsubscribeSourceType,t=n.responseType,r=n.debugMessage,i=n.completedCallback;"BrandCard"===e&&i&&i(t===p.Success,r)}));var g=Object(o.mutatorAction)("populateSubscriptionStore",(function(n){n.subscriptions.forEach((function(n){var e;(null===(e=null==n?void 0:n.smtpInfo)||void 0===e?void 0:e.smtpAddress)&&v.subscriptions.set(n.smtpInfo.smtpAddress.toLowerCase(),n)})),n.unsubscribedSubscriptions.forEach((function(n){var e;(null===(e=null==n?void 0:n.smtpInfo)||void 0===e?void 0:e.smtpAddress)&&v.unsubscribedSubscriptions.set(n.smtpInfo.smtpAddress.toLowerCase(),n)}))})),S="ows/api/beta/subscriptions?orderBy=name, asc";var h=function(n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.b)(n?S+"&noResolveBrand=true":S,void 0,!0)];case 1:return e=r.sent(),Object(w.a)(e.status)?[4,e.json()]:[3,3];case 2:return t=r.sent(),g(t),[2,t];case 3:return[2,null]}}))}))};t.d(e,"b",(function(){return h})),t.d(e,"e",(function(){return c})),t.d(e,"d",(function(){return a})),t.d(e,"a",(function(){return p})),t.d(e,"c",(function(){return m})),t.d(e,"f",(function(){return i}))},1200:function(n,e,t){"use strict";t.d(e,"b",(function(){return u})),t.d(e,"a",(function(){return c}));var r=t(0),i=void 0,o=new Promise((function(n){i=n}));function u(n){null==i||i(n)}function c(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return[2,Promise.race([o,new Promise((function(n,e){setTimeout((function(){return e()}),45e3)}))])]}))}))}},1351:function(n,e,t){"use strict";t.d(e,"b",(function(){return i}));var r=t(4),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),o=i();e.a=o},1762:function(n,e,t){"use strict";var r=t(4),i=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();e.a=i},1811:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(1812),i=t(1343),o=t(904),u=t(51);function c(n){if(Object(u.f)("fwk-skypeBusinessV2")&&n){var e=Object(r.b)(n),t=function(n){switch(n){case"Offline":return o.b.offline;case"Away":case"BeRightBack":return o.b.away;case"Busy":case"IdleBusy":return o.b.busy;case"DoNotDisturb":return o.b.dnd;case"Online":case"IdleOnline":return o.b.online;case"None":return o.b.none}}(i.a.presences.get(e));return t||void 0}}},1812:function(n,e,t){"use strict";t.d(e,"a",(function(){return r})),t.d(e,"b",(function(){return i}));var r="sip:";function i(n){if(!n)return null;var e=n.toLowerCase();return 0!=e.indexOf(r)&&(e=r+e),e}},1925:function(n,e,t){"use strict";var r=t(77),i=t(0),o=t(1351),u=t(104),c=Object(u.action)("addSessionMaskedRecipient")((function(n){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){return o.a.sessionMaskedRecipients[n]=!0,[2]}))}))}));t.d(e,"b",(function(){return s})),t.d(e,"a",(function(){return c}));var a=new r.c((function(){return t.e(494).then(t.bind(null,13725))})),s=new r.a(a,(function(n){return n.execute3SPrimeCall}))},1948:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(51);function i(){return Object(r.f)("rp-peopleSuggestionsCacheFirst")||Object(r.f)("rp-cacheFirstPeopleTrieSize300")||Object(r.f)("rp-cacheFirstPeopleTrieSize500")||Object(r.f)("rp-cacheFirstPeopleTrieSize700")}},2726:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(4),i=Object(r.createStore)("linkedInStore",{status:null})},2854:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(0),i=t(388),o=t(51),u=t(845);function c(n,e,t,c){var a=Object(i.e)(t,n,null,e),s=Object(r.__assign)(Object(r.__assign)({},c),{includeBohemiaOnPopout:Object(u.d)(u.a.Bohemia).bohemiaEnabled&&Object(o.f)("rp-prague")});Object(i.c)("mail",a,s,{resizable:!0})}},2902:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(77),i=t(51),o=new r.c((function(){return Promise.all([t.e(6),t.e(222)]).then(t.bind(null,4381))})),u=new r.a(o,(function(n){return n.initializeErrorHandlerDevtools}));function c(){Object(i.f)("fwk-devTools")&&Object(i.f)("fwk-errorpopup")&&u.importAndExecute()}},3230:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return t.e(445).then(t.bind(null,5191))})),o=new r.a(i,(function(n){return n.initializeCache}))},3624:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(4),i=Object(r.createStore)("allowedOptions",{allowedOptions:[]})},3669:function(n,e,t){"use strict";var r=t(77),i=t(3624),o=t(206);function u(n){return Object(o.a)()||n.every((function(n){return Object(i.a)().allowedOptions.includes(n)}))}t.d(e,"b",(function(){return a})),t.d(e,"a",(function(){return u}));var c=new r.c((function(){return t.e(111).then(t.bind(null,13583))})),a=new r.a(c,(function(n){return n.loadAllowedOptions}))},3799:function(n,e,t){"use strict";t.d(e,"b",(function(){return i}));var r=t(4),i=Object(r.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),o=i();e.a=o},4096:function(n,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return u}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(0),t.e(2),t.e(3),t.e(4),t.e(144)]).then(t.bind(null,6992))})),o=new r.a(i,(function(n){return n.initializeAccountAndCalendars})),u=new r.a(i,(function(n){return n.initializeCalendarsDataForModule}))},4219:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(27),t.e(756),t.e(89),t.e(820)]).then(t.bind(null,6440))})),o=new r.a(i,(function(n){return n.registerAndInitializeSharedABT}))},4220:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return t.e(534).then(t.bind(null,6476))})),o=new r.a(i,(function(n){return n.validateCache}))},4395:function(n,e,t){"use strict";var r=t(24),i=t(0);function o(n,e){var t;return void 0===n.request||n.request.__type||(n.request=(t=n.request,Object(i.__assign)({__type:"SetFocusedInboxConfigurationRequest:#Exchange"},t))),Object(r.a)("SetFocusedInboxConfiguration",n,e)}t.d(e,"a",(function(){return o}))},4888:function(n,e,t){"use strict";t.d(e,"e",(function(){return o})),t.d(e,"b",(function(){return u})),t.d(e,"c",(function(){return c})),t.d(e,"a",(function(){return a})),t.d(e,"d",(function(){return s}));var r=t(77),i=new r.c((function(){return t.e(274).then(t.bind(null,8462))})),o=new r.a(i,(function(n){return n.setGroupHeaderCallbacks})),u=new r.b(i,(function(n){return n.groupHeaderCommandBarStore})),c=new r.b(i,(function(n){return n.groupHeaderNavigationButton})),a=new r.a(i,(function(n){return n.groupHeaderCommandBarAction})),s=new r.b(i,(function(n){return n.isGroupHeaderNavigationOnEmail}))},4889:function(n,e,t){"use strict";var r=t(4),i=Object(r.createStore)("TrustedSenders",{trustedSendersAndDomains:null})();e.a=i},5195:function(n,e,t){"use strict";var r=t(77),i=t(5306),o=t(165);var u=t(2726);function c(){var n=Object(u.a)();return null==n.status||"OptOut"==n.status||"OptOutBound"==n.status||"DisabledBound"==n.status}function a(){return"Bound"===Object(u.a)().status}t.d(e,"a",(function(){return d})),t.d(e,"c",(function(){return c})),t.d(e,"b",(function(){return a}));var s=new r.c((function(){return Promise.all([t.e(6),t.e(323)]).then(t.bind(null,13605))})),d=(new r.a(s,(function(n){return n.connectToLinkedIn})),new r.a(s,(function(n){return n.initializeBindStatus})));"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.completeLinkedInBind=function(n){Object(o.o)("linkedInBindComplete",[n]),Object(i.a)(n?"Unbound":"Bound")})},5199:function(n,e,t){"use strict";var r=t(77),i=t(24);function o(){return Object(i.a)("GetFolderMruConfiguration",{},n).then((function(n){return n}));var n}var u=t(3799),c=t(831),a=t(104),s=Object(a.action)("getMoveToMruList")((function(){o().then((function(n){return function(n){if(null==n.FolderMruEntries||0==n.FolderMruEntries.length)u.a.mruFolders.push(Object(c.a)("inbox")),u.a.mruFolders.push(Object(c.a)("deleteditems")),u.a.mruFolders.push(Object(c.a)("archive"));else for(var e=0;e<n.FolderMruEntries.length;e++){var t=n.FolderMruEntries[e].EwsFolderIdEntry;u.a.mruFolders.push(t)}u.a.isInitialized=!0}(n)}))}));t.d(e,"b",(function(){return f})),t.d(e,"c",(function(){return l})),t.d(e,"a",(function(){return s}));var d=new r.c((function(){return t.e(371).then(t.bind(null,13557))})),f=new r.a(d,(function(n){return n.addFolderIdToMoveToMruList})),l=new r.a(d,(function(n){return n.removeFolderIdFromMoveToMruList}))},5204:function(n,e,t){"use strict";var r="shortcut icon",i="image/x-icon";function o(n){if(document){var e=document.querySelector('link[rel="'+r+'"]');e||((e=document.createElement("link")).rel=r,e.type=i,document.head.appendChild(e)),e.href=n}}var u,c=t(13);function a(n){u&&u(),u=Object(c.autorun)((function(){o(n.get())}))}t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return a}))},5306:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(4),i=t(2726),o=Object(r.mutatorAction)("updateBindStatus",(function(n){Object(i.a)().status=n}))},5374:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(4395),i=t(153);function o(){var n={Header:Object(i.a)(),IsFocusedInboxCapable:!0};return Object(r.a)({request:n}).then((function(n){return n}))}},5391:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(4),i=Object(r.action)("turnOffFocusedInbox")},5510:function(n,e,t){"use strict";var r=t(965),i=t(4),o=Object(i.action)("REMINDER_NOTIFICATION",(function(n){return{notification:n}})),u=Object(i.action)("NEW_MAIL_NOTIFICATION",(function(n){return{notification:n}})),c=Object(i.action)("SOCIAL_ACTIVITY_NOTIFICATION",(function(n){return{notification:n}})),a=t(206),s=!1;function d(){s||(s=!0,r.g.importAndExecute(f("ReminderNotification","ReminderNotifications"),o),r.g.importAndExecute(f("NewMailNotification"),u),Object(a.a)()||r.g.importAndExecute(f("SocialActivityNotification"),c))}function f(n,e){return{subscriptionId:e||n,requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:n}}}t.d(e,"d",(function(){return d})),t.d(e,"a",(function(){return u})),t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return c}))},5910:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(24);function i(n){return Object(r.a)("GetMailboxJunkEmailConfiguration",{},n)}},6e3:function(n,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"c",(function(){return u})),t.d(e,"b",(function(){return c})),t.d(e,"e",(function(){return a})),t.d(e,"d",(function(){return s}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(36),t.e(279)]).then(t.bind(null,8493))})),o=new r.a(i,(function(n){return n.loadGroupAction})),u=new r.a(i,(function(n){return n.onAfterNewGroupSelectedAction})),c=new r.a(i,(function(n){return n.onAfterGroupDetailsSucceededAction})),a=new r.a(i,(function(n){return n.setGroupIsSubscribedAction})),s=new r.a(i,(function(n){return n.setGroupIsMemberAction}))},6096:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(5),t.e(7),t.e(266)]).then(t.bind(null,8478))})),o=new r.b(i,(function(n){return n.editGroup}))},6097:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(5),t.e(7),t.e(267)]).then(t.bind(null,8479))})),o=new r.a(i,(function(n){return n.editGroup}))},6475:function(n,e,t){"use strict";var r=t(77),i=t(1748),o=t(20),u=t(104),c=t(226),a=t(224),s=t(193),d=t(5374),f=Object(u.action)("initializeFocusedInboxConfig")((function(){if(Object(o.a)().UserOptions.IsFocusedInboxFeatureSupported){var n=Object(o.a)().UserOptions,e=null!=n.IsFocusedInboxEnabled,t=null!=n.IsFocusedInboxOnLastUpdateTime?new Date(n.IsFocusedInboxOnLastUpdateTime).getTime():null,r=null!=n.IsFocusedInboxOnLastUpdateTime?new Date(n.IsFocusedInboxOnAdminLastUpdateTime).getTime():null;(!e||null!=t&&null!=r&&r>t)&&(Object(o.a)().UserOptions.IsFocusedInboxEnabled=n.FocusedInboxServerOverride,Object(o.a)().UserOptions.IsFocusedInboxOnLastUpdateTime=n.IsFocusedInboxOnAdminLastUpdateTime,Object(c.a)("OWA.UserOptions",[Object(a.a)({DictionaryKey:Object(s.a)({Type:"String",Value:["IsFocusedInboxEnabled"]}),DictionaryValue:Object(s.a)({Type:"Boolean",Value:[String(n.FocusedInboxServerOverride)]})}),Object(a.a)({DictionaryKey:Object(s.a)({Type:"String",Value:["IsFocusedInboxOnLastUpdateTime"]}),DictionaryValue:Object(s.a)({Type:"String",Value:[n.IsFocusedInboxOnAdminLastUpdateTime]})})]),Object(o.a)().UserOptions.IsFocusedInboxEnabled&&Object(d.a)())}}));t.d(e,"b",(function(){return b})),t.d(e,"c",(function(){return p})),t.d(e,"a",(function(){return f}));var l=new r.c((function(){return t.e(248).then(t.bind(null,13730))})),b=new r.a(l,(function(n){return n.setFocusedInboxOnOff}));function p(){Object(i.subscribe)("saveFocusInboxOptionStitchName",(function(n){return b.importAndExecute(n,!0)}))}},7383:function(n){n.exports=JSON.parse('{"a":"u6a"}')},7555:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return t.e(483).then(t.bind(null,9217))})),o=new r.a(i,(function(n){return n.loadSignature}))},7849:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(11),t.e(16),t.e(259)]).then(t.bind(null,9218))})),o=new r.b(i,(function(n){return n.addGroupMember}))},7850:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(5),t.e(7),t.e(260)]).then(t.bind(null,9219))})),o=new r.a(i,(function(n){return n.addGroupMember}))},7862:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(876);function i(n,e){var t=Object(r.getPersonaFromPersonIdOrEmailAddress)(n,e),i=t;if(null==i?void 0:i.favoriteId)return i.favoriteId;var o=t;return(null==o?void 0:o.id)?o.id:void 0}},7906:function(n,e,t){"use strict";t.d(e,"a",(function(){return d}));var r=t(0),i=t(7907),o=t(965),u=t(2125),c=t(451),a=t(39),s=t(23);function d(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,i.a.import()];case 1:return n=t.sent(),e=(null===window||void 0===window?void 0:window.location)?window.location.pathname:null,[4,n()];case 2:return t.sent(),[4,o.e.importAndExecute({channelEndpoint:Object(c.r)("/owa",e)+"/notificationchannel",pingInterval:3e5,backoffMaximum:64e3,minimumReconnectInterval:1e3,readyCheckTimeout:6e4,handleSessionTimeout:function(){Object(u.b)(Object(a.a)(),Object(s.g)())}})];case 3:return t.sent(),[2]}}))}))}},7907:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return t.e(378).then(t.bind(null,9184))})),o=new r.b(i,(function(n){return n.initializeNotificationDiagnostics}))},7908:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(0),t.e(2),t.e(3),t.e(642),t.e(356)]).then(t.bind(null,9215))})),o=new r.a(i,(function(n){return n.initializeMailOptinService}))},7909:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(77),i=t(5391);t.d(e,"b",(function(){return i.a}));var o=new r.c((function(){return t.e(564).then(t.bind(null,9209))})),u=new r.b(o,(function(n){return n.getActionByFilter}))},833:function(n,e,t){"use strict";t.d(e,"s",(function(){return o})),t.d(e,"A",(function(){return u})),t.d(e,"d",(function(){return c})),t.d(e,"v",(function(){return a})),t.d(e,"y",(function(){return s})),t.d(e,"z",(function(){return d})),t.d(e,"x",(function(){return f})),t.d(e,"w",(function(){return l})),t.d(e,"e",(function(){return b})),t.d(e,"f",(function(){return p})),t.d(e,"h",(function(){return O})),t.d(e,"l",(function(){return v})),t.d(e,"B",(function(){return m})),t.d(e,"j",(function(){return j})),t.d(e,"t",(function(){return w})),t.d(e,"u",(function(){return g})),t.d(e,"a",(function(){return S})),t.d(e,"k",(function(){return h})),t.d(e,"r",(function(){return y})),t.d(e,"i",(function(){return I})),t.d(e,"b",(function(){return A})),t.d(e,"m",(function(){return C})),t.d(e,"c",(function(){return F})),t.d(e,"g",(function(){return _})),t.d(e,"q",(function(){return E})),t.d(e,"n",(function(){return x})),t.d(e,"p",(function(){return T})),t.d(e,"o",(function(){return P}));var r=t(77),i=new r.c((function(){return Promise.all([t.e(1),t.e(4),t.e(7),t.e(74),t.e(106)]).then(t.bind(null,3206))})),o=new r.b(i,(function(n){return n.removeExtensibilityNotification})),u=new r.b(i,(function(n){return n.updatePersistentNotifications})),c=new r.b(i,(function(n){return n.closeTaskPaneAddinCommand})),a=new r.b(i,(function(n){return n.triggerAppointmentTimeChangedEvent})),s=new r.b(i,(function(n){return n.triggerRecipientsChangedEvent})),d=new r.b(i,(function(n){return n.triggerRecurrenceChangedEvent})),f=new r.b(i,(function(n){return n.triggerLocationsChangedEvent})),l=new r.b(i,(function(n){return n.triggerAttachmentsChangedEvent})),b=new r.b(i,(function(n){return n.deinitializeAddinsForItem})),p=new r.b(i,(function(n){return n.initializeAddinsForItem})),O=new r.a(i,(function(n){return n.initializeExtensibilityContext})),v=new r.b(i,(function(n){return n.onHostItemChanged})),m=new r.b(i,(function(n){return n.whenItemHasContextualAddinKeywords})),j=new r.b(i,(function(n){return n.launchTranslateCommand})),w=new r.b(i,(function(n){return n.setPersistedAddin})),g=new r.b(i,(function(n){return n.shouldForceOnSendCompliantBehavior})),S=(Object(r.d)(i,(function(n){return n.AddinBarView})),Object(r.d)(i,(function(n){return n.TaskPaneCollection}))),h=new r.b(i,(function(n){return n.onComposeClose})),y=new r.b(i,(function(n){return n.openContextualCallout})),I=new r.b(i,(function(n){return n.launchAddinCommand})),A=new r.b(i,(function(n){return n.observeAddinCommandSurfaceItems})),C=new r.b(i,(function(n){return n.onItemNavigation})),F=new r.b(i,(function(n){return n.allowItemSendEvent})),_=new r.a(i,(function(n){return n.ExecuteEntryPoint})),E=new r.a(i,(function(n){return n.onNewMessageCompose})),x=new r.a(i,(function(n){return n.onNewAppointmentOrganizer})),T=new r.a(i,(function(n){return n.onNewAttachmentOnMessageCompose})),P=new r.a(i,(function(n){return n.onNewAttachmentOnAppointmentOrganizer}))},840:function(n,e,t){"use strict";var r=t(77),i=t(224),o=t(193),u=t(226);function c(n,e){return void 0===e&&(e="OWA.UserOptions"),Object(u.a)(e,n.map((function(n){return Object(i.a)({DictionaryKey:Object(o.a)({Type:"String",Value:[n.propertyName]}),DictionaryValue:Object(o.a)({Type:n.propertyType,Value:Array.isArray(n.propertyValue)?n.propertyValue:[n.propertyValue]})})})))}var a=t(0);function s(n){return Object(a.__assign)({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},n)}var d=t(24);var f=t(153);function l(n){return void 0===(e=s({Header:Object(f.a)(),Options:(r=n,Object(a.__assign)({__type:"MailboxMessageConfigurationOptions:#Exchange"},r))}))||e.__type||(e=s(e)),Object(d.a)("SetMailboxMessageConfiguration",e,t);var e,t,r}function b(n,e){return null===n?e:n}var p=t(4),O=t(74),v=t(242),m=Object(p.mutatorAction)("updateSessionSettings",(function(n){v(Object(O.h)().SessionSettings,n)})),j=t(242),w=Object(p.mutatorAction)("updateUserOptions",(function(n){j(Object(O.h)().UserOptions,n)}));function g(n){var e=I(n);return!!e&&e.reduce((function(n,e){return n||e.fullOptionFormSettings.isDirty()}),!1)}function S(n){var e=I(n);return e&&e.reduce((function(n,e){return n&&!!e.fullOptionFormSettings.hideSaveDiscard&&e.fullOptionFormSettings.hideSaveDiscard()}),!0)}function h(n){var e=I(n);return!e||e.filter((function(n){return n.fullOptionFormSettings.isDirty()})).reduce((function(n,e){return n&&!!e.fullOptionFormSettings.disableSave&&e.fullOptionFormSettings.disableSave()}),!0)}function y(n,e,t,i,o){var u=new r.b(e,t),c=i&&o?new r.b(i,o):null;return Object(a.__assign)(Object(a.__assign)({},n),{tryImportFullOptionFormSettingsSync:function(){return u.tryImportForRender()},tryImportQuickOptionSettingsSync:c?function(){return c.tryImportForRender()}:void 0})}function I(n){var e=n.options.map((function(n){return function(n){return"fullOptionFormSettings"in n}(n)?n:Object(a.__assign)(Object(a.__assign)({},n),{fullOptionFormSettings:n.tryImportFullOptionFormSettingsSync()})}));return e.some((function(n){return!n.fullOptionFormSettings}))?null:e}var A=t(1493);t.d(e,"g",(function(){return F})),t.d(e,"a",(function(){return _})),t.d(e,"l",(function(){return c})),t.d(e,"h",(function(){return l})),t.d(e,"c",(function(){return b})),t.d(e,"k",(function(){return m})),t.d(e,"m",(function(){return w})),t.d(e,"f",(function(){return g})),t.d(e,"e",(function(){return S})),t.d(e,"i",(function(){return h})),t.d(e,"b",(function(){return y})),t.d(e,"j",(function(){return I})),t.d(e,"d",(function(){return A.a}));var C=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(388)]).then(t.bind(null,13666))})),F=new r.a(C,(function(n){return n.confirmOptionNavigation})),_=Object(r.d)(C,(function(n){return n.OptionsEditor}))},8431:function(n,e,t){"use strict";var r=t(833),i=t(7906),o=t(0),u=t(51),c=t(7849),a=t(7850),s=t(206),d=t(982),f=t(6096),l=t(6097),b=t(4888),p=t(6e3),O=t(900),v=t(1558),m=t(7862),j=t(1425),w=t(994),g=t(825),S=t(2323),h=t(1200),y=t(2854),I=t(1449),A=t(1811),C=t(52),F=t(1572);function _(){var n=Object(F.a)().chatProvider;return 3==n||4==n?E:null}function E(n,e){var t=n.imAddressUrl;I.e.import().then((function(n){var r=n([t],void 0,4);e(r,void 0)}))}var x,T,P,k,N=t(876),U=t(4),R=t(1448),M=function(n){x=n},G=function(n){T=n},L=function(n){P=n},V=function(n){k=n};function B(n){k&&k(n)}Object(U.orchestrator)(R.l,(function(n){x&&x({Smtp:n.groupSmtp,AadObjectId:"",PersonaType:"Group",OlsPersonaId:"",photoUrl:n.photoUrl})})),Object(U.orchestrator)(R.j,(function(n){T&&T({Smtp:n.groupSmtp,AadObjectId:"",PersonaType:"Group",OlsPersonaId:""})})),Object(U.orchestrator)(R.k,(function(n){P&&P({Smtp:n.groupSmtp,AadObjectId:"",PersonaType:"Group",OlsPersonaId:""})})),Object(U.orchestrator)(R.p,(function(n){B(n)})),Object(U.orchestrator)(R.o,(function(n){B(n)}));var D=t(1141);function z(n,e,t){"Group"===n.PersonaType&&Object(u.f)("tri-favorites-roaming")?function(n,e){var t=Object(O.a)().groups.get(n.Smtp.toLowerCase());if(!t)return;Object(N.isGroupInFavorites)(n.Smtp)?e(!1,"Group is already favorited"):N.lazyAddFavoriteGroup.import().then((function(e){return e(n.Smtp,t.basicInformation.DisplayName,"GroupNodeFavoriteButton")})).then((function(){return e(!0,void 0)}))}(n,e):function(n,e,t){if(Object(v.isFavoritingInProgress)(n.Smtp))return void e(!1,void 0);Object(v.addFavoritePersona)(void 0,n.Smtp,t.personaDisplayName,"LivePersonaCard").then((function(){return e(!0,void 0)})).catch((function(n){e(!1,n),v.lazyHandleToggleFavoritePersonaError.importAndExecute(n)}))}(n,e,t)}function H(n,e){"Group"===n.PersonaType&&Object(u.f)("tri-favorites-roaming")?function(n,e){if(!Object(O.a)().groups.get(n.Smtp.toLowerCase()))return;if(Object(N.isGroupInFavorites)(n.Smtp)){var t=Object(w.c)();t.id&&t.id.toLowerCase()==n.Smtp.toLowerCase()&&j.h.importAndExecute(n.Smtp,"groups"),N.lazyRemoveFavoriteGroup.import().then((function(e){return e(n.Smtp,"GroupNodeFavoriteButton")})).then((function(){return e(!0,void 0)}))}else e(!1,"Group is already unfavorited")}(n,e):function(n,e){if(Object(v.isFavoritingInProgress)(n.Smtp))return void e(!1,void 0);var t=Object(m.a)(void 0,n.Smtp);v.lazyRemoveFavoritePersona.importAndExecute(t,"LivePersonaCard").then((function(){return e(!0,void 0)})).catch((function(n){e(!1,n),v.lazyHandleToggleFavoritePersonaError.importAndExecute(n)}))}(n,e)}var q=t(3669),K=t(4220),W=t(1146),J=t(2902),Q=t(5195),$=t(2710),Y=4194304,X=t(831);function Z(n){if(Object(s.a)()){var e=n.ViewStateConfiguration.GlobalFolderViewState;return e&&!JSON.parse(e).IsConversationView?1:0}var t=n.ViewStateConfiguration.FolderViewState,r=Object(X.a)("inbox");if(!r||!t||!t.length)return 0;var i=t.filter((function(n){return JSON.parse(n).FolderId.Id===r}));return 1===((null==i?void 0:i.length)&&i[0]?JSON.parse(i[0]).View:1)?0:1}var nn=t(165),en=t(906);function tn(n){if(function(n){var e,t=n.UserOptions;return Object(s.a)()?!(null===(e=t.ReactOptinSettings)||void 0===e?void 0:e.MailGraduatedFromBeta)||2===t.ClientTypeOptInState||0==(t.NewEnabledPonts&Y):Object(en.a)(32)}(n))return null;Object(nn.o)("settingUpdate");var e=n.UserOptions;return{GlobalReadingPanePositionReact:e.GlobalReadingPanePosition,ConversationSortOrderReact:e.ConversationSortOrder,GlobalListViewTypeReact:Z(n)}}var rn=t(20),on=t(226),un=t(224),cn=t(193);function an(n){var e;switch(n.UserOptions.ConversationSortOrderReact){case"Chronological":e=1;break;case"Tree":e=2;break;case"NewestOnTop":e=4;break;case"NewestOnBottom":e=8;break;case"ChronologicalNewestOnTop":e=5;break;case"ChronologicalNewestOnBottom":e=9;break;case"TreeNewestOnBottom":e=10}return e}var sn=Object(U.mutatorAction)("updateDefaultSettings",(function(n){var e=Object(rn.a)();e.UserOptions.GlobalReadingPanePositionReact=n.GlobalReadingPanePositionReact,e.UserOptions.ConversationSortOrderReact=n.ConversationSortOrderReact,e.UserOptions.GlobalListViewTypeReact=n.GlobalListViewTypeReact}));function dn(){var n,e=tn(Object(rn.a)());e&&(sn(e),n=Object(rn.a)(),Object(on.a)("OWA.UserOptions",[Object(un.a)({DictionaryKey:Object(cn.a)({Type:"String",Value:["GlobalReadingPanePositionReact"]}),DictionaryValue:Object(cn.a)({Type:"Integer32",Value:[""+n.UserOptions.GlobalReadingPanePositionReact]})}),Object(un.a)({DictionaryKey:Object(cn.a)({Type:"String",Value:["ConversationSortOrderReact"]}),DictionaryValue:Object(cn.a)({Type:"Integer32",Value:[""+an(n)]})}),Object(un.a)({DictionaryKey:Object(cn.a)({Type:"String",Value:["GlobalListViewTypeReact"]}),DictionaryValue:Object(cn.a)({Type:"Integer32",Value:[""+n.UserOptions.GlobalListViewTypeReact]})}),Object(un.a)({DictionaryKey:Object(cn.a)({Type:"String",Value:["NewEnabledPonts"]}),DictionaryValue:Object(cn.a)({Type:"Integer32",Value:[""+(n.UserOptions.NewEnabledPonts&~Y)]})})]).then((function(e){"Success"!==e.Body.ResponseMessages.Items[0].ResponseClass||Object(s.a)()||Object(en.a)(32)||(Object(en.b)(!0,32),Object(on.a)("OWA.ViewStateConfiguration",[Object(un.a)({DictionaryKey:Object(cn.a)({Type:"String",Value:["ListViewBitFlags"]}),DictionaryValue:Object(cn.a)({Type:"Integer32",Value:[""+n.ViewStateConfiguration.ListViewBitFlags]})})]))})))}var fn=t(5204),ln=t(13),bn=t(2),pn=t(197),On=Object(U.createStore)("mailFaviconStore",{unseenMessages:0}),vn=Object(ln.computed)((function(){return 0===On().unseenMessages||Object(g.O)(Object(X.a)("inbox"))?mn("resources/images/favicons/mail-seen.ico"):mn("resources/images/favicons/mail-unseen.ico")}));function mn(n){return Object(pn.resolve)(Object(bn.q)(),n)}var jn=t(3412),wn=t(1296),gn=t(827),Sn=Object(U.mutatorAction)("SET_UNSEEN_COUNT",(function(n){On().unseenMessages=n}));Object(U.orchestrator)(jn.a,(function(n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){return Object(wn.a)()===Object(gn.m)("inbox")&&Sn(0),[2]}))}))}));var hn=t(5510),yn=t(74);Object(U.orchestrator)(hn.a,(function(n){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return(Object(wn.a)()!==Object(gn.m)("inbox")||document.hidden)&&("Focused"!==n.notification.InferenceClassification&&Object(yn.h)().UserOptions.IsFocusedInboxEnabled||Sn(On().unseenMessages+1)),[2]}))}))})),document&&document.addEventListener("visibilitychange",(function(){Object(wn.a)()!==Object(gn.m)("inbox")||document.hidden||Sn(0)}));var In=t(7908),An=t(965),Cn=t(7555),Fn=t(845),_n=t(922),En=t(4219),xn=t(1925),Tn=t(6530),Pn=t(5910);var kn=t(4889),Nn=t(104),Un=Object(Nn.action)("getTrustedSendersAndDomains")((function(){kn.a.trustedSendersAndDomains||function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){return[2,Object(Pn.a)().then((function(n){return function(n){return null!=n&&null==n.ErrorMessage?n.Options.TrustedSendersAndDomains:null}(n)}))]}))}))}().then(Object(Nn.action)("updateTrustedSendersAndDomains")((function(n){n&&(kn.a.trustedSendersAndDomains=n)})))})),Rn=t(1935),Mn=t(1948),Gn=t(3230),Ln=t(8514),Vn=t(231);function Bn(n){!function(){var n=this,e={actionCallbacks:{composeMail:function(e,t,r,i){return Object(o.__awaiter)(n,void 0,void 0,(function(){var n,u,c,a,s,f;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return n=null,u=!1,c=e?[{EmailAddress:e,Name:i?i.personaDisplayName:e}]:void 0,a=Object(g.C)(),(s=a&&Object(d.b)(a.tableQuery))&&e&&e.toLowerCase()===s.toLowerCase()?[4,b.d.import()]:[3,2];case 1:f=o.sent(),u=!f(),n=s,c=void 0,o.label=2;case 2:return S.c.importAndExecute("LivePersonaCard",n,c,t,r,u),[2]}}))}))},readMail:function(n,e){C.d.info("Persona action callback: readMail"),Object(y.a)(n)},toggleSubscribeToGroup:function(n,e){n.Smtp&&p.e.importAndExecute(n.Smtp,e)},editGroup:function(e){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return Object(D.a)()?[4,l.a.importAndExecute(e,"OWA_GroupCard")]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,f.a.import()];case 3:n.sent()(e),n.label=4;case 4:return[2]}}))}))},addGroupMembers:function(e){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(n){switch(n.label){case 0:return!Object(u.f)("grp-shareable-crud")||Object(s.a)()?[3,2]:[4,a.a.importAndExecute(e,"OWA_GroupCard")];case 1:return n.sent(),[3,4];case 2:return[4,c.a.import()];case 3:n.sent()(e),n.label=4;case 4:return[2]}}))}))},updateMembership:function(e,t,r,i,u){return Object(o.__awaiter)(n,void 0,void 0,(function(){var n,t,i;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return!e.Smtp||r<=0?[2]:(n=e.Smtp.toLowerCase(),t=Object(g.C)(),i=t&&Object(d.b)(t.tableQuery),n!==i?[2]:[4,p.a.import()]);case 1:return o.sent()(n),[2]}}))}))},getStartChatCallback:_},dataCallbacks:{},dataUpdateBroadcaster:{setGroupUpdateListener:M,setGroupMembersUpdateListener:G,setGroupDeleteListener:L,updatePopupStateListener:V}};e.actionCallbacks.favoritePersona=Object(u.f)("tri-favorites-roaming")?z:void 0,e.actionCallbacks.unfavoritePersona=Object(u.f)("tri-favorites-roaming")?H:void 0,e.dataCallbacks.getIsPersonaFavorited=function(n,e){"Group"===n.PersonaType?e({isFavorited:Object(N.isGroupInFavorites)(n.Smtp)},void 0):e({isFavorited:Object(N.isPersonaInFavorites)(n.OlsPersonaId,n.Smtp)},void 0)},e.dataCallbacks.getPresence=function(n,e){Object(u.f)("fwk-skypeBusinessV2")&&I.f.import().then((function(e){e(n)})),e(Object(A.a)(n),void 0)},Object(h.b)(e)}(),Object(fn.b)(vn),Rn.b.importAndExecute(J.a,{condition:!Object(Mn.a)(),task:function(){return Gn.a.importAndExecute()}},(function(){return Cn.a.importAndExecute()}),{condition:Object(u.f)("cmp-clp")&&!Object(s.a)(),task:function(){return $.b.importAndExecute()}},{condition:Object(_n.a)(),task:function(){return xn.b.importAndExecute()}},{condition:!Object(s.a)(),task:function(){return q.b.importAndExecute()}},(function(){return An.f.importAndExecute()}),(function(){return Fn.g.importAndExecute()}),{condition:Object(u.f)("cmp-proxy-address")&&!Object(s.a)(),task:function(){return Ln.b.importAndExecute()}},{condition:Object(u.f)("rp-linkedInViewProfile"),task:function(){return Q.a.importAndExecute()}},{task:function(){return En.a.importAndExecute()},condition:Object(Vn.a)()&&Object(u.f)("auth-sharedActivityBasedTimeout")&&Object(rn.a)().PolicySettings.IsSharedActivityBasedTimeoutEnabled,idle:n},{task:function(){return r.h.importAndExecute()},condition:Object(u.f)("rp-addins"),idle:n},{task:i.a,idle:n},{task:Un,idle:n},{condition:Object(u.f)("rp-infoBarBrandSubscription")||Object(u.f)("tri-unsubscribeLV"),task:function(){return Object(W.b)(!0)},idle:n},{task:function(){return Tn.c.importAndExecute()},idle:n},{task:function(){return In.a.importAndExecute()},idle:n},{task:function(){return K.a.importAndExecute()},idle:n},{task:dn,idle:n})}t.d(e,"a",(function(){return Bn}))},8470:function(n,e,t){"use strict";var r=t(8431),i=t(4096),o=t(51),u=t(77),c=t(0),a=t(4),s=t(7909),d=t(6475),f=(Object(a.orchestrator)(s.b,(function(n){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){return Object(c.__generator)(this,(function(n){return d.b.importAndExecute(!1,!1),[2]}))}))})),new u.c((function(){return Promise.all([t.e(1),t.e(38),t.e(320)]).then(t.bind(null,13436))}))),l=new u.a(f,(function(n){return n.loadLightningPrimaryView})),b=t(1558),p=t(1425),O=t(3885),v=t(2525),m=t(3553),j=t(2379),w=t(2846),g=t(5199),S=t(1266),h=t(1442),y=t(7079),I=t(5510),A=t(1935),C=t(1948),F=t(3230),_=t(348),E=t(876);var x=t(969);function T(n){Object(r.a)(n),m.c.importAndExecute(w.b(0)),Object(d.c)(),Object(j.h)(),A.b.importAndExecute({condition:Object(C.a)(),task:function(){return F.a.importAndExecute()}},(function(){return b.lazyModule.import()}),g.a,(function(){return S.p.import()}),I.d,{condition:Object(x.d)(),task:function(){O.d.import().then((function(n){n()}))}},(function(){return l.importAndExecute()}),(function(){_.t.importAndExecute().then((function(){(Object(o.f)("tri-favorites-roaming")?Object(c.__spread)(E.favoritesStore.outlookFavorites.values()).some((function(n){return"category"===n.type})):E.favoritesStore.favoriteCategories.size>0)&&_.z.importAndExecute()}))}),(function(){Object(o.d)("tri-upNextV2",(function(){y.b.importAndExecute()}))}),(function(){return i.b.importAndExecute()}),{task:d.a,idle:n},{task:function(){return p.d.importAndExecute()},idle:n},{task:function(){return h.M.importAndExecute()},idle:n},{condition:Object(x.a)(),task:v.b,idle:n})}t.d(e,"a",(function(){return T}))},8514:function(n,e,t){"use strict";var r=t(77),i=t(7383),o=t(51),u=t(840),c=t(74),a=new r.c((function(){return Promise.all([t.e(92),t.e(727)]).then(t.bind(null,13587))})),s=Object(u.b)({key:"ProxyAddressesOptions",titleStringKey:i.a,searchTermsStringKey:i.a,isHidden:function(){return Object(c.t)()||!Object(o.f)("cmp-proxy-address")}},a,(function(n){return n.default}));t.d(e,"b",(function(){return f})),t.d(e,"a",(function(){return s}));var d=new r.c((function(){return Promise.all([t.e(92),t.e(428)]).then(t.bind(null,13353))})),f=new r.a(d,(function(n){return n.initializeProxyAddressStore}))},900:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(4),i=t(13),o=Object(r.createStore)("groupsStore",{groups:new i.ObservableMap})},922:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(20),i=t(51),o=t(1762);function u(){var n=Object(r.a)(),e=null==n?void 0:n.SessionSettings,t=null==e?void 0:e.IsExplicitLogon,u=null==e?void 0:e.IsSubstrateSearchServiceAvailable;return!(o.a.fallbackToFindPeople||!Object(i.f)("rp-3SPeopleSuggestions")||t||!u)}},930:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(4),i=t(974),o=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:i.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},974:function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),function(n){n[n.Private=0]="Private",n[n.Public=1]="Public"}(r||(r={}))}}]);
//# sourceMappingURL=owa.MailFunctionalBoot~PostMailDeeplinkBoot.js.map
self.scriptsLoaded['owa.MailFunctionalBoot~PostMailDeeplinkBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFunctionalBoot~PostMailDeeplinkBoot.js'] = (new Date()).getTime();