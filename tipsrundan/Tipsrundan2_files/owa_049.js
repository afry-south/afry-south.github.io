self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ImmersiveReaderContainer.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[298],{11281:function(e){e.exports=JSON.parse('{"a":"LTc"}')},11282:function(e,t,a){var r=a(11283),o=a(64);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11283:function(e,t,a){(t=e.exports=a(63)(!1)).push([e.i,"._1gop7q4bCchow_bCsGR2xp{top:0;bottom:0;position:absolute;z-index:3001}html[dir=ltr] ._1gop7q4bCchow_bCsGR2xp,html[dir=rtl] ._1gop7q4bCchow_bCsGR2xp{left:0;right:0}._3Aug-3iJYlDVJH1X_Xo95r{position:fixed;top:0;bottom:0;width:100%;height:100%}html[dir] ._3Aug-3iJYlDVJH1X_Xo95r{border:0;margin:0;padding:0}html[dir=ltr] ._3Aug-3iJYlDVJH1X_Xo95r,html[dir=rtl] ._3Aug-3iJYlDVJH1X_Xo95r{left:0;right:0}",""]),t.locals={immersiveReaderContainer:"_1gop7q4bCchow_bCsGR2xp",immersiveReaderIframe:"_3Aug-3iJYlDVJH1X_Xo95r"}},1167:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(1),o={};function i(e){var t;null===(t=o[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function c(e){var t;return o[e]=null!==(t=o[e])&&void 0!==t?t:new Map}function n(e,t,a){var o=r.useRef();r.useEffect((function(){return function(e,t,a){var r=c(e);0===r.size&&window.addEventListener(e,i),r.set(t,a)}(e,o,t),function(){return function(e,t){var a=c(e);a.delete(t),0===a.size&&window.removeEventListener(e,i)}(e,o)}}),a)}},2312:function(e){e.exports=JSON.parse('{"a":"kna"}')},2476:function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return p}));var r=a(0),o=a(3197),i=a(3007),c=a(2312),n=a(8),s=a(37),l=a(1050),m=a(35),d="writeEmail",u="emailList",g="readEmail",h="goTo",b="emailActions";function f(){return[{category:d,displayName:Object(n.a)(i.V)},{category:u,displayName:Object(n.a)(i.i)},{category:g,displayName:Object(n.a)(i.L)},{category:h,displayName:Object(n.a)(i.s)},{category:b,displayName:Object(n.a)(i.h)}]}function p(){var e={};return Object(s.f)("cmp-quickSwitcher")&&(e.goToQuickSwitcher={category:h,description:Object(n.a)(i.w),hotmail:"ctrl+shift+k",yahoo:"ctrl+shift+k",gmail:"ctrl+shift+k",owa:"ctrl+shift+k"}),Object(r.__assign)({newMail:{category:d,description:Object(n.a)(i.F),hotmail:["n"],yahoo:"n",gmail:"c",owa:["n"]},sendMail:{category:d,description:Object(n.a)(i.Q),hotmail:Object(m.i)()?["ctrl+enter"]:["ctrl+enter","alt+s"],yahoo:"alt+s",gmail:"ctrl+enter",owa:Object(m.i)()?["ctrl+enter"]:["ctrl+enter","alt+s"]},reply:{category:d,description:Object(n.a)(i.N),hotmail:"r",yahoo:"r",gmail:"r",owa:["r","ctrl+r"]},replyAll:{category:d,description:Object(n.a)(i.M),hotmail:["a","shift+r"],yahoo:"a",gmail:"a",owa:["shift+r","ctrl+shift+r"]},forward:{category:d,description:Object(n.a)(i.p),hotmail:"shift+f",yahoo:"f",gmail:"f",owa:["shift+f","ctrl+shift+f"]},saveDraft:{category:d,description:Object(n.a)(i.O),hotmail:"ctrl+s",yahoo:"ctrl+s",gmail:"ctrl+s",owa:"ctrl+s"},discardDraft:{category:d,description:Object(n.a)(i.g),hotmail:"esc",owa:"esc"},gotoMail:{category:h,description:Object(n.a)(i.u),hotmail:"ctrl+shift+1",yahoo:"ctrl+shift+1",gmail:"ctrl+shift+1",owa:"ctrl+shift+1"},gotoCalendar:{category:h,description:Object(n.a)(i.q),hotmail:"ctrl+shift+2",yahoo:"ctrl+shift+2",gmail:"ctrl+shift+2",owa:"ctrl+shift+2"},gotoPeople:{category:h,description:Object(n.a)(i.v),hotmail:"ctrl+shift+3",yahoo:"ctrl+shift+3",gmail:"ctrl+shift+3",owa:"ctrl+shift+3"},goToToDo:{category:h,description:Object(l.a)()?Object(n.a)(i.z):Object(n.a)(i.y),hotmail:"ctrl+shift+4",yahoo:"ctrl+shift+4",gmail:"ctrl+shift+4",owa:"ctrl+shift+4"},gotoInbox:{category:h,description:Object(n.a)(i.t),hotmail:"g i",yahoo:"m",gmail:"g i",owa:"g i"},gotoDrafts:{category:h,description:Object(n.a)(i.r),hotmail:"g d",gmail:"g d",owa:"g d"},gotoSent:{category:h,description:Object(n.a)(i.x),hotmail:"g s",gmail:"g t",owa:"g s"},gotoSearch:{category:h,description:Object(n.a)(i.P),hotmail:"/",yahoo:"s",gmail:"/",owa:"alt+q"},undoAction:{category:b,description:Object(n.a)(i.U),hotmail:"ctrl+z",yahoo:"ctrl+z",gmail:"ctrl+z",owa:"ctrl+z"},selectUnselectMessage:{category:u,description:Object(n.a)(i.T),hotmail:"ctrl+space",yahoo:"ctrl+space",gmail:["x","ctrl+x"],owa:"ctrl+space"},selectAll:{category:u,description:Object(n.a)(o.a),hotmail:"ctrl+a",yahoo:"ctrl+a",gmail:"ctrl+a",owa:"ctrl+a"},deselectAll:{category:u,description:Object(n.a)(i.c),hotmail:"esc",yahoo:"esc",gmail:"esc",owa:"esc"},home:{category:u,description:Object(n.a)(i.A),hotmail:["home","ctrl+home"],yahoo:["home","ctrl+home"],gmail:["home","ctrl+home"],owa:["home","ctrl+home"]},end:{category:u,description:Object(n.a)(i.j),hotmail:["end","ctrl+end"],yahoo:["end","ctrl+end"],gmail:["end","ctrl+end"],owa:["end","ctrl+end"]},deleteMail:{category:b,description:Object(n.a)(i.f),hotmail:"del",yahoo:"del",gmail:"#",owa:"del"},openMail:{category:g,description:Object(n.a)(i.H),hotmail:["o","enter"],gmail:["o","enter"],owa:["o","enter"]},openMailInPopout:{category:g,description:Object(n.a)(i.I),hotmail:"shift+enter",gmail:"shift+enter",owa:"shift+enter",yahoo:"shift+enter"},closeMail:{category:g,description:Object(n.a)(i.d),hotmail:"esc",yahoo:"esc",gmail:"u",owa:"esc"},openNextItem:{category:g,description:Object(n.a)(i.J),hotmail:"ctrl+.",yahoo:"ctrl+.",gmail:"j",owa:"ctrl+."},openPrevItem:{category:g,description:Object(n.a)(i.K),hotmail:"ctrl+,",yahoo:"ctrl+,",gmail:"k",owa:"ctrl+,"},focusNextItemPart:{category:g,description:Object(n.a)(i.n),hotmail:".",gmail:"n",owa:"."},focusPrevItemPart:{category:g,description:Object(n.a)(i.o),hotmail:",",gmail:"p",owa:","},expandCollapseAll:{category:g,description:Object(n.a)(i.k),hotmail:"x",owa:"x"},expandAll:{category:g,description:Object(n.a)(i.l),gmail:";"},collapseAll:{category:g,description:Object(n.a)(i.e),gmail:":"},softDeleteMail:{category:b,description:Object(n.a)(i.S),hotmail:"shift+del",yahoo:"shift+del",gmail:"shift+del",owa:"shift+del"},newFolder:{category:b,description:Object(n.a)(i.G),hotmail:"shift+e",yahoo:"ctrl+shift+e",owa:"shift+e"},markAsRead:{category:b,description:Object(n.a)(i.D),hotmail:"q",yahoo:"k",gmail:"shift+i",owa:Object(m.i)()?"q":["q","ctrl+q"]},markAsUnread:{category:b,description:Object(n.a)(i.E),hotmail:"u",yahoo:"shift+k",gmail:"shift+u",owa:["u","ctrl+u"]},toggleFlag:{category:b,description:Object(n.a)(i.m),hotmail:"ins",yahoo:"l",gmail:"s",owa:"ins"},archiveMail:{category:b,description:Object(n.a)(i.a),hotmail:"e",gmail:"e",owa:"e"},markAsJunk:{category:b,description:Object(n.a)(i.C),hotmail:"j",gmail:"shift+1",owa:"j"},moveToFolder:{category:b,description:Object(n.a)(c.a),hotmail:"v",gmail:"v",owa:"v"},categorize:{category:b,description:Object(n.a)(i.b),hotmail:"c",gmail:"l",owa:"c"},insertHyperlink:{category:d,description:Object(n.a)(i.B),hotmail:"ctrl+k",gmail:"ctrl+k",owa:"ctrl+k"},keyboardShortcuts:{category:h,description:Object(n.a)(i.R),hotmail:"?",gmail:"?",owa:"?",yahoo:"?"}},e)}},3001:function(e,t,a){"use strict";var r=a(4);t.a=Object(r.action)("SHOW_IN_IMMERSIVE_READER",(function(e,t,a){return{itemId:e,actionSource:t,subActionSource:a}}))},3007:function(e){e.exports=JSON.parse('{"V":"yVb","i":"zVb","L":"AVb","s":"BVb","h":"CVb","w":"DVb","F":"EVb","Q":"FVb","N":"GVb","M":"HVb","p":"IVb","O":"JVb","g":"KVb","u":"LVb","q":"MVb","v":"NVb","y":"OVb","z":"PVb","t":"QVb","r":"RVb","x":"SVb","P":"TVb","U":"UVb","c":"VVb","A":"WVb","j":"XVb","f":"YVb","H":"ZVb","I":"_Vb","d":"$Vb","J":"aWb","K":"bWb","n":"cWb","o":"dWb","k":"eWb","l":"fWb","e":"gWb","S":"hWb","G":"iWb","D":"jWb","E":"kWb","m":"lWb","a":"mWb","C":"nWb","b":"oWb","B":"pWb","R":"qWb","T":"rWb"}')},3197:function(e){e.exports=JSON.parse('{"a":"sWb"}')},4501:function(e,t,a){"use strict";var r=a(0),o=a(4834),i=a(8),c=a(4),n=a(3001),s=function(e){return new Promise((function(t){return setTimeout((function(){t()}),e)}))},l=a(4835),m=a.n(l);function d(e,t,a,r){return m()({itemId:e,sessionId:t,version:a},r)}var u=a(193),g=a(896),h=a(454),b=a.n(h),f=(Object(c.orchestrator)(n.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,a,c,n,l,m,h,O,j,w,R,S,I,V;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.itemId,a=v(),!t||a.isLoading||0!==a.immersiveReaderFrameState)return[2];(c=new u.a("ShowInImmersiveReader")).addCustomData({sessionId:a.sessionId,subAction:e.subActionSource}),c.addActionSource(e.actionSource),f(!0),p(!0),n=(new Date).getUTCMilliseconds(),l=!0,m=null,h=null,r.label=1;case 1:return r.trys.push([1,7,8,9]),[4,d(b()({Id:t.Id}),a.sessionId,"2.0",null===(V=t.mailboxInfo)||void 0===V?void 0:V.requestOptions)];case 2:if(O=r.sent(),c.addCheckmark("ImmersiveReaderProcessText_Done"),O&&O.ReaderModelJson?m=JSON.parse(O.ReaderModelJson):(l=!1,h="Response from service call was null or did not contain a ReaderModelJson"),!l)return[3,6];j=(new Date).getUTCMilliseconds(),w=(j-n).toString(),null,m.launchToPostMessageSentDurationInMs=w,y({messageType:"LinguisticModel",messageValue:m}),R=120,S=0,r.label=3;case 3:return S<R&&1===v().immersiveReaderFrameState?[4,s(500)]:[3,5];case 4:return r.sent(),S++,[3,3];case 5:1===v().immersiveReaderFrameState&&(l=!1,h="Frame never got to Ready state"),r.label=6;case 6:return[3,9];case 7:return I=r.sent(),l=!1,c.addCheckmark("CaughtException"),h=I.toString(),[3,9];case 8:return f(!1),[7];case 9:return l?c.end():(p(!1),c.endWithError("ServerError",new Error(h)),Object(g.b)(Object(i.a)(o.b),Object(i.a)(o.a),!1,{hideCancelButton:!0})),[2]}}))}))})),Object(c.mutatorAction)("toggleImmersiveReaderLoadingState",(function(e){v().isLoading=e}))),p=Object(c.mutatorAction)("toggleImmersiveReaderShowingState",(function(e){v().immersiveReaderFrameState=e?1:0})),y=Object(c.mutatorAction)("setImmersiveReaderApiResponse",(function(e){v().apiResponse=e})),O=a(452),j={sessionId:Object(O.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},v=Object(c.createStore)("immersivereader",j),w=v(),R=Object(c.mutatorAction)("setImmersiveReaderFrameReady",(function(){v().immersiveReaderFrameState=2})),S=Object(c.mutatorAction)("closeImmersiveReader",(function(){var e=v();e.immersiveReaderFrameState=0,e.apiResponse=null}));a.d(t,"e",(function(){return w})),a.d(t,"b",(function(){return v})),a.d(t,"c",(function(){return R})),a.d(t,"a",(function(){return S})),a.d(t,"d",(function(){return n.a}))},4834:function(e){e.exports=JSON.parse('{"b":"nja","a":"oja"}')},4835:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(38),o=a(454);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=o.default(e.itemId)),r.makeServiceRequest("ImmersiveReaderProcessText",e,t)}},8713:function(e,t,a){"use strict";a.r(t);var r=a(25),o=a(11281),i=a(8),c=a(12),n=a(1),s=a(193),l=a(1167),m=a(37),d=a(18),u=a(4501),g=a(2558),h=a(1242),b=a(2476),f=a(11282),p="https://learningtools.edog.onenote.com/learningtoolsapp/reader",y="https://learningtools.onenote.com/learningtoolsapp/reader";function O(e){Object(g.a)("Keyboard")}var j=Object(r.a)((function(e){var t=n.useRef();Object(h.c)(t,Object(b.b)().closeMail,O),n.useEffect((function(){var e=Object(c.autorun)((function(){u.e.apiResponse&&2===u.e.immersiveReaderFrameState&&r.current&&(g.current&&g.current.addCheckmark("SendingPostMessageToFrame"),r.current.contentWindow.postMessage(JSON.stringify(u.e.apiResponse),"*"))}));return function(){e()}}),[]);Object(l.a)("message",(function(e){e&&0!==u.e.immersiveReaderFrameState&&0===a.current.toLowerCase().indexOf(e.origin.toLowerCase())&&("ImmersiveReader-ReadyForContent"===e.data?(g.current&&g.current.addCheckmark("ReceivedReadyForContent"),Object(u.c)(),r.current.focus()):"CloseImmersiveReader"===e.data&&(g.current&&g.current.addCheckmark("ReceivedCloseReader"),j.current=!0,Object(u.a)()))}));var a=n.useRef(function(){var e=y;Object(m.f)("rp-immersiveReaderDogfood")&&(e=p);var t=Object(d.a)().SessionSettings.UserCulture;return e+"?exitCallback=CloseImmersiveReader&appId=OWA&sessionId="+u.e.sessionId+"&ui="+t+"&appSubId=React"}()),r=n.useRef(),g=n.useRef(),j=n.useRef();return 0===u.e.immersiveReaderFrameState||g.current?0===u.e.immersiveReaderFrameState&&g.current&&(j.current?g.current.end():g.current.endWithError("ServerError",new Error("Did not receive close callback")),g.current=null):(g.current=new s.a("ImmersiveReaderContainer"),g.current.addCustomData({sessionId:u.e.sessionId}),j.current=!1),0!==u.e.immersiveReaderFrameState?n.createElement("div",{className:f.immersiveReaderContainer,ref:t},n.createElement("iframe",{id:"immersive-reader-iframe",className:f.immersiveReaderIframe,title:Object(i.a)(o.a),allowFullScreen:!0,src:a.current,ref:function(e){g.current&&g.current.addCheckmark("GotFrameRef"),r.current=e}})):null}));a.d(t,"ImmersiveReaderContainer",(function(){return j}))}}]);
//# sourceMappingURL=owa.ImmersiveReaderContainer.js.map
self.scriptsLoaded['owa.ImmersiveReaderContainer.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ImmersiveReaderContainer.js'] = (new Date()).getTime();