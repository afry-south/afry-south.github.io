self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Addins.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[106,6,28,30,50],{1008:function(e,t,n){"use strict";var r,a=n(4),i=n(165);!function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.EnterpriseOptInFRE="24",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56"}(r||(r={}));var o=n(1163);Object(a.orchestrator)(o.a,(function(e){var t=e.event,n=e.id;Object.keys(r).some((function(e){return r[e]==n&&(Object(i.o)(t,{key:e,id:n},{isCore:!0}),!0)}))}));var s=n(0),c=n(29),u=n(77),l=n(917),d=n(52),f=n(104),p=n(3),m=n(13),g=Object(f.action)("initializeLightning")((function(e){var t,n;if(d.d.info("initialize lightning store"),Object(l.a)().lastShownId=null,Object(l.a)().lightedCount=0,Object(l.a)().unseenItems=new m.ObservableMap,e)try{for(var r=Object(s.__values)(e),a=r.next();!a.done;a=r.next()){var i=a.value;Object(l.a)().unseenItems.set(i.identity,i)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}));var v=n(196),h="ows/v1.0/lightning/items/unseen";function b(){return d.d.info("initialize lightning from server"),Object(v.b)(h).then((function(e){var t=e.map(y);g(t)}))}function y(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var _,O=n(20),S=n(51),C="lightning",I="UnseenLightening";function A(){var e,t,n;if(!_){var r=Object(p.a)(C);if(r)_=function(e){d.d.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return g(t),Promise.resolve()}(r);else{var a=Object(O.a)().PrimeSettings;if(Object(S.f)("lightning-initFromSD")&&a&&a.Items)try{for(var i=Object(s.__values)(a.Items),o=i.next();!o.done;o=i.next()){var c=o.value;if(c.Id===I&&c.Value){n=c.Value,d.d.info("initialize lightning from session data"),g(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),_=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}_||(_=b())}}return _}var x,E=Object(f.action)("lightup")((function(e){d.d.info("lightup - id:"+e),Object(l.a)().lastShownId=e,Object(l.a)().lightedCount++;var t=Object(l.a)().unseenItems.get(e);t&&(t.visible=!0),Object(o.a)("LIGHTUP",e)})),T=n(451);function w(e,t){(d.d.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(l.a)().lightedCount+", lastShown:"+Object(l.a)().lastShownId),Object(T.u)())?d.d.info("lightning is disabled for deeplink"):Object(l.a)().unseenItems.has(e)&&(!Object(l.a)().lastShownId||function(e,t){var n=!1,r=Object(l.a)().lastShownId;if(r&&t&&!function(){var e=Object(l.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var a=t.indexOf(r),i=t.indexOf(e);a>=0&&a+1==i&&(n=!0)}return n}(e,t)||function(e){var t=Object(l.a)().unseenItems.get(e);return!!t&&t.category==x.UIFeatureDiscovery}(e))&&E(e)}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(x||(x={}));var j=Object(f.action)("beginLightning")((function(e,t,n){d.d.info("beginLightning - id:"+e),t((function(){A().then((function(){return w(e,n)})).catch((function(t){d.d.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))})),P=new u.c((function(){return n.e(319).then(n.bind(null,13672))})),M=new u.a(P,(function(e){return e.endLightningImp})),k=n(1),R=n.n(k);function D(e,t){var n=function(t,n){return R.a.createElement(N,Object(s.__assign)({},t),R.a.createElement(e,Object(s.__assign)({},t)))};return n.displayName=e.displayName,t?R.a.forwardRef(n):n}var N=Object(c.a)((function(e){var t=e.lid,n=e.when,r=e.series,a=e.children;return R.a.useEffect((function(){return j(t,n,r),function(){M.importAndExecute(t)}}),[]),a&&L(t)?R.a.createElement(R.a.Fragment,null,a):null}));function F(e,t){M.importAndExecute(e,t)}function L(e){if(l.b.unseenItems){var t=l.b.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}n.d(t,"c",(function(){return D})),n.d(t,"a",(function(){return N})),n.d(t,"d",(function(){return F})),n.d(t,"e",(function(){return L})),n.d(t,"b",(function(){return r}))},1012:function(e,t,n){"use strict";var r=n(13),a=n(4),i={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),s=o();n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}))},1013:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return u}));var r=n(5),a=Object(r.Qb)("UTC",4500,8,1),i=Object(r.tb)(a).slice(0,-1);function o(e){return c(e.lastDeliveryOrRenewTimeStamp)}function s(e){return c(e.ReceivedOrRenewTime)}function c(e){return e===u()||new Date(e).getTime()==Object(r.zb)(a)}function u(){try{return new Date(Object(r.zb)(a)).toLocaleString(),Object(r.lc)(a).toString()}catch(e){return null}}},1014:function(e,t,n){"use strict";var r,a=n(77),i=n(1055),o=n(1056),s=n(1883);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.Unknown="Unknown"}(r||(r={}));var c=n(1219),u=n(1195),l=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function d(e){var t=Object(u.a)(e);return t&&-1!==l.indexOf(t.source)}var f=n(1736);function p(e){var t=Object(u.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:d(e)?"newLink":"oldLink"}:null}var m=n(1884);function g(){return Object(m.a)().sharingLinks.size}n.d(t,"o",(function(){return h})),n.d(t,"s",(function(){return b})),n.d(t,"w",(function(){return y})),n.d(t,"u",(function(){return _})),n.d(t,"t",(function(){return O})),n.d(t,"r",(function(){return S})),n.d(t,"v",(function(){return C})),n.d(t,"q",(function(){return I})),n.d(t,"p",(function(){return A})),n.d(t,"y",(function(){return v})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return i.b})),n.d(t,"e",(function(){return i.c})),n.d(t,"g",(function(){return i.d})),n.d(t,"B",(function(){return i.f})),n.d(t,"x",(function(){return i.e})),n.d(t,"C",(function(){return o.e})),n.d(t,"D",(function(){return o.f})),n.d(t,"E",(function(){return o.g})),n.d(t,"A",(function(){return o.c})),n.d(t,"f",(function(){return o.b})),n.d(t,"z",(function(){return s.b})),n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return c.a})),n.d(t,"i",(function(){return c.b})),n.d(t,"n",(function(){return c.c})),n.d(t,"m",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"l",(function(){return u.a})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return g}));var v=new a.c((function(){return Promise.all([n.e(6),n.e(14),n.e(48),n.e(321)]).then(n.bind(null,13413))})),h=new a.b(v,(function(e){return e.addRecipientsIntoLink})),b=new a.b(v,(function(e){return e.removeRecipientsFromLink})),y=new a.b(v,(function(e){return e.updateRecipientPermissionInfos})),_=new a.b(v,(function(e){return e.setGetPermissionInfoFailure})),O=new a.b(v,(function(e){return e.resetSharingRecipientsInfo})),S=new a.b(v,(function(e){return e.ignoreSharingTip})),C=new a.b(v,(function(e){return e.setLinkActionStatus})),I=new a.b(v,(function(e){return e.getSharingTipRecipientInfo})),A=new a.b(v,(function(e){return e.createCloudFileFromSharingLink}))},1016:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("getCloudCacheAccount",(function(e){return{webSessionType:e}}))},1026:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(r||(r={}))},1029:function(e,t,n){"use strict";var r=n(77),a=n(1168),i=n(1422),o=(n(1634),n(1521)),s=n(1368),c=n(1012),u=n(993),l=n(52);function d(e,t,n){var r,a=Object(c.b)();if(e){switch(e.type){case u.a.SecondaryReadingPane:e.data.listViewType==n&&(r=Object(s.a)(t,n));break;case u.a.Compose:r=a.viewStates.get(e.data);break;case u.a.Primary:r=t?Object(s.a)(t,n,!0):null;break;default:r=null}return r}return l.d.error("There is no active tab. Something went very wrong."),null}var f=n(1666),p=n(1697);function m(){var e=Object(u.c)(),t=Object(c.b)(),n=e?function(e,t){switch(e.type){case u.a.Primary:return t.primaryComposeId;case u.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,r=n?t.viewStates.get(n):null;return r&&!r.isInlineCompose?r:null}var g=n(1698);n.d(t,"t",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"g",(function(){return _})),n.d(t,"k",(function(){return O})),n.d(t,"o",(function(){return S})),n.d(t,"r",(function(){return C})),n.d(t,"w",(function(){return I})),n.d(t,"p",(function(){return A})),n.d(t,"v",(function(){return x})),n.d(t,"s",(function(){return E})),n.d(t,"q",(function(){return T})),n.d(t,"i",(function(){return w})),n.d(t,"n",(function(){return j})),n.d(t,"u",(function(){return P})),n.d(t,"h",(function(){return M})),n.d(t,"l",(function(){return k})),n.d(t,"j",(function(){return R})),n.d(t,"x",(function(){return D})),n.d(t,"c",(function(){return a.c})),n.d(t,"f",(function(){return i.b})),n.d(t,"e",(function(){return o.a})),n.d(t,"b",(function(){return s.a})),n.d(t,"a",(function(){return d})),n.d(t,"y",(function(){return f.a})),n.d(t,"A",(function(){return p.a})),n.d(t,"d",(function(){return m})),n.d(t,"z",(function(){return g.a}));var v=new r.c((function(){return Promise.all([n.e(1),n.e(4),n.e(5),n.e(7),n.e(331)]).then(n.bind(null,13237))})),h={captureBundleTime:!0},b=new r.a(v,(function(e){return e.replyToMessage}),h),y=new r.a(v,(function(e){return e.forwardMessage}),h),_=new r.a(v,(function(e){return e.closeCompose})),O=new r.a(v,(function(e){return e.discardCompose})),S=new r.a(v,(function(e){return e.loadDraftToCompose})),C=new r.a(v,(function(e){return e.openCompose})),I=new r.a(v,(function(e){return e.trySaveAndCloseCompose})),A=new r.a(v,(function(e){return e.moveComposeToTab})),x=new r.a(v,(function(e){return e.tryCreateResendDraft})),E=new r.a(v,(function(e){return e.replyToApprovalMessage})),T=new r.a(v,(function(e){return e.onEditDraftButtonClicked})),w=new r.b(v,(function(e){return e.createReply})),j=new r.b(v,(function(e){return e.getToCcRecipientsForReply})),P=new r.b(v,(function(e){return e.replyToMessageAndCreateViewState})),M=new r.b(v,(function(e){return e.createAttachments})),k=(new r.b(v,(function(e){return e.findComposeFromRecipientWell})),new r.b(v,(function(e){return e.extractComposePopoutData}))),R=new r.b(v,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),D=new r.b(v,(function(e){return e.insertSignature}))},1031:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("SET_LOADING_STATE_FOR_FOLDER_TREE",(function(e,t){return{folderTreeId:e,loadingState:t}}))},1032:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("ON_FIND_FOLDER_RESPONSE",(function(e,t,n,r,a,i){return{rootFolder:e,distinguishedFolderId:t,treeType:n,principalSMTPAddress:r,displayName:a,folderTreeIdentifier:i}}))},1033:function(e,t,n){"use strict";var r=n(1271),a=n(2544),i=n(2444);t.a=function(e,t){return Object(i.a)(Object(a.a)(e,t,r.a),e+"")}},1035:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}n.d(t,"a",(function(){return r}))},1037:function(e,t,n){"use strict";var r=n(104),a=n(831),i=n(858);t.a=Object(r.select)({folderTable:function(){return Object(i.a)().folderTable}})((function(e,t){var n=Object(a.a)(e);return n||(n=e),t.folderTable.get(n).FolderId}))},1038:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return m}));var r=n(7),a=n(1155),i=n(52),o=n(853),s=n(836),c=n(20),u=n(206);function l(e){try{if(!e)return null;for(var t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),o=0;o<n;o++)r[o]=t.charCodeAt(o);return Object(a.a)(r)}catch(t){return i.d.error("getMailboxGuidFromEwsId : conversion failed for id "+e+" with error "+t),null}}function d(e,t){if(!e||!t)return null;return r.b("{0}@{1}",e,t)}function f(e){if(Object(u.a)()||!e)return null;var t=Object(c.a)().SessionSettings,n=Object(o.a)(),r=n&&n.get(e);return r||e===s.d?e===s.d?d(t.ArchiveMailboxGuid,t.OrganizationDomain):r.treeType===s.c?d((null==r?void 0:r.ReplicaList)?r.ReplicaList[0]:t.ArchiveMailboxGuid,t.OrganizationDomain):r.treeType===s.j?d(l(e),t.OrganizationDomain):null:null}function p(e){if(Object(u.a)()||!e)return null;var t=Object(o.a)(),n=t&&t.get(e);return n&&n.treeType===s.c&&n.ReplicaList?n.ReplicaList[0]:null}function m(e){if(Object(u.a)()||!e)return null;var t=Object(c.a)().SessionSettings,n=l(e);return n===t.MailboxGuid?null:d(n,t.OrganizationDomain)}},1043:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(0),a=n(13),i=n(51),o=n(1183),s=n(4),c={conversationReadingPaneViewState:null,loadedConversationReadingPaneViewStates:new a.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1},u=Object(s.createStore)("readingpane",c),l=u();o.a.registerReference((function(){var e,t;return Object(i.f)("rp-persistedReadingPaneTabs")?Object(r.__spread)(l.loadedConversationReadingPaneViewStates.keys()):null===(t=null===(e=l.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===t?void 0:t.Id})),t.a=l},1044:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=a},1048:function(e,t,n){"use strict";var r=n(1685);var a=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=a(e,t);return Object(r.a)(n)?n:void 0}},1051:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},1053:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"r",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"p",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"t",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"k",(function(){return _})),n.d(t,"c",(function(){return O})),n.d(t,"o",(function(){return S})),n.d(t,"s",(function(){return C})),n.d(t,"b",(function(){return I})),n.d(t,"m",(function(){return A})),n.d(t,"h",(function(){return x}));var r=n(77),a=n(1225);n.d(t,"u",(function(){return a.a}));var i=n(1226);n.d(t,"v",(function(){return i.a}));n(899),n(972);var o=new r.c((function(){return Promise.all([n.e(12),n.e(609),n.e(6),n.e(14),n.e(124)]).then(n.bind(null,2374))})),s=new r.a(o,(function(e){return e.initializeAttachments})),c=new r.a(o,(function(e){return e.reinitializeAttachments})),u=new r.a(o,(function(e){return e.setInlineAttachmentStatus})),l=new r.a(o,(function(e){return e.addAttachmentIntoWellBeforeUpload})),d=new r.b(o,(function(e){return e.refreshSharingTipsAttachmentWell})),f=new r.b(o,(function(e){return e.createAttachmentsViaQueueManager})),p=new r.b(o,(function(e){return e.createAttachmentsFromRecentAttachments})),m=new r.a(o,(function(e){return e.deleteAttachmentViaQueueManager})),g=new r.b(o,(function(e){return e.createAttachmentFullViewStateAndStoreBackingModel})),v=new r.b(o,(function(e){return e.createAttachmentFullViewState})),h=new r.b(o,(function(e){return e.getAttachmentWellInitialValue})),b=new r.b(o,(function(e){return e.getAttachmentWellForCompose})),y=new r.b(o,(function(e){return e.getConversationAttachmentWellInitialValue})),_=(new r.b(o,(function(e){return e.getMaxClassicAttachmentsSize})),new r.b(o,(function(e){return e.getAvailableLocalAttachmentSize}))),O=new r.b(o,(function(e){return e.createAttachmentFileFromExistingMailboxAttachment})),S=new r.a(o,(function(e){return e.mergeToConversationAttachmentWell})),C=new r.a(o,(function(e){return e.sortConversationAttachmentWell})),I=new r.a(o,(function(e){return e.convertImageViewAttachmentToInlineAttachment})),A=new r.b(o,(function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),x=new r.b(o,(function(e){return e.getAllValidAttachments}))},1054:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return e.RoutingType+":"+n}n.d(t,"a",(function(){return r}))},1055:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(4),a=Object(r.action)("ADD_SHARING_LINK",(function(e,t,n,r,a,i){return{linkId:e,url:t,sharingLinkIds:n,response:r,source:a,providerType:i}})),i=Object(r.action)("SHARING_LINK_REMOVED",(function(e,t){return{linkId:e,sharingLinkIds:t}})),o=Object(r.action)("DELETE_LINK",(function(e){return{linkId:e}})),s=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(e,t,n){return{linkId:e,providerId:t,isTryAgain:n}})),c=Object(r.action)("ON_LINK_HAS_CHANGED",(function(e,t,n){return{linkId:e,recipientInfos:t,composeId:n}})),u=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(e,t){return{linkId:e,linkIdContainer:t}}))},1056:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(4),a=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(e,t){return{linkId:e,sharingDialogResponse:t}})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(e,t){return{linkId:e,newPermission:t}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(e,t,n,r){return{linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r}})),s=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(e,t){return{linkId:e,actionStatus:t}})),c=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(e,t,n,r,a,i,o,s){return{linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:a,providerType:i,composeId:o,recipientInfos:s}})),u=Object(r.action)("ADD_SHARING_LINK_INFO",(function(e,t){return{linkId:e,linkModel:t}})),l=Object(r.action)("TOKEN_UNAVAILABLE",(function(e){return{linkId:e}}))},1062:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(r||(r={}))},1063:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(894),a=n(908);function i(){var e=Object(a.c)();return e<=999?198:e<=1199?236:e<=1399?254:e<=1599?300:e<=1600?320:r.c}function o(){var e=Object(a.c)();return e<=999?350:e<=1199?380:e<=1399?452:e<=1599?540:e<=1600?574:r.e}},1064:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(77),a=new r.c((function(){return n.e(448).then(n.bind(null,2880))})),i=new r.b(a,(function(e){return e.searchSuggestionsForSinglePersona})),o=new r.b(a,(function(e){return e.searchSuggestions}))},1066:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(882),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(a.a)()),{defaultOptions:e}}))},1077:function(e,t,n){"use strict";var r=n(1),a=n(1592),i=n(0),o=n(29),s=n(580),c=n(128),u=n(217),l=n(262),d=n(859),f=n(981),p=n(51),m=n(2),g=n(20),v=n(197),h=n(1008),b=n(477),y=n(165),_=n(1831),O=n(1832),S=n(1833),C=n(219).bind(S);function I(e,t){switch(e.title){case"Outlook":case"Gmail":return C(t&&S.floatingBorder);default:return""}}function A(e,t){switch(e.title){case"Outlook":return C(S.leftRailButton,S.outlookButton,!t&&S.leftRailButtonUnselected);case"Gmail":return C(S.leftRailButton,S.gmailButton,!t&&S.leftRailButtonUnselected);case"AddNew":return C(S.addNewButton);default:return""}}function x(e){1==Object(g.a)().SessionSettings.WebSessionType&&setTimeout(e,125)}var E=Object(o.a)((function(e){r.useEffect((function(){2===Object(g.a)().SessionSettings.WebSessionType?Object(f.c)():Object(f.d)(Object(g.a)().SessionSettings.WebSessionType)}),[]);var t=r.useRef(),n=function(e,t){return 2===e.sessionType&&null===f.g.cloudCacheConfigItem.emailAddress?r.createElement("div",null,r.createElement("div",{ref:a},r.createElement(u.a,{iconName:"NewMail",className:A(e,t),ariaLabel:e.ariaLabel,title:e.ariaLabel})),r.createElement(f.a,{lid:h.b.AddCloudCacheAccountCallout,target:o,when:x})):r.createElement(l.a,{shouldFadeIn:!1,src:Object(v.resolve)(Object(m.q)(),e.iconUrl),className:A(e,t),"aria-label":e.ariaLabel,title:e.ariaLabel})},a=function(e){return t.current=e},o=function(){return t.current},E=[],T={role:d.a.menu},w=C(e.className,S.container);return Object(p.f)("auth-cloudCache")&&!Object(g.a)().IsConsumerChild&&(Object(g.a)().SessionSettings.IsPremiumConsumerMailbox||Object(g.a)().SessionSettings.IsShadowMailbox)&&Object(b.a)((null===window||void 0===window?void 0:window.location)?window.location.pathname:null)&&(E=[{iconUrl:_,action:Object(f.e)(1),openInSameTab:!1,title:"Outlook",sessionType:1,ariaLabel:f.g.cloudCacheConfigItem.exchangeSmtpAddress||Object(g.a)().SessionSettings.UserEmailAddress},{iconUrl:f.g.cloudCacheConfigItem.emailAddress?O:null,action:f.g.cloudCacheConfigItem.emailAddress?Object(f.e)(2)+"&login_hint="+f.g.cloudCacheConfigItem.emailAddress:Object(f.f)(2),openInSameTab:!1,title:f.g.cloudCacheConfigItem.emailAddress?"Gmail":"AddNew",sessionType:2,ariaLabel:f.g.cloudCacheConfigItem.emailAddress||"Add Gmail account"}]),r.createElement(s.a,Object(i.__assign)({className:w,isCircularNavigation:!1,direction:c.a.vertical},Object(d.b)(T)),E.map((function(t,a){var o=t.sessionType==Object(g.a)().SessionSettings.WebSessionType;o&&(t.action=e.activeAccountAction);var s={role:d.a.menuitem};return r.createElement("a",Object(i.__assign)({},Object(d.b)(s),{"data-is-focusable":!0,key:a,onClick:function(e){return function(e,t,n){e.preventDefault(),e.stopPropagation(),2==t.sessionType&&"AddNew"==t.title&&Object(y.o)("addCloudCacheAccountClickedFromAccountSwitcher",null,{isCore:!0});t.action instanceof String||"string"==typeof t.action?window.open(t.action.toString(),"_blank"):t.action instanceof Function&&t.action(e,t,n)}(e,t,a)},className:S.buttonContainer}),n(t,o),r.createElement("div",{className:I(t,o)}))})))})),T=n(841),w=n(1806),j=n(1379);function P(){return Object(p.f)("auth-cloudCache")&&(Object(T.b)()||Object(T.c)())&&Object(b.a)((null===window||void 0===window?void 0:window.location)?window.location.pathname:null)}var M=n(1836),k=n(480),R=n(122),D=n(7),N=n(778),F=n(1379),L=n(219).bind(F),U=Object(o.a)((function(e,t){var n=r.useRef(null),a=r.useRef(),i=Object(h.e)(e.lid);r.useImperativeHandle(t,(function(){return{focus:function(){n.current.focus()},openMenu:function(){n.current.openMenu()},dismissMenu:function(){n.current.dismissMenu()},getRef:function(){return a.current}}}));return r.createElement("div",{ref:a,className:L(F.hamburgerButtonWrapper,Object(R.a)("fwk-fluentCommandBar")&&F.fluent)},i&&r.createElement(N.a,{key:"overlay",className:F.freOverlay,isDarkThemed:!0,onClick:function(){e.onFreDismiss&&e.onFreDismiss()}},B(e,i,n)),!i&&B(e,i,n))}),{forwardRef:!0});function B(e,t,n){var a=e.isPaneExpanded,i=e.toggleHamburgerButton,o=e.freButtonCustomClass;return r.createElement(k.a,{key:"button",checked:a,className:L(F.hamburgerButton,t&&o),iconProps:{iconName:"GlobalNavButton"},onClick:i,title:Object(D.a)(M.a),ariaLabel:Object(D.a)(M.a),"aria-expanded":a,componentRef:n})}n.d(t,"a",(function(){return U})),n.d(t,"c",(function(){return P}));t.b=function(e){var t=e.selectedModule,n=e.activeModuleAction,i=Object(p.f)("sig-LeftNavOfficeButtonsTreatment1")||Object(p.f)("sig-LeftNavOfficeButtonsTreatment2");return r.createElement("div",{className:j.leftRail},Object(p.f)("auth-cloudCache")&&r.createElement(E,null),r.createElement(a.b,{selectedModule:t,activeModuleAction:n,isHorizontal:!1}),i&&r.createElement(w.a,{isHorizontal:!1}))}},1080:function(e,t,n){"use strict";function r(e,t){return t+e}n.d(t,"a",(function(){return r}))},1086:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},1087:function(e,t,n){"use strict";var r=n(1130),a=n(1209);t.a=function(e){return null!=e&&Object(a.a)(e.length)&&!Object(r.a)(e)}},1088:function(e,t,n){"use strict";var r=n(1043),a=n(51),i=n(993),o=n(2267);function s(e){return Object(a.f)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||function(){var e=Object(i.c)();switch(e.type){case i.a.Primary:return Object(o.a)();case i.a.SecondaryReadingPane:return e.data.id.Id;default:return null}}()):Object(r.b)().conversationReadingPaneViewState}n.d(t,"a",(function(){return s}))},1092:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r="Success";function a(e){return e&&e.ResponseClass==r}},1096:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(947),a=n(836);function i(){return Object(r.a)(a.i)}},1097:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(947),a=n(836);function i(){return Object(r.a)(a.d)}},1098:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(947);function a(e){return Object(r.a)(e)}},1099:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(544),a=n(543),i=n(450),o=n(153);function s(e,t,n,s,c,u){var l=Object(o.a)();s&&(l.RequestServerVersion=s);var d=e.map((function(e){return Object(i.a)({Id:e})}));return Object(r.a)({Header:l,Body:Object(a.a)({ItemShape:t,ItemIds:d,ShapeName:n,InternetMessageId:u})},c).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}))}},1104:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1127);function a(e){return window.location.origin+"/"+Object(r.a)()+function(e){switch(e){case 1:return"/0/";case 2:return"/1/";default:return""}}(e)+"?bO=5&nlp=1&isc="+e}function i(e){return a(2)+"&nojit=2"}},1109:function(e,t,n){"use strict";n.r(t);var r=n(996),a=n(1192),i=n(1345),o=n(1013),s=n(165),c=n(1325),u=n(838),l=n(52);function d(e){return function(e,t){return p({isPinned:t,returnTime:e.returnTime,receivedOrRenewedTime:e.lastDeliveryOrRenewTimeStamp,receivedTime:e.lastDeliveryTimeStamp})}(e,Object(o.b)(e))}function f(e){return function(e,t){return p({isPinned:t,returnTime:e.ReturnTime,receivedOrRenewedTime:e.ReceivedOrRenewTime,receivedTime:e.DateTimeReceived})}(e,Object(o.c)(e))}function p(e){var t,n=e.returnTime,r=e.receivedOrRenewedTime,a=e.receivedTime,i=e.isPinned;return!!n||!i&&r&&(t=a,!(new Date(r).setMilliseconds(0)==new Date(t).setMilliseconds(0)))}function m(e,t){return G(e,t,1)}function g(e,t){return G(e,t,2)}function v(e,t){return G(e,t,3)}function h(e,t){return G(e,t,10)}function b(e,t){return G(e,t,13)}function y(e,t){return G(e,t,5)}function _(e,t){return G(e,t,25)}function O(e,t){return G(e,t,6)}function S(e,t){return G(e,t,4)}function C(e,t){return G(e,t,14)}function I(e,t){return G(e,t,16)}function A(e,t){return G(e,t,15)}function x(e,t){return G(e,t,24)}function E(e,t){return G(e,t,17)}function T(e,t){return G(e,t,18)}function w(e,t){return G(e,t,26)}function j(e,t){return G(e,t,23)}function P(e,t){return G(e,t,22)}function M(e,t){return G(e,t,21)}function k(e,t){return G(e,t,19)}function R(e,t){return G(e,t,8)}n.d(t,"getCanDelete",(function(){return m})),n.d(t,"getCategories",(function(){return g})),n.d(t,"getConversationId",(function(){return v})),n.d(t,"getIsPinned",(function(){return h})),n.d(t,"getItemIds",(function(){return b})),n.d(t,"getExecuteSearchSortOrder",(function(){return y})),n.d(t,"getUniqueSenders",(function(){return _})),n.d(t,"getFlagStatus",(function(){return O})),n.d(t,"getEffectiveMentioned",(function(){return S})),n.d(t,"getLastDeliveryOrRenewTimeStamp",(function(){return C})),n.d(t,"getLastModifiedTimeStamp",(function(){return I})),n.d(t,"getLastDeliveryTimeStamp",(function(){return A})),n.d(t,"getSubject",(function(){return x})),n.d(t,"getLastSenderMailbox",(function(){return E})),n.d(t,"getLastSenderSMTP",(function(){return T})),n.d(t,"getUnreadCount",(function(){return w})),n.d(t,"getSize",(function(){return j})),n.d(t,"getRowIdString",(function(){return P})),n.d(t,"getRowClientItemId",(function(){return M})),n.d(t,"getParentFolderId",(function(){return k})),n.d(t,"getInstrumentationContext",(function(){return R})),n.d(t,"getIsDraft",(function(){return D})),n.d(t,"getIsSubmitted",(function(){return N})),n.d(t,"getIsSnoozed",(function(){return F})),n.d(t,"getValidCouponIndexes",(function(){return L})),n.d(t,"getImportance",(function(){return U})),n.d(t,"getArchiveTag",(function(){return B})),n.d(t,"getPolicyTag",(function(){return H}));var D=function(e,t){return G(e,t,9)},N=function(e,t){return G(e,t,12)};function F(e,t){return G(e,t,11)}function L(e,t){return G(e,t,27)}function U(e,t){return G(e,t,7)}function B(e,t){return G(e,t,0)}function H(e,t){return G(e,t,20)}function G(e,t,n){switch(t.tableQuery.listViewType){case 0:return function(e,t,n){var a,i=Object(r.a)(e,t.id);if(!i)return W("getConversationProperty should not be called on conversation that not in cache.",n),null;var s=i.id,l=Object(c.a)(s),f=u.x.conversations.get(s),p=u.x.items.get(i.itemIds[0]);switch(n){case 22:return i.id;case 21:return l.clientId;case 3:return s;case 6:return i.flagStatus;case 10:return o.b(i);case 13:return i.itemIds;case 14:return i.lastDeliveryOrRenewTimeStamp;case 15:return i.lastDeliveryTimeStamp;case 16:return i.lastModifiedTimeStamp;case 26:return i.unreadCount;case 17:return null===(a=i.lastSender)||void 0===a?void 0:a.Mailbox;case 18:return i.lastSender&&i.lastSender.Mailbox.EmailAddress;case 5:return i.executeSearchSortOrder;case 19:return 1===t.tableQuery.type?i.parentFolderId:t.tableQuery.folderId;case 24:return l.subject;case 25:return i.uniqueSenders;case 23:return l.size;case 4:return i.effectiveMentioned;case 8:return i.instrumentationContext;case 2:return i.categories;case 1:return null==f?void 0:f.canDelete;case 27:return l.validCouponIndexes;case 7:return i.importance;case 0:return null==p?void 0:p.ArchiveTag;case 20:return null==p?void 0:p.PolicyTag;case 11:return d(i);case 12:case 9:default:return null}}(e,t,n);case 1:return function(e,t,n){var r,s=Object(a.a)(e,t.id);if(!s)return W("getItemProperty: item not in item relations.",n),null;var c=s.clientId,l=u.x.items.get(c.Id);if(!l)return W("getItemProperty: Item not in item cache.",n),null;var d=Object(i.a)(l)?l:null,p=null===(r=null==d?void 0:d.From)||void 0===r?void 0:r.Mailbox;switch(n){case 22:return c.Id;case 21:return c;case 3:return d.ConversationId.Id;case 6:return l.Flag?l.Flag.FlagStatus:null;case 10:return o.c(l);case 13:return[c.Id];case 14:return l.ReceivedOrRenewTime;case 15:return l.DateTimeReceived;case 16:return l.LastModifiedTime;case 26:return d&&!d.IsRead?1:0;case 17:return p;case 18:return null==p?void 0:p.EmailAddress;case 25:return p?[p.Name]:null;case 5:return s.executeSearchSortOrder;case 19:return l.ParentFolderId.Id;case 24:return l.Subject;case 23:return l.Size;case 4:return l.MentionedMe;case 9:return l.IsDraft;case 12:return l.IsSubmitted;case 8:return s.instrumentationContext;case 2:return l.Categories;case 1:return l.CanDelete;case 27:return l.validCouponIndexes;case 7:return l.Importance;case 0:return l.ArchiveTag;case 20:return l.PolicyTag;case 11:return f(l);default:return null}}(e,t,n);default:return null}}function W(e,t){var n=Object(s.q)(),r=e+" PropertyType:"+t;n&&(r+=" Scenario:"+n.eventName),l.d.error(r)}},1110:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},1113:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("removeCloudCacheAccount")},1126:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"BodyContentType:#Exchange"},e)}},1127:function(e,t,n){"use strict";function r(){var e=window.location.pathname;"/"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1));var t=e.indexOf("/"),n=e.substr(t+1);return-1===t?e:n.split("/")[0]}n.d(t,"a",(function(){return r}))},1130:function(e,t,n){"use strict";var r=n(455),a=n(339),i="[object AsyncFunction]",o="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";t.a=function(e){if(!Object(a.a)(e))return!1;var t=Object(r.a)(e);return t==o||t==s||t==i||t==c}},1131:function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},1132:function(e,t,n){"use strict";var r=n(1759),a=n(1712),i=n(1087);t.a=function(e){return Object(i.a)(e)?Object(r.a)(e):Object(a.a)(e)}},1135:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(223);function a(e){return{headers:Object(r.f)(e,"GroupMailbox")}}},1140:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1147:function(e,t,n){"use strict";var r=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return r.Value}},a=function(e){return"false"!==r(e,"0x10f4")},i=function(e){return parseInt(r(e,"SourceWellKnownFolderType"),10)},o=n(831);var s=function(e,t){switch(e){case Object(o.a)("inbox"):return"Inbox";case Object(o.a)("sentitems"):return"Send";case Object(o.a)("drafts"):return"Edit";case Object(o.a)("deleteditems"):return"Delete";case Object(o.a)("archive"):return"Archive";case Object(o.a)("junkemail"):return"Blocked";case Object(o.a)("scheduled"):return"Clock";case Object(o.a)("notes"):return"QuickNote"}return t?"FabricFolder":null},c=n(0),u=n(1),l=u.lazy((function(){return Promise.all([n.e(8),n.e(745),n.e(28),n.e(803)]).then(n.bind(null,13315))})),d=function(e){return u.createElement(u.Suspense,{fallback:u.createElement("div",{className:e.className})},u.createElement(l,Object(c.__assign)({},e)))};n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}))},115:function(e,t,n){"use strict";var r;!function(e){e[e.None=-1]="None",e[e.Red=0]="Red",e[e.Orange=1]="Orange",e[e.Peach=2]="Peach",e[e.YellowLight=3]="YellowLight",e[e.GreenLight=4]="GreenLight",e[e.TealLight=5]="TealLight",e[e.Olive=6]="Olive",e[e.BlueSky=7]="BlueSky",e[e.PurpleLight=8]="PurpleLight",e[e.Pink=9]="Pink",e[e.SteelLight=10]="SteelLight",e[e.SteelGrey=11]="SteelGrey",e[e.GreyLight=12]="GreyLight",e[e.GreyDark=13]="GreyDark",e[e.Black=14]="Black",e[e.RedDark=15]="RedDark",e[e.OrangeDark=16]="OrangeDark",e[e.BrownMedium=17]="BrownMedium",e[e.YellowDark=18]="YellowDark",e[e.GreenDark=19]="GreenDark",e[e.TealDark=20]="TealDark",e[e.OliveDark=21]="OliveDark",e[e.BlueDark=22]="BlueDark",e[e.PurpleDark=23]="PurpleDark",e[e.MagentaDark=24]="MagentaDark"}(r||(r={})),t.a=r},1150:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(883),a=n(905);function i(e){var t=Object(a.a)(),n=t&&t.get(e);return(null==n?void 0:n.loadingState)||r.a.Uninitialized}},1155:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(52);function a(e){if(!e)return null;var t=e,n=0;if(1==t[0]){if(!(t=o(t)))return null}else n=1;var a=t[++n]+(t[n+1]>>8);return function(e,t,n){if(t+n>e.length)return r.d.error("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var a="",i=t;i<t+n;i++)a+=String.fromCharCode(e[i]);return a}(t,n+=2,a)}function i(e){if(!e)return!1;try{for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);var a=0;return 1===n[0]?n=o(n):a=1,n&&1===n[a]}catch(e){return!1}}function o(e){var t=s(e,null);if(0==t)return r.d.error("rleDecompress : Invalid id"),null;var n=new Uint8Array(t);return s(e,n),n}function s(e,t){for(var n=0,a=1;a<e.length;++a)if(a==e.length-1||e[a]!=e[a+1])null!=t&&(t[n]=e[a]),n++;else{if(a==e.length-2)return r.d.error("decompressEx : Invalid id"),null;for(var i=e[a+2],o=0;o<i+2;o++)null!=t&&(t[n]=e[a]),n++;a+=2}return n}},1156:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(20),a=n(52),i=n(1157),o=n(894),s=n(1063);function c(){var e=i.b,t=i.a,n=Object(r.a)().ViewStateConfiguration.GlobalFolderViewState;if(n)try{var c=JSON.parse(n),u=c.Width,l=c.Height;e=u||e,t=l||t}catch(e){a.d.warn("GetListViewDimensions: De-serialize globalFolderViewState failed: "+e.Message)}return{listViewWidth:e=Math.min(Object(s.b)(),Math.max(e,o.h)),listViewHeight:t=Math.min(o.d,Math.max(t,o.g))}}},1157:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));var r=350,a=270,i=418},1158:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("setShowListPane",(function(e){return{showListPane:e}}))},1159:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},1160:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(891),i=n(888),o=n(52);function s(){var e,t,n=Object(i.a)();try{for(var s=Object(r.__values)(n.tabs),c=s.next();!c.done;c=s.next()){var u=c.value;if(2==u.state&&u.type!=a.a.FloatingChat)return u}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return o.d.error("There is no active tab. Something went very wrong."),null}},1163:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("logLightningUsage",(function(e,t){return{event:e,id:t}}))},1167:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(844);function a(){return r.a.selectedTableViewId}},1168:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(20),a="HTML",i="Text",o="Html";function s(){return Object(r.a)().UserOptions.ComposeMarkup==o?"HTML":"Text"}},1169:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1135),a=n(85),i={};function o(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:a.a.GroupMailbox,deprecatedMailboxId:e,userIdentity:Object(a.e)().userIdentity,mailboxSmtpAddress:e,routingKey:Object(a.c)()+e,requestOptions:Object(r.a)(e)};i[t]=n}return i[t]}},1177:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return a})),n.d(t,"x",(function(){return i})),n.d(t,"v",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"m",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"k",(function(){return b})),n.d(t,"u",(function(){return y})),n.d(t,"o",(function(){return _})),n.d(t,"w",(function(){return O})),n.d(t,"p",(function(){return S})),n.d(t,"s",(function(){return C})),n.d(t,"t",(function(){return I})),n.d(t,"n",(function(){return A})),n.d(t,"r",(function(){return x}));var r="multipart/signed",a="application/pkcs7-mime",i="application/x-pkcs7-mime",o=".p7m",s="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",c="CLASSID",u="4",l="0800",d=57,f=78,p=16,m=11,g="IPM.Note.SMIME.MultipartSigned",v="smime-",h="image",b="OwaToSmime",y="SmimeToOwa",_="en-US",O=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],S="https://ow2.res.office365.com/owasmime/20.19.814.2/owasmime.msi",C="OwaSmimeEdgeExtension.appxbundle",I="https://ow2.res.office365.com/owasmime/20.19.814.2/OwaSmimeEdgeExtension.appxbundle",A="https://ow2.res.office365.com/owasmime/20.19.814.2/SmimeOutlookWebChrome.msi",x="https://ow2.res.office365.com/owasmime/20.19.814.2/SmimeOutlookWebChrome.msi"},1183:function(e,t,n){"use strict";var r=new(n(483).a)(50);t.a=r},1184:function(e){e.exports=JSON.parse('{"b":"kHb","d":"lHb","c":"mHb","a":"nHb"}')},1189:function(e,t,n){"use strict";var r=n(0),a=n(85),i=n(1054),o=n(1064),s=n(1267),c=n(4),u=Object(c.action)("resolvePendingPersonaOnRecipient",(function(e,t,n){return{recipient:e,nextPersona:t,searchedString:n}}));Object(c.mutator)(u,(function(e){var t=e.recipient,n=e.nextPersona,r=e.searchedString;Object(i.a)(t.persona.EmailAddress)===r&&(t.isPendingResolution=!1,n&&(t.persona=n,t.isValid=!0,t.displayText=Object(s.a)(n.EmailAddress)))}));var l=u,d=Object(c.action)("addRecipientsToRecipientWell",(function(e,t){return{newRecipients:e,recipientWell:t}}));t.a=d;Object(c.mutator)(d,(function(e){var t,n=e.recipientWell;(t=n.recipients).splice.apply(t,Object(r.__spread)([n.recipients.length,0],e.newRecipients)),n.isDirty=!0})),Object(c.orchestrator)(d,(function(e){var t=e.newRecipients,n=e.recipientWell;t.forEach((function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.isPendingResolution?(t=Object(i.a)(e.persona.EmailAddress),(s=n.userIdentity)||(s=Object(a.e)().userIdentity),[4,o.b.import().then((function(e){return e(s,t)}))]):[2];case 1:return c=r.sent(),l(e,c,t),[2]}}))}))}))}))},1191:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach((function(e){t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress})})),t}n.d(t,"a",(function(){return r}))},1192:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1080),a=n(844);function i(e,t){var n=Object(r.a)(e,t);return a.a.tableViewItemRelations.get(n)}},1195:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1884),a=n(1219);function i(e){var t=Object(r.a)(),n=Object(a.b)(e);return t.sharingLinks.get(n)}},1199:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,a=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,i=/\s+/g,o=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function s(e,t,n){return e?(e=function(e){return e=(e=(e=e.replace(r,"")).replace(i," ")).trim()}(e),o.test(e)||!n&&a.test(e)?"":function(e,t){var n="",r=e.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},1202:function(e,t,n){"use strict";var r;!function(e){e[e.Off=0]="Off",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom"}(r||(r={})),t.a=r},1203:function(e,t,n){"use strict";var r=n(0),a=n(1730),i=n(104),o=Object(i.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var i=e.infoBarHostKey;n&&(a.b[i]||(a.b[i]={}),a.b[i][t]=n)}}));t.a=o},1207:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},1209:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},1212:function(e,t,n){"use strict";var r=n(24),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetClientAccessTokenJsonRequest:#Exchange"},n)),Object(r.a)("GetClientAccessToken",e,t)}n.d(t,"a",(function(){return i}))},1219:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(51),a="_ODSPPSL";function i(e){return Object(r.f)("doc-link-savePermission")&&e&&-1!==e.indexOf(a)?e.substring(0,e.length-a.length):e}function o(e){return!!Object(r.f)("doc-link-savePermission")&&e.lastIndexOf(a)===e.length-a.length}function s(e,t){return!Object(r.f)("doc-link-savePermission")||2!==t&&1!==t?e:e+a}},1225:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1226:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}}))},1231:function(e,t,n){"use strict";var r=n(841),a=["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"];function i(){var e=Object(r.h)(Object(r.e)());return a.indexOf(e)>=0}var o,s={};function c(e,t){return void 0===t&&(t=!0),s[e]&&o&&-1!=o.indexOf(e)||(s[e]=new Promise((function(n,r){var a=window.document.createElement("script");a.src=e,a.type="text/javascript",t&&(a.crossOrigin="anonymous"),a.onload=function(){o?o.push(e):o=[e],n()},a.onerror=function(){r("OnError "+e)},window.document.head.appendChild(a)}))),s[e]}var u,l,d,f,p=n(51),m=n(74),g=n(20),v=["en-us","en-gb","en-ca","en-au"];function h(){if(!u){var e=Object(r.e)();u=Object(p.f)("fwk-nativeAds-bingOneClickOtherInboxOnly")&&v.indexOf(e)>-1?0:2}return u}function b(e){return y(e)?!Object(p.f)("fwk-nativeAds-honorEasyOtherOffKillSwitch")&&8&Object(g.a)().ViewStateConfiguration.FocusedInboxBitFlags||!Object(p.f)("fwk-ads-exp2-RuntimeBypass")&&("DisplayOffNativeInbox"==f||"DisplayOnNativeInbox"==f)?2:1:0}function y(e){return void 0!==l?l:(l=!1,Object(m.t)()?(d=Object(r.e)(),Object(p.f)("fwk-nativeAds-bingOneClickOtherInboxOnly")||Object(p.f)("fwk-nativeAds-prebidOneClickOtherInboxOnly")||Object(p.f)("fwk-nativeAds-appNexusOneClickOtherInboxOnly")?Object(r.b)()?l:Object(r.c)()?l:Object(r.a)()?l:r.d.indexOf(d)>-1?l:_()?l:l=!0:l):l)}function _(){return f=Object(g.a)().UserOptions.ConsumerAdsExperimentMode,!(Object(p.f)("fwk-ads-exp2-RuntimeBypass")||"DisplayOffNativeOff"!=f&&"DisplayOnNativeOff"!=f)}n.d(t,"q",(function(){return i})),n.d(t,"r",(function(){return c})),n.d(t,"e",(function(){return _})),n.d(t,"m",(function(){return y})),n.d(t,"o",(function(){return h})),n.d(t,"n",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"f",(function(){return r.d})),n.d(t,"g",(function(){return r.e})),n.d(t,"h",(function(){return r.f})),n.d(t,"j",(function(){return r.h})),n.d(t,"k",(function(){return r.i})),n.d(t,"l",(function(){return r.j})),n.d(t,"p",(function(){return r.k})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"s",(function(){return r.l})),n.d(t,"i",(function(){return r.g}))},1232:function(e,t,n){"use strict";var r=n(291),a=n(951),i=n(9),o=n(946),s={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"};n.d(t,"a",(function(){return c}));var c=Object(r.a)(a.a,(function(e){var t=e.className,n=e.showSecondaryText,r=e.theme,a=r.palette,c=r.fonts,u=Object(i.getGlobalClassNames)(s,r),l=Object(o.d)(e.size),d=Object(o.c)(e.presence),f={color:a.neutralSecondary,fontWeight:i.FontWeights.regular,fontSize:c.small.fontSize};return{root:[u.root,r.fonts.medium,i.normalize,{color:a.neutralPrimary,position:"relative",height:o.b.size48,minWidth:o.b.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},l.isSize8&&[u.size8,{height:o.b.size8,minWidth:o.b.size8}],l.isSize10&&[u.size10,{height:o.b.size10,minWidth:o.b.size10}],l.isSize16&&[u.size16,{height:o.b.size16,minWidth:o.b.size16}],l.isSize24&&[u.size24,{height:o.b.size24,minWidth:o.b.size24}],l.isSize24&&n&&{height:"36px"},l.isSize28&&[u.size28,{height:o.b.size28,minWidth:o.b.size28}],l.isSize28&&n&&{height:"32px"},l.isSize32&&[u.size32,{height:o.b.size32,minWidth:o.b.size32}],l.isSize40&&[u.size40,{height:o.b.size40,minWidth:o.b.size40}],l.isSize48&&u.size48,l.isSize56&&[u.size56,{height:o.b.size56,minWidth:o.b.size56}],l.isSize72&&[u.size72,{height:o.b.size72,minWidth:o.b.size72}],l.isSize100&&[u.size100,{height:o.b.size100,minWidth:o.b.size100}],l.isSize120&&[u.size120,{height:o.b.size120,minWidth:o.b.size120}],d.isAvailable&&u.available,d.isAway&&u.away,d.isBlocked&&u.blocked,d.isBusy&&u.busy,d.isDoNotDisturb&&u.doNotDisturb,d.isOffline&&u.offline,t],details:[u.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(l.isSize8||l.isSize10)&&{paddingLeft:17},(l.isSize24||l.isSize28||l.isSize32)&&{padding:"0 8px"},(l.isSize40||l.isSize48)&&{padding:"0 12px"}],primaryText:[u.primaryText,i.noWrap,{color:a.neutralPrimary,fontWeight:i.FontWeights.regular,fontSize:c.medium.fontSize,selectors:{":hover":{color:a.neutralDark}}},n&&{height:"16px",lineHeight:"16px",overflowX:"hidden"},(l.isSize8||l.isSize10)&&{fontSize:c.small.fontSize,lineHeight:o.b.size8},l.isSize16&&{lineHeight:o.b.size28},(l.isSize24||l.isSize28||l.isSize32||l.isSize40||l.isSize48)&&n&&{height:18},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&{fontSize:c.xLarge.fontSize},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&n&&{height:22}],secondaryText:[u.secondaryText,i.noWrap,f,(l.isSize8||l.isSize10||l.isSize16||l.isSize24||l.isSize28||l.isSize32)&&{display:"none"},n&&{display:"block",height:"16px",lineHeight:"16px",overflowX:"hidden"},l.isSize24&&n&&{height:18},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&{fontSize:c.medium.fontSize},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&n&&{height:18}],tertiaryText:[u.tertiaryText,i.noWrap,f,{display:"none",fontSize:c.medium.fontSize},(l.isSize72||l.isSize100||l.isSize120)&&{display:"block"}],optionalText:[u.optionalText,i.noWrap,f,{display:"none",fontSize:c.medium.fontSize},(l.isSize100||l.isSize120)&&{display:"block"}],textContent:[u.textContent,i.noWrap]}}),void 0,{scope:"Persona"})},1233:function(e,t,n){"use strict";var r=n(24),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"FindFolderJsonRequest:#Exchange"},n)),Object(r.a)("FindFolder",e,t)}n.d(t,"a",(function(){return i}))},1238:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindFolderRequest:#Exchange"},e)}},1239:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return p}));var r="SwitchGroup",a="NavigateFromMeToWe",i="GroupHeader_SendEmail_Button_Clicked",o="GroupHeader_Email_Button_Clicked",s="GroupHeader_Files_Button_Clicked",c="GroupHeader_Calendar_Button_Clicked",u="GroupHeader_Notebook_Button_Clicked",l="GroupHeader_Planner_Button_Clicked",d="GroupHeader_Site_Button_Clicked",f="GroupHeader_CustomLeaveGroup_Button_Clicked",p="GroupHeader_Settings_Button_Clicked"},12403:function(e){e.exports=JSON.parse('{"b":"eTb","a":"fTb"}')},1243:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r=function(e){return"extCompose_"+e},a=function(e){return"extRead_"+e},i=function(e){return 0===e.indexOf("extCompose")?"Compose":0===e.indexOf("extRead")?"Read":""}},1244:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("onClientReadingPanePositionChange")},1245:function(e,t,n){"use strict";var r=n(891),a=n(1548),i=n(1160),o=n(1904),s=n(2010),c=n(83),u=n(1268);t.a=Object(c.d)("activateTab",a.a.TabViewActivateTab)((function(e,t){switch(Object(o.a)(e,!0),e.type){case r.a.FloatingChat:return void Object(s.a)(e);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(2!=e.state){var n,a=Object(i.a)();if(a)a.state=1,(null==(n=Object(u.a)(a.type))?void 0:n.onDeactivate)&&n.onDeactivate(a);if(e)e.state=2,e.blink=!1,(null==(n=Object(u.a)(e.type))?void 0:n.onActivate)&&n.onActivate(e)}return}}))},1248:function(e,t,n){"use strict";(function(e){var r=n(385),a=n(1527),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||a.a;t.a=c}).call(this,n(1086)(e))},1249:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(77),a=new r.c((function(){return Promise.all([n.e(13),n.e(17),n.e(79),n.e(65),n.e(288)]).then(n.bind(null,3062))})),ReactEditor=Object(r.d)(a,(function(e){return e.ReactEditor})),i=new r.b(a,(function(e){return e.setTableHeaderRow})),o=new r.b(a,(function(e){return e.operateContent})),s=new r.b(a,(function(e){return e.focusToEditor}));function c(e){s.import().then((function(t){return t(e)}))}},1257:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(892);function a(){return Object(r.a)().showReadingPane}},1259:function(e,t,n){"use strict";var r=9007199254740991,a=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}},1267:function(e,t,n){"use strict";var r=n(1360),a=n(1054),i=n(206);var o=function(e,t){var n=t||e.Name;if(!n)return!0;var a,o,s=Object(r.a)(n),c=(a=n,o=e.EmailAddress,a==o||a&&o&&a.toLowerCase()==o.toLowerCase()),u=-1!==n.indexOf("@"),l=!Object(i.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),d="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&c)&&(s||u||l||d)};t.a=function(e,t){var n=t||e.Name,i=!n||Object(r.a)(n);return o(e,t)?i?Object(a.a)(e):n+" <"+Object(a.a)(e)+">":n}},1268:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(891),a={};function i(e,t){a[r.a[e]]=t}function o(e){return a[r.a[e]]}},1269:function(e,t,n){"use strict";var r=n(13),a=n(4),i={folderTable:new r.ObservableMap,rootFolder:null},o=Object(a.createStore)("publicFolderFavoriteStore",i)();t.a=o},1270:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return p}));var r=n(0),a=n(7),i=n(1044),o=n(165),s=n(1297);function c(e,t,n,r){return d(p(e),t,n,r,(function(t,n){Object(o.o)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(a.f)(e),t.sessionAdd],{sessionSampleRate:10})}))}function u(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,s.c.import().then((function(r){return r(e,t,(function(e){return f(n,e,a)}))}))];case 1:return[2,r.sent()]}}))}))}function l(e,t,n,r){return d(e,t,n,r)}function d(e,t,n,r,a){for(var o=[],s=0;o.length<t&&i.a.recipientCache&&s<i.a.recipientCache.length;){var c=i.a.recipientCache[s];if(e(c))f(n,c.EmailAddress,r)||(o.push(c),a&&a(c,s));s++}return o}function f(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var p=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),a=0;a<r.length;a++)if(0==r[a].indexOf(e))return!0}return!1}}},1271:function(e,t,n){"use strict";t.a=function(e){return e}},1275:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(0),a=n(1626),i=n(1267),o={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:a.a.None,members:[]};function s(e,t){return Object(r.__assign)(Object(r.__assign)({},o),{isValid:!0,displayText:Object(i.a)(e,t)})}},1280:function(e,t,n){"use strict";var r=n(455),a=n(1209),i=n(454),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var s=function(e){return Object(i.a)(e)&&Object(a.a)(e.length)&&!!o[Object(r.a)(e)]},c=n(1308),u=n(1581),l=u.a&&u.a.isTypedArray,d=l?Object(c.a)(l):s;t.a=d},1283:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(908);function a(){return Object(r.c)()<=918}},1287:function(e,t,n){"use strict";var r=n(4),a=n(85),i=n(827),o=n(836),s=n(13),c=Object(r.createStore)("mailboxInfoStore",new s.ObservableMap),u=n(20);function l(e){if(!e)return Object(a.e)();if(!c().has(e)){var t=function(e){var t,n,r,s=Object(i.p)(),c=s&&s.get(e);c&&c.treeType===o.j?(t=c.principalSMTPAddress,n=c.principalSMTPAddress,r=Object(a.c)()+c.principalSMTPAddress):(t=Object(a.d)(),n=Object(u.a)().SessionSettings.UserEmailAddress,r=Object(a.b)());return{type:a.a.UserMailbox,deprecatedMailboxId:t,userIdentity:n,mailboxSmtpAddress:n,routingKey:r,requestOptions:Object(i.j)(e)}}(e);d(e,t)}return c().get(e)}var d=Object(r.mutatorAction)("addMailboxInfoToStore",(function(e,t){c().set(e,t)})),f=n(1169),p=n(982),m=n(2001);function g(e){return e?v(e.tableQuery):Object(a.e)()}function v(e){var t=Object(p.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(f.a)(t):h(n)}function h(e){return Object(i.G)(e)?Object(m.a)(e):l(e)}n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return h}))},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(77),a=new r.c((function(){return n.e(454).then(n.bind(null,2572))})),i=new r.a(a,(function(e){return e.subscribe})),o=new r.a(a,(function(e){return e.unsubscribe})),s=new r.a(a,(function(e){return e.trigger}));new r.a(a,(function(e){return e.removeResizeEventEmitter}))},1296:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(827),a=n(994);function i(){var e=Object(a.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.e.folderTable.get(t)}},1297:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(77),a=new r.c((function(){return Promise.all([n.e(21),n.e(86),n.e(93)]).then(n.bind(null,2437))})),i=new r.b(a,(function(e){return e.searchCacheTrie})),o=new r.b(a,(function(e){return e.compareFeatureData})),s=new r.a(a,(function(e){return e.initializeSuggestionTrie}))},1299:function(e,t,n){"use strict";var r=n(455),a=n(454),i="[object Arguments]";var o=function(e){return Object(a.a)(e)&&Object(r.a)(e)==i},s=Object.prototype,c=s.hasOwnProperty,u=s.propertyIsEnumerable,l=o(function(){return arguments}())?o:function(e){return Object(a.a)(e)&&c.call(e,"callee")&&!u.call(e,"callee")};t.a=l},1301:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(77),i=n(1663);function o(e,t,n,o,s){return function(){function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onImportedCallbacks=[],this.args=e,this.pluginName=n}return c.prototype.initialize=function(e){this.editor=e,this.pluginInstance?this.initializeAndCallback():o||this.internalImport()},c.prototype.dispose=function(){this.pluginInstance&&(this.pluginInstance.dispose(),s||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]},c.prototype.getName=function(){return this.isImported()?this.pluginInstance.getName():this.pluginName},c.prototype.setPluginUtils=function(e){this.pluginUtils=e,Object(i.a)(this.pluginInstance)&&this.pluginInstance.setPluginUtils(this.pluginUtils)},c.prototype.onPluginEvent=function(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):(null==o?void 0:o(e,this.editor))&&this.internalImport(e)},c.prototype.willHandleEventExclusively=function(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)},c.prototype.getPlugin=function(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()},c.prototype.isImported=function(){return!!this.pluginInstance},c.prototype.addOnImportedCallback=function(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)},c.prototype.initializeAndCallback=function(){var e=this;this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach((function(t){return t(e.pluginInstance)}))},c.prototype.internalImport=function(n){var i=this;return this.importPluginPromise||(this.importPluginPromise=new a.b(e,t).import().then((function(e){return i.pluginInstance=new(e.bind.apply(e,Object(r.__spread)([void 0],i.args))),i.setPluginUtils(i.pluginUtils),i.editor&&(i.initializeAndCallback(),n&&i.pluginInstance.onPluginEvent&&i.pluginInstance.onPluginEvent(n)),i.pluginInstance}))),this.importPluginPromise},c}()}},1303:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FolderResponseShape:#Exchange"},e)}},1304:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("inboxPlusStore",{inboxPlusPivots:[],isPivotEnableDisableDialogShown:!1})();t.a=a},1308:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},1314:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p}));var r=5,a={},i={};function o(e,t,n,r){v([e,"data",t])||function(e,t){a[e]=a[e]||{data:{},messageIds:[]},a[e].data[t]={}}(e,t),u(n)&&m(n),function(e,t,n,r){a[e].data[t][n]=r,a[e].messageIds.push(n),i[n]={hostItemIndex:e,extensionId:t}}(e,t,n,r)}function s(e){c(e)&&m(e)}function c(e){if(!u(e))return null;var t=i[e];return v([t.hostItemIndex,"data",t.extensionId,e])}function u(e){return!!i[e]}function l(e,t,n){var a=g(e,t)||[],i=Object.keys(a).length||0;return n?i>=1:i>=r}function d(e,t){var n=g(e,t);return n?Object.keys(n).reduce((function(e,t){var r=n[t];return r.Persistent&&(e[t]=r),e}),{}):{}}function f(e){return a[e]?a[e].messageIds:[]}function p(e){a[e]&&(a[e].messageIds.forEach((function(e){return delete i[e]})),delete a[e])}function m(e){var t=i[e],n=t.hostItemIndex;delete g(n,t.extensionId)[e],delete i[e];var r=a[n].messageIds,o=r.indexOf(e);~o&&r.splice(o,1)}function g(e,t){return v([e,"data",t])}function v(e){for(var t=a,n=0;n<e.length;n++){var r=e[n];if(!t[r])return null;t=t[r]}return t}},1315:function(e,t,n){"use strict";function r(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.focusedViewFilter;case 1:return-1;default:throw new Error("Table Query should be either of type search, mail folder or group")}}n.d(t,"a",(function(){return r}))},1317:function(e,t,n){"use strict";var r=n(0),a=n(1730),i=n(4);var o=Object(i.mutatorAction)("removeInfoBarMessages",(function(e,t){e&&(Array.isArray(t)?t:t?[t]:e.infoBarIds?Object(r.__spread)(e.infoBarIds):[]).forEach((function(t){return function(e,t){var n=e.infoBarIds&&e.infoBarIds.indexOf(t);n>=0&&e.infoBarIds.splice(n,1);var r=e.infoBarHostKey;a.b[r]&&(delete a.b[r][t],0===Object.keys(a.b[r]).length&&delete a.b[r])}(e,t)}))}));t.a=o},1325:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(844);function a(e){return r.a.conversationItems.get(e)}},1326:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1401),a=n(337),i=n(153),o=n(1417),s=n(1037),c=n(976);function u(e,t){return Object(o.a)({Header:Object(i.a)(),Body:Object(r.a)({FolderChanges:[{Updates:t,FolderId:Object(a.a)(Object(s.a)(e))}]})},Object(c.a)(e)).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},1327:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(905);function a(e){var t=Object(r.a)(),n=t&&t.get(e);return null==n?void 0:n.currentLoadedIndex}},1328:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(207),a=n(337),i=n(51);function o(e,t){return e.serverFolderId?e.serverFolderId==e.tableQuery.folderId?t?null:s(e.tableQuery):c(e.serverFolderId):null}function s(e){return 2==e.type?(t=e.folderId,Object(r.a)({Id:Object(i.f)("grp-junkemailitems")?"junkemail":"inbox",Mailbox:{MailboxType:"GroupMailbox",EmailAddress:t}})):c(e.folderId);var t}function c(e){return Object(a.a)({Id:e})}},1341:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u}));var r=n(0),a=n(952);function i(e){return Object(a.a)().runningUILessExtendedAddinCommands.has(e)}function o(e){var t,n,a,i,o=l();try{for(var s=Object(r.__values)(o.values()),c=s.next();!c.done;c=s.next()){var u=c.value;try{for(var d=(a=void 0,Object(r.__values)(u.keys())),f=d.next();!f.done;f=d.next()){var p=f.value;if(p===e)return u.get(p).addinCommand}}catch(e){a={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return null}function s(e,t){return l().has(e)&&l().get(e).has(t)?l().get(e).get(t).addinCommandTelemetry:null}function c(e){var t,n,a,i,o=l();try{for(var s=Object(r.__values)(o.keys()),c=s.next();!c.done;c=s.next()){var u=c.value,d=o.get(u);try{for(var f=(a=void 0,Object(r.__values)(d.keys())),p=f.next();!p.done;p=f.next()){if(p.value===e)return u}}catch(e){a={error:e}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return null}function u(e){return null!==o(e)}function l(){return Object(a.a)().runningUILessExtendedAddinCommands}},13410:function(e,t,n){"use strict";n.r(t);var r=n(12403),a=n(4560),i=n(7),o=n(886),s=n(1029),c=function(e){return function(){Object(o.b)(Object(i.a)(r.b),Object(i.a)(r.a),!Object(s.f)(e),{okText:Object(i.a)(a.a),hideCancelButton:!1}).then((function(t){t==o.a.ok&&s.g.importAndExecute(e)}))}},u=function(e){return function(){return e.conversationId}},l=n(4052),d=function(e){return function(){var t;return(null===(t=e.fromViewState)||void 0===t?void 0:t.from)?e.fromViewState.from.email:Object(l.a)()}},f=n(910),p=n(7591),m=n(5359),g=n(5361),v=n(1521),h=n(1189),b=n(0),y=n(104),_=Object(y.action)("clearRecipientWell")((function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){return e.recipients=[],e.isDirty=!0,[2]}))}))})),O=n(2210),S=function(e){return function(t){var n=x(e,t);return Object(v.a)(n)}},C=function(e){return function(t,n){A(e,t);var r=x(e,t);_(r);var a=n.map(O.a);Object(h.a)(a,r)}},I=function(e){return function(t,n){A(e,t);var r=x(e,t),a=n.map(O.a);Object(h.a)(a,r)}};function A(e,t){switch(e.showCompactRecipientWell&&Object(g.a)(e),t){case f.f.To:return;case f.f.Cc:return void Object(m.a)(e);case f.f.Bcc:return void Object(p.a)(e)}}var x=function(e,t){var n;switch(t){case f.f.To:n=e.toRecipientWell;break;case f.f.Cc:n=e.ccRecipientWell;break;case f.f.Bcc:n=e.bccRecipientWell}return n},E=n(2314),T=n(2784),w=function(e){return function(){return Object(T.a)(e),Object(E.b)(e,!1,!0).then((function(){return Promise.resolve(e.itemId.Id)})).catch((function(){return Promise.resolve(null)}))}},j=n(5757),P=n(5758),M=n(5759),k=n(1951),R=n(5760),D=function(e){return function(){return Object(T.a)(e),e.content}},N=function(e){return function(t,n){Object(k.a)(e,t),Object(M.a)(e,t)}},F=function(e){return function(){return e.bodyType}},L=function(e){return function(t){Object(j.a)(e,t)}},U=function(e){return function(t){Object(P.a)(e,t)}},B=function(e){return function(t){Object(f.k)(e.addin,t)}};var H=n(7592),G=n(7593),W=function(e){return function(){return e.subject}},V=function(e){return function(t){Object(H.a)(e,t)}};function z(e){return 5===e.lastFocusedControl}var J=function(e){return function(){return 7===e.lastFocusedControl?function(e){return function(){return function(e){return 7===e.lastFocusedControl}(e)?Object(R.a)(e):null}}(e)():5===e.lastFocusedControl?function(e){return function(){if(!z(e))return null;var t=e.subjectViewState,n=t.selectionStart,r=t.selectionEnd,a=e.subject;return{data:a=a.slice(n,r),sourceProperty:"subject",startPosition:n,endPosition:r}}}(e)():null}},q=function(e){return function(t){7===e.lastFocusedControl?U(e)(t):5===e.lastFocusedControl&&function(e){return function(t){if(z(e)){var n=e.subject,r=e.subjectViewState,a=r.selectionStart,i=r.selectionEnd;n=n.slice(0,a)+t+n.slice(i),Object(H.a)(e,n);var o=a+t.length;Object(G.a)(e,o,o)}}}(e)(t)}},X=n(1442),Q=n(348),K=n(825),Z=n(843),Y=n(3014),$=n(74),ee=n(838),te=n(827),ne=n(836),re=function(e){return function(){return ie(e)}},ae=function(e){return function(){var t=e;return void 0!==t.isInSharedFolder&&t.isInSharedFolder}};function ie(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(te.C)(t,ne.j)}function oe(){return!0}function se(){return Object(b.__awaiter)(this,void 0,void 0,(function(){var e;return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q.u.import()];case 1:return e=t.sent(),[2,e()]}}))}))}function ce(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q.r.import()];case 1:return[2,t.sent()(e,"Addin")]}}))}))}function ue(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q.w.import()];case 1:return[2,t.sent()(e,"Addin")]}}))}))}var le=function(e){return function(){return function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,c,u,l,d;return Object(b.__generator)(this,(function(f){switch(f.label){case 0:return t=Object(Z.b)().items.get(e.itemId),n=t.Categories,[4,Q.u.import()];case 1:if(r=f.sent(),a=r(),null==n)return[2,[]];i=[],o=function(e){var t=a.filter((function(t){return t.Name===e})),n={Name:e,Color:t.length>0?t[0].Color:Y.a.None};i.push(n)};try{for(s=Object(b.__values)(n),c=s.next();!c.done;c=s.next())u=c.value,o(u)}catch(e){l={error:e}}finally{try{c&&!c.done&&(d=s.return)&&d.call(s)}finally{if(l)throw l.error}}return[2,i]}}))}))}(e)}},de=function(e){return function(t){return new Promise((function(n,r){var a=Object(Z.b)().items.get(e.itemId),i=a.ParentFolderId.Id,o=Object($.l)(),s=Object(ee.k)(i,o);if(!ie(a)||!s||"PublishingAuthor"!==s.PermissionLevel&&"Author"!==s.PermissionLevel&&"NoneditingAuthor"!==s.PermissionLevel&&"Reviewer"!==s.PermissionLevel&&"Contributor"!==s.PermissionLevel){var c=Object(K.C)(),u=Object(b.__spread)(c.selectedRowKeys.keys());return X.a.importAndExecute(u,c,t,"Addin"),n()}r(new f.a(f.b.OperationNotSupported))}))}},fe=function(e){return function(t){return new Promise((function(n,r){var a=Object(Z.b)().items.get(e.itemId),i=a.ParentFolderId.Id,o=Object($.l)(),s=Object(ee.k)(i,o);if(!ie(a)||!s||"PublishingAuthor"!==s.PermissionLevel&&"Author"!==s.PermissionLevel&&"NoneditingAuthor"!==s.PermissionLevel&&"Reviewer"!==s.PermissionLevel&&"Contributor"!==s.PermissionLevel){var c=Object(K.C)(),u=Object(b.__spread)(c.selectedRowKeys.keys());return X.G.importAndExecute(u,c,t,"Addin"),n()}r(new f.a(f.b.OperationNotSupported))}))}};var pe=n(2357);function me(e){Object(pe.a)(e,"Mail_Addins",null,2)}function ge(e){return Z.a.items.get(e)}var ve=n(983),he=n(1594),be=n(2854);function ye(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(b.__generator)(this,(function(r){switch(r.label){case 0:return(t=ge(e))&&t.NormalizedBody?[3,2]:(n={Id:e,mailboxInfo:Object(ve.b)(Object(K.C)())},[4,he.e.importAndExecute(n,"LoadItemReadingPane")]);case 1:t=r.sent(),r.label=2;case 2:return t.IsDraft?[4,_e(e)]:[3,4];case 3:return r.sent(),[3,5];case 4:Object(be.a)(e),r.label=5;case 5:return[2]}}))}))}function _e(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,s.o.importAndExecute(e,2)];case 1:return t.sent(),[2]}}))}))}var Oe=n(845),Se=function(e){return!!~Object(Oe.d)(Oe.a.SurfaceActions).composeSurfaceAddins.indexOf(e)},Ce=function(e){return!!~Object(Oe.d)(Oe.a.SurfaceActions).readSurfaceAddins.indexOf(e)},Ie=function(e){return function(){return e.itemId?e.itemId.Id:null}},Ae=function(e){return function(){return e.ItemId.Id}},xe=function(e){return function(){var t=e;return{owner:t.folderOwnerEmailAddress,delegatePermissions:Te(t.folderPermission)}}},Ee=function(e){return function(){var t=e.ParentFolderId.Id,n=Object($.l)(),r=Object(ee.k)(t,n);return{owner:Object(te.p)().get(t).principalSMTPAddress,delegatePermissions:Te(r)}}};function Te(e){return e?{Read:"FullDetails"==e.ReadItems,Create:e.CanCreateItems,EditOwn:"All"==e.EditItems||"Owned"==e.EditItems,EditAll:"All"==e.EditItems,DeleteOwn:"All"==e.DeleteItems||"Owned"==e.DeleteItems,DeleteAll:"All"==e.DeleteItems}:{Read:!0,Create:!0,EditOwn:!0,EditAll:!0,DeleteOwn:!0,DeleteAll:!0}}var we=n(954),je=n(962),Pe=n(1053),Me=n(7553),ke=n(7554),Re=n(3672),De=n(849);var Ne=n(2337);function Fe(e,t){var n=We(e.docViewAttachments,t);if(n||(n=We(e.imageViewAttachments,t)),n||(n=We(e.inlineAttachments,t)),!n)throw new f.a(f.b.GenericResponseError);return Ne.b.importAndExecute(n,t)}var Le=function(e){return function(t,n,r){return Object(ke.a)(e,t,n,r).catch(Ue)}};function Ue(e){throw e.messageId?function(e){switch(e){case"ErrorTooLargeForLocalAttachmentSingle":case"ErrorTooLargeForLocalAttachmentMultiple":return f.b.AttachmentSizeExceeded;default:return f.b.AttachmentUploadGeneralFailure}}(e.messageId):f.b.AttachmentUploadGeneralFailure}var Be=function(e){return function(t,n,r){return Object(Me.a)(e,t,n,r).catch(Ue)}},He=function(e){return function(){return Ne.a.importAndExecute(e.attachmentWell)}},Ge=function(e){return function(t,n,r){return function(e,t,n,r){return new Promise((function(a,i){var o=!1;try{for(var s=atob(t),c=s.length,u=new Uint8Array(new ArrayBuffer(c)),l=0;l<c;l++)u[l]=s.charCodeAt(l);var d=Object(De.f)(n)?new Blob([u],{type:"image/png"}):new Blob([u]);d.name=n;var p=Object(je.e)([d]);Object(Re.a)(p,e,{isInline:r,isHiddenInline:!0,shouldShare:!1},(function(e){o||(o=!0,a(e.Id))}),(function(e,t,n){Object(Pe.u)(e,t,n),a(t.Id)}),(function(){o||(o=!0,i({errorType:"UploadError"}))}))}catch(e){i({errorType:f.b.AttachmentUploadGeneralFailure})}}))}(e,t,n,r).catch(Ue)}};function We(e,t){var n=e.filter((function(e){return e.attachmentId.Id===t}));return n.length>0?n[0]:null}var Ve=function(e){return function(t){return new Promise((function(n,r){Pe.g.import().then((function(a){try{var i=We(e.attachmentWell.docViewAttachments,t);if(i||(i=We(e.attachmentWell.imageViewAttachments,t)),i||(i=We(e.attachmentWell.inlineAttachments,t)),!i)return void r(new f.a(f.b.AttachmentToDeleteDoesNotExist));var o=Object(b.__assign)(Object(b.__assign)({},e.itemId),{mailboxInfo:Object(ve.a)()});a(e.attachmentWell,i,o,e,(function(e,t,r){Object(Pe.v)(e,t,r),n()}))}catch(e){r(new f.a(f.b.AttachmentDeleteGeneralFailure))}}))}))}},ze=function(e){return function(t){return Fe(e.attachmentWell,t)}},Je=n(5756),qe=n(911),Xe=n(165);function Qe(e,t,n){return function(){var r,a=Object(f.n)(t);if(!a)return null;var o=function(e,t,n,r){return{text:Object(i.a)(Je.a),action:function(){var a=!1;n.Actions&&(a=!0),Object(Xe.o)("DissmissButtonClicked",{IsClickableInfobar:a});var i=n.ExtensionId,o=n.Persistent;f.G.import().then((function(n){n(t),o&&f.O.import().then((function(t){t(e,i)}))})),r(t)}}}(e,t,a,n),s=(null===(r=a.Actions)||void 0===r?void 0:r.CustomButtonAction)&&a.Actions.NotificationActionData?function(e,t,n){return{text:t,action:function(){Object(Xe.o)("ClickableInfoBarClicked"),f.v.importAndExecute(e,n)}}}(e,a.Actions.NotificationActionData.actionText,a.Actions.CustomButtonAction):"";return{key:a.Key,source:qe.c.Extensibility,rank:Ze(a.Type),messageParts:Ke(o,s,a),color:qe.a.Grey,icon:a.Actions?a.Actions.CustomButtonIcon:null}}}function Ke(e,t,n){var r;return(null===(r=n.Actions)||void 0===r?void 0:r.CustomButtonAction)?[n.Message,"|",t,"|",e]:[n.Message,"|",e]}function Ze(e){switch(e){case 0:case 1:return qe.b.Info;case 2:return qe.b.Error;case 3:return qe.b.InsightMessage}return qe.b.Safety}var Ye=n(1203),$e=n(1317),et=function(e){return function(t){Object(Ye.a)(e,t,Qe(Object(f.m)(e.composeId),t,tt(e)))}},tt=function(e){return function(t){Object($e.a)(e,[t])}},nt=function(e){return function(){return e.infoBarIds}},rt=n(4),at=Object(rt.mutatorAction)("removeInternetHeaders",(function(e,t){t.forEach((function(t){e.internetHeaders.get(t)&&(e.keysOfInternetHeadersToBeRemoved.push(t),e.internetHeaders.delete(t))})),e.isDirty=!0})),it=Object(rt.mutatorAction)("setInternetHeaders",(function(e,t){e.internetHeaders=e.internetHeaders.merge(t),e.isDirty=!0})),ot=n(1099),st=n(1092),ct=n(328),ut=n(389),lt=n(208),dt="00020386-0000-0000-C000-000000000046",ft="0x007D";function pt(e,t){return Object(b.__awaiter)(this,void 0,void 0,(function(){var n,r;return Object(b.__generator)(this,(function(a){switch(a.label){case 0:return r=[],t.forEach((function(t){e.internetHeaders.get(t)||e.keysOfInternetHeadersToBeRemoved&&-1!=e.keysOfInternetHeadersToBeRemoved.indexOf(t)||r.push(t)})),r.length>0?[4,mt(r,e.itemId.Id)]:[3,2];case 1:n=a.sent(),it(e,n),a.label=2;case 2:return[2]}}))}))}function mt(e,t){return Object(b.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i,o;return Object(b.__generator)(this,(function(s){switch(s.label){case 0:n=Object(ut.a)({BaseShape:"IdOnly",AdditionalProperties:gt(e)}),r={},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Object(ot.a)([t],n,null)];case 2:return a=s.sent(),Object(st.a)(a[0])&&(i=a[0],(o=i.Items[0]).ExtendedProperty&&(c=o.ExtendedProperty,r=c.reduce((function(e,t){return e[t.ExtendedFieldURI.PropertyName]=t.Value,e}),{}))),[3,4];case 3:throw s.sent();case 4:return[2,r]}var c}))}))}function gt(e){var t=[];return e.forEach((function(e){t.push(Object(ct.a)(dt,e,"String"))})),t}function vt(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a;return Object(b.__generator)(this,(function(i){switch(i.label){case 0:t=Object(ut.a)({BaseShape:"IdOnly",AdditionalProperties:ht()}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Object(ot.a)([e],t,null)];case 2:return n=i.sent(),Object(st.a)(n[0])?(r=n[0],(a=r.Items[0]).ExtendedProperty?[2,a.ExtendedProperty[0].Value]:[2,""]):[3,4];case 3:throw i.sent();case 4:return[2,void 0]}}))}))}function ht(){var e=[];return e.push(Object(lt.a)({PropertyTag:ft,PropertyType:"String"})),e}var bt=function(e){return function(t){it(e,t)}},yt=function(e){return function(t){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,pt(e,t)];case 1:n.sent(),n.label=2;case 2:return at(e,t),[2]}}))}))}},_t=function(e){return function(t){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,pt(e,t)];case 1:n.sent(),n.label=2;case 2:return[2,Object(b.__spread)(e.internetHeaders.keys()).filter((function(e){return t.includes(e)})).reduce((function(t,n){return t[n]=e.internetHeaders.get(n),t}),{})]}}))}))}},Ot=n(20),St=Object(y.action)("disableClientSignatureOnReply")((function(){var e=Object(Ot.a)().UserOptions;e.AutoAddSignatureOnReply&&(e.AutoAddSignatureOnReply=!e.AutoAddSignatureOnReply)})),Ct=Object(y.action)("disableClientSignatureOnNew")((function(){var e=Object(Ot.a)().UserOptions;e.AutoAddSignature&&(e.AutoAddSignature=!e.AutoAddSignature)})),It=n(2160),At=function(e){return function(){var t="newMail";return e.addin.draftComposeType===It.b.Reply&&(t="reply"),e.addin.draftComposeType===It.b.Forward&&(t="forward"),e.addin.draftComposeType===It.b.New&&(t="newMail"),{coercionType:e.bodyType,composeType:t}}},xt=function(e){return function(t){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return[4,s.x.import()];case 1:return n.sent()(e,t),[2]}}))}))}},Et=function(){return function(){var e=Object(Ot.a)().UserOptions;return e.AutoAddSignature||e.AutoAddSignatureOnReply}},Tt=function(){return function(){return new Promise((function(e,t){var n=Object(Ot.a)().UserOptions,r=!1;return n.AutoAddSignature&&(Ct(),r=!0),n.AutoAddSignatureOnReply&&(St(),r=!0),e(r)}))}};function wt(e){return{getRecipients:S(e),setRecipients:C(e),addRecipients:I(e),getSubject:W(e),setSubject:V(e),getItemId:Ie(e),getConversationId:u(e),getBody:D(e),setBody:N(e),getBodyType:F(e),prependBody:L(e),getSelectedData:J(e),setSelectedData:q(e),setBodySelectedData:U(e),mode:we.a.MessageCompose,saveItem:w(e),addNotificationMessage:et(e),removeNotificationMessage:tt(e),getNotificationMessageIds:nt(e),close:c(e),displayMessageForm:ye,displayAppointmentForm:me,addItemAttachment:Le(e),addFileAttachment:Be(e),addFileAttachmentFromBase64:Ge(e),removeAttachment:Ve(e),getAttachments:He(e),getAttachmentContent:ze(e),isAddinPinned:Se,isSharedItem:ae(e),getSharedProperties:xe(e),isRemoteItem:oe,getFrom:d(e),getInternetHeaders:_t(e),setInternetHeaders:bt(e),removeInternetHeaders:yt(e),appendOnSend:B(e),getCategoriesMailbox:se,addCategoriesMailbox:ce,removeCategoriesMailbox:ue,getComposeTypeAndCoercionType:At(e),setSignature:xt(e),isClientSignatureEnabled:Et(),disableClientSignature:Tt()}}function jt(e){var t=[];return e&&(t=e.map((function(e){return{Mailbox:e}}))),t}var Pt=n(867),Mt=n(550),kt=function(e,t,n,r,a,i,o,s){var c,u=jt(e),l=jt(t),d=new Date(null==n?Date.now():n),f=null==r?void 0:new Date(r);if(a){var p=Object(Pt.k)(a);c=Object(Pt.h)(p)[0]}var m={RequiredAttendees:u||[],OptionalAttendees:l||[],Locations:c?[c]:[],Resources:(i?i.map((function(e){return{Mailbox:{EmailAddress:e}}})):null)||[],Subject:o,Body:{Value:s,BodyType:"HTML"},Start:d,End:f};Object(Mt.b)(m,"Mail_AddIns",!0,2)},Rt=n(4894),Dt=n(4554),Nt=n(85);function Ft(e,t,n,r){var a=ge(e),i=a?a.ConversationId.Id:null,o=Object(Dt.a)(r);s.t.importAndExecute({referenceItemId:{Id:e,mailboxInfo:Object(Nt.e)()},isReplyAll:t,useFullCompose:!0,actionSource:"AddIns",instrumentationContexts:[],conversationId:i,body:n,fullComposeTarget:2,attachmentFiles:o})}var Lt=n(1690),Ut=n(839),Bt=n(1711),Ht=n(153);function Gt(e){return function(e){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(Bt.a)({Header:Object(Ht.a)(),Body:Object(Lt.a)({EventIds:[e],ItemShape:Object(ut.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(Ut.a)({FieldURI:"calendar:Recurrence"}),Object(Ut.a)({FieldURI:"calendar:SeriesMasterItemId"})]})})},null)];case 1:return[2,t.sent().Body.ResponseMessages.Items]}}))}))}(e).then((function(e){if(Object(ee.c)(e[0])){var t=e[0].Items[0];return{SeriesMasterItemId:t.SeriesMasterItemId,Recurrence:t.Recurrence}}return null}))}function Wt(e){var t=this;return e&&e.IsRecurring?function(){return Object(b.__awaiter)(t,void 0,void 0,(function(){var t;return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return[4,Gt(e.AssociatedCalendarItemId)];case 1:return(null==(t=n.sent())?void 0:t.SeriesMasterItemId)?[2,t.SeriesMasterItemId.Id]:[2,null]}}))}))}:function(){return Promise.resolve(void 0)}}var Vt=function(e){return function(){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){return Object(b.__generator)(this,(function(t){switch(t.label){case 0:return[4,vt(e.ItemId.Id)];case 1:return[2,t.sent()]}}))}))}},zt=n(1088),Jt=n(2915),qt=n(8211),Xt=function(e){return function(t){qt.a(e)(t,Qe(Object(f.o)(e.itemId),t,Qt(e)))}},Qt=function(e){return function(t){qt.c(e)(t)}},Kt=function(e){return function(){return qt.b(e)()}},Zt=function(e){return function(t){return Fe(e.attachmentWell,t)}},Yt=function(e){return function(){return e}},$t=function(e,t,n){return function(){return!e.isConversationItemPart||Object(Jt.b)({conversationReadingPaneState:n.conversationReadingPaneViewState})==e}},en=function(e,t){return function(){var n,r=e.isConversationItemPart?null===(n=t.ConversationId)||void 0===n?void 0:n.Id:null;return!!Object(s.b)(r)}},tn=Object(y.select)({conversationReadingPaneViewState:function(e){var t;return Object(zt.a)(null===(t=null==e?void 0:e.ConversationId)||void 0===t?void 0:t.Id)}})((function(e,t,n){return{getItem:Yt(e),getItemId:Ae(e),addNotificationMessage:Xt(t),removeNotificationMessage:Qt(t),getNotificationMessageIds:Kt(t),mode:we.a.MessageRead,displayMessageForm:ye,displayNewMessageForm:Rt.a,displayNewAppointmentForm:kt,displayReplyForm:Ft,displayAppointmentForm:me,isAddinPinned:Ce,isItemSelected:$t(t,0,n),isInlineComposeOpen:en(t,e),isSharedItem:re(e),isRemoteItem:oe,getSharedProperties:Ee(e),getRecurrence:(r=e,function(){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(b.__generator)(this,(function(n){switch(n.label){case 0:return r.AssociatedCalendarItemId?r.Recurrence?[2,r.Recurrence]:[3,1]:[2,null];case 1:return[4,Gt(r.AssociatedCalendarItemId)];case 2:return(e=n.sent())?e.Recurrence?[2,e.Recurrence]:e.SeriesMasterItemId?[4,Gt(e.SeriesMasterItemId)]:[3,4]:[2,null];case 3:return(t=n.sent())?[2,t.Recurrence]:[2,null];case 4:return[2,null]}}))}))}),getSeriesId:Wt(e),getAllInternetHeaders:Vt(e),getAttachmentContent:Zt(t),getCategoriesMailbox:se,addCategoriesMailbox:ce,removeCategoriesMailbox:ue,getCategoriesItem:le(t),addCategoriesItemRead:de(t),removeCategoriesItemRead:fe(t)};var r}));n.d(t,"createMailComposeAdapter",(function(){return wt})),n.d(t,"createMailReadAdapter",(function(){return tn}))},1345:function(e,t,n){"use strict";function r(e){return!e.ItemClass||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")}n.d(t,"a",(function(){return r}))},1346:function(e,t,n){"use strict";n.r(t),n.d(t,"DESCENDING_SORT_DIR",(function(){return a})),n.d(t,"ASCENDING_SORT_DIR",(function(){return i})),n.d(t,"DEFAULT_SORT_COLUMN",(function(){return o})),n.d(t,"getSortBySupportingPin",(function(){return s})),n.d(t,"getSupportedSortColumns",(function(){return c})),n.d(t,"getDefaultSortDirectionForSortColumn",(function(){return u})),n.d(t,"getDefaultSortBy",(function(){return l})),n.d(t,"isTableMultiValueSort",(function(){return d}));var r=n(831),a="Descending",i="Ascending",o=1;function s(){return{sortColumn:1,sortDirection:a}}function c(e){return Object(r.a)("sentitems")==e||Object(r.a)("drafts")==e?[1,7]:[1,3,7,5,8]}function u(e){switch(e){case 1:case 7:case 5:return a;case 3:case 8:return i;default:throw new Error("getDefaultSortDirectionForSortColumn: sortColumn not supported")}}function l(){return{sortColumn:o,sortDirection:u(o)}}function d(e){var t=0==e.type&&e.sortBy.sortColumn;return t&&0==e.listViewType&&3==t}},1347:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(825),a=n(51),i=n(906);function o(e){return"Unread"!==Object(r.K)(e)||Object(a.f)("tri-autoMarkReadInUnreadSetting")&&Object(i.a)(64)}},1353:function(e,t,n){"use strict";var r=n(448),a="";function i(e){return e.toLowerCase()+"_"+a}var o=n(38),s=n(51),c=n(14);function u(){return((Object(o.d)()||Object(o.i)())&&Object(s.f)("fwk-moduleSwitcherReuseTabs")||Object(s.f)("fwk-moduleSwitcherReuseTab-all"))&&Object(c.b)(window)}var l=n(37);function d(e){if(u()){var t=function(){var e;try{if(null===(e=window.opener)||void 0===e?void 0:e.name){var t=window.opener.name.match(/[a-z]*_(.*)/);return null==t?void 0:t[1]}}catch(e){return null}return null}();t?function(e){a=e}(t):a=Object(r.a)();var n=window.name,o=i(e);window.name=o,l.d(window,o,"1"),window.addEventListener("beforeunload",s),window.addEventListener("unload",s)}function s(){l.c(window,o),window.name=n}}function f(e){if(u()){var t=i(e);if(Object(c.a)(window,t))return window.open("",t).focus(),!0}return!1}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}))},1356:function(e,t,n){var r=n(1830),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1357:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1111),a=n(836);function i(e){return e&&(Object(r.a)(e,a.f)||Object(r.a)(e,a.a))}},1360:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],a=null,i=function(e){return null===a&&(a=new Set,r.forEach((function(e){return a.add(e)}))),e.split("").every((function(e){return a.has(e)}))}},1366:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(0),a=n(1),i=n(580),o=n(128),s=n(164),c=n(65),u=n(70),l=n(178),d=n(151),f=n(341),p=Object(s.a)(),m=function(e){function t(t){var n=e.call(this,t)||this;return n._focusZone=a.createRef(),n._persistedKeytips={},n._keytipManager=f.a.getInstance(),n._divContainer=a.createRef(),n._onRenderItems=function(e){return e.map((function(e,t){var i={className:n._classNames.item};return a.createElement("div",r.__assign({key:e.key},i),n.props.onRenderItem(e))}))},n._onRenderOverflowButtonWrapper=function(e){var t={className:n._classNames.overflowButton},i=n.props.keytipSequences,o=[];return i?e.forEach((function(e){var t=e.keytipProps;if(t){var a={content:t.content,keySequences:t.keySequences,disabled:t.disabled||!(!e.disabled&&!e.isDisabled),hasDynamicChildren:t.hasDynamicChildren,hasMenu:t.hasMenu};t.hasDynamicChildren||n._getSubMenuForItem(e)?a.onExecute=n._keytipManager.menuExecute.bind(n._keytipManager,i,e.keytipProps.keySequences):a.onExecute=t.onExecute,n._persistedKeytips[a.content]=a;var s=r.__assign({},e,{keytipProps:r.__assign({},t,{overflowSetSequence:i})});o.push(s)}else o.push(e)})):o=e,a.createElement("div",r.__assign({},t),n.props.onRenderOverflowButton(o))},t.doNotContainWithinFocusZone&&n._warnMutuallyExclusive({doNotContainWithinFocusZone:"focusZoneProps"}),n}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.items,n=e.overflowItems,s=e.className,u=e.focusZoneProps,l=e.styles,d=e.vertical,f=e.doNotContainWithinFocusZone;this._classNames=p(l,{className:s,vertical:d});var m,g,v=this.props.role||d?"menu":"menubar";return f?(m="div",g=r.__assign({},Object(c.j)(this.props,c.h),{ref:this._divContainer})):(m=i.a,g=r.__assign({},Object(c.j)(this.props,c.h),u,{componentRef:this._focusZone,direction:d?o.a.vertical:o.a.horizontal})),a.createElement(m,r.__assign({"aria-orientation":d?"vertical":"horizontal"},g,{className:this._classNames.root,role:v}),t&&this._onRenderItems(t),n&&n.length>0&&this._onRenderOverflowButtonWrapper(n))},t.prototype.focus=function(e){var t=!1;return this.props.doNotContainWithinFocusZone?this._divContainer.current&&(t=Object(u.c)(this._divContainer.current)):this._focusZone.current&&(t=this._focusZone.current.focus(e)),t},t.prototype.focusElement=function(e){var t=!1;return!!e&&(this.props.doNotContainWithinFocusZone?this._divContainer.current&&Object(l.a)(this._divContainer.current,e)&&(e.focus(),t=document.activeElement===e):this._focusZone.current&&(t=this._focusZone.current.focusElement(e)),t)},t.prototype.componentDidMount=function(){this._registerPersistedKeytips()},t.prototype.componentWillUnmount=function(){this._unregisterPersistedKeytips()},t.prototype.UNSAFE_componentWillUpdate=function(){this._unregisterPersistedKeytips()},t.prototype.componentDidUpdate=function(){this._registerPersistedKeytips()},t.prototype._registerPersistedKeytips=function(){var e=this;Object.keys(this._persistedKeytips).forEach((function(t){var n=e._persistedKeytips[t],r=e._keytipManager.register(n,!0);e._persistedKeytips[r]=n,delete e._persistedKeytips[t]}))},t.prototype._unregisterPersistedKeytips=function(){var e=this;Object.keys(this._persistedKeytips).forEach((function(t){e._keytipManager.unregister(e._persistedKeytips[t],t,!0)})),this._persistedKeytips={}},t.prototype._getSubMenuForItem=function(e){return this.props.itemSubMenuProvider?this.props.itemSubMenuProvider(e):e.subMenuProps?e.subMenuProps.items:void 0},t}(d.a)},1368:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(993),i=n(888),o=n(1012),s=n(222);function c(e,t,n){var c,f;void 0===t&&(t=0);var p=function(e){switch(e){case 0:return u;case 1:return l;case 2:return d;default:return Object(s.a)(e)}}(t),m=Object(o.b)();try{for(var g=Object(r.__values)(Object(i.a)().tabs),v=g.next();!v.done;v=g.next()){var h=v.value;if(h.type==a.a.Compose&&0==h.state){var b=m.viewStates.get(h.data);if((null==b?void 0:b.isInlineCompose)&&p(b,e)&&(0==b.asyncSendState||n&&6==b.asyncSendState))return b}}}catch(e){c={error:e}}finally{try{v&&!v.done&&(f=g.return)&&f.call(g)}finally{if(c)throw c.error}}return null}function u(e,t){return e.conversationId===t}function l(e,t){return e.referenceItemId.Id===t}function d(e,t){return!1}},1376:function(e,t,n){"use strict";var r=n(4);var a=n(13),i=Object(r.createStore)("extensibility",{EnabledAddinCommands:null,HostItems:new a.ObservableMap,IsPreinstalledTeachingUIAvailable:!1,Context:null,taskPanes:new a.ObservableMap,activeDialog:null,ExtensibilityStateIsDirty:!1,contextualCalloutState:{activeContextualAddinCommands:[],contextualAnchor:null,hostItemIndex:null,selectedTerms:[]},runningContextualAddinCommand:null,runningUILessExtendedAddinCommands:new a.ObservableMap,blockedAddinCommands:new a.ObservableMap,autoRunAddinCommandWaitingQueue:new a.ObservableMap,compliance:{isMinor:!1}})();t.a=i},1379:function(e,t,n){var r=n(1835),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1381:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(996),a=n(1192);function i(e,t,n){switch(t.tableQuery.listViewType){case 0:Object(r.a)(e,t.id).instrumentationContext=n;break;case 1:Object(a.a)(e,t.id).instrumentationContext=n}}},1382:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=20,a=10},1391:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(251),o=n(151),s=n(336),c=n(9),u=n(152),l=n(250),d=n(297),f=n(356),p=Object(u.b)((function(e,t,n,r){var a,i,o,s,u,p,m,g,v,h,b=Object(l.a)(e),y=Object(d.a)(e),_=e.palette,O=e.semanticColors,S={root:[Object(c.getFocusStyle)(e,{inset:2,highContrastStyle:{left:4,top:4,bottom:4,right:4,border:"none"},borderColor:"transparent"}),e.fonts.medium,{minWidth:"40px",backgroundColor:_.white,color:_.neutralPrimary,padding:"0 4px",border:"none",borderRadius:0,selectors:(a={},a[c.HighContrastSelector]={border:"none"},a)}],rootHovered:{backgroundColor:_.neutralLighter,color:_.neutralDark,selectors:(i={},i[c.HighContrastSelector]={color:"Highlight"},i["."+f.a.msButtonIcon]={color:_.themeDarkAlt},i["."+f.a.msButtonMenuIcon]={color:_.neutralPrimary},i)},rootPressed:{backgroundColor:_.neutralLight,color:_.neutralDark,selectors:(o={},o["."+f.a.msButtonIcon]={color:_.themeDark},o["."+f.a.msButtonMenuIcon]={color:_.neutralPrimary},o)},rootChecked:{backgroundColor:_.neutralLight,color:_.neutralDark,selectors:(s={},s["."+f.a.msButtonIcon]={color:_.themeDark},s["."+f.a.msButtonMenuIcon]={color:_.neutralPrimary},s)},rootCheckedHovered:{backgroundColor:_.neutralQuaternaryAlt,selectors:(u={},u["."+f.a.msButtonIcon]={color:_.themeDark},u["."+f.a.msButtonMenuIcon]={color:_.neutralPrimary},u)},rootExpanded:{backgroundColor:_.neutralLight,color:_.neutralDark,selectors:(p={},p["."+f.a.msButtonIcon]={color:_.themeDark},p["."+f.a.msButtonMenuIcon]={color:_.neutralPrimary},p)},rootExpandedHovered:{backgroundColor:_.neutralQuaternaryAlt},rootDisabled:{backgroundColor:_.white,selectors:(m={},m["."+f.a.msButtonIcon]={color:O.disabledBodySubtext},m)},splitButtonContainer:{height:"100%",selectors:(g={},g[c.HighContrastSelector]={border:"none"},g)},splitButtonDivider:{backgroundColor:_.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:_.white,border:"none",borderTopRightRadius:"0",borderBottomRightRadius:"0",color:_.neutralSecondary,selectors:{":hover":{backgroundColor:_.neutralLighter,color:_.neutralDark,selectors:(v={},v[c.HighContrastSelector]={color:"Highlight"},v["."+f.a.msButtonIcon]={color:_.neutralPrimary},v)},":active":{backgroundColor:_.neutralLight,selectors:(h={},h["."+f.a.msButtonIcon]={color:_.neutralPrimary},h)}}},splitButtonMenuButtonDisabled:{backgroundColor:_.white},splitButtonMenuButtonChecked:{backgroundColor:_.neutralLight,color:_.neutralDark,selectors:{":hover":{backgroundColor:_.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:_.neutralLight,color:_.black,selectors:{":hover":{backgroundColor:_.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:_.neutralPrimary},splitButtonMenuIconDisabled:{color:_.neutralTertiary},label:{fontWeight:"normal"},icon:{color:_.themePrimary},menuIcon:{color:_.neutralSecondary}};return Object(c.concatStyleSets)(b,y,S,t)}));n.d(t,"a",(function(){return m}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return a.createElement(i.a,r.__assign({},this.props,{variantClassName:"ms-Button--commandBar",styles:p(n,t),onRenderDescription:o.b}))},t=r.__decorate([Object(s.a)("CommandBarButton",["theme","styles"],!0)],t)}(o.a)},1397:function(e,t,n){"use strict";var r=function(e){this.errorCode=e};t.a=r},1400:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"Folder:#Exchange"},e)}},1401:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"UpdateFolderRequest:#Exchange"},e)}},1402:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(36),a=n(39);function i(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function o(){var e="",t=Object(a.a)().pathname.split("/").filter((function(e){return e.length}));return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}function s(){var e=o();return e||(e=i()),e}},1403:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2147),a=n(1575),i=n(1576),o=n(7),s=n(1304),c=n(827),u=n(831);function l(e){switch(e){case 0:return{displayText:1===s.a.inboxPlusPivots.filter((function(e){return e.isEnabled})).length?c.e.folderTable.get(Object(u.a)("inbox")).DisplayName:Object(o.a)(r.a),icon:"Inbox"};case 1:return{displayText:Object(o.a)(i.a),icon:"InboxCheck"};case 2:return{displayText:Object(o.a)(r.c),icon:"ShoppingCart"};case 3:return{displayText:Object(o.a)(r.d),icon:"Like"};case 4:return{displayText:Object(o.a)(r.b),icon:"News"};case 5:return{displayText:Object(o.a)(a.a),icon:"MailLowImportance"};default:return null}}},1417:function(e,t,n){"use strict";var r=n(24),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"UpdateFolderJsonRequest:#Exchange"},n)),Object(r.a)("UpdateFolder",e,t)}n.d(t,"a",(function(){return i}))},1420:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return u}));var r,a=n(7),i="FileAttachment:#Exchange",o="ItemAttachment:#Exchange",s="ItemIdAttachment:#Exchange",c="ReferenceAttachment:#Exchange";!function(e){e[e.File=0]="File",e[e.Item=1]="Item",e[e.Cloud=2]="Cloud"}(r||(r={}));var u=function(e){return e.map((function(e){return{id:l(e),name:e.Name,contentType:e.ContentType,size:e.Size,attachmentType:d(e),isInline:e.IsInline||!1}}))};function l(e){return e.__type===c?e.AttachmentOriginalUrl:e.AttachmentId.Id}function d(e){switch(e.__type){case i:return r.File;case o:return r.Item;case c:return r.Cloud;case s:var t=e;return Object(a.f)(t.AttachmentIdToAttach)?r.Item:r.File;default:throw new Error("Invalid type of attachment "+e.__type)}}},1421:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1422:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(2201);function a(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},1429:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"CreateFolderRequest:#Exchange"},e)}},1430:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(24),a=n(1602);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("CreateFolder",e,t)}},1439:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},1441:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1442:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"y",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"p",(function(){return d})),n.d(t,"Q",(function(){return f})),n.d(t,"L",(function(){return p})),n.d(t,"K",(function(){return m})),n.d(t,"J",(function(){return g})),n.d(t,"w",(function(){return v})),n.d(t,"x",(function(){return h})),n.d(t,"h",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"I",(function(){return _})),n.d(t,"P",(function(){return O})),n.d(t,"v",(function(){return S})),n.d(t,"u",(function(){return C})),n.d(t,"s",(function(){return I})),n.d(t,"r",(function(){return A})),n.d(t,"D",(function(){return x})),n.d(t,"E",(function(){return E})),n.d(t,"B",(function(){return T})),n.d(t,"C",(function(){return w})),n.d(t,"t",(function(){return j})),n.d(t,"q",(function(){return P})),n.d(t,"H",(function(){return M})),n.d(t,"S",(function(){return k})),n.d(t,"T",(function(){return R})),n.d(t,"f",(function(){return D})),n.d(t,"e",(function(){return N})),n.d(t,"a",(function(){return F})),n.d(t,"G",(function(){return L})),n.d(t,"g",(function(){return U})),n.d(t,"N",(function(){return B})),n.d(t,"m",(function(){return H})),n.d(t,"o",(function(){return G})),n.d(t,"n",(function(){return W})),n.d(t,"O",(function(){return V})),n.d(t,"A",(function(){return z})),n.d(t,"z",(function(){return J})),n.d(t,"l",(function(){return q})),n.d(t,"F",(function(){return X})),n.d(t,"M",(function(){return Q})),n.d(t,"R",(function(){return K}));var r=n(77),a=new r.c((function(){return Promise.all([n.e(80),n.e(29),n.e(31),n.e(49),n.e(520)]).then(n.bind(null,6408))})),i=new r.b(a,(function(e){return e.addMailboxToSafeSenders})),o=new r.a(a,(function(e){return e.alwaysMoveRowToFocusedOrOther})),s=new r.a(a,(function(e){return e.moveMailListRowsToFocusedOrOther})),c=new r.a(a,(function(e){return e.deleteMailListRows})),u=new r.a(a,(function(e){return e.deleteItems})),l=new r.b(a,(function(e){return e.deleteItemsBasedOnNodeIds})),d=new r.b(a,(function(e){return e.likeItem})),f=new r.a(a,(function(e){return e.toggleRowsFlagState})),p=new r.a(a,(function(e){return e.setMailListRowsFlagState})),m=new r.a(a,(function(e){return e.setItemsFlagStateFromItemIds})),g=new r.b(a,(function(e){return e.setItemsFlagStateBasedOnNodeIds})),v=(new r.a(a,(function(e){return e.moveItemsFromItemIds})),new r.b(a,(function(e){return e.moveItemsBasedOnNodeIds}))),h=new r.a(a,(function(e){return e.moveMailListRows})),b=new r.a(a,(function(e){return e.copyMailListRows})),y=new r.a(a,(function(e){return e.archiveMailListRowsFromTable})),_=new r.b(a,(function(e){return e.scheduleRows})),O=new r.a(a,(function(e){return e.toggleRowPinnedState})),S=new r.a(a,(function(e){return e.markRowsPinnedUnpinned})),C=new r.a(a,(function(e){return e.markRowsJunkNotJunkFromTable})),I=new r.b(a,(function(e){return e.markItemsJunkNotJunkBasedOnNodeIds})),A=new r.a(a,(function(e){return e.markItemJunkNotJunkFromReadingPane})),x=new r.a(a,(function(e){return e.onKeyboardMarkAsJunkNotJunk})),E=new r.a(a,(function(e){return e.onKeyboardToggleFlagState})),T=new r.a(a,(function(e){return e.onKeyboardArchive})),w=new r.a(a,(function(e){return e.onKeyboardDelete})),j=new r.a(a,(function(e){return e.markRowsAsPhishingFromTable})),P=new r.a(a,(function(e){return e.markItemAsPhishingFromReadingPane})),M=new r.a(a,(function(e){return e.restoreMailListRows})),k=new r.a(a,(function(e){return e.unsubscribeEmail})),R=new r.b(a,(function(e){return e.unsubscribeEmailV2})),D=new r.a(a,(function(e){return e.blockLastSendersFromTable})),N=new r.a(a,(function(e){return e.blockLastSenderFromReadingPane})),F=new r.a(a,(function(e){return e.addCategoriesFromTable})),L=new r.a(a,(function(e){return e.removeCategoriesFromTable})),U=new r.a(a,(function(e){return e.clearCategoriesFromTable})),B=new r.a(a,(function(e){return e.sweepConversations})),H=new r.a(a,(function(e){return e.emptyFolder})),G=new r.a(a,(function(e){return e.emptyTableView})),W=new r.a(a,(function(e){return e.emptySearchTableView})),V=new r.b(a,(function(e){return e.toggleIgnoreConversations})),z=new r.b(a,(function(e){return e.moveSharedFolderItems})),J=new r.b(a,(function(e){return e.moveSharedFolderConversations})),q=new r.b(a,(function(e){return e.dismissNudge})),X=new r.b(a,(function(e){return e.onRemoveMeeting})),Q=new r.a(a,(function(e){return e.showNotificationOnMailboxQuotaWarning})),K=new r.a(a,(function(e){return e.translateFromTable}))},1445:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},1448:function(e,t,n){"use strict";var r=n(1135),a=n(1169),i=n(4),o=Object(i.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),s=Object(i.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(i.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),u=Object(i.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),l=Object(i.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),d=n(1239);n.d(t,"n",(function(){return r.a})),n.d(t,"m",(function(){return a.a})),n.d(t,"l",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"g",(function(){return d.g})),n.d(t,"c",(function(){return d.c})),n.d(t,"d",(function(){return d.d})),n.d(t,"a",(function(){return d.a})),n.d(t,"e",(function(){return d.e})),n.d(t,"f",(function(){return d.f})),n.d(t,"i",(function(){return d.i})),n.d(t,"b",(function(){return d.b})),n.d(t,"h",(function(){return d.h}))},1460:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Single=1]="Single",e[e.Empty=2]="Empty",e[e.Multi=3]="Multi",e[e.NotSupported=4]="NotSupported"}(r||(r={}))},1461:function(e,t,n){"use strict";var r;!function(e){e[e.Added=0]="Added",e[e.Deleted=1]="Deleted"}(r||(r={})),t.a=r},1462:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Room="room",e.Custom="custom"}(r||(r={}))},1463:function(e,t,n){"use strict";var r;!function(e){e[e.To=0]="To",e[e.Cc=1]="Cc",e[e.Bcc=2]="Bcc",e[e.RequiredAttendees=0]="RequiredAttendees",e[e.OptionalAttendees=1]="OptionalAttendees",e[e.Resources=2]="Resources"}(r||(r={})),t.a=r},1464:function(e,t,n){"use strict";var r=n(4),a=Object(r.actionCreator)("ADD_CHAT_TAB",(function(e){return{chatConversationId:e}}));t.a=a},1470:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},1502:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(223);function a(e){var t=new Headers;return Object(r.g)(e,t),{headers:t}}},1518:function(e,t,n){"use strict";function r(e){if(null!=e.RightsManagementLicenseData)return!1;if(e.IsDraft)return!1;var t=e.ItemClass?e.ItemClass.toLowerCase():"";return(0!=t.indexOf("ipm.note.smime")||-1!=t.indexOf("ipm.note.smime.multipartsigned"))&&0!=t.indexOf("report")}n.d(t,"a",(function(){return r}))},1519:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(892);function a(){return Object(r.a)().showListPane}},1520:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(165);function a(e,t,n){Object(r.p)("TnS_FolderPaneChange",[e.toString(),t,n])}},1521:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){var t,n,a=[];if(null==e?void 0:e.recipients)try{for(var i=Object(r.__values)(e.recipients),o=i.next();!o.done;o=i.next()){var s=o.value,c=s.persona.EmailAddress;(null==c?void 0:c.ItemId)&&"PrivateDL"==c.MailboxType?a.push({Name:c.Name,RoutingType:c.RoutingType,MailboxType:c.MailboxType,ItemId:{Id:c.ItemId.Id,ChangeKey:null},EmailAddressIndex:c.EmailAddressIndex,RelevanceScore:c.RelevanceScore||0}):a.push(s.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}},1522:function(e,t,n){"use strict";var r=n(0),a=n(838),i=n(1667),o=n(104),s=n(2011);t.a=Object(o.action)("deleteConversationItemParts")(Object(o.select)({conversations:function(){return a.x.conversations},conversationNodes:function(){return a.x.conversationNodes},items:function(){return a.x.items}})((function(e,t){var n,a,o,c;if(t.conversations.has(e)){var u=t.conversations.get(e);try{for(var l=Object(r.__values)(u.conversationNodeIds),d=l.next();!d.done;d=l.next()){var f=d.value,p=t.conversationNodes.get(f);try{for(var m=(o=void 0,Object(r.__values)(p.itemIds)),g=m.next();!g.done;g=m.next()){var v=g.value;Object(i.a)(v,1)}}catch(e){o={error:e}}finally{try{g&&!g.done&&(c=m.return)&&c.call(m)}finally{if(o)throw o.error}}t.conversationNodes.delete(f)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}t.conversations.delete(e)}Object(s.a)()})))},1523:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},1527:function(e,t,n){"use strict";t.a=function(){return!1}},1543:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20);function a(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},1544:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},1546:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1156),a=n(894),i=24;function o(){return{minWidth:a.h-i,maxWidth:Object(r.a)().listViewWidth-i}}},1547:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(893),a=n(1257);function i(){return Object(r.b)()&&Object(a.a)()}},1548:function(e,t,n){"use strict";t.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(e,t,n,r){return[e,t,n]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(e,t){return[e.type,1==e.state||2==e.state,2==e.state,t,e.startTime?(new Date).getTime()-e.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(e,t){return[e.type,t]},options:{isVerbose:!0}}}},1571:function(e,t,n){"use strict";t.a={sendFeedback:function(){}}},1575:function(e){e.exports=JSON.parse('{"a":"_Lb"}')},1576:function(e){e.exports=JSON.parse('{"a":"ZLb"}')},1577:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1347),a=n(825);function i(e){return"Unread"==Object(a.K)(e)&&Object(r.a)(e)}},1581:function(e,t,n){"use strict";(function(e){var r=n(462),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===a&&r.a.process,s=function(){try{return o&&o.binding&&o.binding("util")}catch(e){}}();t.a=s}).call(this,n(1086)(e))},1592:function(e,t,n){"use strict";var r,a=n(0),i=n(29),o=n(461),s=n(1825),c=n(1826),u=n(1827),l=n(1828),d=n(1658),f=n(1829),p=n(7),m=n(2181),g=n(859),v=n(1),h=n(1391);!function(e){e[e.Mail=0]="Mail",e[e.Calendar=1]="Calendar",e[e.People=2]="People",e[e.FilesHub=3]="FilesHub",e[e.Tasks=4]="Tasks",e[e.OutlookSpaces=5]="OutlookSpaces"}(r||(r={}));var b=n(51),y=n(39),_=n(451),O=n(74),S=n(165),C=n(1036),I=n(1353);function A(e,t,n,a){var i;if(e===t&&n?n():Object(I.b)(r[e].toLowerCase())&&window.open(x(e).toString(),"_blank"),e===r.Tasks){var o=Object(O.h)(),s=null===(i=null==o?void 0:o.SessionSettings)||void 0===i?void 0:i.IsExplicitLogon;Object(S.o)("ModuleSwitch_ToDo",[s],{isCore:!0})}Object(S.o)("ModuleSwitch",[t.toString(),e.toString()],{isCore:!0})}function x(e){var t,n,a=Object(O.h)().UserOptions;switch(e){case r.Mail:return Object(_.k)()+Object(y.a)().search;case r.Calendar:return Object(b.f)("cal-react")||(null===(t=null==a?void 0:a.ReactOptinSettings)||void 0===t?void 0:t.CalendarEnabled)?Object(_.e)()+Object(y.a)().search:Object(_.o)({path:"/calendar"});case r.People:return Object(b.f)("fwk-peopleReact")||(null===(n=null==a?void 0:a.ReactOptinSettings)||void 0===n?void 0:n.PeopleEnabled)?Object(_.p)()+Object(y.a)().search:Object(_.o)({path:"/people"});case r.FilesHub:return Object(_.g)()+Object(y.a)().search;case r.Tasks:return Object(C.a)()?Object(_.s)():Object(_.o)({path:"/tasks"});case r.OutlookSpaces:return Object(_.n)()+Object(y.a)().search;default:throw new Error("Cannot get module switcher item URL of a workload that doesn't exist")}}var E=n(1356),T=n(219).bind(E);function w(e){var t=e.iconProps,n=e.workload,r=e.text,i=e.selectedModule,o=e.isHorizontal,s=e.href,c=n===i,u={role:g.a.menuitem,label:r};return v.createElement("div",{className:E.moduleSwitcherButtonContainer},v.createElement(h.a,Object(a.__assign)({key:n,styles:{root:T(o?E.root:E.verRoot,Object(b.f)("fwk-fluentCommandBar-moduleswitcher")&&E.fluent),menuIcon:c?E.selectedMenuIcon:E.menuIcon},menuIconProps:t,"data-is-focusable":!0,"data-workload":n,onClick:function(t){A(e.workload,e.selectedModule,e.activeModuleAction)},title:r,href:s},Object(g.b)(u))))}var j=n(20);function P(e,t,n,r,a){return{key:n,iconProps:{iconName:r},text:n,title:n,ariaLabel:n,name:n,workload:e,href:t!==e?x(e):"",onClick:function(n){A(e,t,a)}}}var M=n(1356),k=n(219).bind(M),R=Object(i.a)((function(e){v.useEffect((function(){Object(I.a)(r[e.selectedModule])}),[]);var t=Object(o.a)((function(){return D(e.selectedModule,e.activeModuleAction)})),n=Object(b.f)("fwk-fluentCommandBar-moduleswitcher")?56:48,i=Object(b.f)("fwk-fluentCommandBar-moduleswitcher")?4:0,s=e.isHorizontal,c=e.containerWidth,u={role:g.a.menubar,orientation:s?"horizontal":"vertical"},l=t.get(),d=[];if(s){if(!c)throw new Error("When module switcher is horizontal, a container width must be passed in");var f=Math.floor((c-i)/n);f<t.get().length&&(l=t.get().slice(0,f-1),d=t.get().slice(f-1))}return v.createElement(m.a,Object(a.__assign)({className:s&&M.horizontalContainer,vertical:!s,items:l,overflowItems:d,onRenderItem:function(t){var n=e.selectedModule,r=e.activeModuleAction,a=e.isHorizontal;return v.createElement(w,{iconProps:t.iconProps,workload:t.workload,text:t.text,selectedModule:n,activeModuleAction:r,isHorizontal:a,href:t.href})},onRenderOverflowButton:N},Object(g.b)(u),{styles:{root:{minWidth:c}}}))}));function D(e,t){var n=[P(r.Mail,e,Object(p.a)(f.b),"Mail",t),P(r.Calendar,e,Object(p.a)(l.a),"Calendar",t),P(r.People,e,Object(p.a)(u.a),"People",t)];if(Object(b.f)("doc-fileshub")&&n.push(P(r.FilesHub,e,Object(p.a)(f.a),"Attach",t)),!Object(j.a)().SessionSettings.IsShadowMailbox){var a=Object(C.a)(),i=a?Object(p.a)(c.a):Object(p.a)(s.a),o=a?"ToDoLogoOutline":"CheckboxComposite";n.push(P(r.Tasks,e,i,o,t))}return Object(b.f)("outlookSpaces-enabled")&&n.push(P(r.OutlookSpaces,e,Object(p.a)(d.a),"NotePinned",t)),n}function N(e){return v.createElement("div",{className:M.moduleSwitcherButtonContainer},v.createElement(h.a,{key:"overflow",styles:{root:k(M.root,Object(b.f)("fwk-fluentCommandBar-moduleswitcher")&&M.fluent),menuIcon:M.menuIcon},menuIconProps:{iconName:"More"},menuProps:{items:e},title:Object(p.a)(f.c)}))}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return D}));t.b=R},1594:function(e,t,n){"use strict";var r=n(77),a=n(1522),i=n(838),o=n(104),s=Object(o.action)("setIsPendingDeleteConversationItemParts")(Object(o.select)({conversationItemParts:function(e){return i.x.conversations.get(e)}})((function(e,t,n){var r=n.conversationItemParts;r&&(r.isPendingDelete=t)}))),c=n(1382);n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return a.a})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return c.b}));var u=new r.c((function(){return n.e(362).then(n.bind(null,13456))})),l=new r.a(u,(function(e){return e.loadAllRecipientsForItem})),d=new r.a(u,(function(e){return e.loadItem})),f=new r.a(u,(function(e){return e.loadConversation}))},1598:function(e,t,n){"use strict";function r(e,t){if(t.getClickHandler)t.onClick=t.getClickHandler(e);else if(t.sectionProps){t.sectionProps.items.forEach((function(t){r(e,t)}))}else if(t.subMenuProps){t.subMenuProps.items.forEach((function(t){r(e,t)}))}}n.d(t,"a",(function(){return r}))},1602:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"CreateFolderJsonRequest:#Exchange"},e)}},1603:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1575),a=n(1576),i=n(2096),o=n(7),s=n(1403),c=n(969),u=n(825);function l(e,t,n){if(1===e)return Object(o.a)(i.a);if(t){if(Object(u.J)(t))return Object(u.J)(t);var l=Object(u.l)(t),d=Object(u.p)(t.id);if(Object(c.d)()&&0!==d)return Object(s.a)(d).displayText;switch(l){case 0:return Object(o.a)(a.a);case 1:return Object(o.a)(r.a)}}return n}},1604:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(825);function a(e){var t=Object(r.F)().tableViews.get(e);switch(t.tableQuery.type){case 0:return t.tableQuery.inboxClassificationFilter;case 2:case 1:return 0;default:throw new Error("Table Query should be either of type search, mail folder or group")}}},1607:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r={};function a(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function i(e){delete r[e.editorId]}function o(e,t,n,a){if(e){var i=e.bodyType,o=void 0===i||"HTML"===i,s="Text"===i,c=r[e.editorId]||{},u=c.htmlEditor,l=c.plainTextEditor;o&&t&&(u&&!u.isDisposed()||a)?t(u):s&&n&&(l||a)&&n(l)}}},1610:function(e,t,n){"use strict";var r=n(51),a=n(980),i=n(1270),o=function(e){var t=Object(i.c)((function(t){return"SMTP"===t.EmailAddress.RoutingType&&t.EmailAddress.EmailAddress&&t.EmailAddress.EmailAddress.toLowerCase()===e.toLowerCase()}),1);return t.length?t[0]:null},s=n(52),c=function(e){var t=void 0!==e.EmailAddress;return t||s.d.warn("Recipient cache contained a persona that had no EmailAddress"),t};function u(e){if(Object(r.f)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){var t=o(e.EmailAddress);if(t&&c(t))return Object(a.a)(t)}return null}n.d(t,"a",(function(){return u}))},1611:function(e,t,n){"use strict";var r=n(1873),a=n(952);var i=n(1874),o=n(20);function s(){var e=null!=Object(a.a)().Context,t=Object(r.a)(),n=Object(o.a)().SegmentationSettings.OnSendAddinsEnabled;return e&&t?n&&Object(i.a)(1).length>0:n}n.d(t,"a",(function(){return s}))},1615:function(e,t,n){"use strict";var r;!function(e){e[e.Selected=0]="Selected",e[e.Deselected=1]="Deselected"}(r||(r={})),t.a=r},1618:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(74),a=n(831);function i(e){var t=Object(r.h)(),n=1==t.PolicySettings.MessagePreviewsDisabled;return t.UserOptions.ShowReadingPaneOnFirstLoad&&!n&&e.tableQuery.folderId!==Object(a.a)("junkemail")}},1619:function(e){e.exports=JSON.parse('{"a":"OLb","b":"PLb","c":"QLb"}')},1620:function(e){e.exports=JSON.parse('{"b":"KLb","c":"LLb","d":"MLb","a":"NLb"}')},1621:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(51);function a(e,t){switch(e.tableQuery.type){case 0:return Object(r.f)("tri-triageFolderScope")&&t?e.tableQuery.folderId:e.serverFolderId;case 1:case 2:default:return null}}},1622:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(844),a=n(1109);function i(e,t){var n=r.a.tableViews.get(t),i=[];return e.forEach((function(e){var t=Object(a.getRowIdString)(e,n);-1==i.indexOf(t)&&i.push(t)})),i}},1623:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(996);function a(e,t,n,a){for(var i=[],o=new Map,s=0;s<e.length;s++){var c=e[s],u=Object(r.a)(c,t),l=u.id;!o.get(l)&&n(u,a)&&(i.push(c),o.set(l,!0))}return i}},1626:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},1634:function(e,t,n){"use strict";var r=n(450),a=n(104);function i(e){e&&(e.isDirty=!1)}t.a=Object(a.action)("updateComposeItemId")((function(e,t,n,a){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=Object(r.a)({Id:t,ChangeKey:n}),a&&(e.lastSaveTimeStamp=a,e.isDirty=!1,i(e.toRecipientWell),i(e.ccRecipientWell),i(e.bccRecipientWell)))}))},1637:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},1658:function(e){e.exports=JSON.parse('{"a":"jaa"}')},1663:function(e,t,n){"use strict";function r(e){return e&&!!e.setPluginUtils}n.d(t,"a",(function(){return r}))},1664:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(845),a=n(74);function i(){var e=!0;if(Object(a.t)()){var t=Object(r.d)(r.a.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(a.h)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},1665:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(1233),a=n(1238),i=n(1303),o=n(839),s=n(153),c=n(976),u=n(914),l=1e3;function d(e,t){return Object(a.a)({FolderShape:Object(i.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(o.a)({FieldURI:"DistinguishedFolderId"}),Object(o.a)({FieldURI:"FolderClass"}),Object(o.a)({FieldURI:"FolderDisplayName"}),Object(o.a)({FieldURI:"ParentFolderId"}),Object(o.a)({FieldURI:"TotalCount"}),Object(o.a)({FieldURI:"UnreadCount"})]}),Paging:Object(u.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:l}),ParentFolderIds:e,ReturnParentFolder:!0,ShapeName:"Folder",Traversal:"Deep"})}function f(e,t){void 0===t&&(t=0);var n=e,a=d([n],t);return Object(r.a)({Header:Object(s.a)(),Body:a},Object(c.a)(n.Id)).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},1666:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(1905);function i(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.d.import()];case 1:return n=r.sent(),e&&n(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id),[2]}}))}))}},1667:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},1671:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"f",(function(){return _})),n.d(t,"i",(function(){return O})),n.d(t,"a",(function(){return S}));var r=n(77),a=(n(1672),new r.c((function(){return Promise.all([n.e(684),n.e(6),n.e(14),n.e(35),n.e(589)]).then(n.bind(null,3330))}))),i=new r.a(a,(function(e){return e.onSmimeItemAttachmentOpened})),o=new r.a(a,(function(e){return e.mergeSmimeDecodedMessageProperties})),s=(new r.b(a,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(a,(function(e){return e.setSmimePropertiesInDraftMessage}))),c=new r.b(a,(function(e){return e.trySetSmimeProperties})),u=new r.b(a,(function(e){return e.tryAddSmimeProperties})),l=new r.b(a,(function(e){return e.createMailResponseBodyContent})),d=new r.b(a,(function(e){return e.downloadSmimeAttachment})),f=new r.b(a,(function(e){return e.getMergedSmimeViewState})),p=new r.b(a,(function(e){return e.getMergedSmimeViewStateForDraft})),m=new r.b(a,(function(e){return e.isSmimeItemDecoding})),g=new r.b(a,(function(e){return e.previewSmimeAttachment})),v=new r.b(a,(function(e){return e.updateSmimeAttachmentIds})),h=new r.b(a,(function(e){return e.createSmimeAttachmentsFromFiles})),b=new r.b(a,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),y=new r.b(a,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),_=new r.b(a,(function(e){return e.getAttachmentsForSmimeResponse})),O=new r.b(a,(function(e){return e.getSmimeAttachmentsForRequest})),S=Object(r.d)(a,(function(e){return e.SignatureDetails}))},1672:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",(function(e,t){return{smimeViewState:e,signingCertRawData:t}}))},1673:function(e,t,n){"use strict";t.a=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},1674:function(e,t,n){"use strict";var r=n(385).a["__core-js_shared__"];t.a=r},1676:function(e,t,n){"use strict";var r=n(2155);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},1685:function(e,t,n){"use strict";var r,a=n(1130),i=n(1674),o=(r=/[^.]+$/.exec(i.a&&i.a.keys&&i.a.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var s=function(e){return!!o&&o in e},c=n(339),u=n(1470),l=/^\[object .+?Constructor\]$/,d=Function.prototype,f=Object.prototype,p=d.toString,m=f.hasOwnProperty,g=RegExp("^"+p.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.a=function(e){return!(!Object(c.a)(e)||s(e))&&(Object(a.a)(e)?g:l).test(Object(u.a)(e))}},1690:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetCalendarEventRequest:#Exchange"},e)}},1695:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4),a=Object(r.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),i=Object(r.action)("SET_REPLICA_LIST",(function(e,t){return{folderId:e,replicaList:t}})),o=Object(r.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",(function(e,t,n){return{rootFolder:e,treeType:t,principalSMTPAddress:n}}))},1696:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[],traceId:null});t.a=a},1697:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("onInlineComposeSendStateChange",(function(e,t){return{viewState:e,isSendPending:t}}))},1698:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.action)("messageBeingSent")},1700:function(e,t,n){"use strict";var r=n(1131),a=n(1087),i=n(1259),o=n(339);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var s=typeof t;return!!("number"==s?Object(a.a)(n)&&Object(i.a)(t,n.length):"string"==s&&t in n)&&Object(r.a)(n[t],e)}},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1711:function(e,t,n){"use strict";var r=n(24),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarEvent",e,t)}n.d(t,"a",(function(){return i}))},1712:function(e,t,n){"use strict";var r=n(1445),a=n(1760),i=Object(a.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},1722:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1402),a=n(20);function i(){var e=Object(r.c)();return e||Object(a.a)().SessionSettings.UserEmailAddress}},1724:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(1177),a=n(1441);function i(e){return e&&0===e.indexOf(r.e)}function o(e){return e&&0===e.indexOf(a.a)&&!i(e)}function s(e){return e&&0===e.indexOf(a.a)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1730:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r={};function a(e,t){var n,a=e.infoBarHostKey;return null===(n=r[a])||void 0===n?void 0:n[t]}},1736:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},1759:function(e,t,n){"use strict";var r=n(1637),a=n(1299),i=n(865),o=n(1248),s=n(1259),c=n(1280),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(i.a)(e),l=!n&&Object(a.a)(e),d=!n&&!l&&Object(o.a)(e),f=!n&&!l&&!d&&Object(c.a)(e),p=n||l||d||f,m=p?Object(r.a)(e.length,String):[],g=m.length;for(var v in e)!t&&!u.call(e,v)||p&&("length"==v||d&&("offset"==v||"parent"==v)||f&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||Object(s.a)(v,g))||m.push(v);return m}},1760:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},1761:function(e,t,n){"use strict";var r=n(1978),a=n(1676);t.a=function(e,t,n,i){var o=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var u=t[s],l=i?i(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),o?Object(a.a)(n,u,l):Object(r.a)(n,u,l)}return n}},1780:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),a=n(150),i=n(312),o=0;function s(e,t){var n=(t||window).document,s=n.createElement("div");s.id="owa-modal-"+o++,n.body.appendChild(s);var c,u=!1,l=function(){u||(u=!0,a.unmountComponentAtNode(s),n.body.removeChild(s))};return[new Promise((function(t,n){c=n,a.render(r.createElement(i.a,{type:i.b.None,onError:function(){l(),n()}},r.createElement(e,{onDismiss:function(e){l(),t(e)}})),s)})),function(){l(),c()}]}},1806:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(77),a=new r.c((function(){return n.e(383).then(n.bind(null,2822))})),i=Object(r.d)(a,(function(e){return e.OfficeAppRail}))},1825:function(e){e.exports=JSON.parse('{"a":"JLb"}')},1826:function(e){e.exports=JSON.parse('{"a":"ILb"}')},1827:function(e){e.exports=JSON.parse('{"a":"HLb"}')},1828:function(e){e.exports=JSON.parse('{"a":"GLb"}')},1829:function(e){e.exports=JSON.parse('{"b":"DLb","a":"ELb","c":"FLb"}')},1830:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'._2nUgnl8m3i2htoxK6l4hsn{display:-webkit-box;display:-ms-flexbox;display:flex}._2nUgnl8m3i2htoxK6l4hsn,._36b_ljU_eQu9mGocqbJRt_,._3paJrBdtyfJp1Tc4FtBB8p{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}._36b_ljU_eQu9mGocqbJRt_,._3paJrBdtyfJp1Tc4FtBB8p{height:48px;width:100%}html[dir] ._36b_ljU_eQu9mGocqbJRt_,html[dir] ._3paJrBdtyfJp1Tc4FtBB8p{padding:10px;background:transparent}html[dir] ._36b_ljU_eQu9mGocqbJRt_:hover,html[dir] ._3paJrBdtyfJp1Tc4FtBB8p:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}._36b_ljU_eQu9mGocqbJRt_:hover .ezvKpprGjKa5tSHDe6qZH,._3paJrBdtyfJp1Tc4FtBB8p:hover .ezvKpprGjKa5tSHDe6qZH{color:"[theme:themePrimary, default:#0078D4]"}._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC{height:32px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:40px;width:52px}html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC{border-radius:2px;margin:6px 2px;background:transparent}._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC .ms-Button-menuIcon{color:"[theme:themeDark, default:#0D62AA]"}._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover .ms-Button-icon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover .ms-Button-menuIcon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover .ms-Button-icon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover .ms-Button-menuIcon{background:"[theme:neutralLight, default:#eaeaea]"}._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:disabled,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:disabled .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:disabled .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:disabled,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:disabled .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:disabled .ms-Button-menuIcon{color:"[theme:neutralTertiary, default:#a6a6a6]"}._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p:active,._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-menuIcon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-menuIcon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG:active,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG:active .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG:active .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p:active,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-icon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-menuIcon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-icon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active .ms-Button-menuIcon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-icon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-menuIcon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG:active,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG:active .ms-Button-icon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG:active .ms-Button-menuIcon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active .ms-Button-icon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active .ms-Button-menuIcon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-icon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-menuIcon{background:"[theme:neutralQuaternaryAlt, default:#dadada]"}._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p,._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p .ms-Button-menuIcon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-icon,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG .ms-Button-menuIcon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-icon,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p .ms-Button-icon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG._3paJrBdtyfJp1Tc4FtBB8p .ms-Button-menuIcon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-icon,html[dir] ._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p.is-expanded .ms-Button-menuIcon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG .ms-Button-icon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC._2CTXkkDiDMGVbm8WbuYfnG .ms-Button-menuIcon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-icon,html[dir] ._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC.is-expanded .ms-Button-menuIcon{background:"[theme:themeLight, default:#C7E0F4]"}._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p ._3WBRdALGRdu_zFxYfzgjAM,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p .ezvKpprGjKa5tSHDe6qZH,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active ._3WBRdALGRdu_zFxYfzgjAM,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active .ezvKpprGjKa5tSHDe6qZH,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover ._3WBRdALGRdu_zFxYfzgjAM,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover .ezvKpprGjKa5tSHDe6qZH,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC ._3WBRdALGRdu_zFxYfzgjAM,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC .ezvKpprGjKa5tSHDe6qZH,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active ._3WBRdALGRdu_zFxYfzgjAM,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active .ezvKpprGjKa5tSHDe6qZH,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover ._3WBRdALGRdu_zFxYfzgjAM,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover .ezvKpprGjKa5tSHDe6qZH{color:"[theme:neutralSecondary, default:#666666]"}._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p .ezvKpprGjKa5tSHDe6qZH,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:active .ezvKpprGjKa5tSHDe6qZH,._2dbnwJ8QvDpuHgD00m3IGC._3paJrBdtyfJp1Tc4FtBB8p:hover .ezvKpprGjKa5tSHDe6qZH,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC .ezvKpprGjKa5tSHDe6qZH,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:active .ezvKpprGjKa5tSHDe6qZH,._36b_ljU_eQu9mGocqbJRt_._2dbnwJ8QvDpuHgD00m3IGC:hover .ezvKpprGjKa5tSHDe6qZH{color:"[theme:themePrimary, default:#0078D4]"}._3paJrBdtyfJp1Tc4FtBB8p{width:47px}._3paJrBdtyfJp1Tc4FtBB8p._2dbnwJ8QvDpuHgD00m3IGC{height:42px;width:40px}html[dir] ._3paJrBdtyfJp1Tc4FtBB8p._2dbnwJ8QvDpuHgD00m3IGC{margin:0 4px 4px 4px}._3WBRdALGRdu_zFxYfzgjAM,.ezvKpprGjKa5tSHDe6qZH{font-size:16px!important}.ezvKpprGjKa5tSHDe6qZH{color:"[theme:themePrimary, default:#0078D4]"}._3dhUZymTHbxfDmBQWt4m_j{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._3dhUZymTHbxfDmBQWt4m_j{border-top:1px solid "[theme:neutralLight, default:#eaeaea]"}._3dhUZymTHbxfDmBQWt4m_j .ms-OverflowSet-item,._3dhUZymTHbxfDmBQWt4m_j .ms-OverflowSet-overflowButton{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}',""]),t.locals={moduleSwitcherButtonContainer:"_2nUgnl8m3i2htoxK6l4hsn",root:"_36b_ljU_eQu9mGocqbJRt_",verRoot:"_3paJrBdtyfJp1Tc4FtBB8p",selectedMenuIcon:"ezvKpprGjKa5tSHDe6qZH",fluent:"_2dbnwJ8QvDpuHgD00m3IGC",expanded:"_2CTXkkDiDMGVbm8WbuYfnG",menuIcon:"_3WBRdALGRdu_zFxYfzgjAM",horizontalContainer:"_3dhUZymTHbxfDmBQWt4m_j"}},1831:function(e,t,n){e.exports=n.p+"../resources/images/outlook-97fabb0c35e2d45801070287f96fa58e.svg"},1832:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTciIGhlaWdodD0iMTciIHZpZXdCb3g9IjAgMCAxNyAxNyI+CiAgPGRlZnM+CiAgICA8cGF0aCBpZD0iZ29vZ2xlXy1nLV9sb2dvQDJ4LWEiIGQ9Ik0xNi44MDIzMjU2LDYuOTU0NTQ1NDUgTDguNjk3Njc0NDIsNi45NTQ1NDU0NSBMOC42OTc2NzQ0MiwxMC4yMzg2MzY0IEwxMy4zNjI3OTA3LDEwLjIzODYzNjQgQzEyLjkyNzkwNywxMi4zMjUgMTEuMTA5MzAyMywxMy41MjI3MjczIDguNjk3Njc0NDIsMTMuNTIyNzI3MyBDNS44NTExNjI3OSwxMy41MjI3MjczIDMuNTU4MTM5NTMsMTEuMjgxODE4MiAzLjU1ODEzOTUzLDguNSBDMy41NTgxMzk1Myw1LjcxODE4MTgyIDUuODUxMTYyNzksMy40NzcyNzI3MyA4LjY5NzY3NDQyLDMuNDc3MjcyNzMgQzkuOTIzMjU1ODEsMy40NzcyNzI3MyAxMS4wMzAyMzI2LDMuOTAyMjcyNzMgMTEuOSw0LjU5NzcyNzI3IEwxNC40MzAyMzI2LDIuMTI1IEMxMi44ODgzNzIxLDAuODExMzYzNjM2IDEwLjkxMTYyNzksMCA4LjY5NzY3NDQyLDAgQzMuODc0NDE4NiwwIDAsMy43ODYzNjM2NCAwLDguNSBDMCwxMy4yMTM2MzY0IDMuODc0NDE4NiwxNyA4LjY5NzY3NDQyLDE3IEMxMy4wNDY1MTE2LDE3IDE3LDEzLjkwOTA5MDkgMTcsOC41IEMxNyw3Ljk5NzcyNzI3IDE2LjkyMDkzMDIsNy40NTY4MTgxOCAxNi44MDIzMjU2LDYuOTU0NTQ1NDUgWiIvPgogIDwvZGVmcz4KICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgPG1hc2sgaWQ9Imdvb2dsZV8tZy1fbG9nb0AyeC1iIiBmaWxsPSIjZmZmIj4KICAgICAgPHVzZSB4bGluazpocmVmPSIjZ29vZ2xlXy1nLV9sb2dvQDJ4LWEiLz4KICAgIDwvbWFzaz4KICAgIDxwb2x5Z29uIGZpbGw9IiNGQkJDMDUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSItLjc5MSAxMy41MjMgLS43OTEgMy40NzcgNS45MyA4LjUiIG1hc2s9InVybCgjZ29vZ2xlXy1nLV9sb2dvQDJ4LWIpIi8+CiAgICA8cG9seWdvbiBmaWxsPSIjRUE0MzM1IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iLS43OTEgMy40NzcgNS45MyA4LjUgOC42OTggNi4xNDMgMTguMTg2IDQuNjM2IDE4LjE4NiAtLjc3MyAtLjc5MSAtLjc3MyIgbWFzaz0idXJsKCNnb29nbGVfLWctX2xvZ29AMngtYikiLz4KICAgIDxwb2x5Z29uIGZpbGw9IiMzNEE4NTMiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSItLjc5MSAxMy41MjMgMTEuMDcgNC42MzYgMTQuMTkzIDUuMDIzIDE4LjE4NiAtLjc3MyAxOC4xODYgMTcuNzczIC0uNzkxIDE3Ljc3MyIgbWFzaz0idXJsKCNnb29nbGVfLWctX2xvZ29AMngtYikiLz4KICAgIDxwb2x5Z29uIGZpbGw9IiM0Mjg1RjQiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSIxOC4xODYgMTcuNzczIDUuOTMgOC41IDQuMzQ5IDcuMzQxIDE4LjE4NiAzLjQ3NyIgbWFzaz0idXJsKCNnb29nbGVfLWctX2xvZ29AMngtYikiLz4KICA8L2c+Cjwvc3ZnPgo="},1833:function(e,t,n){var r=n(1834),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1834:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'._3pDdA12QpAniGJil5kkiRE{width:100%;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}._3pDdA12QpAniGJil5kkiRE ._3vxOLYksStC-ywwInVkAfU{cursor:pointer;text-decoration:none;color:"[theme:neutralSecondary, default:#666666]";font-size:18px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:48px;width:48px}html[dir] ._3pDdA12QpAniGJil5kkiRE ._3vxOLYksStC-ywwInVkAfU{margin:auto}._3pDdA12QpAniGJil5kkiRE ._3vxOLYksStC-ywwInVkAfU:hover{color:"[theme:black, default:#000000]"}html[dir] ._3pDdA12QpAniGJil5kkiRE ._3vxOLYksStC-ywwInVkAfU:hover{background:"[theme:neutralLight, default:#eaeaea]"}._3pDdA12QpAniGJil5kkiRE ._1IqNi2ejF-rZk-f_NkoTUK,._3pDdA12QpAniGJil5kkiRE ._1IqNi2ejF-rZk-f_NkoTUK:hover,._3pDdA12QpAniGJil5kkiRE ._3vxOLYksStC-ywwInVkAfU:active{color:"[theme:themeDark, default:#0D62AA]"}._2STTyJy0fQpG5eIz5VXYWE{color:"[theme:neutralTertiary, default:#a6a6a6]";width:28px;height:28px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:1}html[dir] ._2STTyJy0fQpG5eIz5VXYWE{border-radius:70%;margin:10px 0;background-color:"[theme:white, default:#ffffff]"}.fsC2Gzug8AmT_U78JLg7t{width:100%;height:48px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;position:relative;text-decoration:none}html[dir] .fsC2Gzug8AmT_U78JLg7t:hover{background:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._3ND1rX3pwJq9w2vDS6ZurZ{background-color:#0078d4}html[dir] ._23jtMcnxwYXCksMq9mjX9i{background-color:#fff}._2MyhSEmJ2UEIw4kLSrbrDf{position:absolute;width:32px;height:32px;top:7px}html[dir] ._2MyhSEmJ2UEIw4kLSrbrDf{border-width:1px;border-style:solid;border-radius:70%;border-color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._2MyhSEmJ2UEIw4kLSrbrDf{left:7px}html[dir=rtl] ._2MyhSEmJ2UEIw4kLSrbrDf{right:7px}.ipVdHCkqxFqN8er1R8MvI{opacity:.5}.zKFBnJdJrrVQQB1Qv19CF{color:"[theme:neutralSecondary, default:#666666]";font-size:16px;width:28px;height:28px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:1}html[dir] .zKFBnJdJrrVQQB1Qv19CF{margin:10px 0}',""]),t.locals={container:"_3pDdA12QpAniGJil5kkiRE",item:"_3vxOLYksStC-ywwInVkAfU",activeItem:"_1IqNi2ejF-rZk-f_NkoTUK",leftRailButton:"_2STTyJy0fQpG5eIz5VXYWE",buttonContainer:"fsC2Gzug8AmT_U78JLg7t",outlookButton:"_3ND1rX3pwJq9w2vDS6ZurZ",gmailButton:"_23jtMcnxwYXCksMq9mjX9i",floatingBorder:"_2MyhSEmJ2UEIw4kLSrbrDf",leftRailButtonUnselected:"ipVdHCkqxFqN8er1R8MvI",addNewButton:"zKFBnJdJrrVQQB1Qv19CF"}},1835:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'._3mlfhE4JyZTE3izdzM4XY8{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;max-width:48px;-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] ._3mlfhE4JyZTE3izdzM4XY8{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._3mlfhE4JyZTE3izdzM4XY8{border-right:1px solid "[theme:neutralLight, default:#eaeaea]"}html[dir=rtl] ._3mlfhE4JyZTE3izdzM4XY8{border-left:1px solid "[theme:neutralLight, default:#eaeaea]"}._1-g0ITEy1o9RP5YglQjcW_{width:100%;max-height:100%;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}._3gdNmT4jTLXmeDgn968BfI{height:44px}html[dir] ._3gdNmT4jTLXmeDgn968BfI{background-color:"[theme:neutralLighter, default:#f4f4f4]";border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}._3gdNmT4jTLXmeDgn968BfI._3jkrUsnJ2QMjUwNU1Wj0QO{width:48px}.WX0IWxSwrsr_XhFQE2sT{-webkit-box-sizing:content-box;box-sizing:content-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:44px;width:48px;color:"[theme:themeDark, default:#0D62AA]"}html[dir] .WX0IWxSwrsr_XhFQE2sT{background:transparent;border:0;padding:0}._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT{height:32px;width:40px}html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT{border-radius:2px;margin:6px 2px;background:transparent;margin:6px 4px}._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT .ms-Button-menuIcon{color:"[theme:themeDark, default:#0D62AA]"}._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:hover,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:hover .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:hover .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:hover,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:hover .ms-Button-icon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:hover .ms-Button-menuIcon{background:"[theme:neutralLight, default:#eaeaea]"}._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:disabled,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:disabled .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:disabled .ms-Button-menuIcon{color:"[theme:neutralTertiary, default:#a6a6a6]"}._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E:active,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E:active .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E:active .ms-Button-menuIcon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:active,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:active .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:active .ms-Button-menuIcon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E:active,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E:active .ms-Button-icon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E:active .ms-Button-menuIcon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:active,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:active .ms-Button-icon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT:active .ms-Button-menuIcon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-icon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-menuIcon{background:"[theme:neutralQuaternaryAlt, default:#dadada]"}._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E .ms-Button-menuIcon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-icon,._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E .ms-Button-icon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.dYAa7AIvO81XAI77t9n7E .ms-Button-menuIcon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-icon,html[dir] ._3jkrUsnJ2QMjUwNU1Wj0QO .WX0IWxSwrsr_XhFQE2sT.is-expanded .ms-Button-menuIcon{background:"[theme:themeLight, default:#C7E0F4]"}html[dir] .WX0IWxSwrsr_XhFQE2sT:hover{background-color:"[theme:themeLight, default:#C7E0F4]"}._249aadPOsQy0LFIytZBYl5{z-index:1}',""]),t.locals={leftRail:"_3mlfhE4JyZTE3izdzM4XY8",accountSwitcherPlaceholder:"_1-g0ITEy1o9RP5YglQjcW_",hamburgerButtonWrapper:"_3gdNmT4jTLXmeDgn968BfI",fluent:"_3jkrUsnJ2QMjUwNU1Wj0QO",hamburgerButton:"WX0IWxSwrsr_XhFQE2sT",expanded:"dYAa7AIvO81XAI77t9n7E",freOverlay:"_249aadPOsQy0LFIytZBYl5"}},1836:function(e){e.exports=JSON.parse('{"a":"taa"}')},1867:function(e,t,n){"use strict";var r,a,i=n(77),o=new i.c((function(){return n.e(108).then(n.bind(null,13607))})),s=new i.a(o,(function(e){return e.updateAdExp2UserOption})),c=n(51),u=n(20),l=n(206),d=n(1231),f=new i.c((function(){return Promise.all([n.e(38),n.e(390)]).then(n.bind(null,13739))})),p=new i.a(f,(function(e){return e.logUserAdConfig}));function m(){if(void 0!==a)return a;if(Object(l.a)()&&Object(c.f)("fwk-ads")){var e=null,t=Object(d.g)(),n=Object(u.a)().UserOptions.ConsumerAdsExperimentMode;Object(d.c)()?e="PremiumUser":Object(d.d)()?e="ShadowMailboxUser":d.f.includes(t)?e="EmbargoedMarket":Object(d.b)()&&(e="ChildAccount"),a=null==e,!(r=null==e)||Object(c.f)("fwk-ads-exp2-RuntimeBypass")||"DisplayOffNativeOff"!=n&&"DisplayOffNativeOther"!=n&&"DisplayOffNativeInbox"!=n||(e="AdsExp2",a=!1),p.importAndExecute(r,e,t,a),s.importAndExecute()}else a=!1;return a}function g(){return m()||Object(d.m)(!1)}n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return m}))},1872:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(897),a=n(869),i=0;function o(e,t){return{userIdentity:t,recipientWellId:"rw-"+ ++i,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:a.b.None,isSearching:!1,directorySearchType:a.a.None,dropViewState:Object(r.a)(),findPeopleFeedbackManager:e,numberOfCacheResults:0}}},1873:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(952);function a(){var e=Object(r.a)().EnabledAddinCommands;return!!e&&e.isInitialized}},1874:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(0),a=n(954),i=n(952),o="User",s="Organization",c="Default";function u(e){var t=Object(i.a)().EnabledAddinCommands;return t?t.getExtensionPoint(a.a.TrapOnSendEvent).map((function(t){return t.AddinCommands.get(e.toString())})):[]}function l(e){var t=u(e),n=t.filter((function(e){return e.extension.OriginString==o})),a=t.filter((function(e){return e.extension.OriginString==c})),i=t.filter((function(e){return e.extension.OriginString==s}));return n.sort((function(e,t){return d(e,t)})),a.sort((function(e,t){return d(e,t)})),i.sort((function(e,t){return d(e,t)})),Object(r.__spread)(n,a,i)}function d(e,t){var n=e.get_Id(),r=t.get_Id();return n<r?-1:n>r?1:0}},1883:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function a(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},1884:function(e,t,n){"use strict";var r=n(13),a=n(4),i={sharingLinks:new r.ObservableMap({})},o=Object(a.createStore)("sharingLinkStore",i);t.a=o},190:function(e,t,n){"use strict";var r=n(463);n.d(t,"a",(function(){return r.a}))},1904:function(e,t,n){"use strict";var r=n(1245),a=n(104),i=n(888);t.a=Object(a.action)("setTabIsShown")((function(e,t){switch(e.state){case 0:t&&(e.state=1,e.blink=!0);break;case 1:case 2:case 3:if(!t){var n=2==e.state&&function(e){var t=Object(i.a)().tabs,n=Math.max(t.indexOf(e),0),r=t.filter((function(t){return t.id==e.parentTabId&&1==t.state}))[0];if(r)return r;for(var a=n;a<t.length;a++)if(1==t[a].state)return t[a];for(a=n-1;a>=0;a--)if(1==t[a].state)return t[a];return null}(e);n&&Object(r.a)(n),e.state=0}}}))},1905:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"c",(function(){return f}));var r=n(77),a=n(1696);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(6),n.e(31),n.e(123)]).then(n.bind(null,3333))})),o=new r.b(i,(function(e){return e.getAttachmentSuggestionsAction})),s=new r.b(i,(function(e){return e.createCloudFileFromAttachmentData})),c=new r.a(i,(function(e){return e.logAttachmentSuggestionClicked})),u=new r.a(i,(function(e){return e.logAttachMenuData})),l=new r.a(i,(function(e){return e.logAttachMenuDataOnClose})),d=(new r.a(i,(function(e){return e.logAttachmentSuggestionsClientLayout})),new r.a(i,(function(e){return e.logAttachmentMenuSuggestionData}))),f=new r.b(i,(function(e){return e.extractAttachmentSuggestions}))},1937:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"CreateItemJsonRequest:#Exchange"},e)}},1938:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"CreateItemRequest:#Exchange"},e)}},1951:function(e,t,n){"use strict";var r=n(104),a=n(2308);t.a=Object(r.action)("updateContent")((function(e,t,n){e.content!=t&&(e.content=t,n||Object(a.a)(e,!0))}))},1967:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},1973:function(e,t,n){"use strict";var r=n(0),a=n(1245),i=n(1548),o=n(1160),s=n(891),c=n(83),u=n(888),l=1;t.a=Object(c.d)("addTab",i.a.TabViewAddTab)((function(e,t,n,i){var c=Object(o.a)(),d=Object(u.a)(),f={id:s.a[e]+(l++).toString(),state:t?1:0,startTime:(new Date).getTime(),parentTabId:c?c.id:null,blink:t,data:i},p=null;switch(e){case s.a.Primary:p=Object(r.__assign)(Object(r.__assign)({},f),{type:s.a.Primary});break;case s.a.OverflowMenu:p=Object(r.__assign)(Object(r.__assign)({},f),{type:s.a.OverflowMenu,data:i});break;case s.a.SecondaryReadingPane:p=Object(r.__assign)(Object(r.__assign)({},f),{type:s.a.SecondaryReadingPane,data:i});break;case s.a.Compose:p=Object(r.__assign)(Object(r.__assign)({},f),{type:s.a.Compose,data:i});break;case s.a.FloatingChat:p=Object(r.__assign)(Object(r.__assign)({},f),{type:s.a.FloatingChat,data:i,isChatActive:!1})}d.tabs.push(p),n&&Object(a.a)(d.tabs[d.tabs.length-1])}))},1978:function(e,t,n){"use strict";var r=n(1676),a=n(1131),i=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var o=e[t];i.call(e,t)&&Object(a.a)(o,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},1994:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(13),a=n(4),i={clpLabels:[],learnMoreUrl:"",rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},o=Object(a.createStore)("protection",i),s=o()},2001:function(e,t,n){"use strict";var r=n(825),a=n(827);function i(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(a.G)(e.tableQuery.folderId)}function o(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(a.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var s=n(4),c=n(85),u=n(1502),l=n(1269),d=n(13),f=Object(s.createStore)("publicFolderUtilsStore",new d.ObservableMap),p=n(74);function m(e){if(!f().has(e)){var t=l.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(p.h)().SessionSettings.DefaultPublicFolderMailbox,r={type:null,deprecatedMailboxId:e,userIdentity:Object(c.e)().userIdentity,mailboxSmtpAddress:t.principalSMTPAddress,routingKey:Object(c.c)()+n,requestOptions:Object(u.a)(n)};g(e,r)}return f().get(e)}var g=Object(s.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){f().set(e,t)}));n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return m}))},2008:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1077),a=n(894);function i(){return Object(r.c)()?a.b:0}},2009:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(908),a=n(894);function i(e,t){return e<a.f?t==r.a.LeftNavResizeExpand?a.f:a.a:e>a.c?a.c:e}},2010:function(e,t,n){"use strict";var r=n(104);t.a=Object(r.action)("toggleChatTab")((function(e){e.isChatActive=!e.isChatActive,e.state=e.isChatActive?2:1,e.blink=!1}))},2011:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(4),a=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),i=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2032:function(e,t,n){"use strict";var r=n(226),a=n(224),i=n(193);var o=n(20),s=n(104);t.a=Object(s.action)("setFolderPaneWidth")((function(e){var t;Object(o.a)().UserOptions.NavigationBarWidth!=e&&(Object(o.a)().UserOptions.NavigationBarWidth=e,t=e,Object(r.a)("OWA.UserOptions",[Object(a.a)({DictionaryKey:Object(i.a)({Type:"String",Value:["NavigationBarWidth"]}),DictionaryValue:Object(i.a)({Type:"Integer32",Value:[""+t]})})]))}))},2056:function(e,t,n){"use strict";var r=n(1780);n.d(t,"a",(function(){return r.a}))},2062:function(e,t,n){"use strict";t.a=function(e){return function(){return e}}},2083:function(e,t,n){"use strict";var r,a,i=n(0),o=32,s=126;function c(e){var t,n;if(!e)return!1;try{for(var r=Object(i.__values)(e),a=r.next();!a.done;a=r.next()){var c=a.value;if(null==c||0===c.trim().length)return!1;for(var u=c.length;u--;)if(c.charCodeAt(u)>s||c.charCodeAt(u)<o)return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}function u(e){return!!e&&c(Object.keys(e))}!function(e){e[e.Read=1]="Read",e[e.Create=2]="Create",e[e.DeleteOwn=4]="DeleteOwn",e[e.DeleteAll=8]="DeleteAll",e[e.EditOwn=16]="EditOwn",e[e.EditAll=32]="EditAll"}(r||(r={})),function(e){e.Base64="base64",e.Eml="eml",e.Url="url",e.Ical="iCalendar"}(a||(a={}));var l=n(1462),d=n(1463),f=n(1420),p=n(1461),m=function(e){var t={locationIdentifier:{}};return t.displayName=e.DisplayName,e.PostalAddress&&"Resource"===e.PostalAddress.LocationSource?(t.emailAddress=e.PostalAddress.LocationUri,t.locationIdentifier.id=t.emailAddress,t.locationIdentifier.type=l.a.Room):(t.emailAddress="",t.locationIdentifier.id=t.displayName,t.locationIdentifier.type=l.a.Custom),t};function g(e){var t,n;if(!e||e.length<=0)return!1;try{for(var r=Object(i.__values)(e),a=r.next();!a.done;a=r.next()){if(a.value.id.trim().length<=0)return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return l.a})),n.d(t,"e",(function(){return d.a})),n.d(t,"f",(function(){return f.a})),n.d(t,"g",(function(){return f.b})),n.d(t,"b",(function(){return p.a})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return g}))},2096:function(e){e.exports=JSON.parse('{"a":"$Lb"}')},2106:function(e,t,n){"use strict";var r=n(2),a=n(20),i=n(51);n(7223);var o=n(7224);OSF.getLocalizedStringsFilePath=function(){var e=Object(r.q)()+"resources/locale/osfruntime/",t=Object(a.a)().SessionSettings?Object(a.a)().SessionSettings.UserLanguage:"en";return e+(o[t]||"en-us")+"/jscript/"},OSF.getManifestHostType=function(){},OSF.AppTelemetry={enableTelemetry:Object(i.f)("addin-oteljs")}},2130:function(e,t,n){"use strict";var r=n(24),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return i}))},2147:function(e){e.exports=JSON.parse('{"a":"VLb","c":"WLb","d":"XLb","b":"YLb"}')},2148:function(e){e.exports=JSON.parse('{"a":"ULb"}')},2149:function(e){e.exports=JSON.parse('{"a":"TLb"}')},2150:function(e){e.exports=JSON.parse('{"a":"SLb"}')},2151:function(e){e.exports=JSON.parse('{"a":"RLb"}')},2155:function(e,t,n){"use strict";var r=n(1048),a=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=a},2159:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2160:function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.Text=0]="Text",e[e.Html=3]="Html"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.New=1]="New",e[e.Reply=2]="Reply",e[e.Forward=3]="Forward"}(a||(a={}))},2163:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(2210),i=n(1872),o=n(13);function s(e,t,n,s){var c,u,l=Object(i.a)(e,n);if(s&&(l.recipients=Object(o.toJS)(s)),t)try{for(var d=Object(r.__values)(t),f=d.next();!f.done;f=d.next()){var p=f.value;l.recipients.push(Object(a.a)(p))}}catch(e){c={error:e}}finally{try{f&&!f.done&&(u=d.return)&&u.call(d)}finally{if(c)throw c.error}}return l}},2181:function(e,t,n){"use strict";var r=n(291),a=n(1366),i={flexShrink:0,display:"inherit"};n.d(t,"a",(function(){return o}));var o=Object(r.a)(a.a,(function(e){var t=e.className;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},e.vertical&&{flexDirection:"column"},t],item:["ms-OverflowSet-item",i],overflowButton:["ms-OverflowSet-overflowButton",i]}}),void 0,{scope:"OverflowSet"})},220:function(e,t,n){"use strict";var r=n(115);var a=n(4),i=n(13);n.d(t,"b",(function(){return c}));var o,s={categoryIdToNameMap:{},categoryMenuViewState:{findText:"",isFocusInSearchBox:!1,newCategoryViewState:null,shouldShowAllCategories:!1},categoryColorPickerViewState:{colorPickerTarget:null,shouldShowColorPicker:!1},colorCodeColorValueMap:((o={})[r.a.None]={primaryColor:"#CCCCCC",secondaryColor:"#A6A6A6",iconColor:"#000000",textColor:"#000000"},o[r.a.Red]={primaryColor:"#fce9ea",secondaryColor:"#F1919A",iconColor:"#E74856",textColor:"#D01B2A"},o[r.a.Orange]={primaryColor:"#fff1e0",secondaryColor:"#ffba66",iconColor:"#FF8C00",textColor:"#A35A00"},o[r.a.Peach]={primaryColor:"#fff5e8",secondaryColor:"#ffcd8f",iconColor:"#FFAB45",textColor:"#A35A00"},o[r.a.YellowLight]={primaryColor:"#fffde0",secondaryColor:"#fff766",iconColor:"#FFF100",textColor:"#7A7400"},o[r.a.GreenLight]={primaryColor:"#e9f9e8",secondaryColor:"#91e38d",iconColor:"#47D041",textColor:"#257E20"},o[r.a.TealLight]={primaryColor:"#e6f8f9",secondaryColor:"#83dde0",iconColor:"#30C6CC",textColor:"#1D797C"},o[r.a.Olive]={primaryColor:"#EEF5E4",secondaryColor:"#abcc7c",iconColor:"#73AA24",textColor:"#527A1A"},o[r.a.BlueSky]={primaryColor:"#e0f7fd",secondaryColor:"#66d7f7",iconColor:"#00BCF2",textColor:"#007899"},o[r.a.PurpleLight]={primaryColor:"#f0ecf6",secondaryColor:"#b7a2d4",iconColor:"#8764B8",textColor:"#7D57B2"},o[r.a.Pink]={primaryColor:"#fef2f7",secondaryColor:"#f8bfd9",iconColor:"#F495BF",textColor:"#D8186E"},o[r.a.SteelLight]={primaryColor:"#f3f5f6",secondaryColor:"#c6ced1",iconColor:"#A0AEB2",textColor:"#5E7373"},o[r.a.SteelGrey]={primaryColor:"#D0E0E2",secondaryColor:"#6693a0",iconColor:"#004B60",textColor:"#004B60"},o[r.a.GreyLight]={primaryColor:"#f6f5f5",secondaryColor:"#d0cecd",iconColor:"#B1ADAB",textColor:"#776E6E"},o[r.a.GreyDark]={primaryColor:"#D4D4D4",secondaryColor:"#9e9c9b",iconColor:"#5D5A58",textColor:"#5D5A58"},o[r.a.Black]={primaryColor:"#969696",secondaryColor:"#666666",iconColor:"#000000",textColor:"#000000"},o[r.a.RedDark]={primaryColor:"#C09BA4",secondaryColor:"#ac6d77",iconColor:"#750B1C",textColor:"#750B1C"},o[r.a.OrangeDark]={primaryColor:"#f9eae2",secondaryColor:"#df9670",iconColor:"#CA5010",textColor:"#B3480F"},o[r.a.BrownMedium]={primaryColor:"#f5ece2",secondaryColor:"#cda16e",iconColor:"#AB620D",textColor:"#9D590B"},o[r.a.YellowDark]={primaryColor:"#f7f3e0",secondaryColor:"#dac466",iconColor:"#C19C00",textColor:"#856A00"},o[r.a.GreenDark]={primaryColor:"#C8DACC",secondaryColor:"#669377",iconColor:"#004B1C",textColor:"#004B1C"},o[r.a.TealDark]={primaryColor:"#CEDCDE",secondaryColor:"#669396",iconColor:"#004B50",textColor:"#004B50"},o[r.a.OliveDark]={primaryColor:"#C3DAC3",secondaryColor:"#6da66d",iconColor:"#0B6A0B",textColor:"#0b6a0b"},o[r.a.BlueDark]={primaryColor:"#A6ACC4",secondaryColor:"#667996",iconColor:"#002050",textColor:"#002050"},o[r.a.PurpleDark]={primaryColor:"#B5ACC8",secondaryColor:"#84729c",iconColor:"#32145A",textColor:"#32145A"},o[r.a.MagentaDark]={primaryColor:"#D1B8D1",secondaryColor:"#9d669d",iconColor:"#5C005C",textColor:"#5C005C"},o),pendingCategoryNamesMap:{},categoryDetails:new i.ObservableMap({}),isSearchFolderReady:!1,categoryDialogViewState:null,isApplyingCategoryOperation:!1},c=Object(a.createStore)("category",s);t.a=c()},2201:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,"a",(function(){return r}))},2207:function(e,t,n){"use strict";var r=n(1033),a=n(1700);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&Object(a.a)(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,o)}return t}))}},2210:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(1275),i=n(1610);function o(e){var t=Object(i.a)(e);if(t)return t;var n=Object(a.b)(e);return Object(r.__assign)(Object(r.__assign)({},n),{isPendingResolution:!0,persona:{EmailAddress:e}})}},2266:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateInternetMessageId",(function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}}))},2267:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(825);function i(){var e=Object(a.C)();if(e){var t=e.isInVirtualSelectAllMode,n=Object(r.__spread)(e.selectedRowKeys.keys());if(1==n.length&&!t)return a.b.getRowIdString(n[0],e)}return null}},2273:function(e){e.exports=JSON.parse('{"a":"kga"}')},2308:function(e,t,n){"use strict";var r=n(104);t.a=Object(r.action)("setIsDirty")((function(e,t){e.isDirty=t}))},2314:function(e,t,n){"use strict";n.d(t,"c",(function(){return _})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return C})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return A}));var r=n(0),a=n(1203),i=n(1317),o=n(3886),s=n(3309),c=n(4873),u=n(5342),l=n(5499),d=n(1422),f=n(3795),p=n(20),m=n(83),g=n(2871),v=n(2710),h=n(51),b={};function y(e){var t=b[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},b[e.composeId]=t),t}function _(e){var t=b[e.composeId];return t&&!!t.activeSaveAction}function O(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(t=y(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}}))}))}function S(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(n=y(e)).activeSaveAction=t,[4,t.then((function(e){return n.activeSaveAction=null,Promise.resolve(e)})).catch((function(e){return n.activeSaveAction=null,Promise.reject(e)}))];case 1:return r.sent(),[2]}}))}))}function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return(null==(t=b[e.composeId])?void 0:t.activeSaveAction)?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}}))}))}function I(e){var t=b[e.composeId];return t&&!!t.activeSaveAction}function A(e){b[e.composeId]&&delete b[e.composeId]}t.b=Object(m.d)("trySaveMessage",s.b.MailComposeSave)((function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,O(e)];case 1:return r.sent()?e?e.isSending||I(e)?[2,Promise.resolve()]:(t||(Object(i.a)(e,c.a),e.isManuallySaved=!0),function(e){return Object(d.a)(e)<=Object(p.a)().MaxRecipientsPerMessage}(e)?[2,S(e,Object(l.b)(e).then((function(n){return e.isSending||(Object(l.a)(n,e),Object(f.a)()&&Object(o.a)(e,t?2:4),Object(g.a)()&&Object(h.f)("cmp-clp-auto-labeling")&&v.f.import().then((function(t){t(e,e.protectionViewState.clpViewState,e.itemId,e.content)}))),Promise.resolve()})).catch((function(r){if(!t&&!e.isSending){var i=Object(u.a)(r?r.message:null,!1);Object(a.a)(e,i)}return n&&!e.isSending?Promise.reject(r):Promise.resolve()})))]:(t||Object(a.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")]:[2,Promise.resolve()]}}))}))}))},2337:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(77),a=new r.c((function(){return n.e(107).then(n.bind(null,4050))})),i=new r.a(a,(function(e){return e.getTypeOfAttachment})),o=new r.a(a,(function(e){return e.getAllAttachments})),s=new r.a(a,(function(e){return e.getAttachmentContentHelper}))},2345:function(e){e.exports=JSON.parse('{"a":"lga","c":"mga","e":"nga","b":"oga","d":"pga"}')},2354:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return g}));var r,a,i=n(2716),o=n(78),s=n(880),c=n(74),u=n(51);n(2106);function l(){return r}function d(){void 0===r&&(r="Store"+OSF.OUtil.generateConversationId());var e=Object(s.s)(),t=r+"|"+window.location.href.split("?")[0],n=OSF.OUtil.addXdmInfoAsHash(e.InClientStoreUrl,t);n=i.a(n,"client","WAC_Outlook");var o=Date.now();return n=i.a(n,"cv","16.2130.0.9999"),n=i.a(n,"ui",Object(c.j)()),n=i.a(n,"rs",Object(c.j)()),n=i.a(n,"timestamp",o.toString()),n=i.a(n,"ep",function(){if(a)return"il";return"ma"}()),n=i.a(n,"exchver",i.c()),n=i.a(n,"privateenabled",e.CustomExtensionsEnabled.toString()),n=i.a(n,"cb",i.d()),n=i.a(n,"ClientSessionId",i.e()),n=i.a(n,"userPuid","0"),n=Object(u.f)("cal-addins")?i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options,Marketplace.Outlook.Pin.Addin.Calendar.Options"):i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options")}function f(){var e=OSF.OUtil.getUniqueId();return Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(e)}function p(){var e=Object(o.a)();return e.headers.append("X-EWS-TargetVersion","2.80"),delete e.credentials,e}function m(e){return"string"==typeof e?e:["notresponded","notconsented","consented"][e]}var g=function(e){a=e}},2357:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(388),i=n(550);function o(e,t,n,o){var s="read/"+encodeURIComponent(e);Object(a.c)("calendar",s,Object(r.__assign)(Object(r.__assign)({},n),{entrySource:t}),i.a,!1,t)}},2416:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return y}));var r=n(2),a=n(197),i=n(154),o="resources/images/surfaceActions",s=o+"/attach.svg",c=o+"/attachDark.svg",u=o+"/inlineimage.svg",l=o+"/inlineimageDark.svg",d=o+"/emoji.svg",f=o+"/showribbon.svg",p=o+"/showribbonDark.svg",m=o+"/dictate.svg",g=o+"/dictationLanguage.svg",v=o+"/spelling.svg";function h(e){var t,n,o=!1;switch(e){case"AddAttachment":t=Object(a.resolve)(Object(r.q)(),Object(i.c)()?c:s),n=Object(a.resolve)(Object(r.q)(),s),o=!0;break;case"AddInlineImage":t=Object(a.resolve)(Object(r.q)(),Object(i.c)()?l:u),n=Object(a.resolve)(Object(r.q)(),u),o=!0;break;case"AddEmoji":t=Object(a.resolve)(Object(r.q)(),d),o=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"ToggleDictation":t=Object(a.resolve)(Object(r.q)(),m),o=!0;break;case"SetDictationLanguage":t=Object(a.resolve)(Object(r.q)(),g),o=!0;break;case"ToggleRibbon":t=Object(a.resolve)(Object(r.q)(),Object(i.c)()?p:f),n=Object(a.resolve)(Object(r.q)(),f),o=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;case"ProofingOptions":t=Object(a.resolve)(Object(r.q)(),v),o=!0;break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:o}}function b(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t="ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function y(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},244:function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(a||(a={}))},2444:function(e,t,n){"use strict";var r=n(2062),a=n(2155),i=n(1271),o=a.a?function(e,t){return Object(a.a)(e,"toString",{configurable:!0,enumerable:!1,value:Object(r.a)(t),writable:!0})}:i.a,s=n(2618),c=Object(s.a)(o);t.a=c},245:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(148),a=null,i=3e4;function o(){return null==a&&(a=new r.Cache),a}function s(e){return o().get(e)}function c(e){return o().del(e)}function u(e,t){o().put(e,t,i)}},2492:function(e){e.exports=JSON.parse('{"a":"Dga"}')},2495:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(r||(r={}))},253:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(287),a=n(4),i=n(289),o=n(3),s={state:r.a.NotStarted,isPopoutV2:Object(o.a)(i.c)==i.d},c=Object(a.createStore)("popoutChild",s);c()},2544:function(e,t,n){"use strict";var r=n(1673),a=Math.max;t.a=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=a(i.length-t,0),c=Array(s);++o<s;)c[o]=i[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=i[o];return u[t]=n(c),Object(r.a)(e,this,u)}}},2551:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(20),a=n(206),i=n(51);function o(){return Object(a.a)()?Object(i.f)("cmp-encryption")&&Object(r.a)().SessionSettings.IsPremiumConsumerMailbox:Object(r.a)().SegmentationSettings.Irm}},2573:function(e,t,n){"use strict";var r=n(77),a=n(3600);function i(e){return a.a.addinOptionSurfaceItems[e]}var o=n(7),s=n(2628),c=n(3435),u=n(3103),l=n(3104),d=n(3601),f=n(3436),p=n(2910),m=n(2492),g=n(2763),v=n(3602),h=n(3130),b=n(3603),y=n(3437),_=n(3438),O=n(2609),S=n(3439),C=n(3440),I=n(3131),A=n(2611),x=n(2610),E=n(3257),T=n(2345),w=n(2273),j=n(3255),P=n(3013),M=n(3132),k=n(3604),R=n(3441),D=n(3605),N=n(3442),F=n(3256),L=n(3606),U=n(3443),B=n(206),H=n(3730);function G(e){switch(e){case"AddAttachment":return Object(o.a)(d.a);case"AddInlineImage":return Object(o.a)(h.a);case"AddEmoji":return Object(o.a)(H.b);case"ToggleRibbon":return Object(o.a)(v.a);case"SaveDraft":return Object(o.a)(k.a);case"InsertSignature":return Object(o.a)(b.a);case"ShowFrom":return Object(o.a)(N.a);case"SetImportance":return Object(o.a)(D.a);case"ShowMessageOptions":return Object(o.a)(L.a);case"SwitchBodyType":return Object(o.a)(U.a);case"SensitivityMenu":return Object(o.a)(R.a);case"ProtectMessage":return Object(o.a)(f.a);case"AccChecker":return Object(o.a)(s.a);case"ToggleDarkCompose":return Object(o.a)(H.t);case"ToggleDictation":return Object(o.a)(H.u);case"SetDictationLanguage":return Object(o.a)(H.r);case"ProofingOptions":return Object(o.a)(H.n);default:return""}}function W(e){switch(e){case"LikeUnlike":return Object(o.a)(H.e);case"Reply":return Object(o.a)(A.a);case"ReplyAll":return Object(o.a)(x.a);case"Forward":return Object(o.a)(O.a);case"ReplyByMeeting":return Object(o.a)(H.g);case"ReportAbuse":return Object(o.a)(M.a);case"Popout":return Object(o.a)(P.a);case"Delete":return Object(o.a)(H.d);case"MarkReadUnread":return Object(o.a)(T.a);case"FlagUnflag":return Object(o.a)(_.a);case"AssignPolicy":return Object(o.a)(l.a);case"AddToSafeSenders":return Object(o.a)(H.c);case"MarkJunkNotJunk":return Object(o.a)(C.a);case"MarkAsPhishing":return Object(o.a)(H.f);case"Block":return Object(o.b)(Object(o.a)(y.a),"");case"CreateRule":return Object(o.a)(p.a);case"Print":return Object(o.a)(I.a);case"Translate":return Object(o.a)(E.a);case"ShowInImmersiveReader":return Object(o.a)(F.a);case"ViewMessageSource":return Object(B.a)()?Object(o.a)(H.i):Object(o.a)(H.h);case"ToggleDarkMode":return Object(o.a)(S.a);case"ReplyByIM":return Object(o.a)(H.q);case"ReplyAllByIM":return Object(o.a)(H.p);case"ToggleAmp":return Object(o.a)(H.s);case"AddToProjectSpace":return Object(o.a)(c.a);case"OtherReplyActions":return Object(o.a)(H.m);case"MessageSafety":return Object(o.a)(H.j);case"View":return Object(o.a)(H.v);case"AdvancedActions":return Object(o.a)(H.a);case"Addins":return Object(o.a)(H.l);default:return""}}function V(e){switch(e){case"None":return Object(o.a)(H.k);case"Delete":return Object(o.a)(m.a);case"Archive":return Object(o.a)(u.a);case"PinUnpin":return Object(o.a)(j.a);case"ReadUnread":return Object(o.a)(H.o);case"FlagUnflag":return Object(o.a)(g.a);case"Move":return Object(o.a)(w.a);default:return""}}var z=n(2416),J=n(3444),q=n(3607),X=n(2551),Q=n(51),K=n(845),Z=n(20),Y=n(154),$=n(42);function ee(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Q.f)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(Q.f)("outlookSpaces-enabled")&&e.push({key:"AddToProjectSpace",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Z.a)().SessionSettings.IsShadowMailbox||(e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0}),Object(Q.f)("tri-reportAbuse")&&e.push({key:"ReportAbuse",hideInGroup:!Object(B.a)(),hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1})),Object(B.a)()||e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Z.a)().SessionSettings.IsShadowMailbox||e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0}),e.push({key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(Q.f)("rp-inlineTranslation")&&Object(Q.f)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(Y.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(Q.f)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(B.a)()||e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(Q.f)("rp-amp")&&Object(B.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),Object(Q.f)("rp-menuShort")&&e.push({key:"OtherReplyActions",hideInMailSurfaceSettings:!0},{key:"MessageSafety",hideInMailSurfaceSettings:!0},{key:"View",hideInMailSurfaceSettings:!0},{key:"AdvancedActions",hideInMailSurfaceSettings:!0},{key:"Addins",hideInMailSurfaceSettings:!0}),e}function te(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return e.push({key:"AddEmoji",hideInGroup:!1}),Object(J.a)()&&e.push({key:"ProofingOptions",hideInGroup:!1}),(Object($.d)()||Object($.e)()||Object($.b)())&&Object(Q.f)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object(Q.f)("cmp-clp")&&!Object(B.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(X.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(q.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e}function ne(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function re(e){return-1!==Object(K.d)(K.a.SurfaceActions).readSurfaceActions.indexOf(e)}function ae(e,t){return re(e)||!(!Object(Q.f)("rp-csaPinnedLikes")||"LikeUnlike"!==e||!t.LikeCount)||!(!Object(Q.f)("rp-menuShort")||"ToggleDarkMode"!==e||!Object(Y.c)())||!!(Object(Q.f)("rp-menuShort")&&"ToggleAmp"===e&&Object(Q.f)("rp-amp")&&Object(B.a)())}var ie=n(165);function oe(e,t,n,r){var a;r?a=r:(a="Pinned",(null==n?void 0:n.renderedInOverflow)&&(a=n.isPinned?"Overflow":"NotPinned")),Object(ie.o)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,a,Object(Q.f)("rp-menuShort")])}function se(e){e.subMenuProps&&e.subMenuProps.items.forEach((function(e){e.renderedInOverflow=!0}))}function ce(e){e.subMenuProps&&e.subMenuProps.items.forEach((function(e){e.renderedInOverflow=!1}))}n.d(t,"k",(function(){return le})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return G})),n.d(t,"g",(function(){return W})),n.d(t,"f",(function(){return V})),n.d(t,"a",(function(){return"-"})),n.d(t,"d",(function(){return z.a})),n.d(t,"h",(function(){return z.c})),n.d(t,"e",(function(){return te})),n.d(t,"i",(function(){return ee})),n.d(t,"p",(function(){return ne})),n.d(t,"o",(function(){return ae})),n.d(t,"j",(function(){return re})),n.d(t,"l",(function(){return oe})),n.d(t,"n",(function(){return se})),n.d(t,"m",(function(){return ce}));var ue=new r.c((function(){return n.e(495).then(n.bind(null,13744))})),le=new r.a(ue,(function(e){return e.setAddinOptionSurfaceItems}))},2609:function(e){e.exports=JSON.parse('{"a":"wga"}')},2610:function(e){e.exports=JSON.parse('{"a":"rga"}')},2611:function(e){e.exports=JSON.parse('{"a":"sga"}')},2618:function(e,t,n){"use strict";var r=800,a=16,i=Date.now;t.a=function(e){var t=0,n=0;return function(){var o=i(),s=a-(o-n);if(n=o,s>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},2627:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(0),a=n(952);function i(e){return Object(a.a)().taskPanes.get(e)}function o(e){return function(e){var t,n,i=Object(a.a)();try{for(var o=Object(r.__values)(i.taskPanes.values()),s=o.next();!s.done;s=o.next()){var c=s.value;if(e(c))return c}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return null}((function(t){return t.controlId===e}))}function s(e){var t,n;try{for(var a=Object(r.__values)(["Persistent","NonPersistent"]),o=a.next();!o.done;o=a.next()){var s=o.value,c=i(s);if(c&&c.controlId===e)return s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}function c(e){return"Persistent"===e?"NonPersistent":"Persistent"}},2628:function(e){e.exports=JSON.parse('{"a":"Lga"}')},2647:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r="X-OWA-SmimeInstalled",a="1",i="SmimeWithoutActiveX",o="message/rfc822",s="ErrorSmimeSendCancelled"},2660:function(e,t,n){"use strict";function r(e,t){var n,r;e&&e((n=t.EventResponseCode,(r={}).Error=n,r))}function a(e,t){(function(e){return void 0!==e.invokeHandlerIfPreviousOnTriggerFailed})(e)&&e.invokeHandlerIfPreviousOnTriggerFailed(t)}var i;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT=9032]="API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT",e[e.INTERNAL_ERROR=5001]="INTERNAL_ERROR",e[e.URL_NOT_IN_APP_DOMAINS=12004]="URL_NOT_IN_APP_DOMAINS",e[e.WEB_DIALOG_CLOSED=12006]="WEB_DIALOG_CLOSED",e[e.DIALOG_ALREADY_OPEN=12007]="DIALOG_ALREADY_OPEN"}(i||(i={}));var o=i,s="DialogApiEventError",c="ApiEventError";function u(e,t,n){return{EventResponseCode:e,ErrorClassification:t,ErrorDetails:n}}function l(){return u(o.SUCCESS)}function d(e){return e.EventResponseCode===o.SUCCESS}function f(e,t){return l()}function p(e){return l()}function m(e,t){return l()}function g(e){return e}function v(e){return[JSON.stringify(e)]}var h={};function b(e,t){var n;return(null===(n=h[e])||void 0===n?void 0:n[t])?h[e][t]:null}function y(e){delete h[e]}function _(e,t){return!!b(e,t)}var O=n(165),S=n(880),C=n(2);function I(e,t,n,a,i){var s=U(e),f=s.onTrigger(n,t);if(d(f)&&(f=function(e,t,n,r){var a=b(e,t);if(!a)return u(o.INTERNAL_ERROR,c,"HandlerNotRegistered");var i=n.formatArgsForHandler(r);return a(i),l()}(t,e,s,n)),r(a,f),i){var p=Object(S.n)(t),m=f.EventResponseCode;Object(O.o)("ExecuteEvent",{dispId:e,Id:p.extension.Id,DisplayName:p.extension.DisplayName,owa_1:Object(C.b)(),owa_2:Object(S.z)(i),extPoint:Object(S.r)(t),owa_4:p.extension.Type,EventResponseCode:m})}}var A,x=n(448);function E(e,t){if(Object(S.H)())return u(o.DIALOG_ALREADY_OPEN,s,o[o.DIALOG_ALREADY_OPEN]);if(!function(e,t){if(t&&1==t.displayInIframe){return function(e,t){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(e,t)}(Object(S.n)(e).extension.AppDomains,t.url)}return!0}(e,t))return u(o.URL_NOT_IN_APP_DOMAINS,s,o[o.URL_NOT_IN_APP_DOMAINS]);var n=function(e,t,n){var r=Object(S.w)(e);return t&&1==t.displayInIframe?{controlId:Object(x.a)(),dialogType:1,url:t.url,heightInPercentage:t.height,widthInPercentage:t.width,parentControlId:e,isOpen:n,hostItemIndex:r}:Object(S.O)(e)?{controlId:Object(x.a)(),dialogType:2,parentControlId:e,isOpen:n,hostItemIndex:r}:null}(e,t,!0);return Object(S.Q)(n),l()}function T(e){return Object(S.Q)(null),I(A.DISPLAY_DIALOG_DISPID,e,null),l()}function w(e,t){return l()}function j(e){return function(e){return null!=e&&void 0!==e.messageToParent}(e)?function(e){var t=e.messageToParent;return{messageType:"0",messageContent:t}}(e):{messageType:o.WEB_DIALOG_CLOSED}}!function(e){e[e.DISPLAY_DIALOG_DISPID=10]="DISPLAY_DIALOG_DISPID",e[e.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID=11]="DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID",e[e.ITEM_CHANGED_EVENT_DISPID=46]="ITEM_CHANGED_EVENT_DISPID",e[e.RECIPIENTS_CHANGED_EVENT_DISPID=47]="RECIPIENTS_CHANGED_EVENT_DISPID",e[e.APPOINTMENT_TIME_CHANGED_EVENT_DISPID=48]="APPOINTMENT_TIME_CHANGED_EVENT_DISPID",e[e.RECURRENCE_CHANGED_EVENT=49]="RECURRENCE_CHANGED_EVENT",e[e.ATTACHMENTS_CHANGED_EVENT_DISPID=50]="ATTACHMENTS_CHANGED_EVENT_DISPID",e[e.LOCATIONS_CHANGED_EVENT=51]="LOCATIONS_CHANGED_EVENT"}(A||(A={}));var P=!1,M=null;function k(e,t){return function(e,t){_(t,A.ITEM_CHANGED_EVENT_DISPID)||(P=!0,M={controlId:t,args:e},Object(O.o)("ExtTriggerUnregisteredItemChangedEvent"))}(e,t),l()}function R(e){P&&M.controlId===e&&I(A.ITEM_CHANGED_EVENT_DISPID,e,M.args),P=!1,M=null}function D(e){return[JSON.stringify(e)]}function N(e){return[JSON.stringify(e)]}function F(e){var t={recurrence:JSON.stringify(e.recurrence)};return[JSON.stringify(t)]}function L(e){return[JSON.stringify(e)]}function U(e){switch(e){case A.DISPLAY_DIALOG_DISPID:case A.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:return{register:E,unregister:T,onTrigger:w,formatArgsForHandler:j};case A.ITEM_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:k,formatArgsForHandler:g,invokeHandlerIfPreviousOnTriggerFailed:R};case A.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:v};case A.RECIPIENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:N};case A.RECURRENCE_CHANGED_EVENT:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:F};case A.LOCATIONS_CHANGED_EVENT:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:D};case A.ATTACHMENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:L};default:throw new Error("ApiEvent not implemented")}}var B=n(51),H=[A.DISPLAY_DIALOG_DISPID];function G(e,t,n){var i,s,c,f,p,m=(i=t.controlId,s=t.eventDispId,c=Object(S.n)(i),f=Object(S.J)(c),p=H.includes(s),!(!f||!p));if(Object(B.f)("addin-autoRun")&&m)return Object(O.o)("ExtRegisterApiEventNotSupportedInAutorun",[t.eventDispId]),void r(n,u(o.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT));if(Object(S.O)(t.controlId)&&function(e){switch(e){case A.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:case A.DISPLAY_DIALOG_DISPID:return!1;case A.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:case A.ITEM_CHANGED_EVENT_DISPID:case A.RECIPIENTS_CHANGED_EVENT_DISPID:case A.RECURRENCE_CHANGED_EVENT:case A.LOCATIONS_CHANGED_EVENT:case A.ATTACHMENTS_CHANGED_EVENT_DISPID:return!0}}(t.eventDispId))r(n,l());else{var g=function(e){return e.targetId?JSON.parse(e.targetId):null}(t),v=U(t.eventDispId),b=v.register(t.controlId,g);d(b)&&(b=function(e,t,n){return function(e,t,n){h[e]||(h[e]={}),h[e][t]=n}(e,t,n),l()}(t.controlId,t.eventDispId,e)),r(n,b),a(v,t.controlId)}}function W(e,t){var n=U(e.eventDispId).unregister(e.controlId);d(n)&&(n=function(e,t){if(!_(e,t))return u(o.INTERNAL_ERROR,c,"ControlNotRegistered");return function(e,t){var n;(null===(n=h[e])||void 0===n?void 0:n[t])&&delete h[e][t]}(e,t),l()}(e.controlId,e.eventDispId)),r(t,n)}function V(e,t,n){var r=Object(S.o)(e),a=!1,i=null;r.forEach((function(r){_(r,t)&&(a||(a=!0,i=n()),I(t,r,i,null,e))}))}var z=n(912),J=n(954);function q(e){var t=Object(S.q)(e),n=Object(z.c)(t);if(null!=n&&n.mode===J.a.AppointmentOrganizer){var r=n;V(t,A.APPOINTMENT_TIME_CHANGED_EVENT_DISPID,(function(){return{start:r.getStartTime(),end:r.getEndTime()}}))}}var X=n(222),Q=n(2083);function K(e,t,n){var r=Object(S.q)(e),a=Object(z.c)(r);if(null!=a&&(a.mode===J.a.AppointmentOrganizer||a.mode===J.a.MessageCompose)){var i=null;switch(t){case Q.b.Added:i="added";break;case Q.b.Deleted:i="removed";break;default:Object(X.a)(t)}var o={attachmentStatus:i,attachmentDetails:n};V(r,A.ATTACHMENTS_CHANGED_EVENT_DISPID,(function(){return o}))}}function Z(e,t){var n=Object(S.q)(e),r=Object(z.c)(n);if(null!=r&&(r.mode===J.a.AppointmentOrganizer||r.mode===J.a.MessageCompose)){var a=null;if(r.mode==J.a.MessageCompose)switch(a={to:!1,cc:!1,bcc:!1},t){case Q.e.To:a.to=!0;break;case Q.e.Cc:a.cc=!0;break;case Q.e.Bcc:a.bcc=!0}else if(r.mode===J.a.AppointmentOrganizer)switch(a={requiredAttendees:!1,optionalAttendees:!1,resources:!1},t){case Q.e.RequiredAttendees:a.requiredAttendees=!0;break;case Q.e.OptionalAttendees:a.optionalAttendees=!0;break;case Q.e.Resources:a.resources=!0}V(n,A.RECIPIENTS_CHANGED_EVENT_DISPID,(function(){return a}))}}var Y=n(3878);function $(e,t){var n=Object(S.q)(e),r=Object(z.c)(n);if(null!=r&&r.mode===J.a.AppointmentOrganizer){var a=Object(Y.a)({recurrenceType:t,startTime:r.getStartTime(),endTime:r.getEndTime(),timeZone:r.getTimeZone()});V(n,A.RECURRENCE_CHANGED_EVENT,(function(){return{recurrence:a}}))}}function ee(e,t){var n=Object(S.q)(e),r=Object(z.c)(n);if(null!=r&&r.mode===J.a.AppointmentOrganizer){var a=t.map(Q.h);V(n,A.LOCATIONS_CHANGED_EVENT,(function(){return{enhancedLocations:a}}))}}n.d(t,"c",(function(){return G})),n.d(t,"j",(function(){return W})),n.d(t,"d",(function(){return I})),n.d(t,"b",(function(){return y})),n.d(t,"e",(function(){return q})),n.d(t,"f",(function(){return K})),n.d(t,"h",(function(){return Z})),n.d(t,"i",(function(){return $})),n.d(t,"g",(function(){return ee})),n.d(t,"a",(function(){return A}))},2705:function(e,t,n){"use strict";var r=n(1450),a=n(4),i=Object(a.action)("setAppPaneUnderlayVisibility",(function(e,t,n,r){return{key:e,isShown:t,shrinkable:n,underlayViewState:r}}));Object(a.mutator)(i,(function(e){var t=e.underlayViewState||Object(r.a)();e.isShown?t.shrinkable.set(e.key,e.shrinkable):t.shrinkable.delete(e.key),t.isShown.set(e.key,e.isShown)})),t.a=i},2710:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(77),a=new r.c((function(){return Promise.all([n.e(1),n.e(8),n.e(654),n.e(427)]).then(n.bind(null,4635))})),i=new r.a(a,(function(e){return e.loadCLPUserLabels})),o=new r.b(a,(function(e){return e.showJustificationModal})),s=new r.a(a,(function(e){return e.loadItemCLPInfo})),c=new r.b(a,(function(e){return e.updateItemCLPInfo})),u=new r.b(a,(function(e){return e.logReadCLPLabel})),l=new r.b(a,(function(e){return e.triggerCLPAutoLabeling})),d=Object(r.d)(a,(function(e){return e.CLPSubjectHeaderLabel}))},2716:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return g}));var r,a=n(448),i=n(20),o=n(880),s=n(4441),c=n(2);function u(){return"x"}function l(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");var r=e.split("#"),a=1==r.length?"":e.substr(e.indexOf("#"));return e=e.indexOf("?")>0?r[0]+"&"+t+"="+n+a:r[0]+"?"+t+"="+n+a}function d(){return Object(c.v)()}function f(){return null==r&&(r=Object(a.a)()),r}function p(){return Object(i.a)().UserOptions.TimeZone}function m(e){var t=encodeURIComponent(e),n=unescape(t);return btoa(n)}function g(){Object(o.V)(!0),Object(s.a)()}n(197)},2731:function(e,t,n){"use strict";t.a=function(e){if(e){var t=e.shouldEncryptMessageAsSmime,n=e.shouldSignMessageAsSmime;return t||n}return!1}},2763:function(e){e.exports=JSON.parse('{"a":"Cga"}')},2784:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1607),a=n(1951);function i(e){Object(r.b)(e,(function(t){Object(a.a)(e,t.getContent(!0))}),(function(t){Object(a.a)(e,t.value)}))}},2791:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(5341),a=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},i=function(e){var t=a(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress.EmailAddress}))},o=function(e){var t=a(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress}))}},2792:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1703),a=n(839),i=n(1544);function o(e,t){var n;return Object(i.a)({Path:Object(a.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},2817:function(e,t,n){"use strict";var r=n(0);function a(e,t,n){return"Addin_"+e+"_"+t+"_"+n}var i,o=n(4376),s=n(912),c=n(1397),u=n(963);function l(e){return void 0===e&&(e=null),{error:i.Success,data:e}}function d(e){return{error:i.Failed,errorCode:e}}function f(e,t){return!p(e)&&(t(d(u.a.InsufficientItemPermissions)),!0)}function p(e){return!e.isSharedItem||!e.getSharedProperties||(!e.isSharedItem()||e.getSharedProperties().delegatePermissions.EditOwn)}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed"}(i||(i={}));var m=n(880),g=n(1314);function v(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,f,v,h,b,y;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=Object(s.c)(e),f=Object(m.u)(t),v=a(e,f,n),!Object(g.f)(v))return[2,d(u.b.NotificationKeyNotFound)];if(h=Object(g.e)(v),(b=h.Persistent)&&!p(i))return[2,d(u.b.InsufficientItemPermissions)];i.removeNotificationMessage(v),Object(g.h)(v),r.label=1;case 1:return r.trys.push([1,4,,5]),b?[4,Object(o.a)(e,f)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return(y=r.sent())instanceof c.a?[2,d(y.errorCode)]:[3,5];case 5:return[2,l()]}}))}))}function h(e){switch(e){case 0:return"informationalMessage";case 2:return"errorMessage";case 1:return"progressIndicator";case 3:return"insightMessage"}return""}function b(e,t,n,i,f,h,b,y,_){return void 0===b&&(b=null),void 0===y&&(y=!1),void 0===_&&(_=null),Object(r.__awaiter)(this,void 0,void 0,(function(){var O,S,C,I,A,x,E;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(O=Object(s.c)(e)))return[2,d(u.b.InvalidSelection)];if(S=Object(m.u)(t),C=a(e,S,i),function(e,t,n){var r=Object(m.n)(t);if(r){var i=r.get_Id(),o=a(e,n,i);Object(g.f)(o)&&v(e,t,i)}}(e,t,S),I=!1,Object(g.f)(C)){if(y)return[2,d(u.b.DuplicateNotificationKey)];A=Object(g.e)(C),I=A.Persistent}else if(Object(g.g)(e,S,_))return[2,d(u.b.NumberOfNotificationsExceeded)];if(x=function(e,t,n,r,a,i,o){return{ExtensionId:e,Persistent:!!t||2===r,Key:n,Type:r,Message:a,Icon:i,Actions:o||null}}(S,n,i,f,h,b,_),!p(O)&&x.Persistent)return[2,d(u.b.InsufficientItemPermissions)];Object(g.a)(e,S,C,x),O.addNotificationMessage(C),r.label=1;case 1:return r.trys.push([1,4,,5]),I||x.Persistent?[4,Object(o.a)(e,S)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return(E=r.sent())instanceof c.a?[2,d(E.errorCode)]:[3,5];case 5:return[2,l()]}}))}))}function y(e){try{var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("style");if(n&&n.length>0)for(var r=0;r<n.length;r++)n[r]&&(n[r].innerHTML="");return t.body.textContent||""}catch(e){return""}}function _(e){var t=Object(m.B)(e);if(t){var n=t.hostItemIndex,r=Object(m.C)(e);Object(m.bb)(r);var a=Object(s.c)(n);a&&a.closeTaskPane&&a.closeTaskPane()}}var O=n(954);function S(e){return Object(s.d)(e)}function C(e,t,n){return e&&e.match(function(e,t){var n,r="g";t&&(r="ig");try{n=new RegExp(e,r)}catch(e){return null}return n}(t,n))}var I=n(348),A=255;function x(e){var t,n;try{for(var a=Object(r.__values)(e),i=a.next();!i.done;i=a.next()){var o=i.value.length;if(o<=0||o>A)return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!1}var E=n(784);var T=n(2083);var w=n(3014),j=n(448);function P(e,t,n){var a,i,o,s,c=m.k.EnabledAddinCommands;if(!c)return null;try{for(var u=Object(r.__values)(c.getExtensionPoint(n)),l=u.next();!l.done;l=u.next()){var d=l.value;if(d.Id==e&&d.AddinCommands.size>0)try{for(var f=(o=void 0,Object(r.__values)(d.AddinCommands.values())),p=f.next();!p.done;p=f.next()){var g=p.value;if(g.control.Id==t)return g}}catch(e){o={error:e}}finally{try{p&&!p.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}}}catch(e){a={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}return null}var M=n(165);var k=/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function R(e){return k.test(e)}function D(e){var t=[];return e.forEach((function(e){R(e.address)&&t.push({Name:e.name,EmailAddress:e.address})})),t}var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},F=/[&<>"'\/]/g;var L=n(24);function U(e){return(t={input:e},Object(L.a)("SanitizeHtml",t,n)).catch(B);var t,n}function B(){return null}var H="<div>",G="</div>";function W(e){var t=e.trim();return t.substr(0,H.length).toLowerCase()==H&&t.substr(t.length-G.length,G.length).toLowerCase()==G&&(t=t.substring(H.length,t.length-G.length)),t}function V(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,U(e)];case 1:return null==(t=n.sent())?[2,null]:[2,W(t)]}}))}))}var z=n(38),J=null;function q(e){J=e}function X(){return J}var Q,K=function(e,t){var n=X();n&&n(e,t)},Z=n(589);!function(e){e[e.Success=0]="Success",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.InternalError=5001]="InternalError",e[e.NotSsoAgave=13e3]="NotSsoAgave",e[e.UserNotSignedIn=13001]="UserNotSignedIn",e[e.UserAborted=13002]="UserAborted",e[e.InvalidResourceUrl=13004]="InvalidResourceUrl",e[e.InvalidGrant=13005]="InvalidGrant",e[e.ClientError=13006]="ClientError",e[e.AddinIsAlreadyRequestingToken=13008]="AddinIsAlreadyRequestingToken",e[e.SSOUnsupportedPlatform=13012]="SSOUnsupportedPlatform"}(Q||(Q={}));var Y=n(197),$="bc59ab01-8403-45c6-8796-ac3ef710b3e3",ee="/owa/extSSO.aspx";function te(e,t,n){var r=Object(m.E)(e),a=Object(Y.resolve)(window.location.origin,ee);try{Object(Z.getAccessTokenOnBehalfOfResource)($,a,r,t,n,ne)}catch(e){ne(e,void 0)}}function ne(e,t){var n,r;t?K(null,t):K((n=e,r=Q.ClientError,n&&(n.indexOf(Z.AdalErrorCode.NoUserLogin)>=0?r=Q.UserNotSignedIn:n.indexOf(Z.AdalErrorCode.InvalidResourceUrl)>=0?r=Q.InvalidResourceUrl:n.indexOf(Z.AdalErrorCode.NoPreAuth)>=0||n.indexOf(Z.AdalErrorCode.NotConsent)>=0?r=Q.InvalidGrant:n.indexOf(Z.AdalErrorCode.UserAborted)>=0&&(r=Q.UserAborted)),r)),q(null)}var re=1e6;function ae(e,t,n,a,i,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,c,f,p,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(t=n.appendTxt||""===n.appendTxt?n.appendTxt:n.data).length>re?(a(d(u.a.OoeInvalidDataFormat)),[2]):(c=null==o?void 0:o(),f=null,n.coercionType!==gn.a.Html?[3,2]:[4,V(t)]);case 1:return null==(f=r.sent())?(a(d(u.a.HtmlSanitizationFailure)),[2]):function(e){for(var t=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("img"),n=0;n<t.length;n++){var r=t[n].getAttribute("src");if(r=decodeURIComponent(r)){var a=r.lastIndexOf(".");if(-1!==a&&"svg"===r.substring(a+1).toLowerCase())return!0}}return!1}(f)?(a(d(Q.OperationNotSupported)),[2]):[3,3];case 2:p=Object(s.c)(e),f="HTML"!==p.getBodyType()||n.appendOnSend?t:t.replace(F,(function(e){return N[e]})),r.label=3;case 3:if(n.appendOnSend)n.appendOnSend.txt=f,i(n.appendOnSend);else{if(o&&(m=o(),v=m,!(null==(g=c)&&null==v||null!=g&&null!=v&&g.data===v.data&&g.sourceProperty===v.sourceProperty&&g.startPosition===v.startPosition&&g.endPosition===v.endPosition)))return a(d(u.a.CursorPositionChanged)),[2];i(f),"Firefox"===Object(z.a)().browser&&document.activeElement.blur()}return a(l()),[2]}var g,v}))}))}var ie=n(4744),oe=n(51),se=5e3;var ce,ue=n(6454);function le(e,t,n,a){!function(e){return Object(r.__spread)(Object(m.t)().taskPanes.values()).some((function(t){return t.controlId===e}))}(t)?function(e){return Object(m.t)().runningContextualAddinCommand&&Object(m.t)().runningContextualAddinCommand.controlId===e}(t)&&Object(m.Z)():_(t),a(l())}!function(e){e[e.MaxRecipientsOnDisplayNewAppointment=100]="MaxRecipientsOnDisplayNewAppointment",e[e.MaxSubjectLength=255]="MaxSubjectLength",e[e.MaxBodyLengthOnDisplayApis=32768]="MaxBodyLengthOnDisplayApis",e[e.MaxLocationLengthOnDisplayNewAppointment=255]="MaxLocationLengthOnDisplayNewAppointment",e[e.MaxAttachmentNumberOnDisplayApis=100]="MaxAttachmentNumberOnDisplayApis",e[e.MaxRecipientsPerCall=100]="MaxRecipientsPerCall"}(ce||(ce={}));var de=ce,fe=function(e){return"string"==typeof e?{Name:e,EmailAddress:e}:{Name:e.name,EmailAddress:e.address}},pe=function(e){return e?e.map(fe):[]};function me(e,t){return e&&e.length>t}function ge(e){switch(e[0]){case"file":return function(e){return{id:e[2],name:e[1],attachmentType:T.f.File,isInline:e[3]}}(e);case"item":return function(e){return{id:e[2],name:e[1],attachmentType:T.f.Item,isInline:!1}}(e);default:return null}}function ve(e,t,n,a,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t="",o=[],n.htmlBody?n.htmlBody.length>de.MaxBodyLengthOnDisplayApis?(a(d()),[2]):[4,V(n.htmlBody)]:[3,2];case 1:if(null==(t=r.sent()))return a(d()),[2];r.label=2;case 2:if(n.attachments){if(n.attachments.length>de.MaxAttachmentNumberOnDisplayApis)return a(d()),[2];o=n.attachments.map(ge)}return[4,(c=Object(s.c)(e)).displayReplyForm(c.getItemId(),i,t,o)];case 3:return r.sent(),a(l()),[2]}}))}))}function he(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,ve(e,0,n,a,!0)];case 1:return t.sent(),[2]}}))}))}function be(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,ve(e,0,n,a,!1)];case 1:return t.sent(),[2]}}))}))}n(2106);function ye(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"EwsProxyRequestParameters:#Exchange"},n)),Object(L.a)("ExecuteEwsProxy",e,t)}function _e(e,t,n){return ye({Body:e,Token:t,ExtensionId:n})}var Oe=n(7),Se="Token type is not supported for caching: {0}",Ce=n(1212),Ie=n(1207),Ae=n(153),xe="CallerIdentity",Ee="ScopedToken",Te="ExtensionRestApiCallback",we="ExtensionCallback";function je(e,t,n){var r=new Array(t.length);t.forEach((function(t,a){return r[a]={TokenType:t,Id:e,Scope:n}}));var a=Object(Ie.a)({TokenRequests:r});return Object(Ce.a)({Header:Object(Ae.a)(),Body:a})}var Pe=15,Me={},ke={};function Re(e,t){Fe(t.TokenType)[e]=function(e){return{cacheTime:Date.now(),token:e}}(t)}function De(e,t){var n=Fe(t);return function(e,t){var n=Fe(t);n[e]&&(r=n[e],a=Date.now()-r.cacheTime,i=1e3*(r.token.TTL-Pe)*60,a>=i)&&delete n[e];var r,a,i;return!!n[e]}(e,t)?n[e].token:null}function Ne(e){return e==xe||e==we}function Fe(e){switch(e){case xe:return Me;case we:return ke;default:throw Object(Oe.b)(Se,e)}}var Le="Success";function Ue(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,o,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(Ne(t)&&(a=De(e.extension.Id,t)))return[2,a];i=[],De(e.extension.Id,xe)||i.push(xe),2!=e.extension.RequestedCapabilities||De(e.extension.Id,we)||i.push(we),t!=Te&&t!=Ee||i.push(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,je(e.extension.Id,i,n)];case 2:return o=r.sent(),[3,4];case 3:return r.sent(),[2,null];case 4:return s=function(e){return e.Body.ResponseMessages.Items.forEach(Be),e.Body.ResponseMessages.Items}(o),[2,He(t)(s)]}}))}))}function Be(e){"NoError"==e.ResponseCode&&e.ResponseClass==Le&&Ne(e.Token.TokenType)&&Re(e.Token.Id,e.Token)}var He=function(e){return function(t){var n=t.filter(Ge(e))[0];return n?n.Token:null}},Ge=function(e){return function(t){return"NoError"==t.ResponseCode&&t.ResponseClass==Le&&t.Token.TokenType==e}};var We=1e6;var Ve="Error",ze="accessToken";function Je(e){var t;return(t={})[Ve]=e,t}var qe="User",Xe="MarketPlace";var Qe=n(222),Ke=n(870),Ze="ItemAttachment:#Exchange";function Ye(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,i,o,s,c,u,l,d,f,p,m,g;return Object(r.__generator)(this,(function(v){switch(v.label){case 0:if(a=null,i=t.getItem(),o=!1,!(i.Attachments.length>0))return[3,13];v.label=1;case 1:v.trys.push([1,10,11,12]),s=Object(r.__values)(i.Attachments),c=s.next(),v.label=2;case 2:return c.done?[3,9]:(u=c.value,l=u.AttachmentOriginalUrl,d=u.AttachmentId.Id,"ReferenceAttachment:#Exchange"!==u.__type||n!==l?[3,3]:(f=u,a={format:T.a.Url,content:f.AttachLongPathName},o=!0,[2,a]));case 3:return n!==d?[3,8]:!0!==e?[3,5]:[4,t.getAttachmentContent(n)];case 4:return a=v.sent(),[3,7];case 5:return[4,t.getAttachmentContent(n)];case 6:a=v.sent(),v.label=7;case 7:return o=!0,[2,a];case 8:return c=s.next(),[3,2];case 9:return[3,12];case 10:return p=v.sent(),m={error:p},[3,12];case 11:try{c&&!c.done&&(g=s.return)&&g.call(s)}finally{if(m)throw m.error}return[7];case 12:if(!o)return[2,a];v.label=13;case 13:return[2,a]}}))}))}var $e=n(544),et=n(543),tt=n(450),nt="Success";function rt(e,t,n){var r=e.map((function(e){return Object(tt.a)({Id:e})}));return Object($e.a)({Header:Object(Ae.a)(),Body:Object(et.a)({ItemShape:t,ItemIds:r,ShapeName:n})}).then((function(e){return(t=e.Body.ResponseMessages.Items[0]).ResponseClass==nt?t.Items[0]:{};var t}))}var at=n(389),it=n(839);function ot(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return e.NormalizedBody?[3,2]:[4,rt([e.ItemId.Id],Object(at.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(it.a)({FieldURI:"NormalizedBody"})]}),"ItemNormalizedBody")];case 1:t=n.sent(),e.NormalizedBody=t.NormalizedBody,n.label=2;case 2:return[2,e.NormalizedBody.Value]}}))}))}function st(e,t){return{wasSuccessful:e,token:t}}var ct,ut="ParentItemId:";!function(e){e[e.Message=1]="Message",e[e.Appointment=2]="Appointment",e[e.MeetingRequest=3]="MeetingRequest",e[e.MessageCompose=4]="MessageCompose",e[e.AppointmentCompose=5]="AppointmentCompose"}(ct||(ct={}));var lt=ct;function dt(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t.itemType=lt.AppointmentCompose,n=t,[4,e.getSeriesId()];case 1:return n.seriesId=r.sent(),[2,t]}}))}))}var ft=n(13),pt=n(242);function mt(e,t,n){if(!e)return{};var r={Addresses:e.Addresses?e.Addresses.map((function(e){return e.Address})):[],Urls:e.Urls?e.Urls.map((function(e){return e.Url})):[],PhoneNumbers:e.PhoneNumbers?e.PhoneNumbers:[]};return r.IsLegacyExtraction=function(e){return!(e.EntityDocument||e.PropertyExistence&&e.PropertyExistence.TextEntityExtractions)}(t),0!=n.extension.RequestedCapabilities&&(r.Contacts=e.Contacts?e.Contacts:[],r.EmailAddresses=e.EmailAddresses?e.EmailAddresses.map((function(e){return e.EmailAddress})):[],r.MeetingSuggestions=e.MeetingSuggestions?e.MeetingSuggestions.map(vt.bind(r)):[],r.TaskSuggestions=e.TaskSuggestions?e.TaskSuggestions:[]),r}function gt(e,t){var n,a;try{for(var i=Object(r.__values)(t),o=i.next();!o.done;o=i.next()){var s=C(e,o.value,!0);if(s&&s.length>0)return!0}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return!1}function vt(e){var t=this.IsLegacyExtraction,n=Object(ft.toJS)(pt({},e));return n.EndTime=t?ht(n.EndTime):new Date(n.EndTime).getTime(),n.StartTime=t?ht(n.StartTime):new Date(n.StartTime).getTime(),n}function ht(e){var t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),n.getTime()}function bt(e){var t={};return e&&Object.keys(e).forEach((function(n){var r;e[n]&&(t[n]=(r=e[n],Object(m.t)().contextualCalloutState.selectedTerms.filter((function(e){return r.indexOf(e)>=0}))))})),t}function yt(e){return rt([e.ItemId.Id],Object(at.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(it.a)({FieldURI:"EntityExtractionResult"})]}),null)}function _t(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t.EntityExtractionResult||!function(e){return e.PropertyExistence&&(e.PropertyExistence.ExtractedAddresses||e.PropertyExistence.ExtractedContacts||e.PropertyExistence.ExtractedEmails||e.PropertyExistence.ExtractedMeetings||e.PropertyExistence.ExtractedPhones||e.PropertyExistence.ExtractedTasks||e.PropertyExistence.ExtractedUrls)}(t))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,yt(t)];case 2:return i=r.sent(),Object(m.gb)(t,i.EntityExtractionResult),[3,4];case 3:return r.sent(),[3,4];case 4:return t.EntityExtractionResult&&(a.entities=mt(t.EntityExtractionResult,t,n),a.entities&&(o=JSON.parse(JSON.stringify(a.entities)),a.selectedEntities=function(e,t){var n={};return e&&t&&(e.Addresses&&(n.Addresses=e.Addresses.filter((function(e){return gt(e,t)}))),e.MeetingSuggestions&&(n.MeetingSuggestions=e.MeetingSuggestions.filter((function(e){return gt(e.MeetingString,t)}))),e.TaskSuggestions&&(n.TaskSuggestions=e.TaskSuggestions.filter((function(e){return gt(e.TaskString,t)}))),e.PhoneNumbers&&(n.PhoneNumbers=e.PhoneNumbers.filter((function(e){return gt(e.OriginalPhoneString,t)}))),e.Urls&&(n.Urls=e.Urls.filter((function(e){return gt(e,t)}))),e.Contacts&&(n.Contacts=e.Contacts.filter((function(e){return gt(e.ContactString,t)}))),e.EmailAddresses&&(n.EmailAddresses=e.EmailAddresses.filter((function(e){return gt(e,t)})))),n}(o,Object(m.t)().contextualCalloutState.selectedTerms))),(s=function(e,t){var n=Object(m.v)(e);return(null==n?void 0:n.contextualEvaluationResults)&&n.contextualEvaluationResults.has(t)?n.contextualEvaluationResults.get(t):null}(e,n.extension.Id))&&(a.filteredEntities=s.filteredEntityMatches,a.regExMatches=s.regExMatches,a.selectedRegExMatches=bt(a.regExMatches)),[2,a]}}))}))}var Ot,St,Ct=n(3878);!function(e){e[e.Other=0]="Other",e[e.DistributionList=1]="DistributionList",e[e.User=2]="User",e[e.ExternalUser=3]="ExternalUser"}(Ot||(Ot={})),function(e){e[e.Unknown=0]="Unknown",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accept=3]="Accept",e[e.Decline=4]="Decline",e[e.NoResponseReceived=5]="NoResponseReceived"}(St||(St={}));var It=function(e){return{address:e.EmailAddress,name:e.Name,recipientType:Et(e.MailboxType)}},At=function(e){var t=It(e.Mailbox);return t.appointmentResponse=function(e){switch(e){case"Organizer":return St.Organizer;case"Tentative":return St.Tentative;case"Accept":return St.Accept;case"Decline":return St.Decline;case"NoResponseReceived":return St.NoResponseReceived;default:return St.Unknown}}(e.ResponseType),t},xt=function(e){return e?e.map((function(e){return At(e)})):[]};function Et(e){switch(e){case"PublicDL":case"PrivateDL":case"PublicFolder":return Ot.DistributionList;case"Mailbox":case"Contact":return Ot.User;case"OneOff":return Ot.ExternalUser;default:return Ot.Other}}function Tt(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a.itemType=lt.Appointment,i=e.getItem(),a.id=i.ItemId.Id,a.end=i.End,a.start=i.Start,a.location=i.Location.DisplayName,a.dateTimeCreated=i.DateTimeCreated?new Date(i.DateTimeCreated):null,a.dateTimeModified=i.LastModifiedTime?new Date(i.LastModifiedTime):null,a.itemClass=i.ItemClass,a.subject=i.Subject,a.normalizedSubject=i.Subject,a.organizer=At(i.Organizer),o=xt(i.RequiredAttendees),a.to=function(e,t){if(t){if(!e.some((function(e){return e.address.toLowerCase()===t.address.toLowerCase()})))return e.concat(t)}return e}(o,a.organizer),a.cc=xt(i.OptionalAttendees),a.attachments=i.Attachments?Object(T.g)(i.Attachments):[],[4,e.getRecurrence()];case 1:return s=r.sent(),a.recurrence=Object(Ct.a)({recurrenceType:s,timeZone:i.StartTimeZoneId,startTime:new Date(i.Start),endTime:new Date(i.End)}),a.resources=xt(i.Resources),c=a,[4,e.getSeriesId()];case 2:return c.seriesId=r.sent(),[4,_t(n,i,t,a)];case 3:return[2,a=r.sent()]}}))}))}var wt=n(5226),jt=n(105),Pt=n(74),Mt=n(2);function kt(e,t,n,r){return r=function(e,t){return t.hostVersion=Object(Mt.g)()||"debug",t.owaView="mouse",t.timeZoneOffsets=Object(jt.e)(),t}(0,r=function(e,t){var n=e.extension;return t.extensionId=n.Id,t.marketplaceContentMarket=n.MarketplaceContentMarket,t.permissionLevel=n.RequestedCapabilities,t.marketplaceAssetId=n.MarketplaceAssetID,t.entryPointUrl=e.get_EntryPoint(),t.consentMetadata=n.ConsentMetadata,t.endNodeUrl=n.EndNodeUrl,t}(t,r)),0!=t.extension.RequestedCapabilities&&(r=function(e,t){return t.userDisplayName=Object(Pt.k)(),t.userEmailAddress=Object(Pt.l)(),t.userTimeZone=Object(Pt.p)(),t.userProfileType=Object(wt.a)(),t.ewsUrl=Object(m.s)().EwsUrl,t.restUrl=Object(m.s)().RestUrl,t}(0,r)),Object(oe.f)("addin-delegateAccess")&&e.isSharedItem&&e.getSharedProperties&&(r.isFromSharedFolder=e.isSharedItem()),Object(oe.f)("addin-delegateAccess")&&(r.shouldRunNewCodeForFlags|=1),r}var Rt="0xe1d";function Dt(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a.id=e.getItemId(),a.isRead=!0,a.itemType=lt.Message,i=e.getItem(),a.itemClass=i.ItemClass,a.subject=i.Subject,a.normalizedSubject=function(e,t){if(!e.ExtendedProperty)return null;for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if((null==r?void 0:r.ExtendedFieldURI)&&r.ExtendedFieldURI.PropertyTag===t)return r.Value}return null}(i,Rt),a.conversationId=i.ConversationId.Id,a.internetMessageId=i.InternetMessageId,a.dateTimeCreated=i.DateTimeCreated?new Date(i.DateTimeCreated).getTime():null,a.dateTimeModified=i.LastModifiedTime?new Date(i.LastModifiedTime).getTime():null,a.dateTimeSent=i.DateTimeSent?new Date(i.DateTimeSent).getTime():null,a.attachments=i.Attachments?Object(T.g)(i.Attachments):[],[4,_t(n,i,t,a)];case 1:return a=r.sent(),0==t.extension.RequestedCapabilities?[3,3]:(a.from=i.From?It(i.From.Mailbox):null,a.sender=i.Sender?It(i.Sender.Mailbox):null,a.to=i.ToRecipients?i.ToRecipients.map(It):[],a.cc=i.CcRecipients?i.CcRecipients.map(It):[],a.bcc=i.BccRecipients?i.BccRecipients.map(It):[],function(e){return 0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Request")||0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Canceled")}(i)?[4,Nt(e,a)]:[3,3]);case 2:a=r.sent(),r.label=3;case 3:return[2,a]}}))}))}function Nt(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=e.getItem(),t.itemType=lt.MeetingRequest,t.location=n.Location.DisplayName,t.start=n.Start,t.end=n.End,t.to=n.RequiredAttendees?n.RequiredAttendees.map(At):[],t.cc=n.OptionalAttendees?n.OptionalAttendees.map(At):[],t.resources=n.Resources?n.Resources.map(At):[],a=t,[4,e.getSeriesId()];case 1:return a.seriesId=r.sent(),[4,e.getRecurrence()];case 2:return i=r.sent(),t.recurrence=Object(Ct.a)({recurrenceType:i,timeZone:n.StartTimeZoneId,startTime:new Date(n.Start),endTime:new Date(n.End)}),[2,t]}}))}))}function Ft(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(n={},a=Object(s.c)(t),Object(m.v)(t),i=Object(m.n)(e),n=kt(a,i,0,n),a.mode){case O.a.MeetingRequest:case O.a.MessageRead:return[3,1];case O.a.MessageCompose:return[3,3];case O.a.AppointmentAttendee:return[3,4];case O.a.AppointmentOrganizer:return[3,6]}return[3,8];case 1:return[4,Dt(a,i,t,n)];case 2:return n=r.sent(),[3,8];case 3:return n=function(e,t){return t.itemType=lt.MessageCompose,t.conversationId=e.getConversationId(),t.isRead=!1,t}(a,n),[3,8];case 4:return[4,Tt(a,i,t,n)];case 5:return n=r.sent(),[3,8];case 6:return[4,dt(a,n)];case 7:return n=r.sent(),[3,8];case 8:return[2,n]}}))}))}var Lt=n(4644);var Ut=500;var Bt,Ht=n(39);!function(e){e[e.Start=1]="Start",e[e.End=2]="End"}(Bt||(Bt={}));var Gt=Bt;var Wt=n(223);function Vt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"LoadExtensionCustomPropertiesParameters:#Exchange"},n))),Object(L.a)("LoadExtensionCustomProperties",e,t)}function zt(e,t,n){return Vt({request:{ExtensionId:e,ItemId:t}},n?{headers:Object(Wt.f)(n)}:{})}function Jt(e,t,n){return{errorMessage:e,wasSuccessful:t,customProperties:n}}var qt=n(2660);function Xt(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"RegisterConsentJsonRequest:#Exchange"},n)),Object(L.a)("RegisterConsent",e,t)}function Qt(e,t){var n,a=(n={Id:e,ConsentState:t},Object(r.__assign)({__type:"RegisterConsentRequest:#Exchange"},n));return Xt({Header:Object(Ae.a)(),Body:a})}function Kt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"SaveExtensionCustomPropertiesParameters:#Exchange"},n))),Object(L.a)("SaveExtensionCustomProperties",e,t)}function Zt(e,t,n,r){return Kt({request:{ExtensionId:e,ItemId:t,CustomProperties:r}},n?{headers:Object(Wt.f)(n)}:{})}function Yt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"SaveExtensionSettingsParameters:#Exchange"},n))),Object(L.a)("SaveExtensionSettings",e,t)}var $t=32768;var en,tn,nn=255;!function(e){e[e.GetInitialData=1]="GetInitialData",e[e.GetUserIdentityToken=2]="GetUserIdentityToken",e[e.EwsRequest=5]="EwsRequest",e[e.LoadCustomProperties=3]="LoadCustomProperties",e[e.SaveCustomProperties=4]="SaveCustomProperties",e[e.DisplayNewAppointmentForm=7]="DisplayNewAppointmentForm",e[e.DisplayMessageForm=8]="DisplayMessageForm",e[e.DisplayAppointmentForm=9]="DisplayAppointmentForm",e[e.DisplayReplyForm=10]="DisplayReplyForm",e[e.DisplayReplyAllForm=11]="DisplayReplyAllForm",e[e.GetCallbackToken=12]="GetCallbackToken",e[e.SetBodySelectedDataAsync=13]="SetBodySelectedDataAsync",e[e.GetBodyTypeAsync=14]="GetBodyTypeAsync",e[e.GetRecipientsAsync=15]="GetRecipientsAsync",e[e.AddFileAttachmentAsync=16]="AddFileAttachmentAsync",e[e.SetSubjectAsync=17]="SetSubjectAsync",e[e.GetSubjectAsync=18]="GetSubjectAsync",e[e.AddItemAttachmentAsync=19]="AddItemAttachmentAsync",e[e.RemoveAttachmentAsync=20]="RemoveAttachmentAsync",e[e.SetRecipientsAsync=21]="SetRecipientsAsync",e[e.AddRecipientsAsync=22]="AddRecipientsAsync",e[e.BodyPrependAsync=23]="BodyPrependAsync",e[e.GetTimeAsync=24]="GetTimeAsync",e[e.SetTimeAsync=25]="SetTimeAsync",e[e.GetLocationAsync=26]="GetLocationAsync",e[e.SetLocationAsync=27]="SetLocationAsync",e[e.GetSelectedDataAsync=28]="GetSelectedDataAsync",e[e.SetSelectedDataAsync=29]="SetSelectedDataAsync",e[e.DisplayReplyFormWithAttachments=30]="DisplayReplyFormWithAttachments",e[e.DisplayReplyAllFormWithAttachments=31]="DisplayReplyAllFormWithAttachments",e[e.SaveAsync=32]="SaveAsync",e[e.AddNotificationMessageAsync=33]="AddNotificationMessageAsync",e[e.GetAllNotificationMessagesAsync=34]="GetAllNotificationMessagesAsync",e[e.ReplaceNotificationMessageAsync=35]="ReplaceNotificationMessageAsync",e[e.RemoveNotificationMessageAsync=36]="RemoveNotificationMessageAsync",e[e.GetBodyAsync=37]="GetBodyAsync",e[e.SetBodyAsync=38]="SetBodyAsync",e[e.RegisterConsentAsync=40]="RegisterConsentAsync",e[e.Close=41]="Close",e[e.CloseApp=42]="CloseApp",e[e.DisplayNewMessageForm=44]="DisplayNewMessageForm",e[e.EventCompleted=94]="EventCompleted",e[e.CloseContainer=97]="CloseContainer",e[e.GetAccessTokenAsync=98]="GetAccessTokenAsync",e[e.GetInitializationContextAsync=99]="GetInitializationContextAsync",e[e.AppendOnSendAsync=100]="AppendOnSendAsync",e[e.GetRecurrenceAsync=103]="GetRecurrenceAsync",e[e.SetRecurrenceAsync=104]="SetRecurrenceAsync",e[e.GetFromAsync=107]="GetFromAsync",e[e.GetSharedPropertiesAsync=108]="GetSharedPropertiesAsync",e[e.MESSAGE_PARENT_DISPID=144]="MESSAGE_PARENT_DISPID",e[e.GetAttachmentsAsync=149]="GetAttachmentsAsync",e[e.AddBase64FileAttachmentAsync=148]="AddBase64FileAttachmentAsync",e[e.GetAttachmentContentAsync=150]="GetAttachmentContentAsync",e[e.GetInternetHeadersAsync=151]="GetInternetHeadersAsync",e[e.SetInternetHeadersAsync=152]="SetInternetHeadersAsync",e[e.RemoveInternetHeadersAsync=153]="RemoveInternetHeadersAsync",e[e.GetEnhancedLocationsAsync=154]="GetEnhancedLocationsAsync",e[e.AddEnhancedLocationsAsync=155]="AddEnhancedLocationsAsync",e[e.RemoveEnhancedLocationsAsync=156]="RemoveEnhancedLocationsAsync",e[e.GetCategoriesAsync=157]="GetCategoriesAsync",e[e.AddCategoriesAsync=158]="AddCategoriesAsync",e[e.RemoveCategoriesAsync=159]="RemoveCategoriesAsync",e[e.GetMasterCategoriesAsync=160]="GetMasterCategoriesAsync",e[e.AddMasterCategoriesAsync=161]="AddMasterCategoriesAsync",e[e.RemoveMasterCategoriesAsync=162]="RemoveMasterCategoriesAsync",e[e.GetItemIdAsync=164]="GetItemIdAsync",e[e.GetAllInternetHeadersAsync=168]="GetAllInternetHeadersAsync",e[e.SaveSettingsRequest=404]="SaveSettingsRequest",e[e.SetSignatureAsync=173]="SetSignatureAsync",e[e.GetComposeTypeAsync=174]="GetComposeTypeAsync",e[e.IsClientSignatureEnabledAsync=175]="IsClientSignatureEnabledAsync",e[e.DisableClientSignatureAsync=176]="DisableClientSignatureAsync"}(en||(en={}));var rn=function(e,t){this.apiMethodDelegate=e,this.apiPermissionRequired=t},an=((tn={})[en.GetInitialData]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Ft(t,e)];case 1:return n=r.sent(),Object(Lt.e)(!0,Object(m.n)(t),e,Object(m.r)(t),Object(m.D)(e,t),t),a(n),[2]}}))}))}),1),tn[en.EwsRequest]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,i,o,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return!(e=n.body)||e.length>We?(a(d(u.b.GenericResponseError)),[2]):[4,Ue(i=Object(m.n)(t),we)];case 1:if(!(o=r.sent()))return a(d(u.b.GenericTokenError)),[2];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,_e(e,o.TokenValue,i.extension.Id)];case 3:return s=r.sent(),c=function(e){return{wasProxySuccessful:e.WasProxySuccessful,errorMessage:e.ErrorMessage,statusCode:e.StatusCode,statusDescription:e.StatusDescription,body:e.Body}}(s),a(c),[3,5];case 4:return r.sent(),a(d(u.b.GenericResponseError)),[3,5];case 5:return[2]}}))}))}),2),tn[en.GetRecipientsAsync]=new rn((function(e,t,n,r){r(l(Object(s.c)(e).getRecipients(n.recipientField).slice(0,Ut).map((function(e){return{name:e.Name,address:e.EmailAddress,recipientType:Et(e.MailboxType)}}))))}),1),tn[en.GetSubjectAsync]=new rn((function(e,t,n,r){r(l(Object(s.c)(e).getSubject()||""))}),1),tn[en.SetSubjectAsync]=new rn((function(e,t,n,r){if(n.subject.length>nn)r(d(null));else{var a=Object(s.c)(e);f(a,r)||(a.setSubject(n.subject),r(l()))}}),3),tn[en.SetRecipientsAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e);if(!f(a,r)){var i=D(n.recipientArray);try{a.setRecipients(n.recipientField,i),r(l())}catch(e){r(d(e.errorCode))}}}),3),tn[en.AddRecipientsAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e);if(!f(a,r)){var i=D(n.recipientArray);try{a.addRecipients(n.recipientField,i),r(l())}catch(e){r(d(e.errorCode))}}}),3),tn[en.SaveSettingsRequest]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=n[0],(o=JSON.stringify(i)).length>$t)return a(d(u.b.GenericSettingsError)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),s=Object(m.n)(t),[4,(c=s.extension.Id,f=s.extension.Version,p=o,Yt({request:{ExtensionId:c,ExtensionVersion:f,Settings:p}}))];case 2:return r.sent(),Object(m.hb)(e,t,o),a(l()),[3,4];case 3:return r.sent(),a(d(u.b.GenericSettingsError)),[3,4];case 4:return[2]}var c,f,p}))}))}),0),tn[en.GetAccessTokenAsync]=new rn((function(e,t,n,r){if(Object(oe.f)("addin-getAccessTokenAsync-api"))if(function(e){return!!Object(m.E)(e)}(t))if(X())r(Je(Q.AddinIsAlreadyRequestingToken));else if(Object(m.H)())r(Je(Q.InternalError));else{var a=n.allowConsentPrompt;if(n.forMSGraphAccess){if(function(e){var t=Object(m.n)(e);return!(null==t||!t.extension||t.extension.OriginString!=qe||t.extension.TypeString!=Xe)}(t))return void r(Je(Q.SSOUnsupportedPlatform));a=!1}!function(e){q(e)}((function(e,t){r(e?Je(e):function(e){var t;return(t={})[Ve]=i.Success,t[ze]=e,t}(t))})),te(t,n.authChallenge,a)}else r(Je(Q.NotSsoAgave));else r(Je(Q.SSOUnsupportedPlatform))}),0),tn[en.GetCallbackToken]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=Object(m.n)(t),o=function(e){var t=s.c(e).getItemId();if(!t)return;return ut+t}(e),function(e,t){return e==Te&&2==t}(c=n.isRest?Te:Ee,i.extension.RequestedCapabilities)||o?[4,Ue(i,c,o)]:(a(d(u.b.CallSaveAsyncBeforeToken)),[2]);case 1:return l=r.sent(),a(l?st(!0,l.TokenValue):d(u.b.GenericTokenError)),[2]}}))}))}),1),tn[en.GetUserIdentityToken]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Ue(Object(m.n)(t),xe)];case 1:return e=n.sent(),a(e?st(!0,e.TokenValue):d(u.b.GenericTokenError)),[2]}}))}))}),1),tn[en.MESSAGE_PARENT_DISPID]=new rn((function(e,t,n,r){Object(qt.d)(qt.a.DISPLAY_DIALOG_DISPID,t,n,(function(){r(l())}))}),0),tn[en.SetBodyAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:(i=n.coercionType==gn.a.Html?"HTML":"Text",[4,ae(e,0,n,a,(function(e){return t.setBody(e,i)}))]);case 1:return r.sent(),[2]}}))}))}),1),tn[en.GetBodyAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),i=t.mode,o=null,i!=O.a.MessageRead&&i!=O.a.AppointmentAttendee)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ot(t.getItem())];case 2:return o=r.sent(),[3,4];case 3:return r.sent(),a(d(u.a.GenericResponseError)),[2];case 4:return[3,6];case 5:i!=O.a.MessageCompose&&i!=O.a.AppointmentOrganizer||(o=t.getBody()),r.label=6;case 6:return n.coercionType==gn.a.Text&&(o=y(o)),a(l(o)),[2]}}))}))}),1),tn[en.GetBodyTypeAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e).getBodyType();r(l(a&&a.toLowerCase()||null))}),1),tn[en.BodyPrependAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:n.coercionType===gn.a.Html&&"Text"===t.getBodyType()?(a(d(u.a.OoeInvalidDataFormat)),[2]):[4,ae(e,0,n,a,t.prependBody)];case 1:return r.sent(),[2]}}))}))}),3),tn[en.Close]=new rn((function(e,t){Object(s.c)(e).close(),Object(ue.a)(e)}),0),tn[en.CloseApp]=new rn(le,0),tn[en.CloseContainer]=new rn(le,0),tn[en.DisplayMessageForm]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(s.c)(e).displayMessageForm(n.itemId)];case 1:return t.sent(),a(l()),[2]}}))}))}),1),tn[en.DisplayReplyAllForm]=new rn(he,1),tn[en.DisplayReplyAllFormWithAttachments]=new rn(he,1),tn[en.DisplayReplyForm]=new rn(be,1),tn[en.DisplayReplyFormWithAttachments]=new rn(be,1),tn[en.DisplayAppointmentForm]=new rn((function(e,t,n,r){n.itemId?(Object(s.c)(e).displayAppointmentForm(n.itemId),r(l())):r(d())}),1),tn[en.DisplayNewAppointmentForm]=new rn((function(e,t,n,r){var a;!n||me((a=n).requiredAttendees,de.MaxRecipientsOnDisplayNewAppointment)||me(a.optionalAttendees,de.MaxRecipientsOnDisplayNewAppointment)||me(a.subject,de.MaxSubjectLength)||me(a.body,de.MaxBodyLengthOnDisplayApis)||me(a.location,de.MaxLocationLengthOnDisplayNewAppointment)?r(d()):(Object(s.c)(e).displayNewAppointmentForm(pe(n.requiredAttendees),pe(n.optionalAttendees),n.start,n.end,n.location,n.resources,n.subject,n.body),r(l()))}),1),tn[en.DisplayNewMessageForm]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o,c,u,f,p,m;return Object(r.__generator)(this,(function(g){switch(g.label){case 0:if(t=!1,i=Object(r.__read)([n.toRecipients,n.ccRecipients,n.bccRecipients].map((function(e){return e?e.length>de.MaxRecipientsPerCall?(t=!0,null):function(e){var t=[];return e.forEach((function(e){R(e)&&t.push({Name:e,EmailAddress:e,MailboxType:"OneOff",RoutingType:"SMTP"})})),t}(e):[]})),3),o=i[0],c=i[1],u=i[2],t)return a(d()),[2];if(f="",n.subject){if(n.subject.length>de.MaxSubjectLength)return a(d()),[2];f=n.subject}return p="",n.htmlBody?n.htmlBody.length>de.MaxBodyLengthOnDisplayApis?(a(d()),[2]):[4,V(n.htmlBody)]:[3,2];case 1:if(null==(p=g.sent()))return a(d()),[2];g.label=2;case 2:if(m=[],n.attachments){if(n.attachments.length>de.MaxAttachmentNumberOnDisplayApis)return a(d()),[2];m=n.attachments.map(ge)}return[4,Object(s.c)(e).displayNewMessageForm(o,c,u,f,p,m)];case 3:return g.sent(),a(l()),[2]}}))}))}),1),tn[en.EventCompleted]=new rn((function(e,t,n,r){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(t,n)}),0),tn[en.GetSelectedDataAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e).getSelectedData();a?(n.coercionType==gn.a.Text&&(a.data=y(a.data)),r(l(a))):r(d(u.a.InvalidSelection))}),1),tn[en.SetSelectedDataAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:null==(i=t.getSelectedData())?(a(d(u.a.InvalidSelection)),[2]):n.coercionType===gn.a.Html&&("subject"===i.sourceProperty||"body"===i.sourceProperty&&"Text"===t.getBodyType())?(a(d(u.a.OoeInvalidDataFormat)),[2]):[4,ae(e,0,n,a,t.setSelectedData,t.getSelectedData)];case 1:return r.sent(),[2]}}))}))}),3),tn[en.SetBodySelectedDataAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:[4,ae(e,0,n,a,t.setBodySelectedData,t.getSelectedData)];case 1:return r.sent(),[2]}}))}))}),0),tn[en.SaveAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e);f(a,r)||a.saveItem().then((function(e){r(e?l(e):d(u.a.SaveError))}))}),3),tn[en.LoadCustomProperties]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,c,l,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n=Object(s.c)(e),!(i=n.getItemId()))return a(Jt("",!0,"{}")),[2];o=Object(m.u)(t),r.label=1;case 1:return r.trys.push([1,3,,4]),n.isSharedItem&&n.getSharedProperties&&n.isSharedItem()&&n.isRemoteItem()&&(l=n.getSharedProperties(),c=l.owner),[4,zt(o,i,c)];case 2:return f=r.sent(),(p=f.CustomProperties)&&(p=p.trim()),p||(p="{}"),a(Jt(f.ErrorMessage,f.WasSuccessful,p)),[3,4];case 3:return r.sent(),a(d(u.b.GenericResponseError)),[3,4];case 4:return[2]}}))}))}),1),tn[en.SaveCustomProperties]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c,p,g,v,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=Object(s.c)(e),o=Object(m.u)(t),c=JSON.stringify(n.customProperties),p=i.getItemId(),r.label=1;case 1:return r.trys.push([1,5,,6]),f(i,a)?[2]:p?[3,3]:[4,i.saveItem()];case 2:p=r.sent(),r.label=3;case 3:return i.isSharedItem&&i.getSharedProperties&&i.isSharedItem()&&i.isRemoteItem()&&(v=i.getSharedProperties(),g=v.owner),[4,Zt(o,p,g,c)];case 4:return h=r.sent(),Object(oe.f)("addin-delegateAccess")?h.WasSuccessful?a(l()):a(d(u.b.GenericResponseError)):a(Jt(h.ErrorMessage,h.WasSuccessful)),[3,6];case 5:return r.sent(),a(d(u.b.GenericResponseError)),[3,6];case 6:return[2]}}))}))}),1),tn[en.AddNotificationMessageAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,l,f,p,g,v,h,y;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(l=!1,f=Object(s.c)(e),p=f.mode,3===n.type&&!n.actions)return a(d(u.a.InvalidParameterValueError)),[2];if(3===n.type&&n.actions)switch(l=!0,g=Object(m.n)(t),v=g.extension.Id,p){case O.a.MessageRead:case O.a.AppointmentAttendee:return a(d(u.a.OperationNotSupported)),[2];case O.a.MessageCompose:case O.a.AppointmentOrganizer:if(!(i=P(v,n.actions[0].commandId,p)))return a(d(u.a.InvalidParameterValueError)),[2];o={NotificationActionData:n.actions[0],CustomButtonAction:i,CustomButtonIcon:i.get_Size16Icon()}}return[4,b(e,t,n.persistent,n.key,n.type,n.message,n.icon,!0,o)];case 1:return h=r.sent(),y=Object(m.n)(t),Object(M.o)("ShowNotificationBar",{Id:y.extension.Id,DisplayName:y.extension.DisplayName,Scenario:Object(m.z)(e),extPoint:Object(m.r)(t),IsClickableInfobar:l,error:h instanceof c.a?JSON.stringify(h):"",mode:p}),a(h),[2]}}))}))}),1),tn[en.GetAllNotificationMessagesAsync]=new rn((function(e,t,n,a){a(l(Object(s.c)(e).getNotificationMessageIds().reduce((function(e,t){var n=Object(g.e)(t);return n&&e.push(function(e){return Object(r.__assign)({key:e.Key,type:h(e.Type),message:e.Message,icon:e.Icon},e.Persistent&&{persistent:!0})}(n)),e}),[])))}),1),tn[en.RemoveNotificationMessageAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,v(e,t,n.key)];case 1:return i=r.sent(),a(i),[2]}}))}))}),1),tn[en.ReplaceNotificationMessageAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,l,f,p,g,v,h,y;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(l=!1,f=Object(s.c)(e),p=f.mode,3===n.type&&!n.actions)return a(d(u.a.InvalidParameterValueError)),[2];if(3===n.type&&n.actions)switch(l=!0,g=Object(m.n)(t),v=g.extension.Id,p){case O.a.MessageRead:case O.a.AppointmentAttendee:return a(d(u.a.OperationNotSupported)),[2];case O.a.MessageCompose:case O.a.AppointmentOrganizer:if(!(i=P(v,n.actions[0].commandId,p)))return a(d(u.a.InvalidParameterValueError)),[2];o={NotificationActionData:n.actions[0],CustomButtonAction:i,CustomButtonIcon:i.get_Size16Icon()}}return[4,b(e,t,n.persistent,n.key,n.type,n.message,n.icon,!1,o)];case 1:return h=r.sent(),y=Object(m.n)(t),Object(M.o)("ShowNotificationBar",{Id:y.extension.Id,DisplayName:y.extension.DisplayName,Scenario:Object(m.z)(e),extPoint:Object(m.r)(t),IsClickableInfobar:l,error:h instanceof c.a?JSON.stringify(h):"",mode:p}),a(h),[2]}}))}))}),1),tn[en.AddItemAttachmentAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),f(t,a)?[2]:[4,t.addItemAttachment(n.name,n.itemId,n.isInline)];case 2:return i=r.sent(),a(i?l(i):d(u.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=r.sent(),a(d(o)),[3,4];case 4:return[2]}}))}))}),3),tn[en.AddFileAttachmentAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),f(t,a)?[2]:[4,t.addFileAttachment(n.name,n.uri,n.isInline)];case 2:return i=r.sent(),a(i?l(i):d(u.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=r.sent(),a(d(o.errorCode)),[3,4];case 4:return[2]}}))}))}),3),tn[en.AddBase64FileAttachmentAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.addFileAttachmentFromBase64(n.base64String,n.name,n.isInline)];case 2:return i=r.sent(),a(i?l(i):d(u.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=r.sent(),a(d(o.errorCode)),[3,4];case 4:return[2]}}))}))}),3),tn[en.RemoveAttachmentAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!n||!n.attachmentIndex)return a(d(u.a.InvalidAttachmentId)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),f(t=Object(s.c)(e),a)?[2]:[4,t.removeAttachment(n.attachmentIndex)];case 2:return r.sent(),a(l()),[3,4];case 3:return i=r.sent(),a(d(i.errorCode)),[3,4];case 4:return[2]}}))}))}),3),tn[en.GetCategoriesAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,c;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:t=Object(s.c)(e),n=t.mode,i=null,o=null,f.label=1;case 1:switch(f.trys.push([1,11,,12]),n){case O.a.MessageRead:return[3,2];case O.a.MessageCompose:return[3,4];case O.a.AppointmentAttendee:return[3,5];case O.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.getCategoriesItem()];case 3:return i=f.sent(),[3,10];case 4:return a(d(u.b.OperationNotSupported)),[2];case 5:return[4,t.getCategoriesItem()];case 6:return i=f.sent(),[3,10];case 7:return[4,t.getCategoriesItem()];case 8:return i=f.sent(),[3,10];case 9:Object(E.a)(n),f.label=10;case 10:return null==i?(a(d(u.b.GenericResponseError)),[2]):(o=function(e){var t,n,a=[];try{for(var i=Object(r.__values)(e),o=i.next();!o.done;o=i.next()){var s=o.value,c={displayName:s.Name,color:w.a[s.Color]};a.push(c)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}(i),a(l(o)),[3,12]);case 11:return c=f.sent(),a(d(c.errorCode)),[3,12];case 12:return[2]}}))}))}),1),tn[en.AddCategoriesAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o,c,f,p;return Object(r.__generator)(this,(function(m){switch(m.label){case 0:return t=Object(s.c)(e),i=t.mode,[4,I.u.import()];case 1:if(o=m.sent(),c=o(),function(e,t){var n,a,i=function(e){if(0===t.filter((function(t){return t.Name===e})).length)return{value:!0}};try{for(var o=Object(r.__values)(e),s=o.next();!s.done;s=o.next()){var c=s.value,u=i(c);if("object"==typeof u)return u.value}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return!1}(n.categories,c)||x(n.categories))return a(d(u.a.InvalidCategoryError)),[2];g=n.categories,v=[],g.forEach((function(e){var t,n,a=!1;try{for(var i=Object(r.__values)(v),o=i.next();!o.done;o=i.next())o.value===e&&(a=!0)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}a||v.push(e)})),f=v,m.label=2;case 2:switch(m.trys.push([2,12,,13]),i){case O.a.MessageRead:return[3,3];case O.a.MessageCompose:return[3,5];case O.a.AppointmentAttendee:return[3,6];case O.a.AppointmentOrganizer:return[3,8]}return[3,10];case 3:return[4,t.addCategoriesItemRead(f)];case 4:return m.sent(),[3,11];case 5:return a(d(u.a.OperationNotSupported)),[2];case 6:return[4,t.addCategoriesItemRead(f)];case 7:return m.sent(),[3,11];case 8:return[4,t.addCategoriesItemCompose(f)];case 9:return m.sent(),[3,11];case 10:Object(E.a)(i),m.label=11;case 11:return a(l()),[3,13];case 12:return p=m.sent(),a(d(p.errorCode)),[3,13];case 13:return[2]}var g,v}))}))}),1),tn[en.RemoveCategoriesAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),i=t.mode,x(n.categories))return a(d(u.a.InvalidCategoryError)),[2];r.label=1;case 1:switch(r.trys.push([1,11,,12]),i){case O.a.MessageRead:return[3,2];case O.a.MessageCompose:return[3,4];case O.a.AppointmentAttendee:return[3,5];case O.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.removeCategoriesItemRead(n.categories)];case 3:return r.sent(),[3,10];case 4:return a(d(u.a.OperationNotSupported)),[2];case 5:return[4,t.removeCategoriesItemRead(n.categories)];case 6:return r.sent(),[3,10];case 7:return[4,t.removeCategoriesItemCompose(n.categories)];case 8:return r.sent(),[3,10];case 9:Object(E.a)(i),r.label=10;case 10:return a(l()),[3,12];case 11:return o=r.sent(),a(d(o.errorCode)),[3,12];case 12:return[2]}}))}))}),1),tn[en.GetAttachmentContentAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o,c,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!n||!n.id)return a(d(u.a.InvalidAttachmentId)),[2];if(t=null,i=Object(s.c)(e),o=i.mode,!1,(c=Object(Ke.a)({Id:n.id})).model.__type===Ze&&(f=c.model.EmbeddedItemClass)&&"IPM.Note"!==f&&"IPM.Appointment"!==f)return a(d(u.a.AttachmentTypeNotSupported)),[2];switch(o){case O.a.MessageRead:return[3,1];case O.a.MessageCompose:return[3,3];case O.a.AppointmentAttendee:return[3,5];case O.a.AppointmentOrganizer:return[3,7]}return[3,9];case 1:return[4,Ye(!0,i,n.id)];case 2:return t=r.sent(),[3,10];case 3:return[4,i.getAttachmentContent(n.id)];case 4:return t=r.sent(),[3,10];case 5:return[4,Ye(!1,i,n.id)];case 6:return t=r.sent(),[3,10];case 7:return[4,i.getAttachmentContent(n.id)];case 8:return t=r.sent(),[3,10];case 9:Object(Qe.a)(o),r.label=10;case 10:if(null==t)return a(d(u.a.InvalidAttachmentId)),[2];try{a(l(t))}catch(e){a(d(u.a.InvalidAttachmentId))}return[2]}}))}))}),1),tn[en.GetAttachmentsAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t=Object(s.c)(e),n=null,i=[],t.mode){case O.a.MessageCompose:return[3,1];case O.a.AppointmentOrganizer:return[3,3]}return[3,5];case 1:return[4,t.getAttachments()];case 2:return n=r.sent(),[3,5];case 3:return[4,t.getAttachments()];case 4:return n=r.sent(),[3,5];case 5:if(null==n)return a(d(u.a.GenericResponseError)),[2];i=n.map((function(e){return{id:e.id,name:e.name,contentType:e.contentType,size:e.size,attachmentType:e.attachmentType,isInline:e.isInline,url:e.url?e.url:void 0}}));try{a(l(i))}catch(e){a(d(e.errorCode))}return[2]}}))}))}),1),tn[en.RegisterConsentAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=n.consentState,!(o=Object(m.u)(t))||!i)return a(d(u.b.GenericResponseError)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),Object(m.eb)(e,t,i),[4,Qt(o,i)];case 2:return"NoError"===(s=r.sent()).Body.ResponseCode&&"Success"===s.Body.ResponseClass?(a(l()),[2]):(a(d(u.b.GenericResponseError)),[3,4]);case 3:return r.sent(),a(d(u.b.GenericResponseError)),[3,4];case 4:return[2]}}))}))}),0),tn[en.GetLocationAsync]=new rn((function(e,t,n,r){r(l(Object(s.c)(e).getLocation()||""))}),1),tn[en.SetLocationAsync]=new rn((function(e,t,n,r){if(null!=n.location){var a=Object(s.c)(e);f(a,r)||(a.setLocation(n.location),r(l()))}else r(d(null))}),3),tn[en.GetTimeAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e),i=null;n.TimeProperty===Gt.Start?i=a.getStartTime():n.TimeProperty===Gt.End&&(i=a.getEndTime()),r(l(i))}),1),tn[en.SetTimeAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e);if(!f(a,r)){var i=new Date(n.time);if(n.TimeProperty===Gt.Start)a.setStartTime(i);else if(n.TimeProperty===Gt.End){if(!a.setEndTime(i))return void r(d(u.a.InvalidEndTime))}r(l())}}),3),tn[en.GetInitializationContextAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(i){return t=Object(m.t)().taskPanes,n="",Object(r.__spread)(t.values()).forEach((function(t){t.hostItemIndex===e&&t.initializationContext&&(n=t.initializationContext)})),a(null!=n&&null!=n?l(n):d()),[2]}))}))}),1),tn[en.GetFromAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e).getFrom();r(a?l({name:a.Name,address:a.EmailAddress}):d())}),1),tn[en.GetSharedPropertiesAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),n=t.getSharedProperties(),!t.isRemoteItem())return[3,5];o=n.owner,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(d=n.owner,new Promise((function(e,t){if(d){var n=Object(Ht.a)().origin+"/autodiscover/autodiscover.json/v1.0/"+d+"?Protocol=REST",r=new XMLHttpRequest;r.open("GET",n),r.onload=function(){if(200===r.status){var n=JSON.parse(this.response).Url;e(n)}else t(new Error("Request failed with status "+r.status+". Message: "+r.responseText))},r.send()}else t(new Error("smtpAddress is null or empty"))})))];case 2:return i=r.sent(),[3,4];case 3:return r.sent(),i=void 0,[3,4];case 4:return[3,6];case 5:o=Object(Pt.l)(),i=Object(m.s)().RestUrl,r.label=6;case 6:return c=function(e){var t=0;e.Read&&(t+=T.c.Read);e.Create&&(t+=T.c.Create);e.DeleteOwn&&(t+=T.c.DeleteOwn);e.DeleteAll&&(t+=T.c.DeleteAll);e.EditOwn&&(t+=T.c.EditOwn);e.EditAll&&(t+=T.c.EditAll);return t}(n.delegatePermissions),u={delegatePermissions:c,owner:n.owner,targetRestUrl:i,targetMailbox:o},a(l(u)),[2]}var d}))}))}),1),tn[en.GetRecurrenceAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,(t=Object(s.c)(e)).getRecurrence()];case 1:return n=r.sent(),i=Object(Ct.a)({recurrenceType:n,timeZone:t.getTimeZoneName(),endTime:t.getEndTime(),startTime:t.getStartTime()}),a(l(i)),[2]}}))}))}),1),tn[en.SetRecurrenceAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(Ct.c)(n.recurrenceData)?f(t=Object(s.c)(e),a)?[2]:[4,t.getSeriesId()]:(a(d(u.a.InvalidRecurrence)),[2]);case 1:return null!=r.sent()?(a(d(u.a.SetRecurrenceOnInstance)),[2]):(null==(i=Object(Ct.b)(n.recurrenceData))?t.setRecurrence(null):(t.setStartTime(i.startTime),t.setEndTime(i.endTime),t.setRecurrence(i.recurrenceType),t.setTimeZoneName(i.timeZone)),a(l()),[2])}}))}))}),3),tn[en.GetInternetHeadersAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&Object(T.j)(n.internetHeaderKeys)?[4,Object(s.c)(e).getInternetHeaders(n.internetHeaderKeys)]:(a(d()),[2]);case 1:return t=r.sent(),a(l(t)),[2]}}))}))}),1),tn[en.SetInternetHeadersAsync]=new rn((function(e,t,n,r){if(n&&Object(T.i)(n.internetHeaderNameValuePairs)){var a=Object(s.c)(e);f(a,r)||(a.setInternetHeaders(n.internetHeaderNameValuePairs),r(l()))}else r(d())}),1),tn[en.RemoveInternetHeadersAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&Object(T.j)(n.internetHeaderKeys)?f(t=Object(s.c)(e),a)?[2]:[4,t.removeInternetHeaders(n.internetHeaderKeys)]:(a(d()),[2]);case 1:return r.sent(),a(l()),[2]}}))}))}),1),tn[en.AppendOnSendAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c,l,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=Object(s.c)(e),o=i.mode,Object(oe.f)("rp-appendOnSend")&&o!=O.a.MessageRead&&o!=O.a.AppointmentAttendee?(c=n.appendTxt)&&c.length>se?(a(d(u.a.OoeInvalidDataFormat)),[2]):f(i,a)?[2]:n.coercionType===gn.a.Html&&"Text"===i.getBodyType()?(a(d(u.a.OoeInvalidDataFormat)),[2]):null==(l=Object(m.u)(t))||Object(ie.a)(l,t)?(a(d(u.a.GenericResponseError)),[2]):(p={id:l,typ:n.coercionType,txt:c},n.appendOnSend=p,[4,ae(e,0,n,a,i.appendOnSend)]):(a(d(u.a.OperationNotSupported)),[2]);case 1:return r.sent(),[2]}}))}))}),3),tn[en.GetEnhancedLocationsAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e).getEnhancedLocations();!a||a.length<=0?r(l([])):r(l(a.map(T.h)))}),1),tn[en.AddEnhancedLocationsAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(f(t=Object(s.c)(e),a))return[2];if(!n||!Object(T.k)(n.enhancedLocations))return a(d()),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.addEnhancedLocations(n.enhancedLocations)];case 2:return r.sent(),a(l()),[3,4];case 3:return r.sent(),a(d()),[3,4];case 4:return[2]}}))}))}),3),tn[en.RemoveEnhancedLocationsAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e);n&&Object(T.k)(n.enhancedLocations)?(a.removeEnhancedLocations(n.enhancedLocations),r(l())):r(d())}),3),tn[en.GetMasterCategoriesAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),n=t.mode,i=[],o=null,r.label=1;case 1:switch(r.trys.push([1,8,,9]),n){case O.a.MessageRead:case O.a.MessageCompose:return[3,2];case O.a.AppointmentAttendee:case O.a.AppointmentOrganizer:return[3,4]}return[3,6];case 2:return[4,t.getCategoriesMailbox()];case 3:return i=r.sent(),[3,7];case 4:return[4,t.getCategoriesMailbox()];case 5:return i=r.sent(),[3,7];case 6:Object(E.a)(n),r.label=7;case 7:return null==i||null==i?(a(d(u.b.GenericResponseError)),[2]):(o=i.map((function(e){return{displayName:e.Name,color:w.a[e.Color]}})),a(l(o)),[3,9]);case 8:return c=r.sent(),a(d(c.errorCode)),[3,9];case 9:return[2]}}))}))}),2),tn[en.AddMasterCategoriesAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o,c,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(t=Object(s.c)(e)).isSharedItem()?(a(d(u.b.InsufficientItemPermissions)),[2]):([],i=n.categoryDetails.map((function(e){return{Name:e.displayName,Id:Object(j.a)(),Color:w.a[e.color]}})),(o=function(e,t){var n=[];return e.forEach((function(e){var t=e.Name.length;if(0===t||t>255)return null;for(var r=!1,a=0;a<n.length;a++)n[a].Name==e.Name&&(n[a].Color=e.Color,r=!0);r||n.push(e)})),n}(i))?function(e){for(var t=Object(I.o)(),n=function(n){if(t.filter((function(t){return t.Name===e[n].Name})).length>0)return{value:!0}},r=0;r<e.length;r++){var a=n(r);if("object"==typeof a)return a.value}return!1}(o)?(a(d(u.b.DuplicateCategoryError)),[2]):[4,t.addCategoriesMailbox(o)]:(a(d(u.b.InvalidCategoryError)),[2]));case 1:return c=r.sent(),a(c?l():d(u.b.GenericResponseError)),[3,3];case 2:return f=r.sent(),a(d(f.errorCode)),[3,3];case 3:return[2]}}))}))}),2),tn[en.RemoveMasterCategoriesAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),(t=Object(s.c)(e)).isSharedItem())return a(d(u.b.InsufficientItemPermissions)),[2];for(i=0;i<n.categories.length;i++)if(0===(o=n.categories[i].length)||o>255)return a(d(u.b.InvalidCategoryError)),[2];return[4,t.removeCategoriesMailbox(n.categories)];case 1:return c=r.sent(),a(c?l():d(u.b.GenericResponseError)),[3,3];case 2:return r.sent(),a(d()),[3,3];case 3:return[2]}}))}))}),2),tn[en.GetItemIdAsync]=new rn((function(e,t,n,r){var a=Object(s.c)(e).getItemId();r(a?l(a):d(u.a.ItemNotSavedError))}),1),tn[en.GetAllInternetHeadersAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(s.c)(e).getAllInternetHeaders()];case 1:return t=n.sent(),a(null==t?d(u.a.GenericResponseError):l(t)),[2]}}))}))}),1),tn[en.SetSignatureAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(oe.f)("addin-signatureScenario")?n.data.length>3e4?(a(d(u.a.OoeInvalidDataFormat)),[2]):(t=Object(s.c)(e),n.coercionType===gn.a.Html&&"Text"===t.getBodyType()?(a(d(u.a.OoeInvalidDataFormat)),[2]):f(t,a)?[2]:t.mode!==O.a.MessageCompose?(a(d(Q.OperationNotSupported)),[2]):[4,ae(e,0,n,a,(function(e){return t.setSignature(e)}))]):(a(d(u.a.OperationNotSupported)),[2]);case 1:return r.sent(),[2]}}))}))}),3),tn[en.GetComposeTypeAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){if(!Object(oe.f)("addin-signatureScenario"))return a(d(u.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode;try{if(n!==O.a.MessageCompose)return a(d(u.b.OperationNotSupported)),[2];void 0,i=t.getComposeTypeAndCoercionType(),a(l(i))}catch(e){a(d(e.errorCode))}return[2]}))}))}),1),tn[en.IsClientSignatureEnabledAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){if(!Object(oe.f)("addin-signatureScenario"))return a(d(u.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode;try{if(n!==O.a.MessageCompose)return a(d(u.b.OperationNotSupported)),[2];void 0,i=t.isClientSignatureEnabled(),a(l(i))}catch(e){a(d(e.errorCode))}return[2]}))}))}),1),tn[en.DisableClientSignatureAsync]=new rn((function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!Object(oe.f)("addin-signatureScenario"))return a(d(u.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode,r.label=1;case 1:return r.trys.push([1,5,,6]),n!==O.a.MessageCompose?[3,3]:(i=void 0,[4,t.disableClientSignature()]);case 2:return(i=r.sent())?(a(l(i)),[3,4]):(a(d(u.b.OperationNotSupported)),[2]);case 3:return a(d(u.b.OperationNotSupported)),[2];case 4:return[3,6];case 5:return o=r.sent(),a(d(o.errorCode)),[3,6];case 6:return[2]}}))}))}),3),tn),on=[en.DisplayAppointmentForm,en.DisplayMessageForm,en.DisplayNewAppointmentForm,en.DisplayNewMessageForm,en.GetAccessTokenAsync,en.MESSAGE_PARENT_DISPID];var sn=n(4746);function cn(e,t,n,r,a){if(an[t]&&an[t].apiMethodDelegate){var i=an[t].apiMethodDelegate,o=Object(m.n)(n),s="ExecuteApiMethod";if(!S(e))return Object(M.o)("ExtExecuteApiMethodNoItemFailure",[t]),void a(d(u.b.GenericResponseError));if(Object(oe.f)("addin-PermissionCheck")&&!function(e,t){var n,r=Object(m.n)(e),a=!1,i=null===(n=null==r?void 0:r.extension)||void 0===n?void 0:n.RequestedCapabilities;switch(t){case 0:a=!0;break;case 1:1!=i&&3!=i&&2!=i||(a=!0);break;case 3:3!=i&&2!=i||(a=!0);break;case 2:2==i&&(a=!0)}return a}(n,an[t].apiPermissionRequired))return Object(M.o)("ExtExecuteApiMethodInsufficientPermissions",[t]),void a(d(u.b.InsufficientItemPermissions));var c=function(e,t){var n=Object(m.n)(e),r=Object(m.J)(n),a=on.includes(t);return!(!r||!a)}(n,t);if(Object(oe.f)("addin-autoRun")&&c)return Object(M.o)("ExtExecuteApiMethodNotSupportedInAutorun",[t]),void a(d(u.b.ApiCallNotSupportedByExtensionPoint));var l=Object(sn.a)();try{i(e,n,r,(function(r){var i=null;r&&(r.errorCode?i=r.errorCode:r.Error&&(i=r.Error));var c=Object(sn.a)();Object(M.o)(s,{dispId:t,Id:o.extension.Id,DisplayName:o.extension.DisplayName,owa_1:Object(Mt.b)(),owa_2:Object(m.z)(e),extPoint:Object(m.r)(n),owa_4:o.extension.Type,apiExecutionTime:c-l,isAutoRun:Object(m.J)(o),errorCode:i}),a(r)}))}catch(r){var f=Object(sn.a)();Object(M.o)(s,{dispId:t,Id:o.extension.Id,DisplayName:o.extension.DisplayName,owa_1:Object(Mt.b)(),owa_2:Object(m.z)(e),extPoint:Object(m.r)(n),owa_4:o.extension.Type,apiExecutionTime:f-l,isAutoRun:Object(m.J)(o),error:JSON.stringify(r)}),a(d(u.b.InternalServerError))}}}function un(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.__assign)({__type:"GetExtensibilityContextParameters:#Exchange"},n))),Object(L.a)("GetExtensibilityContext",e,t)}function ln(e,t,n,r,a){return un({request:{FormFactor:e,ClientLanguage:t,IncludeDisabledExtensions:n,ApiVersionSupported:r,ClientOverrideVersion:a}})}function dn(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"GetAllClientExtensionsNotificationsJsonRequest:#Exchange"},n)),Object(L.a)("GetAllClientExtensionsNotifications",e,t)}function fn(e){var t,n=(t={ItemId:e},Object(r.__assign)({__type:"GetAllClientExtensionsNotificationsRequest:#Exchange"},t));return dn({Header:Object(Ae.a)(),Body:n})}function pn(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(s.c)(e),n={Id:t.getItemId()},t.addNotificationMessage?(Object(g.c)(e).map(t.addNotificationMessage),[4,fn(n).catch(mn)]):[2];case 1:return(i=r.sent())&&(i.Body.Apps||[]).forEach((function(n){var r=!1;n.Notifications.forEach((function(i){var o={ExtensionId:n.Id,Persistent:!0,Key:i.Key,Type:i.Type,Message:i.Message,Icon:i.Icon};2===i.Type&&(o.Persistent=!1,r=!0);var s=a(e,n.Id,i.Key);Object(g.a)(e,n.Id,s,o),t.addNotificationMessage(s)})),r&&Object(o.a)(e,n.Id)})),[2]}}))}))}function mn(){return null}var gn=n(2160);n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return g.b})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return C})),n.d(t,"i",(function(){return cn})),n.d(t,"j",(function(){return yt})),n.d(t,"k",(function(){return ln})),n.d(t,"l",(function(){return pn})),n.d(t,"m",(function(){return v})),n.d(t,"b",(function(){return Ft})),n.d(t,"a",(function(){return gn.a}))},2854:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(388),i=n(51),o=n(845);function s(e,t,n,s){var c=Object(a.e)(n,e,null,t),u=Object(r.__assign)(Object(r.__assign)({},s),{includeBohemiaOnPopout:Object(o.d)(o.a.Bohemia).bohemiaEnabled&&Object(i.f)("rp-prague")});Object(a.c)("mail",c,u,{resizable:!0})}},287:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},2871:function(e,t,n){"use strict";var r=n(51),a=n(1994),i=n(206);t.a=function(){return Object(r.f)("cmp-clp")&&a.b.clpLabels.length>0&&!Object(i.a)()}},289:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s}));var r="popoutv2",a="1",i="leanbootstrap",o="1",s="_owa_projection_root"},2910:function(e){e.exports=JSON.parse('{"a":"Ega"}')},2915:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(2495),a=n(1088),i=n(104),o=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.itemPart:null})),s=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null})),c=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.initiallySelectedItemPart)?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null})),u=Object(i.select)({conversationReadingPaneState:function(){return Object(a.a)()}})((function(e,t){var n=o(t),a=s(t);return n==e&&a==r.a.Item}))},2955:function(e,t,n){"use strict";var r=n(1761),a=n(2207),i=n(1132),o=Object(a.a)((function(e,t,n,a){Object(r.a)(t,Object(i.a)(t),e,a)}));t.a=o},2956:function(e,t,n){"use strict";function r(e){return void 0!==e.publicFolderId}n.d(t,"a",(function(){return r}))},296:function(e,t,n){"use strict";var r=n(0),a=n(148),i=n(183),o=n(246);function s(e){return Object(r.__assign)({__type:"TokenRequest:#Exchange"},e)}var c=n(88),u=n(24);function l(e,t){return void 0===e||e.__type||(e=s(e)),Object(u.a)("GetAccessTokenforResource",e,t)}var d=n(83),f=1500,p="OWA_GetAccessTokenForResource";function m(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return t={isUserActivity:!1},[2,l(s({Resource:e}),t)]}))}))}function g(e,t,n,a){return void 0===a&&(a=f),Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return t<1?(Object(d.h)(p,[e,t,n?n.toString():""]),[2,Promise.reject()]):[2,m(e).catch((function(n){return Object(c.a)(a).then((function(){return g(e,t-1,n,2*a)}))}))]}))}))}var v,h=n(51),b=n(386),y=3,_=500;function O(e){var t=this,n=null,a=null,i=new Promise((function(e,i){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return n=e,a=i,[2]}))}))})),o={onFulfilled:n,onRejected:a,resource:e};return(null==v&&(v=new b.a(y,S,_)),v).add(o),i}function S(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return P(e.resource).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var C=n(245);n.d(t,"d",(function(){return T})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"a",(function(){return P}));var I=1,A=12e4,x=3,E=null;function T(e){E=e}function w(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return null!=(t=M(k(),e))?[3,2]:[4,P(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:void 0]}}))}))}function j(e){var t=M(k(),e);if(t)return[t.AccessToken,void 0];if(Object(h.f)("auth-getAccessTokenQueueEnabled")){var n=Object(C.a)(e),r=void 0;return n?r=n:(r=O(e),Object(C.b)(e,r)),[void 0,r.then((function(t){return Object(C.c)(e),t.AccessToken})).catch((function(t){Object(C.c)(e),Object(d.h)(p,{category:"Promise_For_Token_Request_Failed",err:t?t.toString():"",message:t?t.message:"",stk:t?t.stack:"",resource:e})}))]}return[void 0,P(e).then((function(e){return e.AccessToken}))]}function P(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(h.f)("auth-getAccessTokenQueueEnabled")?[4,g(e,x)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,m(e)];case 3:n=r.sent(),r.label=4;case 4:return null!=(t=n)&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(t.ExpiresIn&&t.ExpiresIn>0&&(t.AccessTokenExpiry=Object(o.a)(Date.now(),t.ExpiresIn).toISOString()),(a=new Date(t.AccessTokenExpiry).getTime()-Date.now()-A)>0&&k().put(e,t,a,(function(e,t){P(e).catch((function(t){Object(d.h)(p,{category:"Cache_Expired",err:t?t.toString():"",message:t?t.message:"",stk:t?t.stack:"",resource:e})}))}))),[2,t]}}))}))}function M(e,t){var n=e.get(t),r=void 0;(null==n?void 0:n.AccessTokenExpiry)&&(Object(i.a)(new Date(n.AccessTokenExpiry),-I)>new Date(Date.now())&&(r=n));return r}function k(){return null==E&&(E=new a.Cache),E}},2981:function(e,t,n){"use strict";var r=n(51);function a(){return Object(r.f)("addin-inClientStoreEnabled")}function i(){return Object(r.f)("addin-persistentTaskPane")}function o(){return Object(r.f)("addin-complianceVerification")}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}))},3013:function(e){e.exports=JSON.parse('{"a":"iga"}')},3014:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=-1]="None",e[e.Preset0=0]="Preset0",e[e.Preset1=1]="Preset1",e[e.Preset2=2]="Preset2",e[e.Preset3=3]="Preset3",e[e.Preset4=4]="Preset4",e[e.Preset5=5]="Preset5",e[e.Preset6=6]="Preset6",e[e.Preset7=7]="Preset7",e[e.Preset8=8]="Preset8",e[e.Preset9=9]="Preset9",e[e.Preset10=10]="Preset10",e[e.Preset11=11]="Preset11",e[e.Preset12=12]="Preset12",e[e.Preset13=13]="Preset13",e[e.Preset14=14]="Preset14",e[e.Preset15=15]="Preset15",e[e.Preset16=16]="Preset16",e[e.Preset17=17]="Preset17",e[e.Preset18=18]="Preset18",e[e.Preset19=19]="Preset19",e[e.Preset20=20]="Preset20",e[e.Preset21=21]="Preset21",e[e.Preset22=22]="Preset22",e[e.Preset23=23]="Preset23",e[e.Preset24=24]="Preset24"}(r||(r={}))},3015:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(77),a=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(7),n.e(247)]).then(n.bind(null,4643))})),i=new r.a(a,(function(e){return e.mountAndShowFlexPane})),o=new r.a(a,(function(e){return e.hideFlexPane}))},3017:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(77),a=new r.c((function(){return n.e(305).then(n.bind(null,4642))})),i=new r.b(a,(function(e){return e.processInlineImageBeforeUpload})),o=new r.b(a,(function(e){return e.setOriginalSrcForSmime}))},3103:function(e){e.exports=JSON.parse('{"a":"Jga"}')},3104:function(e){e.exports=JSON.parse('{"a":"Iga"}')},3130:function(e){e.exports=JSON.parse('{"a":"Aga"}')},3131:function(e){e.exports=JSON.parse('{"a":"tga"}')},3132:function(e){e.exports=JSON.parse('{"a":"hga"}')},3206:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"MAX_REGEX_MATCHES",(function(){return h})),n.d(r,"MAX_BODY_REGEX_ACTIVATION_LENGTH",(function(){return b})),n.d(r,"MAX_REGEX_MATCH_LENGTH",(function(){return y}));var a=n(1314),i=n(4376),o=n(4136),s=n(0),c=n(4645),u=n(880),l=n(2817),d=function(){function e(e){this.collectionRule=e}return e.prototype.Evaluate=function(e,t){var n,r,a=this.GetInitialEvaluationResult();try{for(var i=Object(s.__values)(this.collectionRule.Rules),o=i.next();!o.done;o=i.next()){var c=A(o.value).Evaluate(e,t);a=this.UpdateEvaluationResult(a,c)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},e.prototype.ItemIsReadyForEvaluation=function(e){var t,n;try{for(var r=Object(s.__values)(this.collectionRule.Rules),a=r.next();!a.done;a=r.next()){if(!A(a.value).ItemIsReadyForEvaluation(e))return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0},e.prototype.GetInitialEvaluationResult=function(){if("AND"==this.collectionRule.Mode.toUpperCase())return!0;if("OR"==this.collectionRule.Mode.toUpperCase())return!1;throw new Error("Invalid mode for a Collection rule: "+this.collectionRule.Mode)},e.prototype.UpdateEvaluationResult=function(e,t){return!("AND"==this.collectionRule.Mode.toUpperCase()&&!t)&&(!("OR"!=this.collectionRule.Mode.toUpperCase()||!t)||e)},e}(),f=function(){function e(){}return e.prototype.Evaluate=function(e,t){return!!e.HasAttachments},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}(),p=n(242),m="MeetingString",g=function(){function e(e){this.itemHasKnownEntityRule=e}return e.prototype.Evaluate=function(e,t){if(!e.EntityExtractionResult)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Addresses,"Address");case 7:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Contacts,"ContactString");case 6:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.EmailAddresses,"EmailAddress");case 1:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.MeetingSuggestions,m);case 5:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.PhoneNumbers,"OriginalPhoneString");case 2:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.TaskSuggestions,"TaskString");case 4:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Urls,"Url");default:throw new Error("Unexpected known entity: "+this.itemHasKnownEntityRule.EntityType)}},e.prototype.EvaluateForEntityType=function(e,t,n,r){var a,i;if(!n)return!1;var o=[],c=!1,u=0;try{for(var l=Object(s.__values)(n),d=l.next();!d.done;d=l.next()){var f=d.value;if(this.EvaluateRegExForTerm(f[r])){c=!0,-1===t.evaluationResult.matchedKnownEntityTypes.indexOf(this.itemHasKnownEntityRule.EntityType)&&t.evaluationResult.matchedKnownEntityTypes.push(this.itemHasKnownEntityRule.EntityType),2!==this.itemHasKnownEntityRule.Highlight&&"Subject"!==f.Position&&(t.terms.push(v(f,r)),u++);var m=p({},f);o.push(m)}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}if(this.itemHasKnownEntityRule.FilterName&&this.itemHasKnownEntityRule.RegExFilter&&this.SaveRegexMatches(o,t.evaluationResult),u>0){var g=t.highlightableEntities[this.itemHasKnownEntityRule.EntityType];(!g||u>g)&&(t.highlightableEntities[this.itemHasKnownEntityRule.EntityType]=u)}return c},e.prototype.EvaluateRegExForTerm=function(e){var t=this.itemHasKnownEntityRule.IgnoreCase,n=this.itemHasKnownEntityRule.RegExFilter;if(!n)return!0;var r=Object(l.h)(e,n,t);return r&&r.length>0},e.prototype.ItemIsReadyForEvaluation=function(e){return!!e.EntityExtractionResult||!this.ItemHasEntityOnServer(e)},e.prototype.ItemHasEntityOnServer=function(e){if(!e.PropertyExistence)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return e.PropertyExistence.ExtractedAddresses;case 7:return e.PropertyExistence.ExtractedContacts;case 6:return e.PropertyExistence.ExtractedEmails;case 1:return e.PropertyExistence.ExtractedMeetings;case 5:return e.PropertyExistence.ExtractedPhones;case 2:return e.PropertyExistence.ExtractedTasks;case 4:return e.PropertyExistence.ExtractedUrls;default:return!1}},e.prototype.SaveRegexMatches=function(e,t){switch(this.itemHasKnownEntityRule.EntityType){case 3:t.filteredEntityMatches.Addresses||(t.filteredEntityMatches.Addresses={}),t.filteredEntityMatches.Addresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 7:t.filteredEntityMatches.Contacts||(t.filteredEntityMatches.Contacts={}),t.filteredEntityMatches.Contacts[this.itemHasKnownEntityRule.FilterName]=e;break;case 6:t.filteredEntityMatches.EmailAddresses||(t.filteredEntityMatches.EmailAddresses={}),t.filteredEntityMatches.EmailAddresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 1:t.filteredEntityMatches.MeetingSuggestions||(t.filteredEntityMatches.MeetingSuggestions={}),t.filteredEntityMatches.MeetingSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 5:t.filteredEntityMatches.PhoneNumbers||(t.filteredEntityMatches.PhoneNumbers={}),t.filteredEntityMatches.PhoneNumbers[this.itemHasKnownEntityRule.FilterName]=e;break;case 2:t.filteredEntityMatches.TaskSuggestions||(t.filteredEntityMatches.TaskSuggestions={}),t.filteredEntityMatches.TaskSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 4:t.filteredEntityMatches.Urls||(t.filteredEntityMatches.Urls={}),t.filteredEntityMatches.Urls[this.itemHasKnownEntityRule.FilterName]=e}},e}();function v(e,t){return t===m?function(e,t){var n=e[t];if(!e.TimeStringLength)return n;var r=n.slice(e.TimeStringBeginIndex,e.TimeStringBeginIndex+e.TimeStringLength),a=n.slice(e.TimeStringBeginIndex+e.TimeStringLength,n.length);if(0==a.length)return r;return r+"(?="+a+")"}(e,t):e[t]}var h=50,b=5e5,y=10240,_=n(222);function O(e){return 0===e.indexOf("ipm.note")||0===e.indexOf("ipm.schedule")||0===e.indexOf("ipm.sharing")}function S(e){return 0===e.indexOf("ipm.appointment")||"ipm.ole.class.{00061055-0000-0000-c000-000000000046}"==e}var C=function(){function e(e){this.itemIsRule=e}return e.prototype.Evaluate=function(e,t){return this.EvaluateItemType(e)&&this.EvaluateItemClass(e)},e.prototype.EvaluateItemType=function(e){var t=e.ItemClass;return!(1!=this.itemIsRule.ItemType||!t||!O(t.toLowerCase()))||(!(2!=this.itemIsRule.ItemType||!t||!S(t.toLowerCase()))||!this.itemIsRule.ItemType)},e.prototype.EvaluateItemClass=function(e){var t=e.ItemClass;return!this.itemIsRule.ItemClass||(this.itemIsRule.IncludeSubClasses?t&&0===t.toLowerCase().indexOf(this.itemIsRule.ItemClass.toLowerCase()):t&&this.itemIsRule.ItemClass.toLowerCase()===t.toLowerCase())},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}(),I=function(){function e(e,t){this.itemHasRegularExpressionMatchRule=e,this.limits=t||r}return e.prototype.Evaluate=function(e,t){var n,r,a=this.GetPropertyForEvaluation(e,t),i=this.itemHasRegularExpressionMatchRule.RegExValue,o=this.itemHasRegularExpressionMatchRule.IgnoreCase,c=null;if(null!=a&&(c=Object(l.h)(a,i,o)),null==c)return t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=[],!1;var u=this.removeDuplicatesAndApplyMatchLimits(c);if(t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=u,2===this.itemHasRegularExpressionMatchRule.Highlight)return!0;if(2==this.itemHasRegularExpressionMatchRule.PropertyName)try{for(var d=Object(s.__values)(u),f=d.next();!f.done;f=d.next()){var p=f.value;t.terms.push(p)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return!0},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e.prototype.removeDuplicatesAndApplyMatchLimits=function(e){var t,n,r={},a=0;try{for(var i=Object(s.__values)(e),o=i.next();!o.done;o=i.next()){var c=o.value;if(a>=this.limits.MAX_REGEX_MATCHES)break;c.length<=this.limits.MAX_REGEX_MATCH_LENGTH&&(r[c]=1,a++)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return Object.keys(r)},e.prototype.GetPropertyForEvaluation=function(e,t){switch(this.itemHasRegularExpressionMatchRule.PropertyName){case 1:return e.Subject;case 4:return this.GetSenderSMTPAddress(e);case 3:return this.GetBodyWithLimits(e);case 2:if(t.plainTextBody)return t.plainTextBody;var n=this.GetBodyWithLimits(e);return t.plainTextBody=Object(l.e)(n),t.plainTextBody;default:return Object(_.a)(this.itemHasRegularExpressionMatchRule.PropertyName),""}},e.prototype.GetSenderSMTPAddress=function(e){if(O(e.ItemClass)){var t=e;if(t.Sender&&t.Sender.Mailbox)return t.Sender.Mailbox.EmailAddress}if(S(e.ItemClass)){var n=e;if(n.Organizer&&n.Organizer.Mailbox)return n.Organizer.Mailbox.EmailAddress}return null},e.prototype.GetBodyWithLimits=function(e){var t=this.GetBody(e);return null!=t&&t.length>this.limits.MAX_BODY_REGEX_ACTIVATION_LENGTH?null:t},e.prototype.GetBody=function(e){var t;e.NormalizedBody?t=e.NormalizedBody:e.UniqueBody?t=e.UniqueBody:e.Body&&(t=e.Body);var n=this.itemHasRegularExpressionMatchRule.PropertyName;return!t||"Text"===t.BodyType&&3===n?null:t.Value},e}();function A(e){if("ItemIs"==e.Type)return new C(e);if("ItemHasAttachment"==e.Type)return new f;if("ItemHasKnownEntity"==e.Type)return new g(e);if("ItemHasRegularExpressionMatch"==e.Type)return new I(e);if("Collection"==e.Type)return new d(e);throw new Error("Rule type not supported: "+e.Type)}var x=n(13);function E(e,t,n){var r,a={};e.length>0&&e.forEach((function(e){var i,o,c,l;c=r,l={evaluationResult:Object(u.h)(),highlightableEntities:{},terms:[]},c&&(l.plainTextBody=c.plainTextBody,l.highlightableEntities=c.highlightableEntities);var d=function(e,t,n){try{return function(e,t,n){if(A(e).Evaluate(t,n))return n.terms;return[]}(e.detectedEntity.Rule,t,n)}catch(e){return[]}}(e,t,r=l);try{for(var f=Object(s.__values)(d),p=f.next();!p.done;p=f.next()){var m=p.value;a[m]?a[m].push(e):a[m]=[e]}}catch(e){i={error:e}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}d.length>0&&(n[e.extension.Id]=r.evaluationResult)}));return new x.ObservableMap(a)}function T(e,t){try{return function(e,t){return A(e).ItemIsReadyForEvaluation(t)}(e.detectedEntity.Rule,t)}catch(e){return!0}}function w(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return function(e,t){var n,r;try{for(var a=Object(s.__values)(e),i=a.next();!i.done;i=a.next()){if(!T(i.value,t))return!1}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!0}(t,e)?[3,2]:[4,Object(l.j)(e)];case 1:n=r.sent(),Object(u.gb)(e,n.EntityExtractionResult),r.label=2;case 2:return[2]}}))}))}var j=n(912),P=n(954),M=n(51);function k(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i,o,c;return Object(s.__generator)(this,(function(l){switch(l.label){case 0:return(n=Object(j.c)(t))?(r=!1,n.isSharedItem&&(r=n.isSharedItem()),a=function(e){var t=u.k.EnabledAddinCommands;if(!t)return[];var n=t.getExtensionPoint(P.a.DetectedEntity);if(0==n.length)return[];if(e){if(!Object(M.f)("addin-delegateAccess"))return[];n=Object(u.m)(n)}return n.map((function(e){return Object(s.__spread)(e.AddinCommands.values())[0]}))}(r),i={},[4,w(e,a)]):[2];case 1:return l.sent(),o=E(a,e,i),c=new x.ObservableMap(i),Object(u.fb)(t,o,c),[2]}}))}))}var R=n(2981),D=n(3338),N=n(4638);function F(e,t,n){return void 0===n&&(n=!0),Object(s.__awaiter)(this,void 0,void 0,(function(){var r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return Object(j.a)(e,t),Object(u.G)(e),((i=t.mode)==P.a.MessageRead||i==P.a.MeetingRequest||i==P.a.AppointmentAttendee)&&(r=t,Object(u.kb)(function(e,t){return function(){return k(e.getItem(),t)}}(r,e))),Object(l.l)(e),Object(N.e)(n),[4,Object(D.f)(t.mode)];case 1:return a.sent(),[4,Object(c.a)()];case 2:return a.sent(),Object(R.c)()&&Object(N.f)(N.a.Single,e),[2]}var i}))}))}function L(e){Object(l.f)(e),Object(N.b)(e),Object(u.j)(e),Object(u.i)(e),Object(u.g)(e),function(e,t){Object(u.I)(e)?Object(x.when)((function(){return!Object(u.I)(e)}),(function(){return t(e)})):t(e)}(e,U)}function U(e){Object(u.M)(e)||Object(j.b)(e)}var B=n(1615);function H(e,t){t==B.a.Deselected&&Object(N.b)(e)}function G(e){return!!Object(u.v)(e)&&null!=Object(u.v)(e).contextualTerms}function W(e,t){return Object(x.when)((function(){return G(e)}),(function(){return t(G(n=e)?Object(s.__spread)(Object(u.v)(n).contextualTerms.keys()):null);var n}))}var V=n(2660),z=n(4102),J=function(e){function t(){var t=e.call(this,{},{},{},{})||this;return t.extension={AppDomains:[z.e,z.d],Id:z.k,Version:z.i,Type:"Default",TypeString:"Default",Origin:"Default",OriginString:"Default",IconUrl:z.h,DisplayName:z.c,ConsentState:0,Description:z.b,ProviderName:z.j,HighResolutionIconUrl:z.g,AppStatus:"",LicenseType:0,Settings:"{}",RequestedCapabilities:1,DisableEntityHighlighting:!1,Enabled:!0,LicenseStatus:0,IsMandatory:!1,ExtensionPointCollection:t.get_ExtensionPointCollection()},t.addinId=z.k,t.commandId=z.a,t.endpoint=z.d,t}return Object(s.__extends)(t,e),t.prototype.get_EntryPoint=function(){return this.endpoint.toString()},t.prototype.get_Label=function(){return this.extension.DisplayName},t.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},t.prototype.get_Id=function(){return this.extension.Id},t.prototype.get_Size16Icon=function(){return this.extension.IconUrl},t.prototype.get_Version=function(){return this.extension.Version},t.prototype.get_ExtensionPointCollection=function(){return{FunctionFile:z.f,MessageReadCommandSurface:this.get_ExtensionPoint(),MessageComposeCommandSurface:null,AppointmentOrganizerCommandSurface:null,AppointmentAttendeeCommandSurface:null,Events:null,DetectedEntity:null,CustomPane:null,__type:"MessageReadCommandSurface"}},t.prototype.get_ExtensionPoint=function(){return{Tabs:[this.get_Tab()],__type:""}},t.prototype.get_Tab=function(){return{Type:0,Id:"TabDefault",Groups:[this.get_Group()],Label:z.c,__type:null}},t.prototype.get_Group=function(){return{Id:"ScreamGroup",Label:z.c,Controls:[this.get_TaskPaneControl()],__type:null}},t.prototype.get_IconUrls=function(){return{Size16Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon16x16.png",Size32Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon32x32.png",Size80Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon80x80.png",Size20Url:null,Size24Url:null,Size40Url:null,Size48Url:null,Size64Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",__type:null}},t.prototype.get_TaskPaneControl=function(){var e=this.get_Control();return e.Action={SourceLocation:z.f,__type:"TaskPaneButton"},e},t.prototype.get_Control=function(){return{Label:z.c,Supertip:{Title:"Translate Item",Description:z.b},Icon:this.get_IconUrls(),Id:z.a,__type:"ShowTaskpane"}},t}(u.a),q=n(4441);function X(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(q.a)()];case 1:return n.sent(),null!=(t=new J)?(Object(N.g)(e,t,P.a.MessageRead),[2]):[2,null]}}))}))}var Q=n(4138),K=n(1611),Z=n(29),Y=n(1),$=n(1598),ee=n(9675),te=n(7),ne=n(6575),re=n(5196);var ae=n(5277),ie=n(9676),oe=n(3732),se=n(5278),ce=n(886),ue=n(165);function le(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(ce.b)(Object(te.a)(ie.b),Object(te.a)(oe.b),!1,{okText:Object(te.a)(ie.a),cancelText:Object(te.a)(oe.a)})];case 1:return e=t.sent(),Object(ue.o)("ExtGDPRMinorDialogResponse",[e]),e===ce.a.cancel&&Object(R.b)()&&Object(se.a)(),[2]}}))}))}var de=n(3731);function fe(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,a,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return Object(de.f)(t)?[4,le()]:[3,2];case 1:return o.sent(),[2];case 2:return r=Object(j.c)(e),a=!0,r.mode!==P.a.MessageRead&&r.mode!==P.a.AppointmentAttendee||(i=r.getItem(),a=Object(u.Y)(i)),[4,Object(ce.b)(Object(te.a)(ee.a),"",a,{bodyElement:Y.createElement("p",null,Object(te.a)(ee.b)),hideCancelButton:!0})];case 3:return o.sent(),a?(ne.c(t.control)?Object(ae.a)(e,t,r.mode,n):ne.a(t.control)&&function(e,t){var n=new re.d(e,new re.a),r=n.controlId;Object(u.X)(r,n,t)}(t,e),[2]):[2]}}))}))}var pe=n(6577),me=n(132),ge=function(){function e(e,t){this.key=e,this.name=t}return e.prototype.generateData=function(){return{key:this.key,name:this.name,title:this.description,ariaLabel:this.accessibilityText,iconProps:Object(pe.a)(this.iconUrl),itemType:me.a.Normal,getClickHandler:this.getClickHandler,subMenuProps:this.subMenuData?{items:[this.subMenuData.generateData()]}:null}},e}(),ve=function(){function e(e,t){this.key=e,this.header=t,this.menuItemDataList=[]}return e.prototype.addItem=function(e){this.menuItemDataList.push(e)},e.prototype.generateItemsData=function(){var e,t;try{for(var n=Object(s.__values)(this.menuItemDataList),r=n.next();!r.done;r=n.next()){var a=r.value;this.data.push(a.generateData())}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.generateData=function(){return this.data=[],this.generateItemsData(),{key:this.key,itemType:me.a.Section,sectionProps:{title:this.header,items:this.data}}},e}();function he(e){var t=e.control,n=t.Id,r=t.Label,a=new ge(n,r);return e.isMenu?a.subMenuData=be(n,r,e.subCommands):e.isActionable&&(a.getClickHandler=Se(e)),a.iconUrl=e.control.Icon?e.control.Icon.Size16Url:null,a.accessibilityText=e.control.Label,a.description=e.control.Supertip?e.control.Supertip.Title:null,a}function be(e,t,n){var r,a,i=new ve(e,t);try{for(var o=Object(s.__values)(n),c=o.next();!c.done;c=o.next()){var u=c.value;i.addItem(he(u))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}return i}function ye(e){var t=new ge(e.Id,e.DisplayName);if(Object(de.h)(e))if(Object(de.g)(e))t.subMenuData=be(e.Id,e.DisplayName,Object(de.d)(e).subCommands);else{var n=Object(s.__spread)(e.AddinCommands.values());t.subMenuData=be(e.Id,e.DisplayName,n)}else Object(de.a)(e)&&(t.getClickHandler=Se(Object(de.d)(e)));return t.description=Object(de.e)(e),t.accessibilityText=Object(de.b)(e),t.iconUrl=e.IconUrl,t}var _e=n(9677);var Oe=n(6578);function Se(e){return function(t){return function(n){n.stopPropagation(),fe(t,e)}}}function Ce(e){var t=function(e){var t,n,r=new ve("AddinsHeader",Object(te.a)(_e.a));try{for(var a=Object(s.__values)(e),i=a.next();!i.done;i=a.next()){var o=i.value;r.addItem(ye(o))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}(e).generateData();return Object(M.f)("addin-inClientStoreEnabled")&&Object(u.s)()&&Object(u.s)().InClientStoreUrl&&(t.sectionProps.items.push(Object(Oe.b)()),t.sectionProps.items.push(Object(Oe.a)())),t}var Ie=n(480),Ae=n(303),xe=n(63),Ee=n(9678),Te=Object(Z.a)((function(e){var t=Object(s.__read)(Y.useState(!1),2),n=t[0],r=t[1],a=function(t){t.stopPropagation(),Object(de.a)(e.addin)&&fe(e.hostItemIndex,Object(de.d)(e.addin))},i={iconType:Ae.a.Image,imageProps:{src:e.addin.IconUrl,width:16,height:16,imageFit:xe.b.contain,onLoadingStateChange:function(e){e==xe.c.error?r(!0):r(!1)}}},o={iconType:Ae.a.Default,iconName:"Photo2"},c=Object(de.b)(e.addin),u={className:Ee.addinEntryButton,iconProps:n?o:i,title:c,ariaLabel:c};if(Object(de.a)(e.addin))return Y.createElement(Ie.a,Object(s.__assign)({onClick:a},u));if(Object(de.h)(e.addin)){var l=ye(e.addin).generateData();return Object($.a)(e.hostItemIndex,l),Y.createElement(Ie.a,Object(s.__assign)({onMenuClick:a,menuProps:l.subMenuProps,menuIconProps:null},u))}return null})),we=n(9680);var je=function(e){var t,n,r=[];try{for(var a=Object(s.__values)(e.addins),i=a.next();!i.done;i=a.next()){var o=i.value;r.push(Y.createElement(Te,{hostItemIndex:e.hostItemIndex,addin:o,key:o.Id}))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return Y.createElement("div",{className:we.listViewContainer},r)},Pe=n(9682),Me=n(407),ke=n.n(Me),Re=n(9683),De=Object(Z.a)((function(e){var t={iconType:Ae.a.Default,iconName:"ChevronDownMed",className:ke()([Re.overflowChevron])},n={className:ke()([Re.overflowChevronContainer]),iconProps:t,title:Object(te.a)(Pe.a),ariaLabel:Object(te.a)(oe.c)},r=Ce(e.addins);return Object($.a)(e.hostItemIndex,r),Y.createElement("div",{className:ke()([Re.overflowContainer])},Y.createElement("div",{className:ke()([Re.overflowDivider])}),Y.createElement(Ie.a,Object(s.__assign)({onMenuClick:Ne,menuProps:{items:[r]},menuIconProps:null},n)))}));function Ne(e){e.stopPropagation()}var Fe=n(9685),Le=5,Ue=3,Be=5,He=Object(Z.a)((function(e){var t=u.k.HostItems.get(e.Index),n=u.k.EnabledAddinCommands;if(!t||!n)return Y.createElement("div",null);var r=Object(j.c)(e.Index),a=function(e){switch(e){case P.a.MessageRead:return Ue;case P.a.MessageCompose:return Be;default:return Le}}(r.mode),i=n.getExtensionPoint(r.mode),o=null;return(a=Math.min(a,i.length))<i.length&&(o=Y.createElement(De,{hostItemIndex:e.Index,addins:i.slice(a,i.length)})),Y.createElement("div",{className:Fe.divContainer},Y.createElement(je,{hostItemIndex:e.Index,addins:i.slice(0,a)}),o)}));var Ge=n(6424),We=n(6454),Ve=n(6576);function ze(e,t,n){Object(u.F)(e,t,n);var r=Object(u.t)();Object(Ve.a)(t,r.contextualCalloutState.activeContextualAddinCommands[0])}function Je(e,t,n,r,a){return Object(s.__awaiter)(this,void 0,void 0,(function(){var i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return null==(i=Object(de.c)(t,n,r))?[3,2]:[4,fe(e,i,a)];case 1:return o.sent(),[2];case 2:return[2,null]}}))}))}var qe={};function Xe(e,t){var n=function(e,t){return e+"_"+t}(e,t=!!t);return qe[n]||(qe[n]=Object(x.computed)((function(){var n=Object(u.t)().Context,r=Object(u.t)().EnabledAddinCommands;return r?function(e,t,n,r){if(n&&t.isInitialized){return Ce(t.getExtensionPoint(e,r))}return null}(e,r,n,t):null}))),qe[n]}var Qe=n(5189),Ke=n(7254),Ze=n(9687),Ye=n(20),$e=n(4644),et=function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return e=Object(u.t)().Context,Object(u.K)()&&e?[2,!0]:[3,1];case 1:t={name:"Extensibility initialization observer timeout",timeout:9e3},n.label=2;case 2:return n.trys.push([2,4,,5]),[4,Object(x.when)((function(){return Object(u.t)().Context&&Object(u.K)()}),t)];case 3:return n.sent(),[3,5];case 4:return n.sent(),[2,!1];case 5:return[2,Object(u.t)().Context&&Object(u.K)()]}}))}))};function tt(e){var t;return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i,o,c;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return Object(M.f)("addin-itemSendEvent")?(n=Object($e.b)(),r=Object(Ye.a)().SegmentationSettings.OnSendAddinsEnabled,(a=r)?[4,et()]:[3,2]):[2,!0];case 1:a=!s.sent(),s.label=2;case 2:if(a&&function(e){var t=Object(u.t)().Context,n=Object(u.K)();if(e&&(!t||!n))return Object(ce.b)(Object(te.a)(Ke.a),Object(te.a)(Ze.b),!1,{hideCancelButton:!0}),!0;return!1}(r))return Object($e.d)(n,1),[2,!1];if(i=Object(u.y)(1),o=Object(j.c)(e),null===(t=null==o?void 0:o.isSharedItem)||void 0===t?void 0:t.call(o)){if(!Object(M.f)("addin-delegateAccess"))return[2,!0];i=Object(u.l)(i)}!function(e,t){e.forEach((function(e){return Object(l.m)(t,e.extension.Id,e.extension.Id+"ItemSend")}))}(i,e),c=0,s.label=3;case 3:return c<i.length?[4,nt(e,i[c],n)]:[3,6];case 4:if(!s.sent())return[2,!1];n.addCheckmark("ItemSend"+c),s.label=5;case 5:return c++,[3,3];case 6:return i.length>0?Object($e.d)(n,4):n.invalidate(),[2,!0]}}))}))}function nt(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,a,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return r=new re.d(t,new re.a),a=r.controlId,[4,Object(u.X)(a,r,e)];case 1:return(i=o.sent()).status!==u.d.Success||!1===i.allowEvent?(Object(l.c)(e,t.extension.Id,!1,t.extension.Id+"ItemSend",0,Object(te.b)(Object(te.a)(Ze.a),t.extension.DisplayName)),Object(u.cb)(a,e,i.status),Object($e.c)(n,i,t),[2,!1]):[2,!0]}}))}))}var rt=n(4),at=function(e,t){Object(M.f)("addin-autoRun")&&Object(u.K)()&&Object(N.d)(e,t)},it=Object(rt.action)("onNewMessageCompose",(function(e){return{hostItemIndex:e}}));Object(rt.orchestrator)(it,(function(e){at(e.hostItemIndex,1)}));var ot=it,st=Object(rt.action)("onNewAppointmentOrganizer",(function(e){return{hostItemIndex:e}}));Object(rt.orchestrator)(st,(function(e){at(e.hostItemIndex,2)}));var ct=st,ut=Object(rt.action)("onNewAttachmentOnMessageCompose",(function(e){return{hostItemIndex:e}}));Object(rt.orchestrator)(ut,(function(e){at(e.hostItemIndex,3)}));var lt=ut,dt=Object(rt.action)("onNewAttachmentOnAppointmentOrganizer",(function(e){return{hostItemIndex:e}}));Object(rt.orchestrator)(dt,(function(e){at(e.hostItemIndex,4)}));var ft=dt;n.d(t,"removeExtensibilityNotification",(function(){return a.h})),n.d(t,"updatePersistentNotifications",(function(){return i.a})),n.d(t,"closeTaskPaneAddinCommand",(function(){return o.a})),n.d(t,"initializeAddinsForItem",(function(){return F})),n.d(t,"deinitializeAddinsForItem",(function(){return L})),n.d(t,"onHostItemChanged",(function(){return H})),n.d(t,"initializeExtensibilityContext",(function(){return c.a})),n.d(t,"whenItemHasContextualAddinKeywords",(function(){return W})),n.d(t,"triggerAppointmentTimeChangedEvent",(function(){return V.e})),n.d(t,"triggerAttachmentsChangedEvent",(function(){return V.f})),n.d(t,"triggerRecipientsChangedEvent",(function(){return V.h})),n.d(t,"triggerRecurrenceChangedEvent",(function(){return V.i})),n.d(t,"triggerLocationsChangedEvent",(function(){return V.g})),n.d(t,"launchTranslateCommand",(function(){return X})),n.d(t,"setPersistedAddin",(function(){return Q.a})),n.d(t,"shouldForceOnSendCompliantBehavior",(function(){return K.a})),n.d(t,"AddinBarView",(function(){return He})),n.d(t,"TaskPaneCollection",(function(){return Ge.a})),n.d(t,"onComposeClose",(function(){return We.a})),n.d(t,"openContextualCallout",(function(){return ze})),n.d(t,"launchAddinCommand",(function(){return Je})),n.d(t,"observeAddinCommandSurfaceItems",(function(){return Xe})),n.d(t,"onItemNavigation",(function(){return Qe.a})),n.d(t,"allowItemSendEvent",(function(){return tt})),n.d(t,"ExecuteEntryPoint",(function(){return fe})),n.d(t,"onNewMessageCompose",(function(){return ot})),n.d(t,"onNewAppointmentOrganizer",(function(){return ct})),n.d(t,"onNewAttachmentOnMessageCompose",(function(){return lt})),n.d(t,"onNewAttachmentOnAppointmentOrganizer",(function(){return ft}))},324:function(e,t,n){"use strict";var r=n(385).a.Symbol;t.a=r},3255:function(e){e.exports=JSON.parse('{"a":"jga"}')},3256:function(e){e.exports=JSON.parse('{"a":"Zfa"}')},3257:function(e){e.exports=JSON.parse('{"a":"qga"}')},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(20),a=n(147),i=n(74);function o(e){var t=(e&&Object(a.k)(e.userIdentity)?Object(i.i)(e.userIdentity):Object(r.a)()).MasterCategoryList;return(null==t?void 0:t.MasterList)||[]}},3266:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"SingleRecipientType:#Exchange"},e)}},3267:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(24),a=n(1937);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("CreateItem",e,t)}},327:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(115),a=r.a.GreyDark,i=r.a.GreyDark},328:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(184),a=n(212),i=n(211),o=n(208);function s(e){return Object(r.a)({RequestServerVersion:"Exchange2015",TimeZoneContext:Object(a.a)({TimeZoneDefinition:Object(i.a)({Id:null!=e?e:"Pacific Standard Time"})})})}function c(e,t,n){return Object(o.a)({PropertySetId:e,PropertyName:t,PropertyType:n})}},329:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(327),a=n(220),i=n(326);function o(e,t){t||(t=Object(i.a)());for(var n=0;n<t.length;n++){var r=t[n];if(r.Name.toLowerCase()===e.toLowerCase())return a.a.colorCodeColorValueMap[r.Color.toString()]}return s()}function s(){return a.a.colorCodeColorValueMap[r.a]}},3309:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4872),a=n(3310),i="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{isQos:!0},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{isQos:!0},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{isQos:!0},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(a.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e,"smartReply"),smartDocExtractionId:Object(r.a)(e,"smartDoc")})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},3310:function(e,t,n){"use strict";function r(e){return a(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some((function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()})));var t}function a(e){return!!e.groupId}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},3338:function(e,t,n){"use strict";var r=n(6480),a=n(4137);function i(e){var t=Object(r.a)(e);return Object(a.a)()[t]}var o=n(4138);function s(e){return e.isActionable&&e.control.Action.SupportsPersistence}var c=n(0),u=n(7),l=n(954),d=n(2981),f=n(6441),p=!1;function m(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(c.__generator)(this,(function(r){switch(r.label){case 0:return Object(d.c)()?e===l.a.AppointmentAttendee||e===l.a.AppointmentOrganizer?[2]:p?[3,2]:[4,Object(f.a)()]:[2];case 1:t=r.sent(),(n=JSON.parse(t)).addins&&(p=!0,n.addins.forEach((function(e){if(function(e){return!Object(u.f)(e.mode)&&!Object(u.f)(e.addinId)&&!Object(u.f)(e.commandId)}(e)){var t={addinId:e.addinId,commandId:e.commandId};Object(a.a)()[e.mode]=t}}))),r.label=2;case 2:return[2]}}))}))}function g(){return p}function v(e){return{addinId:e.extension.Id,commandId:e.control.Id}}var h=n(880);function b(e){for(var t=Object.keys(Object(a.a)()),n=0;n<t.length;n++){var r=t[n],i=Object(a.a)()[r];i&&e.indexOf(i.addinId)<0&&(Object(o.b)(r,null),Object(h.ab)(i.addinId))}}var y=function(e){var t=i(l.a.MessageRead),n=i(l.a.MessageCompose);return!!(t&&e.extension.Id===t.addinId&&e.get_Id().indexOf(t.commandId)>=0)||!!(n&&e.extension.Id===n.addinId&&e.get_Id().indexOf(n.commandId)>=0)};n.d(t,"c",(function(){return i})),n.d(t,"h",(function(){return o.a})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return v})),n.d(t,"g",(function(){return b})),n.d(t,"d",(function(){return y}))},339:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3435:function(e){e.exports=JSON.parse('{"a":"Kga"}')},3436:function(e){e.exports=JSON.parse('{"a":"Fga","b":"Gga"}')},3437:function(e){e.exports=JSON.parse('{"a":"yga"}')},3438:function(e){e.exports=JSON.parse('{"a":"xga"}')},3439:function(e){e.exports=JSON.parse('{"a":"vga"}')},3440:function(e){e.exports=JSON.parse('{"a":"uga"}')},3441:function(e){e.exports=JSON.parse('{"a":"dga"}')},3442:function(e){e.exports=JSON.parse('{"a":"_fa"}')},3443:function(e){e.exports=JSON.parse('{"a":"Xfa"}')},3444:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(51),a=n(42);function i(){return Object(r.f)("mc-officeEditorBX")&&(Object(a.b)()||Object(a.c)())}},3446:function(e,t,n){"use strict";function r(e,t,n){var r=n.fromHtml(e,t);return r&&0!=r.length?1==r.length?r[0]:n.wrap(r,"SPAN"):null}n.d(t,"a",(function(){return r}))},348:function(e,t,n){"use strict";var r=n(77),a=n(220),i=n(1),o=n(165),s=n(29);var c=Object(s.a)((function(e){var t=e.categoryContainerClass,n=e.categories,r=e.categoryWellContainerClass,a=e.onCategoryClicked,s=e.categoryList;!function(e){i.useEffect((function(){Object(o.o)("Category_Well_TotalCategories",[e.length],{sessionSampleRate:10})}),[e])}(n);var c=i.useCallback((function(e){var n=e.categoryName,r=e.isLastInWell;return i.createElement(f,{actionSource:"CategoryWell",category:n,containerClassName:t,isLastInWell:r,onCategoryClicked:a,categoryList:s})}),[t,a,s]);return i.createElement("div",{className:r},n.map((function(e,t){return i.createElement(c,{key:e,categoryName:e,isLastInWell:t===n.length-1})})))})),u=n(461),l=n(598),d=n(219).bind(l),f=Object(s.a)((function(e){var t=i.useRef(),n=Object(u.a)((function(){return Object(p.a)(e.category,e.categoryList?e.categoryList:Object(b.a)())})),r={backgroundColor:n.get().primaryColor,borderColor:n.get().secondaryColor,color:n.get().textColor,cursor:e.onCategoryClicked?"pointer":"initial"},a=e.category,s=d(e.containerClassName,e.isLastInWell?l.lastCategoryContainer:l.categoryContainer),c=i.createElement("span",{className:l.categoryName},a);return i.createElement("div",{ref:function(e){return t.current=e},key:a,className:s,style:r,title:a,onMouseEnter:function(){e.onCategoryClicked&&(t.current.style.borderColor=n.get().textColor)},onMouseLeave:function(){e.onCategoryClicked&&(t.current.style.borderColor=n.get().secondaryColor)},onClick:function(t){e.onCategoryClicked&&(Object(o.o)("Category_Well_Click",[e.actionSource]),e.onCategoryClicked(t,e.category,e.actionSource))}},c)})),p=n(329),m=(n(115),n(58)),g=n(600);function v(e){var t=[];return t.push({key:"CategoryMenuItemDiv",onRender:function(){return i.createElement(N,{mailboxInfo:e.mailboxInfo,onAfterCreateNewCategory:e.onAfterCreateNewCategory,addFavoriteCategory:e.addFavoriteCategory,onCheckedCategoryClicked:e.onCheckedCategoryClicked,onUncheckedCategoryClicked:e.onUncheckedCategoryClicked,actionSource:e.actionSource,categoryList:e.categoryList,categoriesToCheck:e.getCategoriesToCheck(),dismissMenu:e.dismissMenu,shouldShowSearchBox:e.shouldShowSearchBox,shouldShowManageCategories:e.shouldShowManageCategories,shouldShowClearCategories:e.getShouldShowClearCategories(),manageCategoriesDisabled:e.manageCategoriesDisabled,createNewCategoryDisabled:e.createNewCategoryDisabled,onManageCategoryClicked:e.onManageCategoryClicked,onClearCategoriesClicked:e.onClearCategoriesClicked})}}),{className:g.categoryMenu,styles:{title:{},container:{},root:{width:e.width?e.width+"px":null},header:{},list:{}},directionalHintFixed:!0,items:t,onMenuDismissed:function(){return D.importAndExecute()},shouldFocusOnMount:!e.shouldShowSearchBox,useTargetWidth:e.useTargetWidth,coverTarget:e.coverTarget,directionalHint:e.directionalHint?e.directionalHint:m.DirectionalHint.bottomLeftEdge,focusZoneProps:{shouldInputLoseFocusOnArrowKey:function(e){return!0}},calloutProps:{className:"customScrollBar"}}}var h=n(485),b=n(326),y=n(327);function _(e){var t,n=null===(t=Object(a.b)().categoryDetails.get(e))||void 0===t?void 0:t.unreadCount;return n||0}function O(e){var t,n=null===(t=Object(a.b)().categoryDetails.get(e))||void 0===t?void 0:t.totalCount;return n||0}function S(e){return 1===Object(b.a)().filter((function(t){return t.Id===e})).length}var C=n(413),I=n(484);n.d(t,"r",(function(){return x})),n.d(t,"w",(function(){return E})),n.d(t,"s",(function(){return T})),n.d(t,"A",(function(){return w})),n.d(t,"u",(function(){return j})),n.d(t,"x",(function(){return P})),n.d(t,"t",(function(){return M})),n.d(t,"z",(function(){return k})),n.d(t,"y",(function(){return R})),n.d(t,"v",(function(){return D})),n.d(t,"e",(function(){return N})),n.d(t,"c",(function(){return F})),n.d(t,"b",(function(){return L})),n.d(t,"p",(function(){return a.b})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return f})),n.d(t,"h",(function(){return p.a})),n.d(t,"j",(function(){return v})),n.d(t,"l",(function(){return h.a})),n.d(t,"o",(function(){return b.a})),n.d(t,"g",(function(){return y.b})),n.d(t,"n",(function(){return _})),n.d(t,"m",(function(){return O})),n.d(t,"q",(function(){return S})),n.d(t,"i",(function(){return C.a})),n.d(t,"k",(function(){return C.b})),n.d(t,"d",(function(){return I.a}));var A=new r.c((function(){return Promise.all([n.e(1),n.e(8),n.e(77),n.e(619),n.e(178)]).then(n.bind(null,13411))})),x=new r.b(A,(function(e){return e.addMasterCategories})),E=new r.a(A,(function(e){return e.removeMasterCategories})),T=new r.a(A,(function(e){return e.changeMasterCategories})),w=new r.a(A,(function(e){return e.updateLastTimeUsedMasterCategories})),j=new r.a(A,(function(e){return e.getMasterCategoryList})),P=new r.a(A,(function(e){return e.setInitialCategoryDialogViewState})),M=(new r.a(A,(function(e){return e.addCategory})),new r.a(A,(function(e){return e.fetchCategoryDetails}))),k=new r.a(A,(function(e){return e.subscribeToCategoryNotifications})),R=new r.a(A,(function(e){return e.setIsApplyingCategoryOperation})),D=new r.a(A,(function(e){return e.onMenuDismissed})),N=Object(r.d)(A,(function(e){return e.CategoryMenu})),F=Object(r.d)(A,(function(e){return e.CategoryDialog})),L=Object(r.d)(A,(function(e){return e.CategoryColorPickerHost}))},349:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(r||(r={}))},3503:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},3504:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return v}));var r=n(0),a=n(165),i=n(5),o=n(20);function s(e,t){var n=h(e.selectedCLPLabel,"Change"),i=e.originalCLPLabel,o=e.selectedCLPLabel,s=Object(r.__assign)(Object(r.__assign)({},n),{IsLabelChanged:!0,LabelIdBefore:i?i.id:null,IsProtectionChanged:!(!i||!o)&&i.isEncryptingLabel!=o.isEncryptingLabel,ProtectedBefore:null==i?void 0:i.isEncryptingLabel,UserJustification:t});a.j.importAndExecute(s)}function c(e){var t=h(e,"Discover");a.j.importAndExecute(t)}function u(e){(null==e?void 0:e.value)&&e.value.length>0&&Object(a.o)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function l(e){e&&Object(a.o)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function d(e,t){t&&e?Object(a.o)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(a.o)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function f(e){401!=e.status&&Object(a.o)("CLPAutoLabelEnabled")}function p(){Object(a.o)("CLPAutoLabelAutomaticApplied")}function m(){Object(a.o)("CLPAutoLabelRecommendedShown")}function g(){Object(a.o)("CLPAutoLabelRecommendedApplied")}function v(){Object(a.o)("CLPAutoLabelRecommendedDismissed")}function h(e,t){var n=Object(o.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,a=n.UserEmailAddress;return{CreationTime:Object(i.tb)(Object(i.Pb)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:a,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},355:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r,a=2,i=[window.location.origin];function o(e,t,n){var r={version:a,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function s(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&a==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow"}(r||(r={}))},3600:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=a},3601:function(e){e.exports=JSON.parse('{"a":"Hga"}')},3602:function(e){e.exports=JSON.parse('{"a":"Bga"}')},3603:function(e){e.exports=JSON.parse('{"a":"zga"}')},3604:function(e){e.exports=JSON.parse('{"a":"gga"}')},3605:function(e){e.exports=JSON.parse('{"a":"cga"}')},3606:function(e){e.exports=JSON.parse('{"a":"Yfa"}')},3607:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(74);function a(){return!Object(r.t)()}},3630:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20);function a(){return Object(r.a)().SessionSettings.UserEmailAddress}},3672:function(e,t,n){"use strict";var r=n(0),a=n(104),i=Object(a.action)("setNumberOfWaitingAttachments")((function(e,t){t<0||(e.numberOfWaitingAttachments=t)})),o=n(2314),s=n(165),c=n(85),u=n(3886),l=n(3795),d=n(1671),f=n(2731),p=n(52),m=n(3017),g=n(1053);function v(e,t,n){if(e.isInline){var r=t.length,a=n.attachmentWell.inlineAttachments.length;m.a.import().then((function(e){for(var i=0;i<r;i++){var o=n.attachmentWell.inlineAttachments[a-r+i];e(n.inlineImage,n,o.placeholderId,t[i])}}))}}function h(e,t,n,a,m,h,b){return Object(r.__awaiter)(this,void 0,void 0,(function(){var y,_,O;return Object(r.__generator)(this,(function(S){switch(S.label){case 0:y=!1,_=Object(f.a)(t.smimeViewState),t.itemId||_||(y=!0,i(t,t.numberOfWaitingAttachments+1)),S.label=1;case 1:return S.trys.push([1,,6,7]),(O=!t.itemId&&!_)?[4,Object(o.f)(t)]:[3,3];case 2:O=!S.sent(),S.label=3;case 3:return O?[4,Object(o.b)(t)]:[3,5];case 4:S.sent(),S.label=5;case 5:return function(e,t,n,a,i,o,u){var l=this;Object(f.a)(t.smimeViewState)?d.c.import().then((function(a){return Object(r.__awaiter)(l,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,a(e,Object(r.__assign)(Object(r.__assign)({},t.itemId),{mailboxInfo:Object(c.e)()}),t.attachmentWell,n,t)];case 1:return i=u.sent(),v(n,i,t),[3,3];case 2:return o=u.sent(),Object(s.o)("CreateSmimeAttachmentsFromFilesErrorDatapoint",{errorMessage:o.message},{isCore:!0}),p.d.warn(o),[3,3];case 3:return[2]}}))}))})):g.f.import().then((function(s){var l=s(t.attachmentWell,Object(r.__assign)(Object(r.__assign)({},t.itemId),{mailboxInfo:n.mailboxInfo?n.mailboxInfo:Object(c.e)()}),e,t,n,a,i,o,u);v(n,l,t)}))}(e,t,n,(function(e){a&&a(e),Object(l.a)()&&Object(u.a)(t,8)}),m,h,b),[3,7];case 6:return y&&i(t,t.numberOfWaitingAttachments-1),[7];case 7:return[2]}}))}))}n.d(t,"a",(function(){return h}))},3730:function(e){e.exports=JSON.parse('{"a":"Bfa","b":"Cfa","e":"Dfa","g":"Efa","d":"Ffa","c":"Gfa","f":"Hfa","i":"Ifa","h":"Jfa","j":"Kfa","k":"Lfa","l":"Mfa","m":"Nfa","n":"Ofa","o":"Pfa","q":"Qfa","p":"Rfa","r":"Sfa","s":"Tfa","t":"Ufa","u":"Vfa","v":"Wfa"}')},3731:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return f}));var r=n(0),a=n(880);function i(e){return s(e)?c(e).isMenu:e.AddinCommands.size>1}function o(e){return!!s(e)&&c(e).isActionable}function s(e){return 1==e.AddinCommands.size}function c(e){return e.AddinCommands.size>0?Object(r.__spread)(e.AddinCommands.values())[0]:null}function u(e){return s(e)?c(e).control.Supertip.Title:""}function l(e){var t=e.DisplayName;s(e)&&(t+=" - "+c(e).control.Supertip.Title);return t}function d(e,t,n){var i,o,s,c,u=a.k.EnabledAddinCommands;if(!u)return null;try{for(var l=Object(r.__values)(u.getExtensionPoint(n)),d=l.next();!d.done;d=l.next()){var f=d.value;if(f.Id==e&&f.AddinCommands.size>0)try{for(var p=(s=void 0,Object(r.__values)(f.AddinCommands.values())),m=p.next();!m.done;m=p.next()){var g=m.value;if(g.control.Id==t)return g}}catch(e){s={error:e}}finally{try{m&&!m.done&&(c=p.return)&&c.call(p)}finally{if(s)throw s.error}}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return null}function f(e){return a.k.compliance.isMinor&&(!function(e){return"Default"===e.TypeString}(t=e.extension)&&!function(e){return"Organization"===e.OriginString}(t)&&!function(e){return"Private"===e.TypeString}(t));var t}},3732:function(e){e.exports=JSON.parse('{"b":"Dda","a":"Eda","c":"Fda","g":"Gda","f":"Hda","d":"Ida","e":"Jda"}')},3761:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="Addins"},3793:function(e,t,n){"use strict";function r(e){return e.policyMatchDetails.slice().sort((function(e,t){var n=a(t.Action)-a(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n}))[0]}function a(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,"a",(function(){return r}))},3794:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},3795:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20);function a(){return Object(r.a)().PolicyTipsEnabled}},385:function(e,t,n){"use strict";var r=n(462),a="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||a||Function("return this")();t.a=i},386:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},3878:function(e,t,n){"use strict";var r=n(0),a=n(105),i=n(5),o=n(51),s=60,c=6e4;function u(e){var t=e.split("-");return{year:parseInt(t[0]),month:parseInt(t[1]),day:parseInt(t[2])}}function l(e){var t=Number(e).toFixed(2);return Number(t)}var d="Monday",f="Tuesday",p="Wednesday",m="Thursday",g="Friday",v="Saturday",h="Sunday",b=[d,f,p,m,g].join(" "),y=[v,h].join(" "),_=[b,y].join(" ");function O(e){switch(e){case"mon":return d;case"tue":return f;case"wed":return p;case"thu":return m;case"fri":return g;case"sat":return v;case"sun":return h;case"weekday":return b;case"weekendDay":return y;case"day":return _}return""}function S(e){switch(e){case d:return"mon";case f:return"tue";case p:return"wed";case m:return"thu";case g:return"fri";case v:return"sat";case h:return"sun";case b:return"weekday";case y:return"weekendDay";case _:return"day"}return""}var C="January",I="February",A="March",x="April",E="May",T="June",w="July",j="August",P="September",M="October",k="November",R="December";function D(e){switch(e){case"jan":return C;case"feb":return I;case"mar":return A;case"apr":return x;case"may":return E;case"jun":return T;case"jul":return w;case"aug":return j;case"sep":return P;case"oct":return M;case"nov":return k;case"dec":return R}return""}function N(e){switch(e){case C:return"jan";case I:return"feb";case A:return"mar";case x:return"apr";case E:return"may";case T:return"jun";case w:return"jul";case j:return"aug";case P:return"sep";case M:return"oct";case k:return"nov";case R:return"dec"}return""}var F="First",L="Second",U="Third",B="Fourth",H="Last";function G(e){switch(e){case"first":return F;case"second":return L;case"third":return U;case"fourth":return B;case"last":return H}return""}function W(e){switch(e){case F:return"first";case L:return"second";case U:return"third";case B:return"fourth";case H:return"last"}return""}function V(e){if(null==e.recurrenceType)return null;var t=function(e){var t,n=e.startTime,d=e.endTime,f=e.recurrenceType,p=e.timeZone,m=u(f.RecurrenceRange.StartDate),g=(d.getTime()-n.getTime())/c;if(Object(o.f)("addin-startTimeRecurenceChange")){var v=Object(i.Qb)(p,n.valueOf()).toString().split("T")[1].split(":");t=l(v[0])*s+l(v[1])}else t=n.getUTCHours()*s+n.getUTCMinutes()+Object(a.h)(n,p);var h={startYear:m.year,startMonth:m.month,startDay:m.day,startTimeMin:t,durationMin:g};if(f.RecurrenceRange.EndDate){var b=u(f.RecurrenceRange.EndDate);h=Object(r.__assign)(Object(r.__assign)({},h),{endDay:b.day,endMonth:b.month,endYear:b.year})}else h.noEndDate=!0;return h}(e),n={name:e.timeZone,offset:Object(a.h)(e.startTime,e.timeZone)},d=e.recurrenceType.RecurrencePattern;switch(d.__type){case"DailyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval},recurrenceType:"daily",seriesTimeJson:t,recurrenceTimeZone:n}}(d,t,n);case"WeeklyRecurrence:#Exchange":return function(e,t,n){if(1===e.Interval&&"weekday"===S(e.DaysOfWeek))return{recurrenceProperties:void 0,recurrenceType:"weekday",seriesTimeJson:t,recurrenceTimeZone:n};return{recurrenceProperties:{interval:e.Interval,days:e.DaysOfWeek.split(" ").map(S),firstDayOfWeek:S(e.FirstDayOfWeek)},recurrenceType:"weekly",seriesTimeJson:t,recurrenceTimeZone:n}}(d,t,n);case"AbsoluteMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfMonth:e.DayOfMonth},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(d,t,n);case"RelativeMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfWeek:S(e.DaysOfWeek),weekNumber:W(e.DayOfWeekIndex)},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(d,t,n);case"AbsoluteYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfMonth:e.DayOfMonth,month:N(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(d,t,n);case"RelativeYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfWeek:S(e.DaysOfWeek),weekNumber:W(e.DayOfWeekIndex),month:N(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(d,t,n)}return null}var z=60;function J(e,t,n,r){var a=Math.floor(r/z);return r-=a*z,new Date(Date.UTC(e,t-1,n,a,r))}function q(e,t){switch(e){case"daily":return function(e){return{__type:"DailyRecurrence:#Exchange",Interval:e.interval}}(t);case"weekday":return{__type:"WeeklyRecurrence:#Exchange",Interval:1,FirstDayOfWeek:"Monday",DaysOfWeek:"Monday Tuesday Wednesday Thursday Friday"};case"weekly":return function(e){return{__type:"WeeklyRecurrence:#Exchange",Interval:e.interval,FirstDayOfWeek:O(e.firstDayOfWeek),DaysOfWeek:e.days.map(O).join(" ")}}(t);case"monthly":return function(e){return e.dayOfMonth?{__type:"AbsoluteMonthlyRecurrence:#Exchange",DayOfMonth:e.dayOfMonth,Interval:e.interval}:{__type:"RelativeMonthlyRecurrence:#Exchange",Interval:e.interval,DaysOfWeek:O(e.dayOfWeek),DayOfWeekIndex:G(e.weekNumber)}}(t);case"yearly":return function(e){return e.dayOfMonth?{__type:"AbsoluteYearlyRecurrence:#Exchange",Month:D(e.month),DayOfMonth:e.dayOfMonth}:{__type:"RelativeYearlyRecurrence:#Exchange",Month:D(e.month),DaysOfWeek:O(e.dayOfWeek),DayOfWeekIndex:G(e.weekNumber)}}(t);default:return null}}function X(e,t,n){return e+"-"+Q(t)+"-"+Q(n)}function Q(e){return e<10?"0"+e:""+e}var K=n(74);function Z(e){if(null==e)return null;var t,n,r,a=e.seriesTimeJson,i=e.recurrenceProperties,o=e.recurrenceType,s=e.recurrenceTimeZone,c=a.startDay,u=a.startMonth,l=a.startYear,d=a.startTimeMin,f=a.durationMin;return t=s?s.name:Object(K.p)(),{recurrenceType:{__type:"RecurrenceType:#Exchange",RecurrenceRange:(n=a,r=X(n.startYear,n.startMonth,n.startDay),n.noEndDate?{__type:"NoEndRecurrence:#Exchange",StartDate:r}:{__type:"EndDateRecurrence:#Exchange",StartDate:r,EndDate:X(n.endYear,n.endMonth,n.endDay)}),RecurrencePattern:q(o,i)},timeZone:t,startTime:J(l,u,c,d),endTime:J(l,u,c,d+f)}}function Y(e,t,n){return e>=1601&&t>=1&&t<=12&&n>=1&&n<=31}function $(e,t,n){var r=new Date;return r.setFullYear(e),r.setMonth(t-1),r.setDate(n),r}function ee(e){return null==e||!!e.recurrenceType&&(!(!e.seriesTimeJson||!function(e){if(!e)return!1;if(!Y(e.startYear,e.startMonth,e.startDay))return!1;if(!e.noEndDate){if(!Y(e.endYear,e.endMonth,e.endDay))return!1;if($(e.startYear,e.startMonth,e.startDay)>=$(e.endYear,e.endMonth,e.endDay))return!1}return!(e.startTimeMin<0||e.durationMin<0)}(e.seriesTimeJson))&&!!function(e,t){switch(e){case"daily":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;return!0}(t);case"weekly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.days||e.days.length<1)return!1;if(!e.firstDayOfWeek)return!1;return!0}(t);case"monthly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"yearly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.month)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"weekday":return!t}}(e.recurrenceType,e.recurrenceProperties))}n.d(t,"a",(function(){return V})),n.d(t,"b",(function(){return Z})),n.d(t,"c",(function(){return ee}))},388:function(e,t,n){"use strict";var r=n(77),a=n(478),i=n(391),o=n(29),s=n(1),c=n(390),u=n(253),l=n(51),d=n(287),f=n(782),p=n(596),m=Object(o.a)((function(e){s.useEffect((function(){Object(l.f)("rp-popoutsDebug")||g()}),[]);return s.createElement("div",{className:p.view},Object(u.a)().state==d.a.Loading?s.createElement("span",null,s.createElement(f.a,null),e.loadingString):s.createElement("button",{onClick:g},"Get Data"))}));function g(){Object(c.a)()}var v=n(85);function h(e,t,n,r){var a="";if(r)a="readimid/",a+=encodeURIComponent(btoa(r));else{if(a=n?"readconv/":"read/",e&&e.type==v.a.GroupMailbox){a+="group/";var i=e.deprecatedMailboxId.split("@");a+=i[1]+"/"+i[0]+"/"}a+=encodeURIComponent(n||t)}return a}n.d(t,"g",(function(){return y})),n.d(t,"c",(function(){return a.a})),n.d(t,"h",(function(){return i.a})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return d.a})),n.d(t,"f",(function(){return u.a})),n.d(t,"d",(function(){return c.b})),n.d(t,"e",(function(){return h}));var b=new r.c((function(){return n.e(420).then(n.bind(null,13487))})),y=new r.b(b,(function(e){return e.bootPopout}))},3881:function(e,t,n){"use strict";var r=n(0),a=n(880),i="permission";n(2106);var o="DefaultSettings",s="0",c={cache:function(e,t){var n,c,u=e.addinCommand,d=u.extension,f="Preinstalled"===d.TypeString&&2!==d.ConsentState?function(e){var t,n=function(e){switch(e){case 1:return"ReadItem";case 2:return"ReadWriteMailbox";case 3:return"ReadWriteItem";default:return"Restricted"}}(e),r=Object(a.s)().ConsentUrl;if(r.indexOf("?")>0)t=(o=r.split("?"))[0]+"?"+i+"="+n+"&"+o[1];else if(r.indexOf("#")>0){var o;t=(o=r.split("#"))[0]+"?"+i+"="+n+"#"+o[1]}else t=r+"?"+i+"="+n;return t}(d.RequestedCapabilities):u.get_EntryPoint();c=l(f,t),n=function(e,t,n){var a=n._sourceLocations[t];return new OSF.Manifest.Manifest((function(t){t._id=e.get_Id(),t._version=e.extension.Version,t._extensionSettings={},t._displayNames={},t._defaultLocale="",t._displayNames[s]=e.extension.DisplayName,t._extensionSettings[o]=n,t._appDomains=Object(r.__spread)(e.extension.AppDomains,[a])}))}(u,t,c),OSF.OsfManifestManager.cacheManifest(u.extension.Id,u.extension.Version,n)}},u={cache:function(e,t){var n=e.addinCommand,r=e.controlId,a=e.sourceLocation,i=function(e,t,n,r){var a=OSF.OsfManifestManager.getCachedManifest(e.extension.Id,e.extension.Version),i=OfficeExt.AddinCommandsManifestManager.createManifestForAddinAction(a,r,null,t);return i._extensionSettings={},i._extensionSettings[o]=l(r,n),i}(n,r,t,a);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(i,r,n.extension.Version)}};function l(e,t){var n=new OSF.Manifest.ExtensionSettings;return n._sourceLocations={},n._sourceLocations[t]=e,n}var d=n(7230),f=n(7);var p=function(e){return function(){window.open(e.extension.EndNodeUrl)}};function m(e){switch(e){case 0:case 3:case 1:return 2;case 2:default:return 0}}var g=n(2),v=n(74),h=n(51),b={sets:[{name:"mailbox",maxVersion:"1.8"},{name:"DialogAPI"},{name:"react"}]},y=["progress.gif","agavedefaulticon96x96.png","moe_status_icons.png"],_=["moeerrorux.css"],O="resources/images/osfruntime/",S="resources/styles/osfruntime/";function C(){return Object(h.f)("addin-officejs-v2")?"16.01.alpha":"16.01"}function I(e,t,n){t.getLocalizedCSSFilePath=A(_,Object(g.q)()+S),t.getLocalizedImageFilePath=A(y,Object(g.q)()+O),t._notifyHostError=t._notifyHost,t._hostType="Outlook",t._hostPlatform="Web",t._hostSpecificFileVersion=C(),t.getRequirementsChecker().setRequirements(b)}function A(e,t){return function(n){var r=e.filter((function(e){return n==e}))[0];return(r=function(e){if(!Object(v.v)())return e;switch(e){case"moeerrorux.css":return"moerroruxrtl.css";default:return e}}(r))?t+r:""}}var x=n(2817),E=n(2660),T=function(e){return function(t,n){if(t){var r=t.ApiParams,a=D(t.MethodData.ControlId),i=t.MethodData.DispatchId;Object(x.i)(e,i,a,r,n)}}},w=function(e,t,n){Object(E.c)(e,n,t)},j=function(e,t,n){n.controlId=D(n.controlId),n.eventDispId=function(e){if(e==E.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID)return E.a.DISPLAY_DIALOG_DISPID;return e}(n.eventDispId),Object(E.j)(n,t)},P=[{name:"GetInitialData",isBlocking:!0,action:T},{name:"executeMethod",isBlocking:!1,action:function(e){return function(t,n){if(t){var r=D(t.DdaMethod.ControlId),a=t.DdaMethod.DispatchId;Object(x.i)(e,a,r,t,n)}}}},{name:"ExecuteMethod",isBlocking:!1,action:T}];function M(e){return[{name:"appCommandInvoked",registerAction:OfficeExt.AddinCommandsRuntimeManager.registerEvent,unregisterAction:OfficeExt.AddinCommandsRuntimeManager.unregisterEvent},{name:"dialogMessageReceived",registerAction:w,unregisterAction:j},{name:"dialogNotificationShown",registerAction:w,unregisterAction:j},{name:"olkItemSelectedChanged",registerAction:w,unregisterAction:j},{name:"olkAppointmentTimeChanged",registerAction:w,unregisterAction:j},{name:"olkRecipientsChanged",registerAction:w,unregisterAction:j},{name:"olkRecurrenceChanged",registerAction:w,unregisterAction:j},{name:"olkEnhancedLocationsChanged",registerAction:w,unregisterAction:j},{name:"olkAttachmentsChanged",registerAction:w,unregisterAction:j}]}function k(e,t){P.forEach((function(n){t.registerMethod(n.name,n.action(e),Microsoft.Office.Common.InvokeType.async,n.isBlocking)})),M().forEach((function(e){t.registerEventEx(e.name,e.registerAction,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,e.unregisterAction,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent)}))}function R(e,t){P.forEach((function(e){return t.unregisterMethod(e.name)})),M().forEach((function(e){return t.unregisterEvent(e.name)}))}function D(e){var t=Object(a.t)().activeDialog;return t&&t.controlId===e?t.parentControlId:e}var N=n(912),F=n(5226);function L(e,t,n){var r=t.addinCommand,i=t.controlId,o=t.isDialog,s=r.extension.Settings?JSON.parse(r.extension.Settings):{},c=function(e,t){var n=Object(N.c)(t);return JSON.stringify({userType:Object(F.a)(),userId:Object(g.f)(),extensionType:e.extension.TypeString,module:Object(g.b)(),deployment:Object(g.o)(),scenario:Object(a.z)(t),clientVersion:Object(g.g)(),isPinned:n.isAddinPinned(e.extension.Id),react:!0,disableLogging:!1})}(r,e);return{div:n,id:i,marketplaceID:o?i:r.extension.Id,marketplaceVersion:r.extension.Version,settings:s,store:"",storeType:OSF.StoreType.Exchange,hostCustomMessage:c,isDialog:o,isVirtualOsfControl:!1}}var U=n(9258),B=n(4644),H=n(165),G=function(){function e(e,t,n,a,i,o){var s,c,u=this;this.notifyHost=function(e,t,n){return Object(r.__awaiter)(u,void 0,void 0,(function(){var a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(a=this.notifyHostActions)&&(i=a[t])?[4,i(e,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},this.hostItemIndex=e,this.addinCommandTelemetry=o,this.contextActivationManager=(s=Object(v.j)(),c=this.notifyHost,OSF.AppSpecificSetup._setupFacade=I,new OSF.ContextActivationManager({appName:64,appVersion:C(),clientMode:1,appUILocale:s,lcid:s,notifyHost:c,dataLocale:"",hostControl:{},localizedScriptsUrl:OSF.getLocalizedStringsFilePath(),docUrl:""})),this.notifyHostActions=n||{},this.onInsertOsfControlAction=a,this.onDisplayNotificationAction=i,this.manifestCacheProvider=t;var l=this.notifyHostActions[8];this.notifyHostActions[8]=function(e,t){return Object(r.__awaiter)(u,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return l&&l(e,t),this.notifyHostError(e,t),this.tryTerminateUiLessAddin(t.errorCode,e),[2]}))}))},this.notifyHostActions[23]=this.sendTelemetryEvent.bind(this)}return e.prototype.insertOsfControl=function(e,t){k(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.activeOsfControl=e,this.extensionContainer=t,this.manifestCacheProvider.cache(e,Object(v.j)()),this.contextActivationManager.insertOsfControl(L(this.hostItemIndex,this.activeOsfControl,t))},e.prototype.purgeOsfControl=function(){if(this.activeOsfControl&&this.extensionContainer){var e=this.activeOsfControl.controlId;R(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),Object(E.b)(e),this.contextActivationManager.purgeOsfControl(e,!1),this.activeOsfControl=null,this.extensionContainer=null}},e.prototype.onInsertOsfControl=function(){var e=this.activeOsfControl.addinCommand.extension;("User"==e.OriginString||"Organization"==e.OriginString)&&a.k.Context&&a.k.Context.IsInOrgMarketplaceRole&&this.tryDisplayNotification(e.AppStatus,e.LicenseType),this.onInsertOsfControlAction&&this.onInsertOsfControlAction()},e.prototype.notifyAgave=function(e){var t=this.activeOsfControl.controlId;this.contextActivationManager.notifyAgave(t,e)},e.prototype.updateHostItemIndex=function(e){R(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.hostItemIndex=e,k(e,this.contextActivationManager._serviceEndPoint)},e.prototype.dispose=function(){this.contextActivationManager.dispose(),this.contextActivationManager=null},e.prototype.notifyHostError=function(e,t){var n=this.activeOsfControl.addinCommand;Object(B.e)(!1,n,this.hostItemIndex,Object(a.r)(e),this.addinCommandTelemetry,e,t.errorCode)},e.prototype.sendTelemetryEvent=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,n,a,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(h.f)("addin-oteljs")?[4,Object(H.g)(t.telemetryProperties.ariaTenantToken)]:[3,2];case 1:e=r.sent(),n=Object(U.a)(t,[],Date.now()),a=this.activeOsfControl,i=a.addinCommand,o=a.controlId,Object(B.a)(n,i,this.hostItemIndex,o),e.logEvent(n),r.label=2;case 2:return[2]}}))}))},e.prototype.displayNotification=function(e){this.contextActivationManager.displayNotification(e),this.onDisplayNotificationAction&&this.onDisplayNotificationAction(e)},e.prototype.tryDisplayNotification=function(e,t){var n=this.activeOsfControl,r=n.addinCommand,a=n.controlId;if(e){var i=function(e,t,n){var r="",a="",i=!1,o=!1;switch(n){case"1.0":r=Object(f.a)(d.b),a=Object(f.a)(d.l),i=!0,o=!0;break;case"1.1":r=Object(f.a)(d.c),a=Object(f.a)(d.l),i=!0,o=!0;break;case"1.2":r=Object(f.a)(d.d),a=Object(f.a)(d.l),i=!0,o=!0;break;case"2.0":r=Object(f.a)(d.e),a=Object(f.a)(d.l);break;case"2.1":r=Object(f.a)(d.f),a=Object(f.a)(d.l);break;case"3.0":r=Object(f.a)(d.g),a=Object(f.a)(d.k);break;case"3.1":r=Object(f.a)(d.h),a=Object(f.a)(d.k);break;case"3.2":r=Object(f.a)(d.i),a=Object(f.a)(d.k);break;case"3.3":r=Object(f.a)(d.j),a=Object(f.a)(d.k);break;default:return null}return{infoType:1,id:e,title:Object(f.a)(d.m),description:r,buttonTxt:a,buttonCallback:p(t),detailView:i,displayDeactive:o,reDisplay:!0}}(a,r,e);i&&this.displayNotification(i)}else 1==t&&this.displayNotification(function(e,t){return{infoType:2,id:t,title:Object(f.a)(d.n),description:Object(f.a)(d.o),buttonTxt:Object(f.a)(d.a),buttonCallback:function(){window.open(e.extension.EndNodeUrl)},reDisplay:!0}}(r,a))},e.prototype.tryTerminateUiLessAddin=function(e,t){if(1042==e){Object(a.cb)(t,this.hostItemIndex,a.d.TimedOut,{allowEvent:!1})}},e}();n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return G}))},3886:function(e,t,n){"use strict";var r=n(7),a=n(4871),i=n(1203),o=n(2955),s=n(24),c=n(0);function u(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(c.__assign)({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),Object(s.a)("GetDlpPolicyTips",e,t)}var l=n(206),d=n(1317),f=n(104),p=n(2791),m=n(3793),g=n(51),v=n(52),h=Object(f.action)("triggerPolicyTips")((function(e,t,n,r,i){var o,s=e.policyTipsViewState;if(!(s.handlerDisabled||Object(g.f)("cmp-dlp-check-irmdata")&&(null===(o=e.protectionViewState)||void 0===o?void 0:o.IRMData))){var c,l=s.inProgressPolicyMatch,f=s.succeededPolicyMatch,m=s.pendingPolicyMatch;if(n||(n=_(e.subject)),r||(r=_(e.content)),i||(i=Object(a.a)(e)),s.isRequestInProgress)s.pendingRequests=!0,m.itemId=e.itemId,m.subjectChecksum=n,m.contentChecksum=r,m.eventTrigger=t,m.attachmentIds=i;else{if(s.pendingRequests=!1,l.itemId=e.itemId,l.subjectChecksum=n,l.contentChecksum=r,l.eventTrigger=t,l.attachmentIds=i,0==(c=l).subjectChecksum&&0==c.contentChecksum&&0==c.attachmentIds.length)return f.policyMatchDetails=[],f.subjectChecksum=0,f.contentChecksum=0,f.attachmentIds=[],void Object(d.a)(e,"dlpPolicyTips");(O(l,f)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(l,f)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,a=e.itemId;if(null==a?void 0:a.Id){var i={ItemId:a,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:O(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(p.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,u(i).then((function(t){!function(e,t,n,r){var a=t.policyTipsViewState,i=a.pendingPolicyMatch;a.isRequestInProgress=!1,a.pendingRequests&&i&&h(t,i.eventTrigger,i.subjectChecksum,i.contentChecksum,i.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,b,y)}))}}(e)}}}));t.a=h;function b(e,t){var n,r=e.policyTipsViewState,a=r.succeededPolicyMatch,s=r.inProgressPolicyMatch;a.itemId=s.itemId,a.attachmentIds=s.attachmentIds,a.subjectChecksum=s.subjectChecksum,a.contentChecksum=s.contentChecksum,a.policyMatchDetails=t.Matches,t.ScanResultData&&(a.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(a.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(r.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(o.a)(n,r,(function(e,t){return t||e}))}}(e,t.CustomizedStrings),n=e,Object(d.a)(n,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(m.a)(n.policyTipsViewState.succeededPolicyMatch)&&(Object(l.a)()?Object(i.a)(n,"consumerDlpPolicyTips"):Object(i.a)(n,"enterpriseDlpPolicyTips"))}function y(e,t){var n=e.policyTipsViewState;t?(v.d.warn(Object(r.b)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(v.d.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(v.d.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(d.a)(e,"dlpPolicyTips")}function _(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function O(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},389:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},390:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var r,a=n(0),i=n(391),o=n(355),s=n(287),c=n(253),u=!1;function l(){Object(i.a)(s.a.Loading),r?r():u=!0}function d(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return u?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(c.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var a=Object(o.b)(n);if(a&&a.type==o.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(a.serializedData):JSON.parse(a.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var a=window.opener;Object(o.c)(a,o.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},391:function(e,t,n){"use strict";var r=n(253),a=n(4);t.a=Object(a.mutatorAction)("setPopoutChildState",(function(e){Object(r.a)().state=e}))},3985:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=0),{shouldEncryptMessageAsSmime:e,shouldSignMessageAsSmime:t,signingCertRawData:null,errorCode:n,errorContext:0,smimeBccForkingMode:0,currentBccRecipientIndex:-1}};function a(e){switch(e){case 6:return r(!0,!1);case 10:case 11:return r(!1,!0);case 12:case 13:case 14:return r(!0,!0);case-1:case 0:default:return r()}}},3986:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s}));var r="msip_labels",a="X-MS-Exchange-Organization-ModifySensitivityLabel",i="00000000-0000-0000-0000-000000000000",o="Standard",s="Privileged"},3987:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},a="messageClassification"},3988:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(389),a=n(1110),i=n(839),o=n(1664),s=n(3794),c=n(51),u=n(4876);function l(e){var t=Object(r.a)({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:a.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:a.f,AdditionalProperties:[Object(i.a)({FieldURI:"ItemLastModifiedTime"})]});return Object(u.a)(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(c.f)("rp-replyImageProxy")&&Object(o.a)()?s.a.OwaConnectorsProxyAndCompose:s.a.None,t}},4052:function(e,t,n){"use strict";var r=n(4278),a=n(3630),i=n(995),o=n(20),s=n(206);var c=n(4539);function u(){var e,t,n=(e=Object(o.a)(),t=Object(s.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault,Object(i.c)(t)?t:Object(a.a)()),u=Object(a.a)();if(u===n&&Object(c.a)(n)){var l=Object(r.b)(u,!0);if(l&&l.length>0)return l[0]}return n}var l=n(5343),d=n(838);function f(e){var t;if(e){var n=Object(d.j)(),r=null==n?void 0:n.items,a=r&&r.has(e.Id)&&r.get(e.Id);t=a&&Object(l.a)(a.ToRecipients,a.CcRecipients)}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||u(),Name:Object(o.a)().SessionSettings.UserDisplayName}}n.d(t,"a",(function(){return f}))},4102:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"g",(function(){return p}));var r="27797656-b5ea-4db3-8043-0230f0b4d6d6",a="translate.buttonDesktop1_1",i="https://ogma.osi.office.net/outlooktranslatorapp/desktop",o="https://ogma.osi.office.net",s="https://ogma.osi.office.net/outlooktranslatorapp/desktop",c="1.0.8.1",u="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",l="Translator",d="Help you translate messages in your preferred language across devices",f="Microsoft",p="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon128x128.png"},411:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(r||(r={}))},413:function(e,t,n){"use strict";function r(e,t){var n=t.filter((function(t){return t.Name===e}));return n.length>0?n[0].Id:null}function a(e,t){var n=t.filter((function(t){return t.Id===e}));return n.length>0?n[0].Name:null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},4136:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(880);function a(e){var t=Object(r.A)("NonPersistent");!t||e&&t.hostItemIndex!==e||Object(r.bb)("NonPersistent")}},4137:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r={};function a(){return r}},4138:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(6480),a=n(4137),i=n(6441);function o(e,t){s(Object(r.a)(e),t)}function s(e,t){var n=t?t.addinId:"",r=t?t.commandId:"";Object(a.a)()[e]=t||void 0,Object(i.b)(e,n,r)}},4139:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(1),i=n(2981),o=n(3881),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=function(e){e&&(r.extensionContainer=e,r.osfControlAdapter.insertOsfControl(r.props,r.extensionContainer))},r.handlerContainerOnFocus=function(){r.notifyAgave(11)},r.osfControlAdapter=r.props.osfControlAdapter?r.props.osfControlAdapter:new o.c(t.hostItemIndex,t.manifestCacheProvider,t.notifyHostActions,t.onInsertOsfControl,t.onDisplayNotification,t.addinCommandTelemetry),r}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){Object(i.c)()&&this.isNewHostItemIndex(e)&&this.osfControlAdapter.updateHostItemIndex(e.hostItemIndex)},t.prototype.shouldComponentUpdate=function(e){return this.isNewOsfControl(e)},t.prototype.componentWillUpdate=function(){this.osfControlAdapter.purgeOsfControl()},t.prototype.componentDidUpdate=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillUnmount=function(){this.osfControlAdapter.purgeOsfControl(),this.osfControlAdapter.dispose(),this.osfControlAdapter=null},t.prototype.notifyAgave=function(e){this.osfControlAdapter.notifyAgave(e)},t.prototype.isNewOsfControl=function(e){return this.props.controlId!=e.controlId},t.prototype.isNewHostItemIndex=function(e){return this.props.hostItemIndex!=e.hostItemIndex},t.prototype.render=function(){return this.extensionContainer&&this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer),a.createElement("div",{tabIndex:0,ref:this.refCallback,style:this.props.style,className:this.props.className,onFocus:this.handlerContainerOnFocus})},t}(a.Component)},4278:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(3630),a=n(4539),i=n(20),o=n(206);function s(e){var t=[],n=Object(r.a)();Object(a.a)(n)||t.push(n);var o=c(n,e);return t=function(e){var t=Object(i.a)().SessionSettings.ConnectedAccountInfos;t&&t.length>0&&t.forEach((function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}));return e}(t=t.concat(o))}function c(e,t){var n=[];if(Object(o.a)()||t){var r=function(e){return u(e,Object(i.a)().SessionSettings.UserProxyAddresses)}(e);n=n.concat(r)}if(Object(o.a)()){var a=function(e){return u(e,Object(i.a)().SessionSettings.NotManagedEmailAddresses)}(e);n=n.concat(a)}return n}function u(e,t){var n=[];return t&&t.length>0&&t.forEach((function(t){e==t||Object(a.a)(t)||n.push(t)})),n}},4279:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(20);function a(e,t){return e===t||e&&t&&e.toLowerCase()==t.toLowerCase()}function i(e){return e&&a(e.EmailAddress,Object(r.a)().SessionSettings.UserEmailAddress)}},4280:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r="<div id=appendonsend></div>";function a(e){var t="";return"HTML"==e&&(t+=r),t}},4281:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1523),a=n(208),i=n(1703),o=n(1544);function s(e){return Object(o.a)({Path:Object(a.a)(e.ExtendedFieldURI),Item:Object(i.a)({ExtendedProperty:[Object(r.a)(e)]})})}},4376:function(e,t,n){"use strict";var r=n(0),a=n(1397),i=n(963),o=n(24);function s(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"UpdateClientExtensionNotificationsJsonRequest:#Exchange"},n)),Object(o.a)("UpdateClientExtensionNotifications",e,t)}var c=n(153);function u(e,t,n){var a,i=(a={ItemId:t,Id:e,Notifications:n},Object(r.__assign)({__type:"UpdateClientExtensionNotificationsRequest:#Exchange"},a));return s({Header:Object(c.a)(),Body:i})}var l=n(912),d=n(1314);function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o,s,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(n=Object(l.c)(e),!(o={Id:n.getItemId()}).Id)throw new a.a(i.b.CannotPersistPropertyInUnsavedDraftError);return s=Object(d.d)(e,t),c=Object.keys(s).map((function(e){var t=s[e];return{Key:t.Key,Type:t.Type,Message:t.Message,Icon:t.Icon}})),[4,u(t,o,c).catch((function(e){throw new a.a(i.b.PersistedNotificationArraySaveError)}))];case 1:return r.sent(),[2]}}))}))}n.d(t,"a",(function(){return f}))},4441:function(e,t,n){"use strict";var r=n(4645);n.d(t,"a",(function(){return r.a}));var a=n(4748);n.d(t,"b",(function(){return a.a}))},4539:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20),a=n(206);function i(e){var t=!1;if(Object(a.a)()){var n=Object(r.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}},454:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},455:function(e,t,n){"use strict";var r=n(324),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,s=r.a?r.a.toStringTag:void 0;var c=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var a=o.call(e);return r&&(t?e[s]=n:delete e[s]),a},u=Object.prototype.toString;var l=function(e){return u.call(e)},d="[object Null]",f="[object Undefined]",p=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:d:p&&p in Object(e)?c(e):l(e)}},4554:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(910),i=n(962),o=n(849);function s(e){var t,n,s=[];try{for(var c=Object(r.__values)(e),u=c.next();!u.done;u=c.next()){var l=u.value,d=null;l.attachmentType==a.j.Item?d={fileType:i.a.MailItem,name:l.name,size:l.size,itemId:l.id}:l.attachmentType==a.j.File&&(d={fileType:i.a.Uri,name:l.name,size:l.size,uri:l.id,type:Object(o.b)(l.id)}),d&&s.push({file:d,isInline:l.isInline})}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return s}},4560:function(e){e.exports=JSON.parse('{"a":"gea"}')},459:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(9),a=n(152),i=n(250),o=Object(a.b)((function(e,t){var n,a=Object(i.a)(e),o={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent"},rootHovered:{color:e.palette.themePrimary,selectors:(n={},n[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent",borderColor:"transparent"},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(r.concatStyleSets)(a,o,t)}))},460:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(1),i=n(251),o=n(151),s=n(336),c=n(459),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return a.createElement(i.a,r.__assign({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Object(c.a)(n,t),onRenderDescription:o.b}))},t=r.__decorate([Object(s.a)("ActionButton",["theme","styles"],!0)],t)}(o.a)},461:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(13),a=n(1);function i(e){return{get:e}}function o(e,t){return Object(a.useMemo)((function(){return Object(r.computed)(e)}),t).get()}},462:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(45))},463:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},4638:function(e,t,n){"use strict";var r=n(5189),a=n(1460),i=n(4136),o=n(5277),s=n(1),c=n(150),u=n(29),l=n(3732),d=n(7),f=n(6576),p=n(5278),m=n(2981),g=n(7228),v=Object(u.a)((function(e){return s.createElement("div",{className:g.divContainer},s.createElement("div",null,Object(d.a)(l.b)," ",s.createElement("a",{href:"",onClick:function(t){t.stopPropagation(),t.preventDefault(),e.onClickUninstall&&e.onClickUninstall(),Object(m.b)()&&Object(p.a)()}},Object(d.a)(l.a))))})),h=n(460),b=n(480),y=n(3881),_=n(561),O=n(217),S=n(2181),C=n(3731),I=n(4139),A=(n(2106),n(880)),x=n(7231),E=Object(u.a)((function(e){var t=s.useRef(),n=function(){t.current.focus()},r=Object(A.t)();if(!r.runningContextualAddinCommand)return s.createElement("div",null);var a,i,o=r.contextualCalloutState.contextualAnchor,c=r.runningContextualAddinCommand,u=c.hostItemIndex,l=c.addinCommand,d=(a=r.contextualCalloutState.activeContextualAddinCommands,i=l,a.map((function(e){var t,n=e.get_Id()===i.get_Id();return{key:e.get_Id(),className:n&&x.selected,text:e.detectedEntity.Label,onClick:(t=e,function(){var e=Object(A.t)().runningContextualAddinCommand,n=e.hostItemIndex,r=e.addinCommand;t.get_Id()!==r.get_Id()&&Object(f.a)(n,t)})}}))),p={height:l.detectedEntity.RequestedHeight?l.detectedEntity.RequestedHeight+"px":"350px"},m={};m[13]=n,m[14]=n,m[15]=T;var g=Object(C.f)(l)?s.createElement(v,{onClickUninstall:T}):s.createElement(I.a,{addinCommand:r.runningContextualAddinCommand.addinCommand,controlId:r.runningContextualAddinCommand.controlId,hostItemIndex:u,manifestCacheProvider:y.a,style:p,notifyHostActions:m});return s.createElement(_.a,{gapSpace:0,target:o,onDismiss:T,setInitialFocus:!0,calloutWidth:parseInt("570px"),beakWidth:19,className:x.divContainer},s.createElement(O.a,{className:x.appIcon,iconName:"OfficeAddinsLogo"}),s.createElement("div",{className:x.divider}),s.createElement(S.a,{componentRef:function(e){t.current=e},items:d,className:x.contextualBar,onRenderItem:w,onRenderOverflowButton:j}),s.createElement("div",{className:x.contextualAddinFrame},g))}));function T(){Object(A.t)().activeDialog||(Object(A.t)().contextualCalloutState.contextualAnchor.focus(),Object(A.Z)())}function w(e){return s.createElement(h.a,{className:e.className,onClick:e.onClick,text:e.text,ariaLabel:e.text})}function j(e){return s.createElement(b.a,{menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:Object(d.a)(l.c)})}var P=n(7233),M=n(777),k=n(299),R=n(2660),D=n(7234),N=Object(u.a)((function(e){var t=Object(A.t)().activeDialog,n=s.useCallback((function(){return F(t.parentControlId)}),[null==t?void 0:t.parentControlId]);if(!t)return s.createElement("div",{className:D.divContainer});if(t.isOpen&&1==t.dialogType){var r=Object(A.n)(t.parentControlId),a=r.extension.DisplayName,i={height:t.heightInPercentage+"vh",width:t.widthInPercentage+"vw",overflow:"hidden"},o=Object(d.a)(P.a);o&&(o=o.replace("{0}",a));var c={};return c[15]=F,s.createElement(M.a,{hidden:!t.isOpen,onDismiss:n,dialogContentProps:{type:k.a.close,title:a,closeButtonAriaLabel:o},modalProps:{isBlocking:!0,containerClassName:D.dialogContainer},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},s.createElement(I.a,{addinCommand:r,controlId:t.controlId,isDialog:!0,hostItemIndex:t.hostItemIndex,sourceLocation:t.url,manifestCacheProvider:y.b,notifyHostActions:c,style:i}))}return s.createElement("div",{className:D.divContainer})}));function F(e){Object(R.j)({eventDispId:R.a.DISPLAY_DIALOG_DISPID,controlId:e})}var L=n(6424),U=n(7246),B=Object(u.a)((function(e){var t=A.k.activeDialog,n=!1;t&&t.parentControlId==e.controlId&&2==t.dialogType&&(n=!0);var r=e.addinCommand,a=r.extension.ConsentState,i=r.extension.Type,o=2!=a&&"Preinstalled"==i?U.consentContainer:U.uiLessContainer,c=n?"":U.hiddenContainer;return s.createElement("div",null,s.createElement(M.a,{hidden:!1,onDismiss:function(){Object(R.j)({eventDispId:R.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID,controlId:e.controlId})},dialogContentProps:{type:k.a.normal,title:r.extension.DisplayName},modalProps:{isBlocking:n,containerClassName:U.dialogContainer,className:c},forceFocusInsideTrap:n,containerClassName:U.dialogContainer,isClickableOutsideFocusTrap:!0},s.createElement("div",{className:o},e.children)))})),H=n(0),G=n(7248),W=n(449),V=n(2817),z=n(4),J=Object(z.action)("onUILessExecutionCompleted",(function(e,t,n,r,a){return{addinCommand:e,controlId:t,hostItemIndex:n,args:r,status:a}}));Object(z.orchestrator)(J,(function(e){var t=e.args?e.args.completedContext:void 0,n=Object(A.J)(e.addinCommand);Object(A.cb)(e.controlId,e.hostItemIndex,e.status,t),n&&e.status==A.d.Success&&Object(A.P)(e.hostItemIndex)}));var q,X=J,Q=n(165),K=n(2),Z=n(7249),Y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.addDisplayNotification=function(e){Object(V.c)(r.props.hostItemIndex,r.props.controlId,!1,""+r.props.extendedAddinCommand.addinCommand.get_Id()+r.infoBarId++,Object(y.d)(e.infoType),e.description)},r.addGenericErrorNotification=function(){var e=Object(d.b)(Object(d.a)(G.b),r.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName());Object(V.c)(r.props.hostItemIndex,r.props.controlId,!1,r.props.extendedAddinCommand.addinCommand.get_Id(),2,e,r.props.extendedAddinCommand.addinCommand.get_Size16Icon())},r.invokeAppCommand=function(){r.props.extendedAddinCommand.addinCommandTelemetry.setExecutionStartTime();var e=r.props.extendedAddinCommand.addinCommand.getControl(),t=e.Action.FunctionName,n={source:{id:e.Id}};r.props.disableProgressBar||r.addProgressNotification(),OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(r.props.controlId,t,n,r.onEventCompleted)},r.onEventCompleted=function(e,t){r.props.disableProgressBar||r.removeProgressNotification(),e!=A.d.Success&&Object(A.I)(r.props.hostItemIndex)&&r.addGenericErrorNotification(),r.props.extendedAddinCommand.addinCommandTelemetry.setExecutionEndTime(),Object(A.J)(r.props.extendedAddinCommand.addinCommand)&&Object(Q.o)("AddinExecutionCompleted",{id:r.props.extendedAddinCommand.addinCommand.extension.Id,controlId:r.props.controlId,owa_1:Object(K.b)(),owa_2:Object(A.z)(r.props.hostItemIndex),executionEndTime:r.props.extendedAddinCommand.addinCommandTelemetry.getExecutionEndTime()}),X(r.props.extendedAddinCommand.addinCommand,r.props.controlId,r.props.hostItemIndex,t,e)},r.infoBarId=0,r}return Object(H.__extends)(t,e),t.prototype.removeProgressNotification=function(){Object(V.m)(this.props.hostItemIndex,this.props.controlId,this.props.extendedAddinCommand.addinCommand.get_Id())},t.prototype.addProgressNotification=function(){var e=Object(d.b)(Object(d.a)(G.a),this.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName(),this.props.extendedAddinCommand.addinCommand.get_Label());Object(V.c)(this.props.hostItemIndex,this.props.controlId,!1,this.props.extendedAddinCommand.addinCommand.get_Id(),1,e)},t.prototype.render=function(){var e={};return e[8]=this.addGenericErrorNotification,s.createElement(I.a,{addinCommand:this.props.extendedAddinCommand.addinCommand,addinCommandTelemetry:this.props.extendedAddinCommand.addinCommandTelemetry,controlId:this.props.controlId,hostItemIndex:this.props.hostItemIndex,manifestCacheProvider:y.a,onInsertOsfControl:this.invokeAppCommand,onDisplayNotification:this.addDisplayNotification,notifyHostActions:e,className:Z.uiLessContainer})},t=Object(H.__decorate)([W.observer],t)}(s.Component),$=Object(u.a)((function(e){var t=[];return Object(A.t)().runningUILessExtendedAddinCommands.forEach((function(e,n){e.forEach((function(e,r){e.addinCommandTelemetry.setExecutionInitTime();var a=e.addinCommand,i=Object(A.J)(a);t.push(s.createElement(B,{hostItemIndex:n,controlId:r,addinCommand:a,key:r},s.createElement(Y,{extendedAddinCommand:e,controlId:r,hostItemIndex:n,disableProgressBar:i})))}))})),s.createElement("div",null,t)}));function ee(e){q||(q=document.createElement("div"),document.body.appendChild(q),c.render(s.createElement(s.StrictMode,null,s.createElement(te,{renderTaskPaneInPanel:e})),q))}function te(e){return s.createElement("div",null,e.renderTaskPaneInPanel&&s.createElement(L.a,{renderTaskPaneInPanel:!0}),s.createElement($,null),s.createElement(E,null),s.createElement(N,null))}var ne=n(6577),re=n(6578),ae=n(132);function ie(e){var t,n=e.map(oe);return n.push({key:(t=Object(re.a)()).key,name:t.name,itemType:t.itemType,iconProps:t.iconProps}),n}function oe(e){return{key:e.Id,name:e.DisplayName,itemType:ae.a.Normal,iconProps:Object(ne.a)(e.IconUrl)}}var se=n(51),ce=n(5196),ue=function(e,t){if(Object(se.f)("addin-autoRun")){var n=Object(A.p)(t).map((function(e){return new ce.d(e,new ce.b)}));Object(A.e)(n,e),Object(A.P)(e)}};n.d(t,"f",(function(){return r.a})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return i.a})),n.d(t,"g",(function(){return o.a})),n.d(t,"e",(function(){return ee})),n.d(t,"c",(function(){return ie})),n.d(t,"d",(function(){return ue}))},464:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(1),i=n(164),o=n(283),s=n(65),c=n(151),u=Object(i.a)(),l=function(e){function t(t){var n=e.call(this,t)||this,r=n.props.allowTouchBodyScroll,a=void 0!==r&&r;return n._allowTouchBodyScroll=a,n}return r.__extends(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(o.d)()},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(o.e)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,i=e.theme,o=e.styles,c=Object(s.j)(this.props,s.h),l=u(o,{theme:i,className:n,isDark:t});return a.createElement("div",r.__assign({},c,{className:l.root}))},t}(c.a)},4644:function(e,t,n){"use strict";var r=function(){return{tenantTokens:["56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696"]}},a=n(912),i=n(165),o=n(51),s=n(74),c=n(880),u=n(2),l=function(e,t,n,l,d,f,p){if(Object(o.f)("addin-launchDatapoint")){var m=function(e){if(Object(o.f)("addin-delegateAccess")){var t=Object(a.c)(e);if(t.isSharedItem)return t.isSharedItem()}return!1}(n),g=!!Object(c.J)(t);if(function(e,t,n,a,o,l,d,f,p){var m,g;f&&(m=f.getExecutionInitTime(),g=f.getExecutionStartTime());var v=new i.a("ExtAddinLaunched",r());v.addCustomData({id:t.extension.Id,name:t.extension.DisplayName,owa_1:Object(u.b)(),owa_2:Object(c.z)(n),owa_3:a,lang:Object(s.j)(),owa_4:t.extension.Type,errorCode:o,delegate:l,isAutoRun:d,executionInitTime:m,executionStartTime:g,controlId:p}),e?v.end():v.endWithError("Timeout",new Error("Add-in failed to load with code: "+o))}(e,t,n,l,p,m,g,d,f),e&&m&&function(e,t){var n=new i.a("ExtDelegateAddinLaunched",r());n.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,owa_1:Object(u.b)(),owa_2:Object(c.z)(t)}),n.end()}(t,n),e&&g){var v=function(e){return e.getLaunchEventType()}(t);!function(e,t,n,a,o){var s,c;a&&(s=a.getQueuePushTime(),c=a.getQueuePopTime());var u=new i.a("ExtAutoRunAddinLaunched",r());u.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,launchEventType:n,autoRunQueuePushTimeTime:s,autorunQueuePopTime:c,controlId:o}),u.end()}(t,0,v,d,f)}}};var d=9e5;function f(){var e=r();return e.timeout=d,new i.a("ExtItemSendEvent",e)}function p(e,t){e.addCustomData({owa_1:t}),e.end()}function m(e,t,n){e.addCustomData({reason:g(t),id:n.extension.Id,name:n.extension.DisplayName,module:Object(u.b)()}),e.end()}function g(e){if(e.status===c.d.Success)return e.allowEvent?4:2;switch(e.status){case c.d.TimedOut:return 16;case c.d.FunctionNotFound:return 8;default:return 32}}var v=n(5226),h=n(3338),b=n(954),y=n(38);function _(e,t,n,r){var i,o=Object(s.h)();e.properties["App.Name"]="Outlook",e.properties["App.Platform"]="Web",e.properties["App.Version"]=Object(u.g)(),e.properties["Release.AudienceGroup"]=function(){switch(Object(u.o)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";default:return"Production"}}(),e.properties["Release.Audience"]=Object(u.o)(),e.properties["User.TenantId"]=o.SessionSettings.ExternalDirectoryTenantGuid,e.properties["User.TenantGroup"]="outlookCom"===(i=Object(v.a)())||"gmail"===i?"Consumer":"Commercial",e.properties["User.PrimaryIdentitySpace"]=function(){switch(Object(v.a)()){case"outlookCom":return"MsaPuid";case"office365":return"OrgIdPuid";default:return"Unknown"}}(),e.properties["User.PrimaryIdentityHash"]=o.SessionSettings.UserPuid,e.properties["Browser.Name"]=Object(y.a)().browser,e.properties["Browser.Version"]=Object(y.a)().browserVersion.join("."),e.properties["Session.Id"]=function(e){if(void 0!==e)return(e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)).toLowerCase();return e}(Object(u.f)()),e.properties["Event.Time"]=(new Date).toISOString(),e.properties["Data.SDX.AppState"]=function(e){switch(Object(a.c)(e).mode){case b.a.MessageRead:return"MessageRead";case b.a.MessageCompose:return"MessageCompose";case b.a.AppointmentAttendee:return"AppointmentAttendee";case b.a.AppointmentOrganizer:return"AppointmentOrganizer";default:return"Unknown"}}(n),e.properties["Device.OsVersion"]="N/A",e.properties["Device.OsBuild"]="N/A",e.properties["Data.SDX.LaunchReason"]=function(e,t){if(Object(c.N)(e.extension.Id,t))return"Auto";if(Object(h.d)(e))return"Auto";return"Manual"}(t,r),e.properties["Data.SDX.CommandPlacement"]=function(e,t,n){if(Object(c.N)(e.extension.Id,n))return"OnSend";if(Object(h.d)(e))return"Persistent";if(e.detectedEntity)return"Contextual";return Object(a.c)(t).isAddinPinned(e.extension.Id)?"Ribbon":"Overflow"}(t,n,r),e.properties["Data.SDX.ActionType"]=function(e){switch(Object(c.r)(e)){case 2:return"ShowTaskpane";case 3:return"ExecuteFunction";case 1:return"Contextual";case 5:return"Dialog";case 4:return"Unknown"}}(r),e.properties["Data.ExEnv"]=Object(u.o)()}n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return _}))},4645:function(e,t,n){"use strict";var r=n(0),a=n(954),i=function(){function e(e){this.addinFactory=e}return e.prototype.activate=function(e){var t=this;return new Promise((function(n,r){var i=new Map;Object.values(a.a).filter((function(e){return isNaN(Number(a.a[e]))})).forEach((function(n){i.set(n,[]),e.forEach((function(e){var r=t.addinFactory.CreateAddinIfEntryPointSupported(e,n);r&&i.get(n).push(r)}))})),n(i)}))},e}(),o=n(2573),s=n(4638);var c=n(880),u=n(5196),l=n(3338);function d(e,t){var n=new u.c;return t.activate(e).then((function(e){Object.values(a.a).forEach((function(t){n.setExtensionPoint(e.get(t),t)}))})).then((function(){n.isInitialized=!0,Object(c.T)(n),function(e){var t={};[a.a.MessageRead,a.a.MessageCompose,a.a.AppointmentAttendee,a.a.AppointmentOrganizer].forEach((function(n){var r=e.getExtensionPoint(n);t[n]=Object(s.c)(r)})),o.k.importAndExecute(t)}(n);var t=e.map((function(e){return e.Id}));Object(l.g)(t)}))}var f=n(4748),p=n(2981),m=n(52);n.d(t,"a",(function(){return v}));var g=!1;function v(){var e=this;return new Promise((function(t,n){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if((g||Object(c.K)())&&!Object(c.L)())return Object(c.kb)(t),[2];Object(c.V)(!1),h(!0),[],e=new i(new c.c(new c.b)),n=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(f.a)()];case 2:return n=r.sent(),[3,4];case 3:return a=r.sent(),m.d.error(a),[3,4];case 4:return Object(c.U)(n),null!==(n=Object(c.s)())&&Object(p.a)()&&Object(c.R)(n.GenericInfo),[4,d(function(e){return(null==e?void 0:e.Extensions)?e.Extensions.filter((function(e){return e.Enabled&&null!=e.ExtensionPointCollection})):[]}(n),e)];case 5:return r.sent(),h(!1),t(),[2]}}))}))}))}function h(e){g=e}},470:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(0),a=n(1),i=n(9),o=n(164),s=n(142),c=n(594),u=n(332),l=n(49),d=n(310),f=n(259),p=n(162),m=n(65),g=n(411),v=n(472),h=n(349),b=Object(o.a)(),y=function(e){function t(n){var r=e.call(this,n)||this;return r._tooltipHost=a.createRef(),r._defaultTooltipId=Object(s.a)("tooltip"),r.show=function(){r._toggleTooltip(!0)},r.dismiss=function(){r._hideTooltip()},r._getTargetElement=function(){if(r._tooltipHost.current){var e=r.props.overflowMode;if(void 0!==e)switch(e){case g.a.Parent:return r._tooltipHost.current.parentElement;case g.a.Self:return r._tooltipHost.current}return r._tooltipHost.current}},r._onTooltipMouseEnter=function(e){var n=r.props,a=n.overflowMode,i=n.delay;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,void 0!==a){var o=r._getTargetElement();if(o&&!Object(c.b)(o))return}if(!e.target||!Object(u.a)(e.target,r._getTargetElement()))if(r._clearDismissTimer(),r._clearOpenTimer(),i!==h.a.zero){r.setState({isAriaPlaceholderRendered:!0});var s=r._getDelayTime(i);r._openTimerId=r._async.setTimeout((function(){r._toggleTooltip(!0)}),s)}else r._toggleTooltip(!0)},r._onTooltipMouseLeave=function(e){var n=r.props.closeDelay;r._clearDismissTimer(),r._clearOpenTimer(),n?r._dismissTimerId=r._async.setTimeout((function(){r._toggleTooltip(!1)}),n):r._toggleTooltip(!1),t._currentVisibleTooltip===r&&(t._currentVisibleTooltip=void 0)},r._onTooltipKeyDown=function(e){e.which===l.a.escape&&r._hideTooltip()},r._clearDismissTimer=function(){r._async.clearTimeout(r._dismissTimerId)},r._clearOpenTimer=function(){r._async.clearTimeout(r._openTimerId)},r._hideTooltip=function(){r._clearOpenTimer(),r._clearDismissTimer(),r._toggleTooltip(!1)},r._toggleTooltip=function(e){r.state.isTooltipVisible!==e&&r.setState({isAriaPlaceholderRendered:!1,isTooltipVisible:e},(function(){return r.props.onTooltipToggle&&r.props.onTooltipToggle(e)}))},r._getDelayTime=function(e){switch(e){case h.a.medium:return 300;case h.a.long:return 500;default:return 0}},Object(d.a)(r),r.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},r._async=new f.a(r),r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,o=e.content,s=e.directionalHint,c=e.directionalHintForRTL,u=e.hostClassName,l=e.id,d=e.setAriaDescribedBy,f=void 0===d||d,g=e.tooltipProps,h=e.styles,y=e.theme;this._classNames=b(h,{theme:y,className:u});var _=this.state,O=_.isAriaPlaceholderRendered,S=_.isTooltipVisible,C=l||this._defaultTooltipId,I=!!(o||g&&g.onRenderContent&&g.onRenderContent()),A=S&&I,x=f&&S&&I?C:void 0;return a.createElement("div",r.__assign({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._hideTooltip},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,"aria-describedby":x}),n,A&&a.createElement(v.a,r.__assign({id:C,content:o,targetElement:this._getTargetElement(),directionalHint:s,directionalHintForRTL:c,calloutProps:Object(p.a)({},t,{onDismiss:this._hideTooltip,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onWheel:this._hideTooltip},Object(m.j)(this.props,m.h),g)),O&&a.createElement("div",{id:C,style:i.hiddenContentStyle},o))},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:h.a.medium},t}(a.Component)},471:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(1),i=n(164),o=n(65),s=n(561),c=n(58),u=Object(i.a)(),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return a.createElement("p",{className:t._classNames.subText},e.content)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,i=e.directionalHint,c=e.directionalHintForRTL,l=e.styles,d=e.id,f=e.maxWidth,p=e.onRenderContent,m=void 0===p?this._onRenderContent:p,g=e.targetElement,v=e.theme;return this._classNames=u(l,{theme:v,className:t||n&&n.className,beakWidth:n&&n.beakWidth,gapSpace:n&&n.gapSpace,maxWidth:f}),a.createElement(s.a,r.__assign({target:g,directionalHint:i,directionalHintForRTL:c},n,Object(o.j)(this.props,o.h,["id"]),{className:this._classNames.root}),a.createElement("div",{className:this._classNames.content,id:d,role:"tooltip",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},m(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:c.DirectionalHint.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(a.Component)},472:function(e,t,n){"use strict";var r=n(291),a=n(471),i=n(9);n.d(t,"a",(function(){return o}));var o=Object(r.a)(a.a,(function(e){var t=e.className,n=e.beakWidth,r=void 0===n?16:n,a=e.gapSpace,o=void 0===a?0:a,s=e.maxWidth,c=e.theme,u=c.semanticColors,l=c.fonts,d=c.effects,f=-(Math.sqrt(r*r/2)+o);return{root:["ms-Tooltip",c.fonts.medium,i.AnimationClassNames.fadeIn200,{background:u.menuBackground,boxShadow:d.elevation8,padding:"8px",maxWidth:s,selectors:{":after":{content:"''",position:"absolute",bottom:f,left:f,right:f,top:f,zIndex:0}}},t],content:["ms-Tooltip-content",l.small,{position:"relative",zIndex:1,color:u.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"})},4744:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(880);function a(e,t){var n=Object(r.n)(t);return!!n&&n.get_Id()===e+"ItemSend"}},4745:function(e,t,n){"use strict";var r=n(2627),a=n(4);t.a=Object(a.mutatorAction)("updatePersistentTaskPaneError",(function(e){var t=Object(r.b)("Persistent");t&&(t.errorType=e)}))},4746:function(e,t,n){"use strict";var r=n(77),a=(n(5276),n(4747));n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return n.e(328).then(n.bind(null,9203))}));new r.b(i,(function(e){return e.logJank}))},4747:function(e,t,n){"use strict";t.a=function(){return window.performance?performance.now():Date.now()}},4748:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),a=n(2817),i=n(74),o=3,s=3e3,c=3,u=!0,l="1.8",d="1.1";function f(){return function e(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(f=t==o?0:s,new Promise((function(e,t){setTimeout((function(){e()}),f)})))];case 1:return r.sent(),[4,Object(a.k)(c,Object(i.m)(),u,l,d)];case 2:return[2,r.sent()];case 3:if(n=r.sent(),0==t)throw n;return[3,4];case 4:return[4,e(--t)];case 5:return[2,r.sent()]}var f}))}))}(o)}},4749:function(e,t,n){var r=n(7241),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},476:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n(1),i=n(244),o=n(164),s=n(65),c=n(545),u=n(151),l=Object(o.a)(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.type,n=e.size,o=e.ariaLabel,u=e.ariaLive,d=e.styles,f=e.label,p=e.theme,m=e.className,g=e.labelPosition,v=o,h=Object(s.j)(this.props,s.h,["size"]),b=n;void 0===b&&void 0!==t&&(b=t===i.b.large?i.a.large:i.a.medium);var y=l(d,{theme:p,size:b,className:m,labelPosition:g});return a.createElement("div",r.__assign({},h,{className:y.root}),a.createElement("div",{className:y.circle}),f&&a.createElement("div",{className:y.label},f),v&&a.createElement("div",{role:"status","aria-live":u},a.createElement(c.a,null,a.createElement("div",{className:y.screenReaderText},v))))},t.defaultProps={size:i.a.medium,ariaLive:"polite",labelPosition:"bottom"},t}(u.a)},478:function(e,t,n){"use strict";var r=n(0),a=n(38),i=600,o=800,s=8,c=25,u={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},l=-1;function d(e,t){try{t=function(e){var t=c*(1+(l=(l+1)%s)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),o)};return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u),n),e)}(t);var n=window.open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(a.d)()||Object(a.e)())&&n.moveTo(t.left,t.top),n}catch(e){return null}}var f=n(2),p=n(451),m=n(51),g=n(289),v="version";var h=n(83),b=n(388);t.a=Object(h.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,a,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,i,o,s){var c=function(e){var t=null,n=void 0;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,(Object(a.d)()||Object(a.g)()||Object(a.e)())&&(t=e.projectionTabId||null))),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t}}(n),u=c.deeplinkCallback,l=c.projectionTabId,h=d(l?"about:blank":function(e,t,n,r){var a;void 0===r&&(r={});var i=((a={})[v]=Object(f.g)(),a[g.c]=g.d,a);return Object(m.f)("rp-popout-lean-bootstrap")&&(i[g.a]=g.b),Object.keys(r).map((function(e){i[e]=r[e]})),Object(p.q)(e,t,n,i)}(e,t,i,s),r);h&&b.g.import().then((function(t){return t(e,h,l,u)}))}))},483:function(e,t,n){"use strict";var r=n(0),a=n(104),i=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,a;if(this.store)throw new Error("MruCache cannot be initialized twice.");this.store=e,this.deleteCallback=t;try{for(var i=Object(r.__values)(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;this.mruList.push(s)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}},e.prototype.add=function(e,t){var n=this;Object(a.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(a.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(a.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return i}))},484:function(e,t,n){"use strict";var r=n(29),a=n(217),i=n(329),o=n(220),s=n(1),c=n(348),u=n(602),l=n(219).bind(u),d=Object(r.a)((function(e){var t={color:(e.categoryName?Object(i.a)(e.categoryName,e.categoryList?e.categoryList:Object(c.o)()):e.categoryColorId?o.a.colorCodeColorValueMap[e.categoryColorId]:Object(i.b)()).iconColor},n=l(u.categoryIcon,e.iconClassName);return s.createElement(a.a,{className:n,iconName:"TagSolid",style:t})}));t.a=d},485:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e,t){var n,a,i=[],o=!1,s=e.trim().toLocaleLowerCase();try{for(var c=Object(r.__values)(t),u=c.next();!u.done;u=c.next()){var l=u.value,d=l.Name.trim().toLocaleLowerCase();""!=d&&d.indexOf(s)>=0&&(i.push(l),d==s&&(o=!0))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}var f=e.toLocaleLowerCase().trim();return i.sort((function(e,t){var n=e.Name.toLocaleLowerCase().trim(),r=t.Name.toLocaleLowerCase().trim(),a=n.indexOf(f),i=r.indexOf(f);return a==i?n.localeCompare(r):a-i})),{suggestions:i,hasExactMatch:o}}},4871:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach((function(e){t.push(e.attachmentId)})),n.inlineAttachments.forEach((function(e){t.push(e.attachmentId)})),n.imageViewAttachments.forEach((function(e){t.push(e.attachmentId)}))),t}n.d(t,"a",(function(){return r}))},4872:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(838);function a(e,t){var n,a,i,o="";if(e){var s=r.x.items.get(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id);switch(t){case"smartReply":(null===(a=null==s?void 0:s.SmartReplyData)||void 0===a?void 0:a.ExtractionID)&&(o=s.SmartReplyData.ExtractionID);break;case"smartDoc":(null===(i=null==s?void 0:s.SmartDocData)||void 0===i?void 0:i.EntityId)&&(o=s.SmartDocData.EntityId)}}return o}},4873:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageMaxRecipientsExceed","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},4874:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(450);function a(e){return e?Object(r.a)({Id:e.Id,ChangeKey:e.ChangeKey}):null}},4875:function(e,t,n){"use strict";function r(e){if(e.smimeBccForkingMode){var t=e.smimeBccForkingMode;return 2===t||3===t}return!1}n.d(t,"a",(function(){return r}))},4876:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(51),a=n(208);function i(e){Object(r.f)("cmp-clp")&&e.AdditionalProperties.push(Object(a.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}))}},4894:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4554),a=n(1029);function i(e,t,n,i,o,s){var c={operation:0,bodyType:"HTML",subject:i,newContent:o,to:e,cc:t,bcc:n,preferAsyncSend:!0,attachmentFilesToUpload:Object(r.a)(s)};a.r.importAndExecute(c,2)}},5189:function(e,t,n){"use strict";var r=n(3731),a=n(912),i=n(3338),o=n(51),s=n(880);function c(e,t){var n,c=Object(a.c)(e);if(c){var u=c.mode,l=Object(i.c)(u);if(l){var d=Object(r.c)(l.addinId,l.commandId,u);if(null===(n=c.isSharedItem)||void 0===n||!n.call(c)||Object(o.f)("addin-delegateAccess")&&Object(s.f)(d))if(d&&!Object(r.f)(d)){var f=Object(s.x)();Object(s.W)(f,e,d,"Persistent",u,t)}else!d&&Object(s.K)()&&Object(i.h)(u,null)}}}var u=n(954),l={hostItemIndex:null,mode:u.a.Unknown,isNullSent:!1};function d(){return l}function f(e){l=e}function p(e){switch(Object(a.c)(e).mode){case u.a.MessageRead:case u.a.MeetingRequest:return u.a.MessageRead;case u.a.MessageCompose:return u.a.MessageCompose;default:return u.a.Unknown}}function m(){Object(s.bb)("Persistent"),f({hostItemIndex:null,mode:u.a.Unknown,isNullSent:!1})}var g=n(0),v=n(2817),h=n(2660);function b(e){var t=d();t.mode!==u.a.MessageCompose&&t.mode!==u.a.Unknown?(Object(s.ib)(e),t.isNullSent||(!function(){var e=Object(s.A)("Persistent");if(e){Object(h.d)(h.a.ITEM_CHANGED_EVENT_DISPID,e.controlId,null)}}(),f({hostItemIndex:null,mode:u.a.MessageRead,isNullSent:!0}))):m()}var y=n(4745);function _(e){Object(y.a)(0),Object(s.A)("Persistent")?(Object(s.jb)(e),function(e){Object(g.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(g.__generator)(this,(function(r){switch(r.label){case 0:return(t=Object(s.A)("Persistent"))?[4,Object(v.b)(t.controlId,e)]:[3,2];case 1:n=r.sent(),Object(h.d)(h.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,n),r.label=2;case 2:return[2]}}))}))}(e)):c(e),f({hostItemIndex:e,mode:p(e),isNullSent:!1})}var O=n(2981),S=n(1460);function C(e,t){if(Object(O.c)())switch(e){case S.a.NotSupported:m();break;case S.a.Empty:b(1);break;case S.a.Multi:b(2);break;case S.a.Single:t&&function(e){Object(v.g)(e)&&Object(s.K)()&&Object(i.e)()&&!function(e){var t=Object(a.c)(e);return t.mode===u.a.MessageRead&&t.isInlineComposeOpen()}(e)&&function(e){var t=Object(a.c)(e);return t.mode!==u.a.MessageRead||t.isItemSelected()}(e)&&!function(e){return e===d().hostItemIndex}(e)&&(function(e){var t=Object(a.c)(e),n=t.mode;return!(!Object(o.f)("addin-delegateAccess")&&t.isSharedItem&&t.isSharedItem())&&(n!==u.a.MessageRead||Object(s.Y)(t.getItem()))}(e)?function(e){return p(e)!==d().mode}(e)?function(e){Object(s.bb)("Persistent"),c(e),f({hostItemIndex:e,mode:p(e),isNullSent:!1})}(e):!function(e){var t=Object(a.c)(e),n=Object(s.A)("Persistent");return!!n&&(!Object(s.f)(n.addinCommand)&&!!(t&&t.isSharedItem&&t.isSharedItem()))}(e)?_(e):b(4):b(3))}(t)}}n.d(t,"a",(function(){return C}))},5196:function(e,t,n){"use strict";var r=n(0),a=n(880),i=n(954),o=n(51),s=function(){function e(){var e=this;this.getAutoRunAddinsByLaunchEventType=function(t){var n=e.getAddinsForMode(i.a.LaunchEvent),r=[],a=[];return(r=e.autoRunAddinsIndexMapping.get(t))&&r.map((function(e){a.push(n[e])})),a},this.setAutoRunAddinsMapping=function(t){t.forEach((function(t,n){Object(r.__spread)(t.AddinCommands.values()).forEach((function(t){var r=t.getLaunchEventType();e.setAutoRunAddinMapForLaunchEventType(r,n)}))}))},this.setAutoRunAddinMapForLaunchEventType=function(t,n){e.autoRunAddinsIndexMapping.has(t)?e.autoRunAddinsIndexMapping.get(t).push(n):e.autoRunAddinsIndexMapping.set(t,[n])},this.isInitialized=!1,this.appointmentAttendeeAddins=[],this.appointmentOrganizerAddins=[],this.detectedEntityAddins=[],this.messageReadAddins=[],this.messageComposeAddins=[],this.meetingRequestAddins=[],this.eventsAddins=[],this.autoRunAddins=[],this.autoRunAddinsIndexMapping=new Map}return e.prototype.getExtensionPoint=function(e,t){var n=this.getAddinsForMode(e);if(t){if(!Object(o.f)("addin-delegateAccess"))return[];n&&(n=Object(a.m)(n))}return n},e.prototype.setExtensionPoint=function(e,t){switch(t){case i.a.MeetingRequest:this.meetingRequestAddins=e;break;case i.a.AppointmentAttendee:this.appointmentAttendeeAddins=e;break;case i.a.AppointmentOrganizer:this.appointmentOrganizerAddins=e;break;case i.a.DetectedEntity:this.detectedEntityAddins=e;break;case i.a.MessageCompose:this.messageComposeAddins=e;break;case i.a.MessageRead:this.messageReadAddins=e;break;case i.a.TrapOnSendEvent:this.eventsAddins=e;break;case i.a.LaunchEvent:this.autoRunAddins=e,this.setAutoRunAddinsMapping(e)}},e.prototype.getAddinsForMode=function(e){switch(e){case i.a.MeetingRequest:return this.meetingRequestAddins;case i.a.AppointmentAttendee:return this.appointmentAttendeeAddins;case i.a.AppointmentOrganizer:return this.appointmentOrganizerAddins;case i.a.DetectedEntity:return this.detectedEntityAddins;case i.a.MessageCompose:return this.messageComposeAddins;case i.a.MessageRead:return this.messageReadAddins;case i.a.TrapOnSendEvent:return this.eventsAddins;case i.a.LaunchEvent:return this.autoRunAddins;default:return null}},e}(),c=n(4746),u=function(){function e(){}return e.prototype.setExecutionInitTime=function(){this.executionInitTime=Object(c.a)()},e.prototype.setExecutionStartTime=function(){this.executionStartTime=Object(c.a)()},e.prototype.setExecutionEndTime=function(){this.executionEndTime=Object(c.a)()},e.prototype.setQueuePushTime=function(){this.queuePushTime=Object(c.a)()},e.prototype.setQueuePopTime=function(){this.queuePopTime=Object(c.a)()},e.prototype.getExecutionInitTime=function(){return this.executionInitTime},e.prototype.getExecutionStartTime=function(){return this.executionStartTime},e.prototype.getExecutionEndTime=function(){return this.executionEndTime},e.prototype.getQueuePushTime=function(){return this.queuePushTime},e.prototype.getQueuePopTime=function(){return this.queuePopTime},e}(),l=function(e,t){this.addinCommand=e,this.addinCommandTelemetry=t,this.controlId=Object(a.x)()},d=function(){function e(){}return e.prototype.setExecutionInitTime=function(){this.executionInitTime=Object(c.a)()},e.prototype.setExecutionStartTime=function(){this.executionStartTime=Object(c.a)()},e.prototype.setExecutionEndTime=function(){this.executionEndTime=Object(c.a)()},e.prototype.getExecutionInitTime=function(){return this.executionInitTime},e.prototype.getExecutionStartTime=function(){return this.executionStartTime},e.prototype.getExecutionEndTime=function(){return this.executionEndTime},e}();n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}))},5226:function(e,t,n){"use strict";var r=n(20);function a(){return function(){var e=Object(r.a)().SessionSettings.WebSessionType;if(1===e)return"outlookCom";if(2===e)return"gmail";if(0==e)return"office365";return"unknown"}()}n.d(t,"a",(function(){return a}))},5276:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(0),n(4747);var r={currentAction:null,rootActions:[]};function a(e){return void 0===e&&(e=r),JSON.stringify(e.rootActions)}},5277:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4136),a=n(912),i=n(3338),o=n(880);function s(e,t,n,s){Object(r.a)(e);var c=Object(o.A)("Persistent");if(!(c&&(u=c.addinCommand,l=t,u&&l&&u.get_Id()===l.get_Id()))){var u,l,d=Object(a.c)(e);d.openTaskPane&&d.openTaskPane();var f=Object(o.x)();Object(o.W)(f,e,t,function(e,t){var n=Object(i.c)(t);if(!n)return"NonPersistent";var r=n.addinId,a=n.commandId;return e.get_Id()===""+r+a?"Persistent":"NonPersistent"}(t,n),n,s)}}},5278:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,a=n(1),i=n(150),o=n(5704),s=n(6415);function c(){Object(s.a)().then((function(e){i.render(a.createElement(o.a,{storeUrl:e,ref:function(e){return!!e&&e.setPanelOpen()}}),r)}))}r=document.createElement("div"),document.body.appendChild(r)},5341:function(e,t,n){"use strict";var r=n(0);t.a=function(e){return e&&0!==e.length?e.filter((function(e){return!!e})).reduce((function(e,t){return Object(r.__spread)(e,(null==(n=t)?void 0:n.recipients)?n.recipients.slice():[]);var n}),[]):[]}},5342:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",(function(){return r}))},5343:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(4278),i=n(4279);function o(e,t){return function(e,t){for(var n=0;n<t.length;n++)if(s(t[n],e))return t[n];return null}((e||[]).concat(t||[]),Object(a.a)(!0))}function s(e,t){var n,a;if(t&&t.length>0)try{for(var o=Object(r.__values)(t),s=o.next();!s.done;s=o.next()){var c=s.value;if(c&&Object(i.a)(e,c.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return!1}},5344:function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return S}));var r=n(0),a=n(5974),i=n(7),o=n(1317),s=n(2314),c=n(5345),u=n(51),l=n(2056),d=n(451),f="",p="",m="/owa",g="owahipcontrol.aspx",v="compose=1";function h(e,t){var n;if(e){e.WasclUpgradeToPremiumUrl&&(f=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(p=e.AccountRecoveryFlowUrl);var r=(null===(n=e.ResponseMessages)||void 0===n?void 0:n.Items)?e.ResponseMessages.Items[0]:null;!r||"ErrorExceededMessageLimit"!=r.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=r.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=r.ResponseCode||Object(s.b)(t,!0)}}function b(e){return{text:Object(i.a)(a.a),action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(f)}}}var y=null;function _(e){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}function O(e,t){var n,o=(null===(n=null===window||void 0===window?void 0:window.location)||void 0===n?void 0:n.pathname)||null;return{text:Object(i.a)(a.b),action:function(){var n;if(Object(u.f)("cmp-hipCheckModal")){if(null!==y)return;n=Object(r.__read)(Object(l.a)(c.a,t),1),(y=n[0]).then((function(t){var n=t.success;y=null,n&&_(e)}),(function(e){y=null}))}else _(e),window.open(Object(d.r)(m,o)+"/"+g+"?"+v)}}}function S(e){return{text:Object(i.a)(a.b),action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(p)}}}},5345:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(77),a=new r.c((function(){return Promise.all([n.e(1),n.e(648),n.e(396)]).then(n.bind(null,8458))})),i=Object(r.d)(a,(function(e){return e.HipCheckModal}))},5346:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),a=n(3988),i=n(51),o=n(1502),s=n(1269),c=n(1938),u=n(337),l=n(389),d=n(839),f=n(879),p=n(3267),m=n(153),g=n(20),v=n(1543);function h(e,t,n,h,b,y,_,O,S){var C,I=function(e,t,n,o,s,p,m,g,h){var b="PostItem:#Exchange"==e.__type?"newPost":"newMail",y=m?Object(f.a)({BaseFolderId:Object(u.a)({Id:m})}):null,_=Object(c.a)(Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:b,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",Items:[e],TimeFormat:o,SendOnNotFoundError:!0,RemoteExecute:g,ItemShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(d.a)({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:y,SuppressMarkAsReadOnReplyOrForward:Object(i.f)("tri-suppressMarkReadBehaviorOnRF")&&h},Object(v.a)()));return(null==p?void 0:p.IsOwner)&&(_.ComplianceId=p.RmsTemplateId?p.RmsTemplateId.toUpperCase():"0"),n?s&&(_.ItemShape.ReturnOnlyInternetMessageId=!0):(_.ItemShape=Object(a.a)(t),_.ShapeName="MailCompose"),_}(e,t,n,h,b,y,_,O,S);if("PostItem:#Exchange"==e.__type){var A=s.a.folderTable.get(_);C=Object(o.a)(null!=A.ReplicaList?A.ReplicaList[0]:Object(g.a)().SessionSettings.DefaultPublicFolderMailbox)}return Object(p.a)({Header:Object(m.a)(),Body:I},C).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}},5347:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ReplyAllToItem:#Exchange"},e)}},5348:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ReplyToItem:#Exchange"},e)}},5349:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(1301),a=n(77),i=new a.c((function(){return Promise.all([n.e(4),n.e(13),n.e(634),n.e(292)]).then(n.bind(null,8435))})),o=Object(r.a)(i,(function(e){return e.AtMentionPickerPlugin}),"AtMentionsPicker",(function(e){return 9==e.eventType})),s=new a.b(i,(function(e){return e.loadAtMentionsData}))},5359:function(e,t,n){"use strict";var r=n(2163),a=n(4);t.a=Object(a.mutatorAction)("showCcWell",(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},5361:function(e,t,n){"use strict";var r=n(104);t.a=Object(r.action)("switchToReadWriteRecipient")((function(e){e.showCompactRecipientWell=!1}))},543:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},544:function(e,t,n){"use strict";var r=n(24),a=n(0);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return i}))},5499:function(e,t,n){"use strict";var r=n(0),a=n(4874),i=n(4052),o=n(1521),s=n(3985),c=n(4875);var u=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function l(e){var t=0;if(e){var n=e.match(u);t=n?n.length:0}return t}var d=n(1014);var f=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),p=new RegExp('\\sSRC\\s*=\\s*"[\\s\\S]+?"',"im"),m=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function g(e,t){return e?e.replace(f,(function(e){return e=e.replace(p,""),t&&(e=e.replace(m,' src="')),e})):e}var v=n(20),h=n(3266),b=n(1523),y=n(208),_=35356;var O=n(5),S="0x3FEF";function C(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function I(e,t,n){var r,a;n?C(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(a=t).ExtendedProperty||(a.ExtendedProperty=[]),a.ExtendedProperty.push(Object(b.a)({Value:JSON.stringify(r),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function A(e,t){e.internetHeaders.size>0&&function(e,t){var n,a;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var i=Object(r.__values)(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;t.ExtendedProperty.push(Object(b.a)({Value:e.get(s),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"InternetHeaders",PropertyName:s,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&C(e.keysOfInternetHeadersToBeRemoved,t)}var x=n(2160);function E(e,t,n){n?C(["ComposeType"],t):void 0!==e.addin&&null!==e.addin.draftComposeType&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);t.ExtendedProperty.push(Object(b.a)({Value:x.b[e],ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"ComposeType",PropertyType:"String"})}))}(e.addin.draftComposeType,t)}var T=n(3310),w=n(5344),j=n(4),P=Object(j.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",(function(e){e.keysOfInternetHeadersToBeRemoved=[]})),M=n(1634),k=n(2266),R=n(4280),D=n(1053),N=n(51),F=n(836),L=n(1448),U=n(7),B=n(3503),H=n(3986),G=function(e){switch(e.labelApplyMethod){case B.a.Manual:return H.d;case B.a.Default:case B.a.Automatic:default:return H.e}},W=n(3504),V="MSIP_Label";function z(e,t){var n=Object(v.a)().SessionSettings.ExternalDirectoryTenantGuid,r=e.selectedCLPLabel,a=e.originalCLPLabel,i=e.nonTenantLabelString;if(function(e,t,n){if(!e&&!t)return;var r=e&&!t&&e.isDefault;if(e&&t&&e.id==t.id&&!t.isDefault)return;var a=(t&&!r?t.id:H.a)+";"+(e?e.id:H.a);J(H.b,a,n)}(r,a,t),r||i){var o="";if(r)o=function(e,t){return Object.keys(e).map((function(n){return V+"_"+t.id+"_"+n+"="+e[n]+";"})).join("")}({Enabled:"True",SiteId:n,SetDate:Object(O.tb)(Object(O.Pb)()),Name:r.displayName,ContentBits:0,Method:G(e)},r);var s=i?i+o:o;J(H.c,s,t),Object(W.c)(r)}}function J(e,t,n){var r=Object(b.a)({ExtendedFieldURI:Object(y.a)({PropertyName:e,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:t});n.ExtendedProperty?n.ExtendedProperty.push(r):n.ExtendedProperty=[r]}var q=n(2956),X=n(994),Q=n(3987);var K=n(5346),Z=n(5516),Y=n(223),$=n(389);var ee=n(839),te=n(24);function ne(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostGroupItemJsonRequest:#Exchange"},n)),Object(te.a)("PostGroupItem",e,t)}var re=n(153),ae=n(1543);function ie(e,t,n,a,i,o){var s,c=(s=Object(r.__assign)({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",Items:[t],TimeFormat:a,ItemShape:Object($.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ee.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ae.a)()),Object(r.__assign)({__type:"PostGroupItemRequest:#Exchange"},s));return o&&(c.ItemShape.ReturnOnlyInternetMessageId=!0),(null==i?void 0:i.IsOwner)&&(c.ComplianceId=i.RmsTemplateId?i.RmsTemplateId.toUpperCase():"0"),c}function oe(e,t,n,r,a,i){var o=ie(e,t,0,r,a,i),s={headers:Object(Y.f)(null,"GroupMailbox")};return ne({Header:Object(re.a)(),Body:o},s).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}function se(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},n)),Object(te.a)("PostUnifiedGroupItem",e,t)}function ce(e,t,n,a,i){var o,s=(o={ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Object($.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ee.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(r.__assign)({__type:"PostUnifiedGroupItemRequest:#Exchange"},o));return i&&(s.ItemShape.ReturnOnlyInternetMessageId=!0),s}var ue=n(4281),le=n(2792),de=n(1967);function fe(e,t){return Object(de.a)({Path:Object(y.a)({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var pe=n(1439),me=n(450),ge=n(2159),ve=n(2130);function he(e,t,n,a){var i=function(e,t,n,a){var i,o=[];e.MimeContent&&o.push(Object(le.a)("MimeContent",e.MimeContent));var s=[Object(le.a)("ToRecipients",e.ToRecipients),Object(le.a)("CcRecipients",e.CcRecipients),Object(le.a)("BccRecipients",e.BccRecipients),Object(le.a)("Subject",e.Subject),Object(le.a)("Body",e.Body),Object(le.a)("Importance",e.Importance),Object(le.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(le.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];(null===(i=e.Attachments)||void 0===i?void 0:i.length)&&s.push(Object(le.a)("Attachments",e.Attachments)),e.ItemClass&&s.push(Object(le.a)("ItemClass",e.ItemClass)),e.From&&s.push(Object(le.a)("From",e.From)),a.length>0&&a.map((function(e){s.push(fe("InternetHeaders",e))})),t&&s.push(fe("Common","AppendOnSend")),e.MentionsEx&&s.push(Object(le.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&s.push(Object(le.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map((function(e){s.push(Object(ue.a)(e))})),t&&e.DocLinks&&e.DocLinks.length>0&&s.push(Object(le.a)("DocLinks",e.DocLinks));var c=Object(pe.a)({Updates:Object(r.__spread)(o,s),ItemId:Object(me.a)({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),u=Object(ge.a)(Object(r.__assign)({ItemChanges:[c],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Object($.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ee.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ae.a)()));return(null==n?void 0:n.IsOwner)&&(u.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),u}(e,t,n,a);return Object(ve.a)({Header:Object(re.a)(),Body:i}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var be=n(1092),ye=n(843),_e="InternetHeaders",Oe="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",Se="X-Ms-Exchange-Organization-Dlp-FalsePositive";var Ce=n(1994);function Ie(e){if(!e)return null;var t=e.IRMData;return!t||t.RmsTemplateId&&!Ce.b.rmsTemplates.get(t.RmsTemplateId)?null:t}function Ae(e){return Object(r.__assign)({__type:"ApproveRequestItem:#Exchange"},e)}var xe=n(1126),Ee=n(1703);function Te(e){return Object(r.__assign)({__type:"RejectRequestItem:#Exchange"},e)}var we=n(5347),je=n(5348),Pe=n(206),Me=n(2647),ke=n(2731),Re=n(1724),De=n(5349),Ne="X-MS-Exchange-Organization-ClientSubmitSmtp-OriginalFrom";var Fe=n(1671);n.d(t,"c",(function(){return ze})),n.d(t,"b",(function(){return Je})),n.d(t,"a",(function(){return qe}));var Le='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',Ue="IPM.Note";function Be(e){var t=e.content;if("HTML"==e.bodyType){var n=Xe(e);t=g(t),t=Object(U.b)(Le,n,t)}var a,i=Object(xe.a)({BodyType:e.bodyType,Value:t});i.DataUriCount=l(e.content);var o,s={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return o=Object(r.__assign)(Object(r.__assign)({},s),{Body:i}),a=Object(r.__assign)({__type:"PostItem:#Exchange"},o),e.itemId&&(a.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=Object(h.a)({Mailbox:n.email})}(e.fromViewState,a),a}var He=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(ke.a)(e.smimeViewState)?[2,null]:[4,D.h.import()];case 1:return(null==(t=r.sent()(e.attachmentWell,e.content,e.bodyType,!0))?void 0:t.length)?[4,Fe.i.import()]:[3,3];case 2:return n=r.sent()(t),[3,4];case 3:n=null,r.label=4;case 4:return[2,n]}}))}))};function Ge(e){var t=e.content,n=Object(ke.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(R.a)(e.bodyType)),"HTML"==e.bodyType){var i=Xe(e);n&&(t=g(t,n)),t=Object(U.b)(Le,i,t)}var s=Object(xe.a)({BodyType:e.bodyType,Value:t});s.DataUriCount=l(e.content);var c,u=Object(a.a)(e.itemId),d=Object(a.a)(e.referenceItemId),f=[],p=[],m=[];if(e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode)switch(e.smimeViewState.smimeBccForkingMode){case 1:f=Object(o.a)(e.toRecipientWell),p=Object(o.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){var C=e.smimeViewState.currentBccRecipientIndex;m=[Object(o.a)(e.bccRecipientWell)[C]]}break;case 3:e.bccRecipientWell&&(m=Object(o.a)(e.bccRecipientWell))}else f=Object(o.a)(e.toRecipientWell),p=Object(o.a)(e.ccRecipientWell),m=Object(o.a)(e.bccRecipientWell);var I={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:f,CcRecipients:p,BccRecipients:m,Sensitivity:e.sensitivity};return e.useSmartResponse?c=(2==e.operation?we.a:je.a)(Object(r.__assign)(Object(r.__assign)({},I),{UpdateResponseItemId:u,ReferenceItemId:d,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:s})):5==e.operation||6==e.operation?c=(5==e.operation?Ae:Te)(Object(r.__assign)(Object(r.__assign)({},I),{ReferenceItemId:d,Body:s})):(c=Object(Ee.a)(Object(r.__assign)(Object(r.__assign)({},I),{Body:s})),e.itemId&&(c.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,a=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(a)for(var i=0;i<a.length;i++){var o=a[i];if(o.EmailAddress==n.email.EmailAddress){r=!0;var s=Object(b.a)({Value:o.SubscriptionGuid,ExtendedFieldURI:Object(y.a)({PropertyId:_,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s],t.From=Object(h.a)({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:o.DisplayName}});break}}r||(t.From=Object(h.a)({Mailbox:n.email}))}}(e.fromViewState,c),e.deferredSendTime&&function(e,t){if(e){var n=Object(b.a)({Value:Object(O.m)(e).toISOString(),ExtendedFieldURI:Object(y.a)({PropertyTag:S,PropertyType:"SystemTime"})});t.ExtendedProperty?t.ExtendedProperty.push(n):t.ExtendedProperty=[n]}}(e.deferredSendTime,c),c}function We(e,t){var n,a;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,l,d,f,p,m,g,h,_,O,S,C,x;return Object(r.__generator)(this,(function(j){switch(j.label){case 0:return d=Object(v.a)().UserOptions.TimeFormat,Object(q.a)(e)?(f=e,u=Be(e),[4,Object(K.a)(u,e.bodyType,t,d,e.isInlineCompose,Ie(e.protectionViewState),f.publicFolderId)]):[3,2];case 1:return l=j.sent(),[3,14];case 2:return u=Ge(e),p=u,[4,He(e)];case 3:return p.Attachments=j.sent(),A(e,u),I(e.addin,u,t),E(e,u,t),m=e.protectionViewState,Object(N.f)("cmp-clp")&&!Object(T.a)(e)&&z(m.clpViewState,u),Object(N.f)("cmp-message-classification")&&function(e,t){var n=e.messageClassification;if(n){t.ExtendedProperty||(t.ExtendedProperty=[]),Object.keys(n).forEach((function(e){var r=Q.b[e];r&&t.ExtendedProperty.push(Object(b.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:n[e]}))}));var r=Q.b.IsClassified;t.ExtendedProperty.push(Object(b.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:"true"}))}}(m.classificationViewState,u),Object(N.f)("cmp-proxy-address")&&function(e,t){var n,r,a,i;if(null===(r=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress){var o=Object(b.a)({ExtendedFieldURI:Object(y.a)({PropertyName:Ne,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:null===(i=null===(a=null==e?void 0:e.from)||void 0===a?void 0:a.email)||void 0===i?void 0:i.EmailAddress});t.ExtendedProperty?t.ExtendedProperty.push(o):t.ExtendedProperty=[o]}}(e.fromViewState,u),(null===(n=e.mentionsPicker)||void 0===n?void 0:n.atMentionTuples)&&Object.keys(e.mentionsPicker.atMentionTuples).length>0?[4,De.b.import()]:[3,5];case 4:return h=j.sent(),[3,6];case 5:h=null,j.label=6;case 6:if(null==(g=h)||g(e.mentionsPicker,t,u),!Object(ke.a)(e.smimeViewState))return[3,11];j.label=7;case 7:return j.trys.push([7,9,,10]),_=function(e,t,n){var a,u=e.smimeViewState||Object(s.a)(),l=e.attachmentWell,d=l.docViewAttachments,f=l.inlineAttachments,p=Object(c.a)(u);return(a=d.slice(0)).push.apply(a,Object(r.__spread)(f)),{smimeViewState:u,message:t,fromAddress:Object(i.a)(),isSend:n,composeId:e.composeId,toRecipients:p?Object(o.a)(e.toRecipientWell):[],ccRecipients:p?Object(o.a)(e.ccRecipientWell):[],attachments:a}}(e,u,t),[4,Fe.p.import().then((function(e){return e(_)}))];case 8:return j.sent(),[3,10];case 9:return O=j.sent(),(x=new Error).message=O.message==Me.a?Me.a:"SmimeEncodeError",[2,Promise.reject(x)];case 10:return[3,12];case 11:e.itemId&&(S=Object(ye.b)().items.get(e.itemId.Id))&&Object(Re.b)(S.ItemClass)&&(u.ItemClass=Ue),j.label=12;case 12:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:Se,PropertyType:"String",DistinguishedPropertySetId:_e},Value:""};t.push(n)}if(e.isOverridden){n={ExtendedFieldURI:{PropertyName:Oe,PropertyType:"String",DistinguishedPropertySetId:_e},Value:e.overrideJustification};t.push(n)}return t}(e.policyTipsViewState).map((function(e){return function(e,t){null==e.ExtendedProperty?e.ExtendedProperty=[t]:e.ExtendedProperty.push(t)}(u,e)})),[4,Ve(e,u,d,t)];case 13:l=j.sent(),j.label=14;case 14:return P(e),(C=(null===(a=null==l?void 0:l.ResponseMessages)||void 0===a?void 0:a.Items)?l.ResponseMessages.Items[0]:l&&!l.ResponseMessages?l:null)&&"Success"==C.ResponseClass?[2,Promise.resolve(C)]:(Object(w.d)(l,e),x=void 0,C?(x=new Error(C.ResponseCode)).messageText=C.MessageText:x=new Error("Unrecognized response"),[2,Promise.reject(x)])}}))}))}function Ve(e,t,n,a){var i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,s,c,u,l,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(T.a)(e)?a&&3!=e.operation?Object(Pe.a)()||e.itemId||t.RightsManagementLicenseData||(null===(i=e.protectionViewState)||void 0===i?void 0:i.IRMData)?[4,oe(e.groupId,t,e.bodyType,n,Ie(e.protectionViewState),e.isInlineCompose)]:[3,2]:[3,4]:[3,6];case 1:return[2,r.sent()];case 2:return o=Object(L.m)(e.groupId),[4,(p=e.groupId,m=t,e.bodyType,g=o.requestOptions,v=e.isInlineCompose,h=ce(p,m,0,0,v),se({Header:Object(re.a)(),Body:h},g).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})))];case 3:return[2,r.sent()];case 4:return s=1==e.operation||2==e.operation,!e.itemId&&s||e.useSmartResponse?[4,Object(Z.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)]:[3,6];case 5:return[2,r.sent()];case 6:return c=Object(X.c)(),u=!(!c||c.treeType!==F.j&&c.treeType!==F.c),a&&(l=function(e){var t=[];return e.attachmentWell.sharingLinkIds.forEach((function(e){var n=Object(d.l)(e),r=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel);if(1===r||2===r){var a={ProviderType:"OneDrivePro",Url:n.url,PermissionType:r};t.push(a)}})),t}(e))&&l.length>0&&(t.DocLinks=l),!e.useSmartResponse&&e.itemId?[3,8]:[4,Object(K.a)(t,e.bodyType,a,n,e.isInlineCompose,Ie(e.protectionViewState),null,u)];case 7:return f=r.sent(),[3,10];case 8:return[4,he(t,a,Ie(e.protectionViewState),e.keysOfInternetHeadersToBeRemoved)];case 9:f=r.sent(),r.label=10;case 10:return[2,f]}var p,m,g,v,h}))}))}function ze(e){return We(e,!0)}function Je(e){return We(e,!1)}function qe(e,t){if(Object(be.a)(e)){var n=function(e){var t;if(null==e?void 0:e.Items)return e.Items[0];if(null===(t=e)||void 0===t?void 0:t.Item)return e.Item;return null}(e);return n&&(Object(ke.a)(t.smimeViewState)||D.h.import().then((function(e){var r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&Fe.r.import().then((function(e){return e(r,n.Attachments,Object(me.a)({Id:t.composeId}))}))})),n.ItemId&&(Object(M.a)(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&Object(T.a)(t)&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&Object(k.a)(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}function Xe(e){return e.textDirection||(Object(v.a)().SessionSettings.IsUserCultureRightToLeft?"rtl":"ltr")}},550:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(0),a=n(85),i=n(388),o={width:1095,height:640};function s(e,t,n,i){if(e){var o=Object(a.e)();c(Object(r.__assign)({ItemId:Object(r.__assign)({mailboxInfo:o},e)},t),n,!0,i||0)}}function c(e,t,n,r,a,s){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t,shouldDuplicate:a,eventScope:s,eventHasUpdates:n},o)}},5516:function(e,t,n){"use strict";var r=n(0),a=n(3988);var i=n(389),o=n(839),s=n(24);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},n)),Object(s.a)("CreateResponseFromModernGroup",e,t)}var u=n(153),l=n(1543);function d(e,t,n,s,c,u){var d,f=(d=Object(r.__assign)({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:s?"SendAndSaveCopy":"SaveOnly",Items:[t],TimeFormat:c,ItemShape:Object(i.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(o.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(l.a)()),Object(r.__assign)({__type:"CreateResponseFromModernGroupRequest:#Exchange"},d));return s?u&&(f.ItemShape.ReturnOnlyInternetMessageId=!0):(f.ItemShape=Object(a.a)(n),f.ShapeName="MailCompose"),f.GroupSmtpAddress=e,f}function f(e,t,n,r,a,i){var o=d(e,t,n,r,a,i);return c({Header:Object(u.a)(),Body:o}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return f}))},5704:function(e,t,n){"use strict";var r=n(0),a=n(29),i=n(5705),o=n(7),s=n(1),c=n(1571),u=n(480),l=n(634),d=n(7225);function f(){c.a.sendFeedback()}t.a=Object(a.a)((function(e,t){var n=Object(r.__read)(s.useState(!0),2),a=n[0],c=n[1];return s.useImperativeHandle(t,(function(){return{setPanelOpen:function(){c(!0)}}}),[]),s.createElement(l.a,{isOpen:a,onDismiss:function(){return c(!1)}},s.createElement("div",{className:d.container},s.createElement(u.a,{className:d.closeButton,onClick:function(){c(!1)},iconProps:{iconName:"Cancel"}}),s.createElement("iframe",{src:e.storeUrl,title:"",className:d.inClientStoreIFrameCenter,frameBorder:0})),s.createElement("div",{className:d.FeedbackCommandBarCenter},s.createElement("div",{onClick:f},Object(o.a)(i.a))))}),{forwardRef:!0})},5705:function(e){e.exports=JSON.parse('{"a":"Lda"}')},5756:function(e){e.exports=JSON.parse('{"a":"nRb"}')},5757:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3761),a=n(1249);function i(e,t){return a.c.import().then((function(n){n(e,(function(e,n){return e.insertContent(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),{selectionRange:n,changeSource:r.a}}),(function(e,n,r){return{value:t+e,selectionStart:n,selectionEnd:r,focus:!0}}))}))}},5758:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3761),a=n(1249);function i(e,t){return a.c.import().then((function(n){n(e,(function(e,n){var a=n?3:1;return e.insertContent(t,{position:a,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1}),{selectionRange:n,changeSource:r.a}}),(function(e,n,r){return{value:e.substring(0,n)+t+e.substring(r+1),selectionStart:n,selectionEnd:r,focus:!0}}))}))}},5759:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3446),a=n(3761),i=n(1249);function o(e,t){return i.c.import().then((function(n){n(e,(function(e,n,i){if(e.getContent(!1)==t)return null;e.setContent("");var o=Object(r.a)(t,e.getDocument(),i);return e.insertNode(o,{position:0,updateCursor:!0,replaceSelection:!1,insertOnNewLine:!1}),{selectionRange:o?i.createRange(o,-3):null,changeSource:a.a}}))}))}},5760:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1607);function a(e){var t=null;return Object(r.b)(e,(function(e){var n=e.getSelectionRange(),r=n.cloneContents(),a=document.createElement("div");a.appendChild(r),t={data:a.innerHTML,sourceProperty:"body",startPosition:n.startOffset,endPosition:n.endOffset}}),(function(e){var n=e.value,r=e.selectionStart,a=e.selectionEnd;t={data:n.substring(r,a),sourceProperty:"body",startPosition:r,endPosition:a}})),t}},589:function(e,t,n){"use strict";n.r(t);var r=n(148),a=n(296);function i(e){Object(a.d)(new r.Cache),Object(a.b)(e.location.origin)}var o=n(0),s=n(59),c=n(75),u=n(246),l=n(83),d="OWA_GetDelegationAccessToken",f={};function p(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:t=encodeURIComponent(e.client_id+e.scope+e.requestId),n={},r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,m(e,window,t)];case 2:return n=r.sent(),[3,5];case 3:return r.sent(),n.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",f[e]),t.document.body.removeChild(n),delete f[e])}(t,window),[7];case 5:return[2,n]}}))}))}function m(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(o.__generator)(this,(function(i){return r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+s.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((a=t.document.createElement("iframe")).src=r.toString(),a.style.display="none",a.id=n,t.document.body.appendChild(a),[2,new Promise((function(r,i){f[n]=function(n){var o={};try{a.contentWindow&&a.contentWindow.location.host==t.location.host&&(o=function(e,t){var n=s.parse(e),r={};n.access_token?(r.AccessToken=n.access_token,r.AccessTokenExpiry=Object(u.a)(Date.now(),parseInt(n.expires_in)).toISOString(),r.TokenResultCode=0):"login_required"==n.error||"interaction_required"==n.error||"consent_required"==n.error?(r.TokenResultCode=3,Object(l.h)(d+" MSA Failure Unauthorized",{error:n.error,param:e,requestId:t})):(r.TokenResultCode=2,Object(l.h)(d+" MSA Failure",{error:n.error,param:e,requestId:t}));return r}(a.contentWindow.location.hash.substring(1),e.requestId))}catch(t){Object(l.h)(d+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),o.TokenResultCode=2,i(o)}r(o)},a.addEventListener("load",f[n],!1)}))])}))}))}var g,v=n(51),h=n(245),b=n(386),y=3,_=500;function O(e){var t=this,n=null,r=null,a=new Promise((function(e,a){return Object(o.__awaiter)(t,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return n=e,r=a,[2]}))}))})),i={onFulfilled:n,onRejected:r,options:e};return(null==g&&(g=new b.a(y,S,_)),g).add(i),a}function S(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return p(e.options).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var C=n(301),I=n(448),A=null,x="OWA_GetDelegationAccessToken",E="https://login.live.com/oauth20_authorize.srf",T="/owa/auth/dt.aspx",w="292841";function j(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,r,a,i,u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:n={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:t||Object(I.a)()},r=void 0,a=void 0,o.label=1;case 1:return o.trys.push([1,7,,8]),Object(v.f)("auth-disableGetAuthenticationCall")?[4,P(R(n))]:[3,3];case 2:return r=o.sent(),[3,6];case 3:return[4,Object(c.a)()];case 4:return 0!=(a=o.sent()).ResultCode||null==a.ImplicitGrantAuthorizationUrl||""==a.ImplicitGrantAuthorizationUrl?(Object(l.h)(x+" ImplicitGrantAuthorizationUrl is empty or null ",{scope:e,correlationId:n.requestId}),[2,r]):(i=s.parse(a.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(n.client_id=i.client_id,n.authorization_uri=a.ImplicitGrantAuthorizationUrl.split("?")[0],n.redirect_uri=i.redirect_uri,[4,P(n)]):[3,6];case 5:r=o.sent(),o.label=6;case 6:return[2,r];case 7:return u=o.sent(),Object(l.h)(x+" GetDelegationToken Operation failed ",{err:u.toString(),message:u.message,stk:u.stack||"",scope:e,requestId:n.requestId}),[2,r];case 8:return[2]}}))}))}function P(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a;return Object(o.__generator)(this,(function(i){switch(i.label){case 0:return t=e.client_id+e.scope,(null==(n=function(e,t){var n=e.get(t),r=void 0;if(null==n?void 0:n.AccessTokenExpiry){new Date(n.AccessTokenExpiry)>new Date(Date.now())&&(r=n)}return r}(k(),t))?void 0:n.AccessToken)?[2,n.AccessToken]:[3,1];case 1:return Object(v.f)("auth-getDelegationTokenQueueEnabled")?(r=Object(h.a)(t),a=void 0,r?a=r:(a=O(e),Object(h.b)(t,a)),[2,a.then((function(e){return M(t,e),Object(h.c)(t),e.AccessToken})).catch((function(n){Object(h.c)(t),Object(l.h)(x,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",scope:e.scope,requestId:e.requestId})}))]):[3,2];case 2:return[4,p(e)];case 3:return n=i.sent(),M(t,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}}))}))}function M(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&k().put(e,t,n)}}function k(){return null==A&&(A=new r.Cache),A}function R(e){return e.redirect_uri=Object(C.a)()+T,e.authorization_uri=E,e.client_id=w,e}var D=n(8),N=n(350);var F=!1;function L(e){F||(!function(e){var t=Object(N.a)("/owa",e);Object(D.b)({baseUrl:t})}(e),F=!0)}var U={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function B(e,t,n,r,a){n?e.acquireTokenPopup(t,null,n,a):e.acquireToken(t,(function(n,i){n&&n.indexOf(U.NoPreAuth)>=0&&r?e.acquireTokenPopup(t,null,null,a):a(n,i)}))}var H=n(77),G=new H.c((function(){return Promise.all([n.e(606),n.e(102)]).then(n.bind(null,13709))})),W=new H.a(G,(function(e){return e.createAdalAuthenticationContext}));var V=function(e,t,n,r,a){return function(i,o){i||!o?a(i,null):(e.getCachedUser(),B(e,t,n,r,a))}},z="adalIdTokenFrame";function J(e,t,n,r,a){e.config.displayCall=function(i){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(i),window.detectUserCachedCallback=V(e,t,n,r,a),function(e,t){e._addAdalFrame(z).src="about:blank",e._loadFrame(t+"&prompt=none",z)}(e,i)},e.login()}var q=n(20);function X(e,t,n,r,a,i){var s,c;return Object(o.__awaiter)(this,void 0,void 0,(function(){var u,l,d,f;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return"https://login.microsoftonline.com/",[4,W.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return u=o.sent(),l=Object(q.a)(),d=null===(s=l.SessionSettings)||void 0===s?void 0:s.UserPrincipalName,f=null===(c=l.SessionSettings)||void 0===c?void 0:c.UserEmailAddress,u._user={profile:{upn:d||f}},u.getCachedUser()?B(u,n,r,a,i):J(u,n,r,a,i),[2]}}))}))}n.d(t,"registerTokenProvider",(function(){return i})),n.d(t,"getAccessTokenforResource",(function(){return a.b})),n.d(t,"getAccessTokenforResourceAsLazy",(function(){return a.c})),n.d(t,"getDelegationToken",(function(){return P})),n.d(t,"getDelegationTokenForOwa",(function(){return j})),n.d(t,"bootstrap",(function(){return L})),n.d(t,"getAccessTokenOnBehalfOfResource",(function(){return X})),n.d(t,"AdalErrorCode",(function(){return U}))},594:function(e,t,n){"use strict";function r(e){return e.clientWidth<e.scrollWidth}function a(e){return e.clientHeight<e.scrollHeight}function i(e){return r(e)||a(e)}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}))},596:function(e,t,n){var r=n(597),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},597:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},5974:function(e){e.exports=JSON.parse('{"a":"qqb","b":"rqb"}')},598:function(e,t,n){var r=n(599),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},599:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._2xN9TZyXtoJZK5Lfq0Po_e,._3Syrcsld5EhJ0NsexwVKCW{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:18px;max-width:120px;white-space:nowrap;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._2xN9TZyXtoJZK5Lfq0Po_e,html[dir] ._3Syrcsld5EhJ0NsexwVKCW{border-radius:2px;border-style:solid;border-width:1px}html[dir=ltr] ._2xN9TZyXtoJZK5Lfq0Po_e{margin-right:4px}html[dir=rtl] ._2xN9TZyXtoJZK5Lfq0Po_e{margin-left:4px}html[dir=ltr] ._3Syrcsld5EhJ0NsexwVKCW{margin-right:0}html[dir=rtl] ._3Syrcsld5EhJ0NsexwVKCW{margin-left:0}.GW-PnOYWKlba0TwtiRFoK{font-size:12px;font-weight:400;max-width:120px;overflow:hidden;text-overflow:ellipsis}html[dir] .GW-PnOYWKlba0TwtiRFoK{padding-bottom:2px}html[dir=ltr] .GW-PnOYWKlba0TwtiRFoK,html[dir=rtl] .GW-PnOYWKlba0TwtiRFoK{padding-right:4px;padding-left:4px}",""]),t.locals={categoryContainer:"_2xN9TZyXtoJZK5Lfq0Po_e",lastCategoryContainer:"_3Syrcsld5EhJ0NsexwVKCW",categoryName:"GW-PnOYWKlba0TwtiRFoK"}},600:function(e,t,n){var r=n(601),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},601:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._2vy8bJGTwEqZL1fhtL8s3m{max-height:436px}",""]),t.locals={categoryMenu:"_2vy8bJGTwEqZL1fhtL8s3m"}},602:function(e,t,n){var r=n(603),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},603:function(e,t,n){(e.exports=n(72)(!1)).push([e.i,"",""])},6415:function(e,t,n){"use strict";n(2106);var r=n(2354),a=n(2716),i=n(0);function o(e){return Object(i.__assign)({__type:"InstallExtensionJsonRequest:#Exchange"},e)}var s=n(24);function c(e,t){return void 0===e||e.__type||(e=o(e)),Object(s.a)("InstallExtension",e,t)}var u=n(2),l=n(328);function d(e){e.registerMethod("InstallOutlookWebExt",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:e[1],MarketplaceContentMarket:e[0],Client:"WAC_Outlook",ClientVersion:Object(u.g)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null},n=o({Header:Object(l.b)(a.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{var r=n.Body.Extension?n.Body.Extension.MarketplaceAssetID:e[1],i=!!n.Body.WasFirstInstall;t([r,i],0),a.g()}}))}),Microsoft.Office.Common.InvokeType.async,!1)}var f=n(20),p=n(206),m=n(880);function g(e){return Object(i.__assign)({__type:"DisableExtensionJsonRequest:#Exchange"},e)}function v(e){e.registerMethod("DisableOutlookWebExt",(function(e,t){(function(e){var t={__type:"DisableAppRequest:#Exchange",ID:e.toString(),DisableReason:"NoReason"},n=g({Header:Object(l.b)(a.f()),Body:t}),i=Object(r.b)();return o=n,c=i,void 0===o||o.__type||(o=g(o)),Object(s.a)("DisableExtension",o,c);var o,c})(e).then((function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):t([e.toString()],0),a.g()}))}),Microsoft.Office.Common.InvokeType.async,!1)}function h(e){return Object(i.__assign)({__type:"UninstallExtensionJsonRequest:#Exchange"},e)}function b(e){e.registerMethod("UninstallOutlookWebExt",(function(e,t){(function(e){var t={__type:"UninstallAppRequest:#Exchange",ID:e.toString()},n=h({Header:Object(l.b)(a.f()),Body:t}),i=Object(r.b)();return o=n,c=i,void 0===o||o.__type||(o=h(o)),Object(s.a)("UninstallExtension",o,c);var o,c})(e).then((function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):(t([e.toString()],0),a.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function y(e){e.registerMethod("InstallOutlookWebExtByManifest",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.g)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:e[0],Id:null};t.Manifest=a.b(t.Manifest);var n=o({Header:Object(l.b)(a.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,e.Body.Extension?e.Body.Extension.Enabled.toString():"false",e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),a.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function _(e){e.registerMethod("InstallOutlookWebExtByManifestUrl",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.g)(),SendWelcomeEmail:!0,ManifestUrl:e[0],Manifest:null,Id:null},n=o({Header:Object(l.b)(a.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,!!e.Body.Extension&&e.Body.Extension.Enabled.toString(),e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),a.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function O(e){e.registerMethod("InstallOutlookWebExtByProductId",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.g)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null,Id:e},n=o({Header:Object(l.b)(a.f()),Body:t}),i=Object(r.b)();return c(n,i)})(e).then((function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{t([e,!1],0)}a.g()}))}),Microsoft.Office.Common.InvokeType.async,!1)}function S(e){return Object(i.__assign)({__type:"EnableAppDataRequest:#Exchange"},e)}var C=n(4441);function I(e){e.registerMethod("EnableApp",(function(e,t){(function(e){var t={DisplayName:e[0],RawIdentity:e[1]},n=S({Header:Object(l.b)(a.f()),Identity:t}),i=Object(r.b)();return o=n,c=i,void 0===o||o.__type||(o=S(o)),Object(s.a)("EnableApp",o,c);var o,c})(e).then((function(e){t([e.WasSuccessful],0),Object(C.b)().then((function(e){Object(m.U)(e),Object(m.V)(!0)}))})).catch((function(e){e.ErrorMessage?t([e.ErrorMessage],-1):t([],-1)}))}),Microsoft.Office.Common.InvokeType.async,!1)}var A=n(845);function x(e,t){!function(e){e.registerMethod("GetTelemetryInfoFromOutlook",(function(e,t){var n=Object(m.s)(),r=Object(f.a)(),i=!r.SessionSettings.IsSPOnPrem,o=Object(p.a)(),s=i?o?"Consumer":"Business":"OnPremise";t([Object(u.w)(),r.SessionSettings.UserCulture,"16.2130.0.9999",a.c(),s,i,o,n.MarketplaceUrl,r.SessionSettings.ExternalDirectoryUserGuid,r.SessionSettings.OrganizationDomain,a.e(),"other","OWA_REACT",n.GenericInfo],0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllInstalledAddIns",(function(e,t){var n=Object(m.s)(),a=[];n.Extensions.forEach((function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString&&a.push([e.Id,e.MarketplaceAssetID,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString,e.LicenseStatus.toString(),e.TrialExpirationDate,e.IsMandatory.toString(),e.OriginString])})),t(a,0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllPrivateAddIns",(function(e,t){var n=Object(m.s)().Extensions,a=[];n.forEach((function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString||a.push([e.Id,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString.toString(),e.LicenseStatus.toString(),e.TrialExpirationDate,e.Description,e.ProviderName,e.IconUrl,e.HighResolutionIconUrl,e.DisplayName,e.RequestedCapabilities.toString(),e.Version,e.OriginString,e.IsMandatory.toString()])})),t(a,0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),d(e),v(e),b(e),y(e),_(e),O(e),I(e),function(e){e.registerMethod("LaunchUrl",(function(e){var t=e;return window.open(t),null}),Microsoft.Office.Common.InvokeType.sync,!1)}(e),function(e){e.registerMethod("UpdateAddinPinOptions",(function(e){var t={readMode:e[2],composeMode:e[3],calendarMode:e[4]};A.h.importAndExecute(e[0],e[1],t)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),e.registerConversation(r.d(),t,null,null)}t.a=function(){var e=r.c();return Object(C.a)().then((function(){var t=r.a();return x(e,t),t}))}},6424:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(29),o=n(7236),s=n(7),c=n(407),u=n.n(c),l=n(3732),d=n(7237),f=n(217),p=n(7238),m=Object(i.a)((function(e){var t=function(e){switch(e){case 1:return{title:Object(s.a)(d.d),description:Object(s.a)(d.e)};case 2:return{title:Object(s.a)(l.d),description:Object(s.a)(l.e)};case 3:return{title:Object(s.a)(d.a),description:Object(s.a)(d.b)};case 4:return{title:Object(s.a)(d.a),description:Object(s.a)(d.c)};default:return{title:null,description:null}}}(e.errorType);return a.createElement("div",{className:p.errorContainer},a.createElement("div",{className:p.errorContent},a.createElement(f.a,{className:p.errorIcon,iconName:"OfficeAddinsLogo"}),a.createElement("span",{className:u()([p.errorTextCommon,p.errorTextTitle])},t.title),a.createElement("span",{className:u()([p.errorTextCommon,p.errorTextDescription])},t.description)))}));var g=n(7240),v=n(303),h=n(63),b=n(262),y=n(4749),_=Object(i.a)((function(e){var t=Object(r.__read)(a.useState(!1),2),n=t[0],i=t[1];return n?a.createElement(f.a,{iconName:"Photo2",iconType:v.a.default,className:u()([y.fallbackIcon,e.className])}):a.createElement(b.a,{onLoadingStateChange:function(e){e==h.c.error?i(!0):i(!1)},src:e.src,width:e.width,height:e.height,imageFit:h.b.contain,className:e.className})})),O=n(480),S=n(4749),C=Object(i.a)((function(e){var t,n=e.isPersisted?"Pinned":"Pin",r=(t=e.isPersisted?Object(s.a)(l.g):Object(s.a)(l.f),Object(s.b)(t,e.displayName));return a.createElement(O.a,{className:S.persistIcon,onClick:e.togglePersist,title:r,ariaLabel:r,iconProps:{iconName:n}})})),I=n(2981),A=n(4749),x=Object(i.a)((function(e,t){var n=a.useRef();a.useImperativeHandle(t,(function(){return{focusCloseButton:function(){n.current&&n.current.focus()}}}),[]);var r=e.isCalendar;return a.createElement("div",{className:u()(A.addinPaneHeader,r&&A.addinPaneHeaderCalendar)},a.createElement(_,{src:e.iconUrl,width:32,height:32,className:A.addinPaneIcon}),a.createElement("div",{className:u()([A.addinPaneLabelText,A.ellipsis])},e.displayName),a.createElement("div",{className:A.rightButtons},Object(I.c)()&&e.isPersistable&&!r&&a.createElement(C,{displayName:e.displayName,isPersisted:e.isPersisted,togglePersist:e.togglePersist}),a.createElement(O.a,{componentRef:function(e){return n.current=e},className:A.closeButton,onClick:e.closeOnClick,ariaLabel:Object(s.a)(g.a),iconProps:{iconName:"Cancel"}})))}),{forwardRef:!0}),E=n(3881),T=n(775),w=n(800),j=n(7242),P=function(e){return e.renderInPanel?a.createElement(w.a,{focusTrapZoneProps:{forceFocusInsideTrap:!1,disableFirstFocus:e.disableFirstFocus,isClickableOutsideFocusTrap:!0},hasCloseButton:!1,isOpen:!0,onDismiss:e.onDismiss,className:u()(j.taskPane,e.isDeepLink&&j.taskPaneNoHeader),isBlocking:!1,isFooterAtBottom:!0,isLightDismiss:!0},e.children):a.createElement(T.a,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:j.taskPane},e.children)},M=n(2817),k=n(954),R=n(451),D=n(4139),N=(n(2106),n(880)),F=n(3338),L=n(7244),U=Object(i.a)((function(e){var t=a.useRef(),n=function(){t.current&&t.current.focusCloseButton()},r=function(){return e.instance.mode===k.a.AppointmentAttendee||e.instance.mode===k.a.AppointmentOrganizer},i=function(){return"Persistent"===e.type},c=function(){return 0!==e.instance.errorType},l=function(){var t=e.instance,n=t.mode,r=t.controlId;i()&&Object(F.h)(n,null),Object(M.d)(r)},d=e.instance,f=void 0===e.renderInPanel||e.renderInPanel;if(!d)return a.createElement("div",{className:L.divContainer});var p,g=d.addinCommand;return a.createElement(P,{renderInPanel:f,onDismiss:l,isDeepLink:Object(R.u)(),disableFirstFocus:i()},a.createElement(x,{iconUrl:g.extension.IconUrl,displayName:g.extension.DisplayName,closeOnClick:l,ref:t,isCalendar:r(),isPersistable:Object(F.a)(e.instance.addinCommand),isPersisted:i(),togglePersist:function(){var t=i()?null:Object(F.b)(e.instance.addinCommand);Object(F.h)(e.instance.mode,t),Object(N.db)(e.type)}}),a.createElement("div",{tabIndex:0,className:u()(L.extensionContainer,r()&&L.extensionContainerCalendar),"aria-label":Object(s.b)(Object(s.a)(o.a),g.extension.DisplayName),role:"complementary"},(p=e.instance.errorType,c()&&a.createElement(m,{errorType:p})),function(){var t=e.instance,r=t.hostItemIndex,i=t.controlId,o=t.addinCommand,s={};return s[15]=n,s[14]=n,s[13]=n,a.createElement(D.a,{addinCommand:o,controlId:i,className:u()([L.extensionHost,c()&&L.hide]),hostItemIndex:r,manifestCacheProvider:E.a,notifyHostActions:s})}()))})),B=n(2705),H=n(3015),G=n(1294),W="addinTaskPane";var V=n(2),z=n(449),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.componentDidUpdate=function(){if("Mail"===Object(V.b)()){var e=Object(N.t)().taskPanes;!this.previousTaskPanesSize&&e.size?(Object(B.a)(W,!0,!1),G.b.importAndExecute(),H.a.importAndExecute()):this.previousTaskPanesSize&&!e.size&&(Object(B.a)(W,!1,!1),G.b.importAndExecute()),this.previousTaskPanesSize=e.size}},t.prototype.renderTaskPane=function(e){var t=Object(N.A)(e);return t&&a.createElement(U,{key:t.controlId,type:e,instance:t,renderInPanel:this.props.renderTaskPaneInPanel})},t.prototype.render=function(){var e=Object(I.c)()&&this.renderTaskPane("Persistent"),t=this.renderTaskPane("NonPersistent");return a.createElement(a.Fragment,null,[e,t])},t=Object(r.__decorate)([z.observer],t)}(a.Component);t.a=J},6441:function(e,t,n){"use strict";var r=n(448),a=n(196),i="/ows/api/beta/PersistedAddins";function o(e,t,n){var o=Object(r.a)();Object(a.c)(i,{Addin:{mode:e,addinId:t,commandId:n}},o)}var s=n(0),c=n(190);function u(){return Object(s.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return e=Object(r.a)(),[4,Object(a.b)(i,e,!0)];case 1:return t=n.sent(),Object(c.a)(t.status)?[4,t.text()]:[3,3];case 2:return[2,n.sent()];case 3:return[2,"{}"]}}))}))}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}))},6454:function(e,t,n){"use strict";var r=n(0),a=n(2660),i=n(880),o=function(e){Object(i.t)().activeDialog&&Object(i.t)().activeDialog.parentControlId==e&&Object(a.j)({eventDispId:a.a.DISPLAY_DIALOG_DISPID,controlId:e})};function s(e){Object(i.t)().runningUILessExtendedAddinCommands.has(e)&&Object(r.__spread)(Object(i.t)().runningUILessExtendedAddinCommands.get(e).keys()).forEach((function(t,n){!function(e,t,n){o(e),Object(i.cb)(e,t,n)}(t,e,i.d.NavigatedBeforeCompleted)}))}function c(e){s(e),Object(i.g)(e)}n.d(t,"a",(function(){return c}))},6480:function(e,t,n){"use strict";var r;!function(e){e.MailRead="MailRead",e.MailCompose="MailCompose",e.NoEndpoint=""}(r||(r={}));var a=r,i=n(954);function o(e){switch(e){case i.a.MessageRead:case i.a.MeetingRequest:return a.MailRead;case i.a.MessageCompose:return a.MailCompose;default:return a.NoEndpoint}}n.d(t,"a",(function(){return o}))},6575:function(e,t,n){"use strict";function r(e){var t=e&&e.Action;return t&&!!t.SourceLocation}function a(e){var t=e&&e.Action;return t&&!!t.FunctionName}function i(e){return!!e&&!!e.MenuItems}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},6576:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(880);function a(e,t){var n=Object(r.x)();Object(r.S)(n,e,t)}},6577:function(e,t,n){"use strict";var r=n(1),a=n(303),i=n(217),o=n(63),s=n(7251);t.a=function(e){return{iconType:a.a.Image,imageProps:{src:e,width:16,height:16,imageFit:o.b.contain,shouldFadeIn:!1},styles:{root:{width:"16px !important",height:"16px !important"}},imageErrorAs:function(e){return r.createElement(i.a,{className:s.fallbackIcon,iconName:"Photo2",iconType:a.a.Default})}}}},6578:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(7253),a=n(7),i=n(5278),o=n(303),s=n(132);function c(){return{key:"AddinMarketplace",name:Object(a.a)(r.a),title:Object(a.a)(r.a),ariaLabel:Object(a.a)(r.a),iconProps:{iconName:"AddIn",iconType:o.a.default},itemType:s.a.Normal,onClick:function(){Object(i.a)()}}}function u(){return{key:"AddinMarketplaceDivider",displayName:"-",itemType:s.a.Divider,iconProps:{iconName:"AddIn",iconType:o.a.default},onClick:null}}},7223:function(e,t){
/*!
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var n,r;n=l||(l={}),r=function(){var e=!0;function t(){}return t.prototype.isMsAjaxLoaded=function(){var t="function",n="undefined";return!!(typeof Sys!==n&&typeof Type!==n&&Sys.StringBuilder&&typeof Sys.StringBuilder===t&&Type.registerNamespace&&typeof Type.registerNamespace===t&&Type.registerClass&&typeof Type.registerClass===t&&typeof Function._validateParams===t&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===t)&&e},t.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";i.OUtil.loadScript(t,e)},Object.defineProperty(t.prototype,"msAjaxError",{get:function(){var e=this;return null==e._msAjaxError&&e.isMsAjaxLoaded()&&(e._msAjaxError=Error),e._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxString",{get:function(){var e=this;return null==e._msAjaxString&&e.isMsAjaxLoaded()&&(e._msAjaxString=String),e._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxDebug",{get:function(){var e=this;return null==e._msAjaxDebug&&e.isMsAjaxLoaded()&&(e._msAjaxDebug=Sys.Debug),e._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:e,configurable:e}),t}(),n.MicrosoftAjaxFactory=r;var a=new l.MicrosoftAjaxFactory,i=i||{};!function(e){var t=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,r=0;r<n;r++){var a=this._internalStorage.key(r);0===a.indexOf(e)&&t.push(a)}}catch(e){}return t},e}();e.SafeStorage=t}(l||(l={})),i.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},i.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext"},i.OUtil=function(){var e="focus",t="on",n="configurable",r="writable",o="enumerable",s="",c="undefined",u=!1,d=!0,f=2147483647,p=null,m=-1,g=m,v="&_xdm_Info=",h="&_serializer_version=",b="_xdm_",y="#",_="class",O={},S=p,C=p,I=(new Date).getTime();function A(){var e=f*Math.random();return(e^=I^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function x(){if(!S){try{var e=window.sessionStorage}catch(t){e=p}S=new l.SafeStorage(e)}return S}function E(e){for(var t,n=[],r=[],a=e.length,i=0;i<a;i++)(t=e[i]).tabIndex?t.tabIndex>0?r.push(t):0===t.tabIndex&&n.push(t):n.push(t);return r=r.sort((function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=r.indexOf(e)-r.indexOf(t)),n})),[].concat(r,n)}return{set_entropy:function(e){if("string"==typeof e)for(var t=0;t<e.length;t+=4){for(var n=0,r=0;r<4&&t+r<e.length;r++)n=(n<<8)+e.charCodeAt(t+r);I^=n}else I^="number"==typeof e?e:f*Math.random();I&=f},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var r=e[n];try{r=JSON?JSON.stringify(r,(function(e,t){return i.OUtil.isDate(this[e])?i.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+i.DDA.SettingsManager.DataJSONSuffix:t})):Sys.Serialization.JavaScriptSerializer.serialize(r),t[n]=r}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var r=e[n];try{r=JSON?JSON.parse(r,(function(e,t){var n;return"string"==typeof t&&t&&t.length>6&&t.slice(0,5)===i.DDA.SettingsManager.DateJSONPrefix&&t.slice(m)===i.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,m))))?n:t})):Sys.Serialization.JavaScriptSerializer.deserialize(r,d),t[n]=r}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var r=window.document,a=O[e];if(a)a.loaded?t():a.pendingCallbacks.push(t);else{var i=r.createElement("script");i.type="text/javascript",a={loaded:u,pendingCallbacks:[t],timer:p},O[e]=a;var o=function(){a.timer!=p&&(clearTimeout(a.timer),delete a.timer),a.loaded=d;for(var e=a.pendingCallbacks.length,t=0;t<e;t++){a.pendingCallbacks.shift()()}},s=function(){delete O[e],a.timer!=p&&(clearTimeout(a.timer),delete a.timer);for(var t=a.pendingCallbacks.length,n=0;n<t;n++){a.pendingCallbacks.shift()()}};i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=p,o())}:i.onload=o,i.onerror=s,n=n||3e4,a.timer=setTimeout(s,n),i.setAttribute("crossOrigin","anonymous"),i.src=e,r.getElementsByTagName("head")[0].appendChild(i)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,t){var n=t[e.trim()];if(typeof n==c)throw a.msAjaxDebug.trace("invalid enumeration string:"+e),a.msAjaxError.argument("str");return n},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(g+=1).toString()},formatString:function(){var e=arguments,t=e[0];return t.replace(/{(\d+)}/gm,(function(t,n){var r=parseInt(n,10)+1;return void 0===e[r]?"{"+n+"}":e[r]}))},generateConversationId:function(){return[A(),A(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return b+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,v,t,u)},addSerializerVersionAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,h,t,d)},addInfoAsHash:function(e,t,n,r){var a,i=(e=e.trim()||s).split(y),o=i.shift(),c=i.join(y);return a=r?[t,encodeURIComponent(n),c].join(s):[c,t,n].join(s),[o,y,a].join(s)},parseHostInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=i.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=i.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return i.OUtil.parseInfoWithGivenFragment(v,b,u,e,t)},parseSerializerVersion:function(e){var t=i.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=i.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(i.OUtil.parseInfoWithGivenFragment(h,"_serializer_version=",d,e,t))},parseInfoFromWindowName:function(e,t,n){try{var r=JSON.parse(t),a=r!=p?r[n]:p,o=x();if(!e&&o&&r!=p){var s=r[i.WindowNameItemKeys.BaseFrameName]+n;a?o.setItem(s,a):a=o.getItem(s)}return a}catch(e){return p}},parseInfoWithGivenFragment:function(e,t,n,r,a){var i=a.split(e),o=i.length>1?i[i.length-1]:p;n&&o!=p&&(o.indexOf("&")>=0&&(o=o.split("&")[0]),o=decodeURIComponent(o));var s=x();if(!r&&s){var c=window.name.indexOf(t);if(c>m){var u=window.name.indexOf(";",c);u==m&&(u=window.name.length);var l=window.name.substring(c,u);o?s.setItem(l,o):o=s.getItem(l)}}return o},getConversationId:function(){var e=window.location.search,t=p;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var t=e.split("$");return typeof t[1]==c&&(t=e.split("|")),typeof t[1]==c&&(t=e.split("%7C")),t},getXdmFieldValue:function(e,t){var n=s,r=i.OUtil.parseXdmInfo(t);if(r){var a=i.OUtil.getInfoItems(r);if(null!=a&&a.length>=3)switch(e){case i.XdmFieldName.ConversationUrl:n=a[2];break;case i.XdmFieldName.AppId:n=a[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:u},{name:"expectedProperties",type:Object,mayBeNull:u},{name:"callback",type:Function,mayBeNull:d}]);if(n)throw n;for(var r in t)if(n=Function._validateParameter(e[r],t[r],r))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),a.msAjaxDebug.trace(e))},outputDebug:function(e){typeof a!==c&&a.msAjaxDebug&&a.msAjaxDebug.trace&&a.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,r){for(var a in n=n||{},r){var i=r[a];null==n[i]&&(n[i]=d)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){for(var r in t=t||{})i.OUtil.defineNondefaultProperty(e,r,t[r],n);return e},defineEnumerableProperty:function(e,t,n){return i.OUtil.defineNondefaultProperty(e,t,n,[o])},defineEnumerableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[o])},defineMutableProperty:function(e,t,a){return i.OUtil.defineNondefaultProperty(e,t,a,[r,o,n])},defineMutableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[r,o,n])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),r=n.length,a=0;a<r;a++){var i=n[a],o=Object.getOwnPropertyDescriptor(e,i);o.get||o.set||(o.writable=t.writable||u),o.configurable=t.configurable||u,o.enumerable=t.enumerable||d,Object.defineProperty(e,i,o)}return e},mapList:function(e,t){var n=[];if(e)for(var r in e)n.push(t(e[r]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return d;return u},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return d;return u},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var r in t)n(r,t[r])},redefineList:function(e,t){for(var n in e)delete e[n];for(var r in t)e[r]=t[r]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,n,r){e.addEventListener?e.addEventListener(n,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent(t+n,r):e[t+n]=r},removeEventListener:function(e,n,r){e.removeEventListener?e.removeEventListener(n,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent(t+n,r):e[t+n]=p},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,s)},xhrGet:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,d),r.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,r){var a,i=t;try{(a=new XMLHttpRequest).onreadystatechange=function(){4==a.readyState&&(200==a.status?n(a,i):r(a.status))},a.open("GET",e,d),a.send()}catch(e){r(e)}},encodeBase64:function(e){if(!e)return e;var t,n,r,a,i,o,c,u=[],l=[],d=0,f=e.length;do{t=e.charCodeAt(d++),n=e.charCodeAt(d++),r=e.charCodeAt(d++),c=0,a=255&t,i=t>>8,o=255&n,l[c++]=a>>2,l[c++]=(3&a)<<4|i>>4,l[c++]=(15&i)<<2|o>>6,l[c++]=63&o,isNaN(n)||(a=n>>8,i=255&r,o=r>>8,l[c++]=a>>2,l[c++]=(3&a)<<4|i>>4,l[c++]=(15&i)<<2|o>>6,l[c++]=63&o),isNaN(n)?l[c-1]=64:isNaN(r)&&(l[c-2]=64,l[c-1]=64);for(var p=0;p<c;p++)u.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l[p]))}while(d<f);return u.join(s)},getSessionStorage:function(){return x()},getLocalStorage:function(){if(!C){try{var e=window.localStorage}catch(t){e=p}C=new l.SafeStorage(e)}return C},convertIntToCssHexColor:function(e){return"#"+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){var n=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:u},{name:"paramName",type:String,mayBeNull:u}]);if(n)return a.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),s;var r=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return r.test(e)?r.exec(e)[1]:(a.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),s)},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?d:u},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!i.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},shallowCopy:function(e){if(e==p)return p;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var r=e.constructor();for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);return r}return e},createObject:function(e){var t=p;if(e){t={};for(var n=e.length,r=0;r<n;r++)t[e[r].name]=e[r].value}return t},addClass:function(e,t){if(!i.OUtil.hasClass(e,t)){var n=e.getAttribute(_);n?e.setAttribute(_,n+" "+t):e.setAttribute(_,t)}},removeClass:function(e,t){if(i.OUtil.hasClass(e,t)){var n=e.getAttribute(_),r=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(r,s),e.setAttribute(_,n)}},hasClass:function(e,t){var n=e.getAttribute(_);return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(t,n){var r,a,i=u,o=function(){i=d},s=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(t=E(t),r=n?t.length-1:0,0===t.length)return p;for(;!i&&r>=0&&r<t.length;)a=t[r],window.focus(),a.addEventListener(e,o),a.focus(),a.removeEventListener(e,o),r=s(t.length,r,n),i||a!==document.activeElement||(i=d);return i?a:p},focusToNextTabbable:function(t,n,r){var a,i,o,s=u,c=function(){s=d},l=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(a=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return m}(t=E(t),n),(i=l(t.length,a,r))<0)return p;for(;!s&&i>=0&&i<t.length;)(o=t[i]).addEventListener(e,c),o.focus(),o.removeEventListener(e,c),i=l(t.length,i,r),s||o!==document.activeElement||(s=d);return s?o:p}}}(),i.OUtil.Guid=function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var t="",n=(new Date).getTime(),r=0;r<32&&n>0;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[n%16],n=Math.floor(n/16);for(;r<32;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[Math.floor(16*Math.random())];return t}}}(),window.OSF=i,function(e){var t="\n",n=!0,r=null,i="undefined",o=function(){function e(){}return e.isInstanceOfType=function(e,t){if(typeof t===i||t===r)return!1;if(t instanceof e)return n;var a=t.constructor;return a&&"function"==typeof a&&a.__typeName&&"Object"!==a.__typeName||(a=Object),!(a!==e)||a.__typeName&&e.__typeName&&a.__typeName===e.__typeName},e}();e.MsAjaxTypeHelper=o;var s=function(){var e="Parameter name: {0}";function n(){}return n.create=function(e,t){var n=new Error(e);if(n.message=e,t)for(var r in t)n[r]=t[r];return n.popStackFrame(),n},n.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||"Parameter count mismatch."),r=n.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},n.argument=function(r,a){var i="Sys.ArgumentException: "+(a||"Value does not fall within the expected range.");r&&(i+=t+c.format(e,r));var o=n.create(i,{name:"Sys.ArgumentException",paramName:r});return o.popStackFrame(),o},n.argumentNull=function(r,a){var i="Sys.ArgumentNullException: "+(a||"Value cannot be null.");r&&(i+=t+c.format(e,r));var o=n.create(i,{name:"Sys.ArgumentNullException",paramName:r});return o.popStackFrame(),o},n.argumentOutOfRange=function(a,o,s){var u="Sys.ArgumentOutOfRangeException: "+(s||"Specified argument was out of the range of valid values.");a&&(u+=t+c.format(e,a)),typeof o!==i&&o!==r&&(u+=t+c.format("Actual value was {0}.",o));var l=n.create(u,{name:"Sys.ArgumentOutOfRangeException",paramName:a,actualValue:o});return l.popStackFrame(),l},n.argumentType=function(r,a,i,o){var s="Sys.ArgumentTypeException: ";s+=o||(a&&i?c.format("Object of type '{0}' cannot be converted to type '{1}'.",a.getName?a.getName():a,i.getName?i.getName():i):"Object cannot be converted to the required type."),r&&(s+=t+c.format(e,r));var u=n.create(s,{name:"Sys.ArgumentTypeException",paramName:r,actualType:a,expectedType:i});return u.popStackFrame(),u},n.argumentUndefined=function(r,a){var i="Sys.ArgumentUndefinedException: "+(a||"Value cannot be undefined.");r&&(i+=t+c.format(e,r));var o=n.create(i,{name:"Sys.ArgumentUndefinedException",paramName:r});return o.popStackFrame(),o},n.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e||"Operation is not valid due to the current state of the object."),r=n.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},n}();e.MsAjaxError=s;var c=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e;return r.replace(/{(\d+)}/gm,(function(e,n){var r=parseInt(n,10);return void 0===t[r]?"{"+n+"}":t[r]}))},e.startsWith=function(e,t){return e.substr(0,t.length)===t},e}();e.MsAjaxString=c;var u=function(){function e(){}return e.trace=function(){},e}();if(e.MsAjaxDebug=u,!a.isMsAjaxLoaded()){var l=function(e,t,n){void 0!==e.__typeName&&e.__typeName!==r||(e.__typeName=t),void 0!==e.__class&&e.__class!==r||(e.__class=n)};l(Function,"Function",n),l(Error,"Error",n),l(Object,"Object",n),l(String,"String",n),l(Boolean,"Boolean",n),l(Date,"Date",n),l(Number,"Number",n),l(RegExp,"RegExp",n),l(Array,"Array",n),Function.createCallback||(Function.createCallback=function(e,t){var r=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:n}]);if(r)throw r;return function(){var n=arguments.length;if(n>0){for(var r=[],a=0;a<n;a++)r[a]=arguments[a];return r[n]=t,e.apply(this,r)}return e.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(e,t){var r=Function._validateParams(arguments,[{name:"instance",mayBeNull:n},{name:"method",type:Function}]);if(r)throw r;return function(){return t.apply(e,arguments)}}),Function._validateParams||(Function._validateParams=function(e,t,n){var a,o=t.length;if(n=n||typeof n===i,a=Function._validateParameterCount(e,t,n))return a.popStackFrame(),a;for(var s=0,c=e.length;s<c;s++){var u=t[Math.min(s,o-1)],l=u.name;if(u.parameterArray)l+="["+(s-o+1)+"]";else if(!n&&s>=o)break;if(a=Function._validateParameter(e[s],u,l))return a.popStackFrame(),a}return r}),Function._validateParameterCount||(Function._validateParameterCount=function(e,t,a){var i,o,c=t.length,u=e.length;if(u<c){var l=c;for(i=0;i<c;i++){var d=t[i];(d.optional||d.parameterArray)&&l--}u<l&&(o=n)}else if(a&&u>c)for(o=n,i=0;i<c;i++)if(t[i].parameterArray){o=!1;break}if(o){var f=s.parameterCount();return f.popStackFrame(),f}return r}),Function._validateParameter||(Function._validateParameter=function(e,t,n){var a,o=t.type,s=!!t.integer,c=!!t.domElement,u=!!t.mayBeNull;if(a=Function._validateParameterType(e,o,s,c,u,n))return a.popStackFrame(),a;var l=t.elementType,d=!!t.elementMayBeNull;if(o===Array&&typeof e!==i&&e!==r&&(l||!d))for(var f=!!t.elementInteger,p=!!t.elementDomElement,m=0;m<e.length;m++){var g=e[m];if(a=Function._validateParameterType(g,l,f,p,d,n+"["+m+"]"))return a.popStackFrame(),a}return r}),Function._validateParameterType||(Function._validateParameterType=function(t,n,a,o,s,c){var u;return typeof t===i?s?r:((u=e.MsAjaxError.argumentUndefined(c)).popStackFrame(),u):t===r?s?r:((u=e.MsAjaxError.argumentNull(c)).popStackFrame(),u):n&&!e.MsAjaxTypeHelper.isInstanceOfType(n,t)?((u=e.MsAjaxError.argumentType(c,typeof t,n)).popStackFrame(),u):r}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++)n[t[r]]=n[t[r]]||{},n=n[t[r]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(e){({})}),typeof Sys===i&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){var e=this;if(0!==arguments.length)throw s.parameterCount();if(typeof e.stack!==i&&e.stack!==r&&typeof e.fileName!==i&&e.fileName!==r&&typeof e.lineNumber!==i&&e.lineNumber!==r){for(var n=e.stack.split(t),a=n[0],o=e.fileName+":"+e.lineNumber;typeof a!==i&&a!==r&&-1===a.indexOf(o);)n.shift(),a=n[0];var c=n[1];if(typeof c!==i&&c!==r){var u=c.match(/@(.*):(\d+)$/);typeof u!==i&&u!==r&&(e.fileName=u[1],e.lineNumber=parseInt(u[2]),n.shift(),e.stack=n.join(t))}}}),a.msAjaxError=s,a.msAjaxString=c,a.msAjaxDebug=u}}(l||(l={})),i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},i.SerializerVersion={MsAjax:0,Browser:1},function(e){e.appSpecificCheckOrigin=function(){return!1}}(l||(l={})),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=this,n=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(n)throw n;t._methodObjectList={},t._eventHandlerProxyList={},t._Id=e,t._conversations={},t._policyManager=null,t._appDomains={},t._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,r){var i="invokeType",o=!1,s=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:o},{name:"method",type:Function,mayBeNull:o},{name:i,type:Number,mayBeNull:o},{name:"blockingOthers",type:Boolean,mayBeNull:o}]);if(s)throw s;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw a.msAjaxError.argument(i);var c=new Microsoft.Office.Common.MethodObject(t,n,r);this._methodObjectList[e]=c},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var r=!1,a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:r},{name:"registerMethod",type:Function,mayBeNull:r},{name:"unregisterMethod",type:Function,mayBeNull:r}]);if(a)throw a;var i=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,r),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,r));this._methodObjectList[e]=i},registerEventEx:function(e,t,n,r,a){var i=!1,o=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:i},{name:"registerMethod",type:Function,mayBeNull:i},{name:"registerMethodInvokeType",type:Number,mayBeNull:i},{name:"unregisterMethod",type:Function,mayBeNull:i},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:i}]);if(o)throw o;var s=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,i),new Microsoft.Office.Common.MethodObject(r,a,i));this._methodObjectList[e]=s},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,r){var i="appDomains",o=!0,s=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:o},{name:i,type:Object,mayBeNull:o,optional:o},{name:"serializerVersion",type:Number,mayBeNull:o,optional:o}]);if(s)throw s;if(n){if(!(n instanceof Array))throw a.msAjaxError.argument(i);this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:r}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t="policyManager",n=Function._validateParams(arguments,[{name:t,type:Object,mayBeNull:!1}]);if(n)throw n;if(!e.checkPermission)throw a.msAjaxError.argument(t);this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){var e=null,t=this;t._methodObjectList=e,t._eventHandlerProxyList=e,t._Id=e,t._conversations=e,t._policyManager=e,t._appDomains=e,t._onHandleRequestError=e}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,r){var o="targetWindow",s=this,c=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:o,mayBeNull:!1},{name:"targetUrl",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(c)throw c;try{if(!t.postMessage)throw a.msAjaxError.argument(o)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw a.msAjaxError.argument(o)}s._conversationId=e,s._targetWindow=t,s._targetUrl=n,s._callingIndex=0,s._callbackList={},s._eventHandlerList={},s._serializerVersion=null!=r?r:i.SerializerVersion.Browser},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(a)throw a;var i=r._callingIndex++,o=new Date,s={callback:t,createdOn:o.getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(s.timeout=n.__timeout__,delete n.__timeout__),r._callbackList[i]=s;try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,r._conversationId,i,n),u=Microsoft.Office.Common.MessagePackager.envelope(c,r._serializerVersion);r._targetWindow.postMessage(u,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}},registerForEvent:function(e,t,n,r){var a=this,i=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(i)throw i;var o=a._callingIndex++,s=new Date;a._callbackList[o]={callback:n,createdOn:s.getTime()};try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,a._conversationId,o,r),u=Microsoft.Office.Common.MessagePackager.envelope(c,a._serializerVersion);a._targetWindow.postMessage(u,a._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),a._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[o]}}},unregisterForEvent:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(a)throw a;var i=r._callingIndex++,o=new Date;r._callbackList[i]={callback:t,createdOn:o.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,r._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}finally{delete r._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e="serviceEndPointId",t=!0,n="channel is not ready.",r="conversationId",o="Unknown conversation Id.",s=!1,c=null,u=[],d=c,f=c,p=10,m=s,g=c,v=65e3,h=v,b={},y={},_=s;function O(e){for(var t in b)if(b[t]._conversations[e])return b[t];throw a.msAjaxDebug.trace(o),a.msAjaxError.argument(r)}function S(e){var t=y[e];return!t&&a.msAjaxDebug.trace(o),t}function C(e){u.push(e)}function I(){if(f!==c){if(!m)if(u.length>0){A(u.shift())}else clearInterval(f),f=c}else a.msAjaxDebug.trace(n)}function A(e){m=e.getInvokeBlockingFlag(),e.invoke(),d=(new Date).getTime()}function x(){if(g){var e,t,r=0,i=new Date;for(var o in y)for(var s in(e=y[o])._callbackList){var u=e._callbackList[s];if((t=u.timeout?u.timeout:h)>=0&&Math.abs(i.getTime()-u.createdOn)>=t)try{u.callback&&u.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,c)}finally{delete e._callbackList[s]}else r++}0===r&&(clearInterval(g),g=c)}else a.msAjaxDebug.trace(n)}function E(){m=s}function T(e,n){var r,a,i=s;return e===t?t:e&&n&&e.length&&n.length?(r=document.createElement("a"),a=document.createElement("a"),r.href=e,a.href=n,i=j(r,a),delete r,i):i}function w(e,t){var n=s;if(!(t&&t.length&&e&&e instanceof Array&&e.length))return n;var r=document.createElement("a"),a=document.createElement("a");r.href=t;for(var i=0;i<e.length&&!n;i++)-1!==e[i].indexOf("://")&&(a.href=e[i],n=j(r,a));return delete r,n}function j(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&e.port==t.port}function P(e){var n="Access Denied";if(i&&""!=e.data){var r,o=i.SerializerVersion.Browser,u=e.data;try{o=(r=Microsoft.Office.Common.MessagePackager.unenvelope(u,i.SerializerVersion.Browser))._serializerVersion!=c?r._serializerVersion:o}catch(e){return}if(r._messageType===Microsoft.Office.Common.MessageType.request){var g=e.origin==c||"null"==e.origin?r._origin:e.origin;try{var v=O(r._conversationId),h=v._conversations[r._conversationId];o=h.serializerVersion!=c?h.serializerVersion:o;var b=[h.url].concat(v._appDomains[r._conversationId]);if(!w(b,e.origin)&&!l.appSpecificCheckOrigin(b,e,r._origin,w))throw"Failed origin check";var y=v.getPolicyManager();if(y&&!y.checkPermission(r._conversationId,r._actionName,r._data))throw n;var _=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw a.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),a.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(v,r),x=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,g,r._actionName,r._conversationId,r._correlationId,E,o),j=new Microsoft.Office.Common.Invoker(_,r._data,x,v._eventHandlerProxyList,r._conversationId,r._actionName,o),P=t;f==c&&((d==c||(new Date).getTime()-d>p)&&!m?(A(j),P=s):f=setInterval(I,p)),P&&C(j)}catch(t){v&&v._onHandleRequestError&&v._onHandleRequestError(r,t);var M=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;t==n&&(M=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var k=new Microsoft.Office.Common.Response(r._actionName,r._conversationId,r._correlationId,M,Microsoft.Office.Common.ResponseType.forCalling,t),R=Microsoft.Office.Common.MessagePackager.envelope(k,o),D=s;try{D=!(!e.source||!e.source.postMessage)}catch(e){}D&&e.source.postMessage(R,g)}}else{if(r._messageType!==Microsoft.Office.Common.MessageType.response)return;var N=S(r._conversationId);if(!N)return;if(N._serializerVersion=o,!T(N._targetUrl,e.origin))throw"Failed orgin check";if(r._responseType===Microsoft.Office.Common.ResponseType.forCalling){var F=N._callbackList[r._correlationId];if(F)try{F.callback&&F.callback(r._errorCode,r._data)}finally{delete N._callbackList[r._correlationId]}}else{var L=N._eventHandlerList[r._actionName];void 0!==L&&L!==c&&L(r._data)}}}}function M(){_||(!function(e){if(window.addEventListener)window.addEventListener("message",e,s);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw a.msAjaxDebug.trace("Browser doesn't support the required API."),a.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(P),_=t)}return{connect:function(e,t,n,r){var a=y[e];return a||(M(),a=new Microsoft.Office.Common.ClientEndPoint(e,t,n,r),y[e]=a),a},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:s}]);if(t)throw t;return y[e]},createServiceEndPoint:function(e){M();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return b[e]=t,t},getServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;return b[t]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:s}]);if(t)throw t;delete y[e]},deleteServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;delete b[t]},checkUrlWithAppDomains:function(e,t){return w(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:s}]);if(t)throw t;h=e<=0?v:e},_startMethodTimeoutTimer:function(){g||(g=setInterval(x,2e3))}}}(),Microsoft.Office.Common.Message=function(e,t,n,r,a){var i=!1,o=this,s=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:i},{name:"actionName",type:String,mayBeNull:i},{name:"conversationId",type:String,mayBeNull:i},{name:"correlationId",mayBeNull:i},{name:"data",mayBeNull:!0,optional:!0}]);if(s)throw s;o._messageType=e,o._actionName=t,o._conversationId=n,o._correlationId=r,o._origin=window.location.href,o._data=void 0===a?null:a},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,r,a){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,r,a),this._actionType=t},i.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,r,a,i){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,i),this._errorCode=r,this._responseType=a},i.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=i.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,r,i,o,s){var c=!1,u=this,l=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(l)throw l;u._requesterWindow=e,u._requesterUrl=t,u._actionName=n,u._conversationId=r,u._correlationId=i,u._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,u._responseType=o;var d=u;u._send=function(e){try{var t=new Microsoft.Office.Common.Response(d._actionName,d._conversationId,d._correlationId,d._invokeResultCode,d._responseType,e),n=Microsoft.Office.Common.MessagePackager.envelope(t,s);d._requesterWindow.postMessage(n,d._requesterUrl)}catch(e){a.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,r,i,o,s){var c=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(c,e,t,n,r,i,Microsoft.Office.Common.ResponseType.forCalling,s),c._postCallbackHandler=o;var u=c;c._send=function(e,t){null!=t&&(u._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(u._actionName,u._conversationId,u._correlationId,u._invokeResultCode,u._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,s);u._requesterWindow.postMessage(r,u._requesterUrl),u._postCallbackHandler()}catch(e){a.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},i.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,r,a,i,o){var s=!0,c=!1,u=this,l=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:c},{name:"paramValue",mayBeNull:s},{name:"invokeCompleteCallback",mayBeNull:c},{name:"eventHandlerProxyList",mayBeNull:s},{name:"conversationId",type:String,mayBeNull:c},{name:"eventName",type:String,mayBeNull:c},{name:"serializerVersion",type:Number,mayBeNull:s,optional:s}]);if(l)throw l;u._methodObject=e,u._param=t,u._invokeCompleteCallback=n,u._eventHandlerProxyList=r,u._conversationId=a,u._eventName=i,u._serializerVersion=o},Microsoft.Office.Common.Invoker.prototype={invoke:function(){var e=this;try{var t;switch(e._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:e._methodObject.getMethod()(e._param,e._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:t=e._methodObject.getMethod()(e._param),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var n=e._createEventHandlerProxyObject(e._invokeCompleteCallback);t=e._methodObject.getMethod()(n.getSend(),e._param),e._eventHandlerProxyList[e._conversationId+e._eventName]=n.getSend(),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var r=e._eventHandlerProxyList[e._conversationId+e._eventName];t=e._methodObject.getMethod()(r,e._param),delete e._eventHandlerProxyList[e._conversationId+e._eventName],e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var a=e._createEventHandlerProxyObject(e._invokeCompleteCallback);e._methodObject.getMethod()(a.getSend(),e._invokeCompleteCallback.getSend(),e._param),e._eventHandlerProxyList[e._callerId+e._eventName]=a.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var i=e._eventHandlerProxyList[e._callerId+e._eventName];e._methodObject.getMethod()(i,e._invokeCompleteCallback.getSend(),e._param),delete e._eventHandlerProxyList[e._callerId+e._eventName]}}catch(t){e._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),e._invokeCompleteCallback.getSend()(t)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},i.OUtil.setNamespace("OSF",window),i.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},i.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614},i.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},i.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},i.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23},i.SharedConstants={NotificationConversationIdSuffix:"_ntf"},i.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},i.OfficeAppContext=function(e,t,n,r,a,i,o,s,c,u,l,d,f,p,m,g,v,h,b,y,_,O,S,C){var I=this;I._id=e,I._appName=t,I._appVersion=n,I._appUILocale=r,I._dataLocale=a,I._docUrl=i,I._clientMode=o,I._settings=s,I._reason=c,I._osfControlType=u,I._eToken=l,I._correlationId=d,I._appInstanceId=f,I._touchEnabled=p,I._commerceAllowed=m,I._appMinorVersion=g,I._requirementMatrix=v,I._hostCustomMessage=h,I._hostFullVersion=b,I._isDialog=!1,I._clientWindowHeight=y,I._clientWindowWidth=_,I._addinName=O,I._appDomains=S,I._dialogRequirementMatrix=C,I.get_id=function(){return this._id},I.get_appName=function(){return this._appName},I.get_appVersion=function(){return this._appVersion},I.get_appUILocale=function(){return this._appUILocale},I.get_dataLocale=function(){return this._dataLocale},I.get_docUrl=function(){return this._docUrl},I.get_clientMode=function(){return this._clientMode},I.get_bindings=function(){return this._bindings},I.get_settings=function(){return this._settings},I.get_reason=function(){return this._reason},I.get_osfControlType=function(){return this._osfControlType},I.get_eToken=function(){return this._eToken},I.get_correlationId=function(){return this._correlationId},I.get_appInstanceId=function(){return this._appInstanceId},I.get_touchEnabled=function(){return this._touchEnabled},I.get_commerceAllowed=function(){return this._commerceAllowed},I.get_appMinorVersion=function(){return this._appMinorVersion},I.get_requirementMatrix=function(){return this._requirementMatrix},I.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},I.get_hostCustomMessage=function(){return this._hostCustomMessage},I.get_hostFullVersion=function(){return this._hostFullVersion},I.get_isDialog=function(){return this._isDialog},I.get_clientWindowHeight=function(){return this._clientWindowHeight},I.get_clientWindowWidth=function(){return this._clientWindowWidth},I.get_addinName=function(){return this._addinName},I.get_appDomains=function(){return this._appDomains}},i.OsfControlType={DocumentLevel:0,ContainerLevel:1},i.ClientMode={ReadOnly:0,ReadWrite:1},i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Client",Microsoft.Office),i.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},i.OUtil.setNamespace("DDA",i),i.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},i.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},i.DDA.EventDescriptors={},i.DDA.ListDescriptors={},i.DDA.UI={},i.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},i.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147},i.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},i.Constants={FileVersion:"16.0.10908.10000",ThreePartsFileVersion:"16.0.10908",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",OmexConsentNotificationPage:"/client/consentnotification.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"https://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js",StringResourceFile:"osfruntime_strings.js"};var o,s,c=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};!function(e){!function(e){var t="ov:Control",n="ov:SourceLocation",r="resid",a="ov:Description",i="ov:Title",o="bt:Image",s="ov:VersionOverrides",u="o:OfficeApp",l=null,d=function(e){this.name="AddinManifestError",this.message=this.name+": "+e},f=function(e){this.name="AddinInternalError",this.message=e};function p(e,t){if(e==l)throw new d(t)}var m=function(){function e(e){var t="bt:String",n=this;n.Images={},n.Urls={},n.LongStrings={},n.ShortStrings={};var r=e.manifest._xmlProcessor.selectSingleNode(u),a=e.selectSingleNode(r,[s,"ov:Resources"]);n.parseCollection(e,e.selectChildNodes(o,a,["bt:Images"]),n.Images),n.parseCollection(e,e.selectChildNodes("bt:Url",a,["bt:Urls"]),n.Urls),n.parseCollection(e,e.selectChildNodes(t,a,["bt:LongStrings"]),n.LongStrings),n.parseCollection(e,e.selectChildNodes(t,a,["bt:ShortStrings"]),n.ShortStrings)}return e.prototype.parseCollection=function(e,t,n){for(var r=t.length,a=0;a<r;a++){var i=t[a];n[i.getAttribute("id")]=e.parseLocaleAwareSettingsAndGetValue(i)}},e}();e.ManifestResourceManager=m;var g=function(){function e(e,t,n,r){var a=this;a.hostType=e,a.formFactor=t,a.entitlement=n,a.manifest=r,a.resources=new m(a)}return e.prototype.parseIdRequired=function(e){var t=e.getAttribute("id");return p(t,"Id required"),t},e.prototype.parseLabel=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:Label",e);return t!=l?this.getShortString(t):l},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return p(t,"Label required"),t},e.prototype.parseRequiredSuperTip=function(e){var t=this.parseSuperTip(e);return p(t,"SuperTip required"),t},e.prototype.parseSuperTip=function(e){var t=this,n=l,r=t.manifest._xmlProcessor.selectSingleNode("ov:Supertip",e);if(r!=l){var o,s=r;p(r=t.manifest._xmlProcessor.selectSingleNode(i,s),"Title is necessary for SuperTip."),o=t.getShortString(r),p(r=t.manifest._xmlProcessor.selectSingleNode(a,s),"Description is necessary for SuperTip."),n={title:o,description:t.getLongString(r)}}return n},e.prototype.parseRequiredIcon=function(e){var t=this.parseIcon(e);return p(t,"Icon required"),t},e.prototype.parseIcon=function(e){var t=this.selectChildNodes(o,e,["ov:Icon"]),n=t.length;if(0==n)return l;for(var r={},a=0;a<n;a++){var i=t[a];r[i.getAttribute("size")]=this.getImageResource(i)}return r},e.prototype.parseChildControls=function(e,t,n){var r=this.manifest._xmlProcessor.selectNodes(e,t);return this.parseControls(r,n)},e.prototype.parseControls=function(e,t){for(var n=[],r=e.length,a=0;a<r;a++){var i=t(this,e[a]);p(i,"parser must return a control."),n.push(i)}return n},e.prototype.parseControlInGroup=function(t){var n,r=t.getAttribute(e.typeAttributeName);switch(r){case"Menu":n=new C;break;case"Button":n=new A(r);break;default:throw new d("Unsupported control type.")}return n.parse(this,t),n},e.prototype.parseMenuItem=function(e){var t=new x;return t.parse(this,e),t},e.prototype.parseLocaleAwareSettingsAndGetValue=function(e){var t=this,n={},r=e.getAttribute("DefaultValue");n[t.manifest._defaultLocale]=r,n[t.manifest._defaultLocale.toLocaleLowerCase()]=r;var a=t.manifest._xmlProcessor.selectNodes("bt:Override",e);if(a)for(var i=a.length,o=0;o<i;o++){var s=(e=a[o]).getAttribute("Locale"),c=e.getAttribute("Value");n[s]=c,n[s.toLocaleLowerCase()]=c}return t.manifest._getDefaultValue(n)},e.prototype.selectSingleNode=function(e,t){if(t==l)return e;for(var n=0;n<t.length&&(e=this.manifest._xmlProcessor.selectSingleNode(t[n],e))!=l;n++);return e},e.prototype.selectChildNodes=function(e,t,n){return(t=this.selectSingleNode(t,n))==l?[]:this.manifest._xmlProcessor.selectNodes(e,t)},e.prototype.getResourceByNode=function(e,t){var n=t.getAttribute(r),a=e[n];return p(a,"resid: "+n+" not found"),a},e.prototype.getImageResource=function(e){return this.getResourceByNode(this.resources.Images,e)},e.prototype.getUrlResource=function(e){return this.getResourceByNode(this.resources.Urls,e)},e.prototype.getLongString=function(e){return this.getResourceByNode(this.resources.LongStrings,e)},e.prototype.getShortString=function(e){return this.getResourceByNode(this.resources.ShortStrings,e)},e.typeAttributeName="xsi:type",e}();e.ParsingContext=g;var v=function(){function e(){}return e.buildControls=function(e,t){for(var n=t.length,r=0;r<n;r++){t[r].apply(e)}},e}(),h=function(e,t){this.functionFile=e,this.builder=t},b=function(){function e(){}return e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor,r=n.selectSingleNode(i,t);p(r,"Title is necessary for GetStarted."),this.title=e.getShortString(r);var o=n.selectSingleNode(a,t);p(o,"Description is necessary for GetStarted."),this.description=e.getLongString(o);var s=n.selectSingleNode("ov:LearnMoreUrl",t);this.learnMoreUrl=e.getUrlResource(s)},e}(),y=function(){function e(e){this.type=e}return e.prototype.buildAction=function(){},e.prototype.parse=function(){},e}(),_=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return e.actionBuilder.buildShowTaskpane(this.sourceLocation,this.title,this.taskpaneId)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n);var r=t.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",n);r!=l&&(this.taskpaneId=r.firstChild.nodeValue),(r=t.manifest._xmlProcessor.selectSingleNode(i,n))!=l&&(this.title=t.getShortString(r))},t}(function(e){function t(){e.apply(this,arguments),this.title=l}return c(t,e),t.prototype.parse=function(e,t){var r=e.manifest._xmlProcessor.selectSingleNode(n,t);p(r,"SourceLocation is necessary for ShowTaskpane action"),this.sourceLocation=e.getUrlResource(r),e.manifest.addManifestUrl(this.sourceLocation)},t}(y)),O=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return p(e.functionFile,"Function file source url is necessary for ExecuteFunctionAction."),e.actionBuilder.buildCallFunction(e.functionFile,this.functionName,this.controlId)},t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",t);p(n,"FunctionName is necessary for ExecuteFunctionAction."),this.functionName=e.manifest._xmlProcessor.getNodeValue(n)},t}(y),S=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),C=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.apply=function(e){e.controlBuilder.startBuildMenu(this),v.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=t.parseRequiredIcon(n),r.superTip=t.parseRequiredSuperTip(n);var a=t.selectChildNodes("ov:Item",n,["ov:Items"]);r.children=t.parseControls(a,(function(e,t){return e.parseMenuItem(t)}))},t}(S),I=function(e){function t(t){e.call(this),this.controlType=t}return c(t,e),t.prototype.apply=function(e){var t=this,n=t.action.buildAction(e),r={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:n};t.applyControl(e,r)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=r.parseIcon(t,n),r.superTip=t.parseRequiredSuperTip(n);var a=t.manifest._xmlProcessor.selectSingleNode("ov:Action",n);p(a,"Action is necessary for itemControl.");var i,o=a.getAttribute(g.typeAttributeName);switch(o){case"ShowTaskpane":i=new _(o);break;case"ExecuteFunction":(i=new O(o)).controlId=r.id;break;default:throw new d("Unsupported action type.")}i.parse(t,a),r.actionType=o,r.action=i},t.prototype.applyControl=function(){throw new f("Not implemented method applyControl for ItemControl.")},t.prototype.parseIcon=function(e,t){return e.parseIcon(t)},t}(S),A=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addButton(t)},t.prototype.parseIcon=function(e,t){return e.parseRequiredIcon(t)},t}(I),x=function(e){function t(){e.call(this,"MenuItem")}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addMenuItem(t)},t}(I),E=function(){function e(e){var t=this;t.label=l,t.isOfficeTab=!1,t.children=[],t.isOfficeTab=e}return e.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildTab(this);for(var t=this.children.length,n=0;n<t;n++){this.children[n].apply(e)}e.builder.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var n=this;n.id=e.parseIdRequired(t),n.isOfficeTab||(n.label=e.parseLabelRequired(t)),n.children=e.parseChildControls("ov:Group",t,(function(e,t){var n=new T;return n.parse(e,t),n}))},e}(),T=function(e){function n(){e.apply(this,arguments)}return c(n,e),n.prototype.parse=function(n,r){e.prototype.parse.call(this,n,r),this.icon=n.parseRequiredIcon(r),this.children=n.parseChildControls(t,r,(function(e,t){return e.parseControlInGroup(t)}))},n.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildGroup(this),v.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.ribbonBuilder},this.children),e.builder.ribbonBuilder.endBuildGroup()},n}(S),w=function(){function e(e){this.type=e,this.tabs=[]}return e.prototype.apply=function(e){if(this.type==e.builder.commandSurface)for(var t=this.tabs.length,n=0;n<t;n++){this.tabs[n].apply(e)}},e.prototype.parse=function(e,t){var n,r=e.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",t);r!=l&&((n=new E(!0)).parse(e,r),this.tabs.push(n));(r=e.manifest._xmlProcessor.selectSingleNode("ov:CustomTab",t))!=l&&((n=new E(!1)).parse(e,r),this.tabs.push(n))},e}(),j=function(){function e(){}return e.prototype.parse=function(e,n){this.id=e.parseIdRequired(n),this.children=e.parseChildControls(t,n,(function(e,t){return e.parseControlInGroup(t)}))},e.prototype.apply=function(e){e.controlBuilder.startBuildMenu({id:this.id,label:l,superTip:l}),v.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},e}(),P=function(){function e(e){this.type=e}return e.prototype.apply=function(e){this.type==e.builder.commandSurface&&v.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.contextMenuBuilder},this.children)},e.prototype.parse=function(e,t){this.children=e.parseChildControls("ov:OfficeMenu",t,(function(e,t){var n=new j;return n.parse(e,t),n}))},e}(),M=function(){function e(e){this.type=e}return e.prototype.apply=function(){},e.prototype.parse=function(e,t){var n=this,a=e.manifest._xmlProcessor.selectSingleNode("ov:Namespace",t);if(a&&(n.namespaceResId=a.getAttribute(r)),!n.namespaceResId)throw new d("Missing required <Namespace> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var i=e.manifest._xmlProcessor.selectSingleNode("ov:Script",t);if(i&&(n.scriptResId=n._parseSourceLocationResId(e,i)),!n.scriptResId)throw new d("Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var o=e.manifest._xmlProcessor.selectSingleNode("ov:Page",t);if(o&&(n.pageResId=n._parseSourceLocationResId(e,o)),!n.pageResId)throw new d("Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var s=e.manifest._xmlProcessor.selectSingleNode("ov:Metadata",t);if(s&&(n.metadataResId=n._parseSourceLocationResId(e,s)),!n.metadataResId)throw new d("Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.")},e.prototype._parseSourceLocationResId=function(e,t){var a=e.manifest._xmlProcessor.selectSingleNode(n,t);if(a)return a.getAttribute(r)},e}();e.CustomFunctionsExtensionPoint=M;var k=function(){function e(){var e=this;e.getStartedNode=l,e.functionFile=l,e.cacheableUrls=[],e.ExtensionPoints=[]}return e.prototype.cacheableResources=function(){return this.cacheableUrls},e.prototype.apply=function(e,t){var n=this;try{e.startApplyAddin({entitlement:n.extensionEntitlement,manifest:n.extensionManifest,startedNode:n.getStartedNode,overrides:{type:n.type,description:n.description}});for(var r=new h(n.functionFile,e),a=n.ExtensionPoints.length,i=0;i<a;i++){n.ExtensionPoints[i].apply(r)}e.endApplyAddin()}catch(e){throw e instanceof d&&t.setErrorMessageForAddin(n.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),e}},e.prototype.parse=function(e,t){var n=this;n.type=t.getAttribute(g.typeAttributeName);var r=e.manifest._xmlProcessor.selectSingleNode(a,t);r!=l&&(n.description=e.getLongString(r));for(var i=e.selectChildNodes("ov:Host",t,["ov:Hosts"]),o=l,s=i.length,c=0;c<s;c++){var u=i[c];if(u.getAttribute(g.typeAttributeName)==e.hostType){(o=e.manifest._xmlProcessor.selectSingleNode("ov:"+e.formFactor,u))==l&&(o=e.manifest._xmlProcessor.selectSingleNode("ov:AllFormFactors",u));break}}var f=e.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",o);f!=l&&(n.getStartedNode=new b,n.getStartedNode.parse(e,f)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",o))!=l&&(n.functionFile=e.getUrlResource(r),e.manifest.addManifestUrl(n.functionFile));var p=e.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",o);s=p.length;for(c=0;c<s;c++){var m,v=p[c],h=v.getAttribute(g.typeAttributeName);switch(h){case"Events":throw"Not Implemented";case"PrimaryCommandSurface":m=new w(h);break;case"ContextMenu":m=new P(h);break;case"CustomFunctions":m=new M(h);break;default:throw new d("Unsupported extension type.")}m.parse(e,v),n.ExtensionPoints.push(m)}var y=e.resources.Images;for(var _ in y)n.cacheableUrls.push(y[_]);n.extensionEntitlement=e.entitlement,n.extensionManifest=e.manifest},e}();e.VersionOverrides=k;var R=function(){function e(){}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(){},e}(),D=function(){function e(e,t){this.hostType=e,this.formFactor=t}return e.prototype.parseExtensions=function(e,t,n){try{var r=t._xmlProcessor.selectSingleNode(u),a=t._xmlProcessor.selectSingleNode(s,r);if(a==l)return new R;var i=new k;return i.parse(new g(this.hostType,this.formFactor,e,t),a),i}catch(t){throw t instanceof d&&n.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}},e}();e.AddinCommandsManifestParser=D}(e.Parser||(e.Parser={}))}(l||(l={})),function(e){var t=function(){function e(){}return e.createManifestForAddinAction=function(e,t,n,r){var a=null,o=new i.Manifest.ExtensionSettings,s=(i.FormFactor.Default,{}),c=e._UILocale.toLocaleLowerCase();s[c]=n,o._defaultHeight=a,o._defaultWidth=a,o._sourceLocations={},o._sourceLocations[c]=t;var u=e;return new i.Manifest.Manifest((function(e){e._xmlProcessor=u._xmlProcessor,e._displayNames=n!=a?s:u._displayNames,e._iconUrls=u._iconUrls,e._extensionSettings={formFactor:o},e._highResolutionIconUrls=u._highResolutionIconUrls,e._target=u._target,e._id=r!=a?r:u._id,e._version=u._version,e._providerName=u._providerName,e._idIssuer=u._idIssuer,e._alternateId=u._alternateId,e._defaultLocale=u._defaultLocale,e._signature=u._signature,e._capabilities=u._capabilities,e._hosts=u._hosts,e._descriptions=u._descriptions,e._appDomains=u._appDomains,e._permissions=u._permissions,e._requirements=u._requirements,e._webApplicationResource=u._webApplicationResource,e._webApplicationId=u._webApplicationId,e._webApplicationScopes=u._webApplicationScopes,e._webApplicationAuthorizations=u._webApplicationAuthorizations}),u._UILocale)},e.cacheManifestForAction=function(e,t,n){i.OsfManifestManager.cacheManifest(t,n,e)},e.purgeManifestForAction=function(e,t){i.OsfManifestManager.purgeManifest(e,t)},e}();e.AddinCommandsManifestManager=t}(l||(l={})),function(e){var t="##UILessContainer##",n=null;e.AddinActionContextMap={},e.AutoShowTaskPaneControlIdMap={};var r={};!function(e){var t="ExclusiveForNew",n="ExclusiveForCur";e[e.Default=1]="Default",e[e[n]=2]=n,e[e[t]=3]=t}(e.CommandInvokeMode||(e.CommandInvokeMode={}));var a,o=e.CommandInvokeMode;!function(e){var t="ooeOperationNotSupported",n="ooeSuccess",r="ooeTimeout";e[e[r]=-1]=r,e[e[n]=0]=n,e[e[t]=5e3]=t}(a||(a={}));var s=function(){function o(e,t,n){this.contextProvider=e,this.manifest=n,this.entitlement=t}return o.prototype.buildShowTaskpane=function(e,t,n){return this.CreateManifestAndActivationContextForTaskpaneCommand(e,t,n)},o.prototype.buildCallFunction=function(e,t,n){return this.CreateManifestAndActivationContextForUILessCommand(e,t,n)},o.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,t,i){var o=function(e,t){t==a.ooeSuccess&&i!=n&&(r[i]=e)},s=function(e,t){var a=r[e];if(a==n)return!1;var i=t.getOsfControl(a);return i!=n&&(i._refresh(),!0)};return this.CreateManifestAndActivationContext(e,t,i,(function(e,t,r,a){i!=n&&s(i,t),e.showTaskpane(r,a,o)}))},o.prototype.CreateManifestAndActivationContext=function(t,r,a,o){var s=this,c=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,t,r,n);return function(t){var r=s.contextProvider.createActionContext(t,(function(n,r){var u={assetId:s.entitlement.assetId+(a||t),appVersion:s.entitlement.appVersion,storeId:s.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane};c._inMemoryEToken=s.entitlement.eToken,e.AddinCommandsManifestManager.cacheManifestForAction(c,u.assetId,u.appVersion),o(n,r,u,c)}));e.AddinActionContextMap[t]=r,e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]==n&&"Office.AutoShowTaskpaneWithDocument"==a&&(e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]=t)}},o.prototype.CreateManifestAndActivationContextForUILessCommand=function(r,o,s){var c=this,u=function(e,t){if(t==a.ooeSuccess){var n={source:{id:s}};d.invokeAppCommand(e,o,n,(function(){}))}},l=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,r,n,n);return function(n){var r=c.contextProvider.createActionContext(n,(function(n){var r={assetId:c.entitlement.assetId+t,appVersion:c.entitlement.appVersion,storeId:c.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane};e.AddinCommandsManifestManager.cacheManifestForAction(l,r.assetId,r.appVersion),n.createUILessSandbox(r,l,(function(e,t){if(t==a.ooeSuccess)d.ensureOsfHostEntry(e,n);u(e,t)}))}));e.AddinActionContextMap[n]=r}},o}(),c=function(){function n(e,t){this.contextProvider=e,this.entitlement=t}return n.prototype.buildShowTaskpane=function(){var t=this;return function(n){delete e.AddinActionContextMap[n],e.AddinCommandsManifestManager.purgeManifestForAction(t.entitlement.assetId+n,t.entitlement.appVersion)}},n.prototype.buildCallFunction=function(){var n=this;return function(r){delete e.AddinActionContextMap[r],e.AddinCommandsManifestManager.purgeManifestForAction(n.entitlement.assetId+t,n.entitlement.appVersion)}},n}(),u=function(){function t(){}return t.createActionBuilder=function(e,t,n){return new s(e,t,n)},t.createDeleterActionBuilder=function(e,t){return new c(e,t)},t.bindAction=function(e,t){t(e)},t.retrieveActionContext=function(t){return e.AddinActionContextMap[t]},t.retrieveAutoShowTaskPaneControlIdMap=function(){return e.AutoShowTaskPaneControlIdMap},t}();e.DefaultControlActionBinder=u;var l=function(){function e(){this.invocationQueue={}}return e.prototype.invokeAppCommand=function(t,r,a,s,c){var u=this,l={dispid:i.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:u.osfControlId};l[0]=t,l[1]=r,l[2]=JSON.stringify(a),c=c||e.defaultTimeout;var d=a&&a.commandMode?a.commandMode:o.Default,f={args:l,onComplete:s,timeout:c,timeoutTimer:n},p=u.invocationQueue[r];p==n&&(p=[],u.invocationQueue[r]=p),!(d==o.ExclusiveForCur&&p.length>0)&&!(d==o.ExclusiveForNew&&p.length>1)&&p.push(f),1==p.length&&u.trySendInvocation(f)},e.prototype.invocationCompleted=function(e,t,r){var a=this,i=a;for(var o in a.invocationQueue){var s=a.invocationQueue[o],c=s[0];if(e==c.args[0]){if(s.length>1){s.splice(0,1);var u=s[0];window.setTimeout((function(){i.trySendInvocation(u)}),0)}else delete a.invocationQueue[o];return c.timeoutTimer!=n&&(window.clearTimeout(c.timeoutTimer),c.timeoutTimer=n),void c.onComplete(t,r)}}},e.prototype.sendInvocations=function(e){var t=this;if(t.eventHandler=e,e!=n)for(var r in t.invocationQueue){var a=t.invocationQueue[r][0];t.sendInvocation(e,a)}},e.prototype.trySendInvocation=function(e){var t=this.eventHandler;t!=n&&this.sendInvocation(t,e)},e.prototype.sendInvocation=function(e,t){var n=this,r=t.args;e(r),t.timeoutTimer=window.setTimeout((function(){n.invocationTimeout(r[0])}),t.timeout)},e.prototype.invocationTimeout=function(e){this.invocationCompleted(e,a.ooeTimeout,n)},e.prototype.disposeHost=function(){var e=this;for(var t in e.invocationQueue)return;e.host.disposeHost(e.osfControlId),e.onDisposed!=n&&e.onDisposed(e)},e.defaultTimeout=3e5,e}(),d=function(){var e="targetId",t="controlId",r="eventDispId";function o(){}return o.registerEvent=function(n,a,i){o.registerEventInternal(i[r],i[t],i[e],n,(function(e){a&&a(0==e)}))},o.unregisterEvent=function(n,a,i){o.unregisterEventInternal(i[r],i[t],i[e],n,(function(e){a&&a(0==e)}))},o.invokeAppCommand=function(e,t,n,r){var a=o.getOrCreateOsfHostEntry(e),i=o.getNextAppCommandId();a.invokeAppCommand(i,t,n,r)},o.invocationCompleted=function(e,t){var r=o.getOrCreateOsfHostEntry(e),a=t[0],i=t[1],s=t[2]?JSON.parse(t[2]):n;r.invocationCompleted(a,i,s)},o.ensureOsfHostEntry=function(e,t){var r=o.getOrCreateOsfHostEntry(e);return r.host==n&&(r.host=t),r},o.getNextAppCommandId=function(){return"AppCmd"+o._nextAppCommandId++},o.getOrCreateOsfHostEntry=function(e){var t=o._invocationQueues[e];return t==n&&((t=new l).osfControlId=e,t.onDisposed=function(e){delete o._invocationQueues[e.osfControlId]},o._invocationQueues[e]=t),t},o.registerEventInternal=function(e,t,n,r,s){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var c=o.getOrCreateOsfHostEntry(t);return s(a.ooeSuccess),void c.sendInvocations(r)}s(a.ooeOperationNotSupported)},o.unregisterEventInternal=function(e,t,r,s,c){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var u=o.getOrCreateOsfHostEntry(t);return u.eventHandler==s&&(u.eventHandler=n),void c(a.ooeSuccess)}c(a.ooeOperationNotSupported)},o._nextAppCommandId=0,o._invocationQueues={},o}();e.AddinCommandsRuntimeManager=d}(l||(l={})),i.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen"},i.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},i.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},i.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},i.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},i.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},i.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){!function(e){var t="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function n(e){if("undefined"!=typeof JSON)try{return JSON.stringify(e)}catch(e){}return""}function r(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return o("Error happens in isInternetExplorer.",e),!1}}function o(e,t){a.msAjaxDebug.trace(e+" Exception details: "+n(t))}e.parseAppContextFromWindowName=function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.AppContext)},e.serializeObjectToString=n,e.isHostTrusted=function(){return new RegExp(t).test(i.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,r="#",a=(e=e.trim()||"").split(r),i=a.shift(),o=a.join(r),s=i.split("?");return s.length>1?n=i+"&_host_Info="+t:s.length>0&&(n=i+"?_host_Info="+t),o?[n,r,o].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3"],t=window.navigator.userAgent,n=0,a=e.length;n<a;n++)if(t.indexOf(e[n])>-1)return r();return!1}catch(e){return o("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=r,e.removeMatchesFromLocalStorage=function(e){for(var t=i.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),r=0,a=n.length;r<a;r++)for(var o=n[r],s=0,c=e.length;s<c;s++)if(e[s].test(o)){t.removeItem(o);break}},e.logExceptionToBrowserConsole=o;var s=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+"appinstall_authenticated.{0}.{1}.{2}.{3}",e.EntitlementsKey="entitle.{0}.{1}",e}();e.CacheConstants=s}(e.WACUtils||(e.WACUtils={}))}(l||(l={})),i.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64},i.Xpath3Provider=function(e,t){var n=this;n._xmldoc=(new DOMParser).parseFromString(e,"text/xml"),n._evaluator=new XPathEvaluator,n._namespaceMapping={},n._defaultNamespace=null;for(var r,a=t.split(" "),i=0;i<a.length;++i)(r=/xmlns="([^"]*)"/g.exec(a[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(a[i]))&&(n._namespaceMapping[r[1]]=r[2]);n._resolver=n},i.Xpath3Provider.prototype={lookupNamespaceURI:function(e){return this._namespaceMapping[e]||this._defaultNamespace},addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return r?r.singleNodeValue:null},selectNodes:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),a=[];if(r)for(var i=r.iterateNext();i;)a.push(i),i=r.iterateNext();return a},selectNodesByXPath:function(e,t){var n=this._evaluator.evaluate(e,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=[];if(n)for(var a=n.iterateNext();a;)r.push(a),a=n.iterateNext();return r},getDocumentElement:function(){return this._xmldoc.documentElement}},i.IEXpathProvider=function(e,t){for(var n=null,r=["MSXML2.DOMDocument.6.0"],o=0;o<r.length;o++)try{(n=new ActiveXObject(r[o])).setProperty("ResolveExternals",!1),n.setProperty("ValidateOnParse",!1),n.setProperty("ProhibitDTD",!0),n.setProperty("MaxXMLSize",i.XmlConstants.MaxXmlSize),n.setProperty("MaxElementDepth",i.XmlConstants.MaxElementDepth),n.async=!1,n.loadXML(e),n.setProperty("SelectionLanguage","XPath"),n.setProperty("SelectionNamespaces",t);break}catch(e){a.msAjaxDebug.trace("xml doc creating error:"+e)}this._xmldoc=n},i.IEXpathProvider.prototype={selectSingleNode:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectSingleNode(n)},addNamespaceMapping:function(e,t){var n="SelectionNamespaces",r=this._xmldoc.getProperty(n),a="xmlns:"+e+"=",i="xmlns:"+e+'="'+t+'"';return-1==r.indexOf(a)&&(r=r+" "+i,this._xmldoc.setProperty(n,r),!0)},selectNodes:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectNodes(n)},selectNodesByXPath:function(e,t){return t.selectNodes(e)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}},i.DomParserProvider=function(e,t){var n=this;try{n._xmldoc=(new DOMParser).parseFromString(e,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}n._namespaceMapping={},n._defaultNamespace=null;for(var r,a=t.split(" "),i=0;i<a.length;++i)(r=/xmlns="([^"]*)"/g.exec(a[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(a[i]))&&(n._namespaceMapping[r[1]]=r[2])},i.DomParserProvider.prototype={addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=t||this._xmldoc,r=this._selectNodes(e,n);return 0===r.length?null:r[0]},selectNodes:function(e,t){var n=t||this._xmldoc;return this._selectNodes(e,n)},selectNodesByXPath:function(){return null},_selectNodes:function(e,t){var n=[];if(!e)return n;var r,i,o=e.split(":");if(1===o.length)r=null,i=o[0];else{if(2!==o.length)throw a.msAjaxError.argument("name");r=this._namespaceMapping[o[0]],i=o[1]}if(!t.hasChildNodes)return n;for(var s=t.childNodes,c=0;c<s.length;c++)i===this._removeNodePrefix(s[c].nodeName)&&r===s[c].namespaceURI&&n.push(s[c]);return n},_removeNodePrefix:function(e){var t=e.split(":");return 1===t.length?e:t[1]},getDocumentElement:function(){return this._xmldoc.documentElement}},i.XmlProcessor=function(e,t){var n=this,r=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:!1},{name:"xmlNamespaces",type:String,mayBeNull:!1}]);if(r)throw r;document.implementation&&document.implementation.hasFeature("XPath","3.0")?n._provider=new i.Xpath3Provider(e,t):(n._provider=new i.IEXpathProvider(e,t),n._provider.getActiveXObject()||(n._provider=new i.DomParserProvider(e,t)))},i.XmlProcessor.prototype={addNamespaceMapping:function(e,t){var n=Function._validateParams(arguments,[{name:"namespacePrefix",type:String,mayBeNull:!1},{name:"namespaceUri",type:String,mayBeNull:!1}]);if(n)throw n;return this._provider.addNamespaceMapping(e,t)},selectSingleNode:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectSingleNode(e,t)},selectNodes:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectNodes(e,t)},selectNodesByXPath:function(e,t){var n=Function._validateParams(arguments,[{name:"xpath",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return t=t||this._provider.getDocumentElement(),this._provider.selectNodesByXPath(e,t)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.text?e.text:e.textContent},getNodeText:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return 9==this.getNodeType(e)?this.getNodeText(this.getDocumentElement()):e.text?e.text:e.textContent},setNodeText:function(e,t){var n=!1,r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:n},{name:"text",type:String,mayBeNull:n}]);if(r)throw r;if(9==this.getNodeType(e))return n;try{e.text?e.text=t:e.textContent=t}catch(e){return n}return!0},getNodeXml:function(e){var t,n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(n)throw n;return e.xml?t=e.xml:(t=(new XMLSerializer).serializeToString(e),2==this.getNodeType(e)&&(t=this.getNodeBaseName(e)+'="'+t+'"')),t},setNodeXml:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"xml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var a=r.getDocumentElement();try{e.parentNode.replaceChild(a,e)}catch(e){return null}return a},getNodeNamespaceURI:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.namespaceURI},getNodePrefix:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.prefix},getNodeBaseName:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return!e.nodeType||1!=e.nodeType&&2!=e.nodeType?e.nodeName:e.baseName?e.baseName:e.localName},getNodeType:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.nodeType},appendChild:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"childXml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var a=r.getDocumentElement();return e.appendChild(a),a},_getAttributeLocalName:function(e){return e.localName?e.localName:e.baseName},readAttributes:function(e,t,n){var r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"attributesToRead",type:Object,mayBeNull:!1},{name:"objectToFill",type:Object,mayBeNull:!1}]);if(r)throw r;for(var a,i,o=0;o<e.attributes.length;o++)for(var s in a=e.attributes[o],i=this._getAttributeLocalName(a),t)i===s&&(n[t[s]]=a.value)},isValidXml:function(){var e="parsererror";if(null==this.getDocumentElement())return!1;if(this._provider._xmldoc.getElementsByTagName(e).length>0){var t=(new DOMParser).parseFromString("<","text/xml").getElementsByTagName(e)[0].namespaceURI;return this._provider._xmldoc.getElementsByTagNameNS(t,e).length<=0}return!0}},function(e){var t=function(){function e(){}return e.prototype.Serialize=function(e){try{return JSON.stringify(e)}catch(e){return null}},e.prototype.Deserialize=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();e.SafeSerializer=t;var n=function(){function e(e,t){this._localStorage=e,this._serializer=t}return e.prototype.GetCacheItem=function(t,n,r,a,i){var o="cacheExpired",s=this;void 0===n&&(n=!0),void 0===i&&(i=!0),s.ValidateCurrentCache();var c=s._localStorage.getItem(t);if(c){var u=s._serializer.Deserialize(c);if(void 0!==a&&a>0&&a-u.createdOn>0)s._localStorage.removeItem(t),r&&(r[o]=!0);else{if(!n)return u.data;var l=new Date;if(Math.abs(l.getTime()-u.createdOn)<e.msPerDay*u.refreshRate)return u.data;i&&(s._localStorage.removeItem(t),r&&(r[o]=!0))}}},e.prototype.SetCacheItem=function(t,n,r){r=r||e.defaultRefreshRateInDays;var a={data:n,createdOn:(new Date).getTime(),refreshRate:r};this._localStorage.setItem(t,this._serializer.Serialize(a))},e.prototype.RemoveCacheItem=function(e){this._localStorage.removeItem(e)},e.prototype.RemoveAll=function(e){for(var t=this._localStorage.getKeysWithPrefix(e),n=0,r=t.length;n<r;n++)this._localStorage.removeItem(t[n])},e.prototype.RemoveMatches=function(e){for(var t=this._localStorage.getKeysWithPrefix(""),n=0,r=t.length;n<r;n++)for(var a=t[n],i=0,o=e.length;i<o;i++)if(e[i].test(a)){this._localStorage.removeItem(a);break}},e.prototype.ValidateCurrentCache=function(){this._localStorage.getItem(e.cacheVersionKey)!=e.currentSchemaVersion&&(this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]),this._localStorage.setItem(e.cacheVersionKey,e.currentSchemaVersion))},e.defaultRefreshRateInDays=3,e.msPerDay=864e5,e.currentSchemaVersion="1",e.checkedCache=!1,e.cacheVersionKey="osfCacheVersion",e}();e.AppsDataCacheManager=n;var r=function(e){function t(t,n){e.call(this,t,n)}return c(t,e),t.prototype.GetRefreshToken=function(n,r){var a=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);return e.prototype.GetCacheItem.call(this,a)},t.prototype.AddRefreshToken=function(n,r,a){var o=i.OUtil.formatString(t._refreshTokenCacheKey,r,a);e.prototype.SetCacheItem.call(this,o,n)},t.prototype.RemoveAll=function(){e.prototype.RemoveAll.call(this,t._refreshTokenCachePrefixKey)},t.prototype.RemoveRefreshToken=function(n,r){var a=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);e.prototype.RemoveCacheItem.call(this,a)},t._refreshTokenCacheKey="_OSF_PRIVATECATALOG_REFRESHTOKEN_{0}_{1}",t._refreshTokenCachePrefixKey="_OSF_PRIVATECATALOG_REFRESHTOKEN",t}(n);e.TokenCacheManager=r}(l||(l={})),function(e){var t="Error",n="ResponseTime",r="Result",a="OperationMetadata",i="ErrorResult",o="AssetId",s="CorrelationId",u=!0,l=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:u,configurable:u}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:u,configurable:u}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){null!=t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){var e=this;return e._serializedFields={},e.SetSerializedField("Table",e._table),e.SerializeFields(),JSON.stringify(e._serializedFields)},e}();e.BaseUsageData=l;var d=function(e){var t="Stage11Time",n="Stage10Time",r="Stage9Time",a="Stage8Time",l="Stage7Time",d="Stage6Time",f="Stage5Time",p="Stage4Time",m="Stage3Time",g="Stage2Time",v="Stage1Time",h="InstanceId",b="ActivationInfo",y="AppInfo";function _(){e.call(this,"AppLoadTime")}return c(_,e),Object.defineProperty(_.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,y,{get:function(){return this.Fields[y]},set:function(e){this.Fields[y]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,b,{get:function(){return this.Fields[b]},set:function(e){this.Fields[b]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,h,{get:function(){return this.Fields[h]},set:function(e){this.Fields[h]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),_.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(y,e.AppInfo),e.SetSerializedField(b,e.ActivationInfo),e.SetSerializedField(h,e.InstanceId),e.SetSerializedField(o,e.AssetId),e.SetSerializedField(v,e.Stage1Time),e.SetSerializedField(g,e.Stage2Time),e.SetSerializedField(m,e.Stage3Time),e.SetSerializedField(p,e.Stage4Time),e.SetSerializedField(f,e.Stage5Time),e.SetSerializedField(d,e.Stage6Time),e.SetSerializedField(l,e.Stage7Time),e.SetSerializedField(a,e.Stage8Time),e.SetSerializedField(r,e.Stage9Time),e.SetSerializedField(n,e.Stage10Time),e.SetSerializedField(t,e.Stage11Time),e.SetSerializedField(i,e.ErrorResult)},_}(l);e.AppLoadTimeUsageData=d;var f=function(e){var t="NotificationClickInfo";function n(){e.call(this,"AppNotification")}return c(n,e),Object.defineProperty(n.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),n.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(i,e.ErrorResult),e.SetSerializedField(t,e.NotificationClickInfo)},n}(l);e.AppNotificationUsageData=f;var p=function(e){function t(){e.call(this,"AppManagementMenu")}return c(t,e),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(o,e.AssetId),e.SetSerializedField(a,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(l);e.AppManagementMenuUsageData=p;var m=function(e){var t="LastActiveTabCount",n="LastActiveTab",r="DialogState",a="TrustPageSessionTime",i="TotalSessionTime";function s(){e.call(this,"InsertionDialogSession")}return c(s,e),Object.defineProperty(s.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),s.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(o,e.AssetId),e.SetSerializedField(i,e.TotalSessionTime),e.SetSerializedField(a,e.TrustPageSessionTime),e.SetSerializedField(r,e.DialogState),e.SetSerializedField(n,e.LastActiveTab),e.SetSerializedField(t,e.LastActiveTabCount)},s}(l);e.InsertionDialogSessionUsageData=m;var g=function(e){function t(){e.call(this,"UploadFileDevCatelog")}return c(t,e),Object.defineProperty(t.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(a,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(l);e.UploadFileDevCatelogUsageData=g;var v=function(e){var t="AppSizeHeight",n="AppSizeWidth",r="IsAppCommand",a="AppTargetType",i="AppVersion",o="AppId",l="StoreType";function d(){e.call(this,"UploadFileDevCatalogUsage")}return c(d,e),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(l,e.StoreType),e.SetSerializedField(o,e.AppId),e.SetSerializedField(i,e.AppVersion),e.SetSerializedField(a,e.AppTargetType),e.SetSerializedField(r,e.IsAppCommand),e.SetSerializedField(n,e.AppSizeWidth),e.SetSerializedField(t,e.AppSizeHeight)},d}(l);e.UploadFileDevCatalogUsageUsageData=v;var h=function(e){function a(){e.call(this,"OneDriveCatalogGetAccessToken")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(l);e.OneDriveCatalogGetAccessTokenUsageData=h;var b=function(e){function a(){e.call(this,"OneDriveCatalogGetManifests")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(l);e.OneDriveCatalogGetManifestsUsageData=b;var y=function(e){var a="id";function i(){e.call(this,"OneDriveCatalogGetManifest")}return c(i,e),Object.defineProperty(i.prototype,a,{get:function(){return this.Fields.id},set:function(e){this.Fields.id=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),i.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(a,e.id),e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},i}(l);e.OneDriveCatalogGetManifestUsageData=y;var _=function(e){function a(){e.call(this,"OneDriveCatalogInsertManifest")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(l);e.OneDriveCatalogInsertManifestUsageData=_}(o||(o={})),function(e){var t=null;!function(e){var t="verboseEx",n="unexpected";e[e[n]=10]=n,e[e.warning=15]="warning",e[e.info=50]="info",e[e.verbose=100]="verbose",e[e[t]=200]=t}(e.ULSTraceLevel||(e.ULSTraceLevel={}));var n=e.ULSTraceLevel;!function(e){var t="msoulscat_Osf_UploadFileDevCatalogUsage",n="msoulscat_Osf_UploadFileDevCatelog",r="msoulscat_Osf_InsertionDialogSession",a="msoulscat_Osf_AppManagementMenu",i="msoulscat_Osf_Runtime",o="msoulscat_Osf_Notification",s="msoulscat_Osf_Latency";e[e[s]=1401]=s,e[e[o]=1402]=o,e[e[i]=1403]=i,e[e[a]=1404]=a,e[e[r]=1405]=r,e[e[n]=1406]=n,e[e[t]=1411]=t}(e.ULSCat||(e.ULSCat={}));var r,a,s=e.ULSCat;!function(e){var t="IsAnonymous",n="InsertionDialogClosed",r="ConfirmationDialogCancel";e[e[r]=256]=r,e[e[n]=512]=n,e[e[t]=1024]=t}(r||(r={})),function(e){var t="TrustPageVisited",n="Canceled",r="Inserted",a="Undefined";e[e[a]=0]=a,e[e[r]=1]=r,e[e[n]=2]=n,e[e.Closed=3]="Closed",e[e[t]=8]=t}(a||(a={}));var c=function(){function e(){this.timeValue=0}return e.prototype.Start=function(){this.timeValue=-(new Date).getTime(),this.finishedMeasurement=!1},e.prototype.Stop=function(){this.timeValue<0&&(this.timeValue+=(new Date).getTime(),this.finishedMeasurement=!0)},Object.defineProperty(e.prototype,"Finished",{get:function(){return this.finishedMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){var e=this.timeValue;return!this.Finished&&e<0&&(e=Math.abs(e)-(new Date).getTime()),e},enumerable:!0,configurable:!0}),e}();e.LatencyStopwatch=c;var u=function(){};e.Context=u;var l=function(){function e(){}return e.SendULSTraceTag=function(e,t,n,r){Microsoft.Office.WebExtension.FULSSupported&&Diag.UULS.trace(r,e,t,n)},e}(),d=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),6062431)},e.category=s.msoulscat_Osf_Notification,e.level=n.info,e}();e.NotificationLogger=d;var f=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085957)},e.category=s.msoulscat_Osf_AppManagementMenu,e.level=n.info,e}();e.AppManagementMenuLogger=f;var p=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085958)},e.category=s.msoulscat_Osf_UploadFileDevCatelog,e.level=n.info,e}();e.UploadFileDevCatelogLogger=p;var m=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17834653)},e.category=s.msoulscat_Osf_UploadFileDevCatalogUsage,e.level=n.info,e}();e.UploadFileDevCatalogUsageLogger=m;var g=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),4748055)},e.category=s.msoulscat_Osf_Latency,e.level=n.info,e}();e.LatencyLogger=g;var v=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085959)},e.category=s.msoulscat_Osf_InsertionDialogSession,e.level=n.info,e}();e.InsertionDialogSessionLogger=v;var h=function(){function e(){}return e.LogNotification=function(e,t,n){var r=new o.AppNotificationUsageData;r.CorrelationId=e,r.ErrorResult=t,r.NotificationClickInfo=n,d.Instance().LogData(r)},e}();e.AppNotificationHelper=h;var b=function(){function e(){}return e.LogAppManagementMenuAction=function(e,t,n,a,i,s){var c=new o.AppManagementMenuUsageData,u=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10);a&&(t|=r.InsertionDialogClosed),i&&(t|=r.IsAnonymous),c.AssetId=u,c.OperationMetadata=t,c.ErrorResult=s,f.Instance().LogData(c)},e}();e.AppManagementMenuHelper=b;var y=function(){function e(){}return e.LogUploadFileDevCatelogAction=function(e,t,n,r,a,i){var s=new o.UploadFileDevCatelogUsageData;s.CorrelationId=e,s.OperationMetadata=t,s.ErrorResult=i,p.Instance().LogData(s)},e}();e.UploadFileDevCatelogHelper=y;var _=function(){function e(){}return e.LogUploadFileDevCatalogUsageAction=function(e,t,n,r,a,i,s,c){var u=new o.UploadFileDevCatalogUsageUsageData;u.CorrelationId=e,u.StoreType=t,u.AppId=n,u.AppVersion=r,u.AppTargetType=a,u.IsAppCommand=i,u.AppSizeWidth=s,u.AppSizeHeight=c,m.Instance().LogData(u)},e}();e.UploadFileDevCatalogUsageHelper=_;var O=function(){var e="Stage11Time",r="Stage10Time",a="Stage9Time",i="Stage8Time",u="Stage7Time",d="Stage5Time",f="Stage4Time",p="Stage2Time",m="Stage1Time";function v(){}return v.GenerateActivationMessage=function(e,n){var r="";return e!=t&&(r+="ActivationRuntimeType: "+e.toString()+"|"),n!=t&&(r+="CorrelationId: "+n),r},v.ActivationStart=function(t,g,h,b,y,_){v.activatingNumber++,t.LoadTime=new o.AppLoadTimeUsageData,t.Timers={},t.LoadTime.CorrelationId=b,t.LoadTime.AppInfo=g,t.LoadTime.ActivationInfo=0,t.LoadTime.InstanceId=y,t.LoadTime.AssetId=h,t.LoadTime.Stage1Time=0,t.Timers[m]=new c,t.LoadTime.Stage2Time=0,t.Timers[p]=new c,t.LoadTime.Stage3Time=0,t.LoadTime.Stage4Time=0,t.Timers[f]=new c,t.LoadTime.Stage5Time=0,t.Timers[d]=new c,t.LoadTime.Stage6Time=v.activatingNumber,t.LoadTime.Stage7Time=0,t.Timers[u]=new c,t.LoadTime.Stage8Time=0,t.Timers[i]=new c,t.LoadTime.Stage9Time=0,t.Timers[a]=new c,t.LoadTime.Stage10Time=0,t.Timers[r]=new c,t.LoadTime.Stage11Time=0,t.Timers[e]=new c,t.LoadTime.ErrorResult=0,t.ActivationRuntimeType=_,v.StartStopwatch(t,m),l.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,v.GenerateActivationMessage(_,b),19515419)},v.ActivationEnd=function(e){v.ActivateEndInternal(e)},v.PageStart=function(e){v.StartStopwatch(e,p)},v.PageLoaded=function(e){v.StopStopwatch(e,p)},v.ServerCallStart=function(e){v.StartStopwatch(e,f)},v.ServerCallEnd=function(e){v.StopStopwatch(e,f)},v.AuthenticationStart=function(e){v.StartStopwatch(e,d)},v.AuthenticationEnd=function(e){v.StopStopwatch(e,d)},v.EntitlementCheckStart=function(e){v.StartStopwatch(e,u)},v.EntitlementCheckEnd=function(e){v.StopStopwatch(e,u)},v.KilledAppsCheckStart=function(e){v.StartStopwatch(e,i)},v.KilledAppsCheckEnd=function(e){v.StopStopwatch(e,i)},v.AppStateCheckStart=function(e){v.StartStopwatch(e,a)},v.AppStateCheckEnd=function(e){v.StopStopwatch(e,a)},v.ManifestRequestStart=function(e){v.StartStopwatch(e,r)},v.ManifestRequestEnd=function(e){v.StopStopwatch(e,r)},v.OfficeJSStartToLoad=function(t){v.StartStopwatch(t,e)},v.OfficeJSLoaded=function(t){v.StopStopwatch(t,e)},v.SetAnonymousFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,0)},v.SetRetryCount=function(e,t){v.SetActivationInfoField(e,t,3,2)},v.SetManifestTrustCachedFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,5)},v.SetManifestDataCachedFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,7)},v.SetOmexHasEntitlementFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,9)},v.SetManifestDataInvalidFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,11)},v.SetAppStateDataCachedFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,13)},v.SetAppStateDataInvalidFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,15)},v.SetActivationRuntimeType=function(e,t){v.SetActivationInfoField(e,t,2,17)},v.SetErrorResult=function(e,t){e.LoadTime&&(e.LoadTime.ErrorResult=t,v.ActivateEndInternal(e))},v.SetBit=function(e,t,n,r){v.SetActivationInfoField(e,t,r||2,n)},v.StartStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Start(),v.UpdateActivatingNumber(e))},v.StopStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Stop(),v.UpdateActivatingNumber(e))},v.ConvertFlagToBit=function(e){return e?2:1},v.SetActivationInfoField=function(e,t,n,r){e.LoadTime&&(v.UpdateActivatingNumber(e),e.LoadTime.ActivationInfo=v.SetBitField(e.LoadTime.ActivationInfo,t,n,r))},v.SetBitField=function(e,t,n,r){return e&~(Math.pow(2,n)-1<<r)|t<<r},v.UpdateActivatingNumber=function(e){e.LoadTime&&(e.LoadTime.Stage6Time=e.LoadTime.Stage6Time>v.activatingNumber?e.LoadTime.Stage6Time:v.activatingNumber)},v.ActivateEndInternal=function(e){if(e.LoadTime){if(v.StopStopwatch(e,m),e.Timers)for(var r in e.Timers)e.Timers[r].ElapsedTime!=t&&(e.LoadTime[r]=e.Timers[r].ElapsedTime);l.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,v.GenerateActivationMessage(e.ActivationRuntimeType,e.LoadTime.CorrelationId),19515420),g.Instance().LogData(e.LoadTime),e.LoadTime=t,v.activatingNumber--}},v.activatingNumber=0,v}();e.AppLoadTimeHelper=O;var S=function(){var e=" AppCorrelationId:";function r(){}return r.LogProxyFailure=function(e,a,o){var s;e==t&&(e=""),s=i.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",e,a),Object.keys(o).forEach((function(e){var n=o[e];n!=t&&(n=n.toString()),s+=", "+e+":"+n})),l.SendULSTraceTag(r.category,n.warning,s,6062432)},r.LogExceptionTag=function(a,i,o,s){var c=a;i&&(i.name&&(c+=" Exception name:"+i.name+"."),i.paramName&&(c+=" Param name:"+i.paramName+"."),i.message&&(c+=" Message:"+i.message+"."),i.stack&&(c+=" [Stack:"+i.stack+"]")),o!=t&&(c+=e+o+"."),l.SendULSTraceTag(r.category,n.warning,c,s)},r.LogCommonMessageTag=function(a,i,o){i!=t&&(a+=e+i+"."),l.SendULSTraceTag(r.category,n.info,a,o)},r.category=s.msoulscat_Osf_Runtime,r}();e.RuntimeTelemetryHelper=S;var C=function(){function e(){}return e.LogInsertionDialogSession=function(e,t,n,r,i,s){var c=new o.InsertionDialogSessionUsageData,u=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10),l=a.Undefined;l|=r?a.Inserted:a.Canceled,n>0&&(l|=a.TrustPageVisited),c.AssetId=u,c.TotalSessionTime=t,c.TrustPageSessionTime=n,c.DialogState=l,c.LastActiveTab=i,c.LastActiveTabCount=s,v.Instance().LogData(c)},e}();e.InsertionDialogSessionHelper=C}(s||(s={}));var u='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';i.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160"},i.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};var l;i.HostSpecificFileVersionDefault="16.00",i.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.02"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"}},i.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote"},i.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook",Mailbox:"Mailbox"},i.HostPlatform={Web:"Web"},i.getAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="excel.exe";break;case i.AppName.AccessWebApp:t="ZAC";break;case i.AppName.PowerpointWebApp:t="WAP";break;case i.AppName.WordWebApp:t="WAW";break;case i.AppName.OneNoteWebApp:t="WAO";break;default:throw a.msAjaxDebug.trace(n),n}return t},i.getModernAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="WAC_Excel";break;case i.AppName.PowerpointWebApp:t="WAC_PowerPoint";break;case i.AppName.WordWebApp:t="WAC_Word";break;case i.AppName.OneNoteWebApp:t="WAC_OneNote";break;case i.AppName.OutlookWebApp:t="WAC_Outlook";break;default:throw a.msAjaxDebug.trace(n),n}return t},i.getManifestHostType=function(e){var t;switch(e){case i.HostType.Excel:t=i.ManifestHostType.Workbook;break;case i.HostType.Word:t=i.ManifestHostType.Document;break;case i.HostType.PowerPoint:t=i.ManifestHostType.Presentation;break;case i.HostType.OneNote:t=i.ManifestHostType.Notebook;break;case i.HostType.Outlook:t=i.ManifestHostType.Mailbox;default:throw a.msAjaxDebug.trace("Invalid host type."),"Invalid hostType."}return t},i.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook"},i.HostCapability={Excel:i.Capability.Workbook,Outlook:i.Capability.Mailbox,Access:i.Capability.Database,PowerPoint:i.Capability.Presentation,Word:i.Capability.Document,Sway:i.Capability.Sway,OneNote:i.Capability.Notebook},i.OsfControlTarget={Undefined:-1,InContent:0,TaskPane:1,Contextual:2},i.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131,ReadWriteDocument:135},i.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8},i.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6},i.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",Exchange:"exchange",FileSystem:"filesystem",Registry:"registry",InMemory:"inmemory",OneDrive:"onedrive",PrivateCatalog:"excatalog",HardCodedPreinstall:"hardcodedpreinstall",FirstParty:"firstparty",UploadFileDevCatalog:"uploadfiledevcatalog",Sdx:"sdxcatalog"},i.StoreTypeEnum={MarketPlace:0,Catalog:1,SPApp:2,Exchange:3,FileSystem:4,Registry:5,OneDrive:9,PrivateCatalog:10,HardCodedPreinstall:11,FirstParty:12,Sdx:14,UploadFileDevCatalog:15},i.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"},i.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15,UserIsMinor:16},i.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4},i.OmexTrialType={None:0,Office:1,External:2},i.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"},i.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3},i.OmexRemoveAppStatus={Failed:0,Success:1},i.OfficeAppType={ContentApp:i.OsfControlTarget.InContent,TaskPaneApp:i.OsfControlTarget.TaskPane,MailApp:i.OsfControlTarget.Contextual},i.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"},i.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"},i.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"},i.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"},i.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2},i.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942},i.BWsaStreamTypes={Static:1},i.BWsaConfig={defaultMaxStreamRows:1e3},i.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR:-2147209295,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055,WAC_FirstPartyAddInListRequestFailure:1056,WAC_SSOAddinRequireConsent:1057},i.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10},i.OmexClientNames=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]="WAC_Excel",e[t.WordWebApp]="WAC_Word",e[t.OutlookWebApp]="WAC_Outlook",e[t.AccessWebApp]="WAC_Access",e[t.PowerpointWebApp]="WAC_Powerpoint",e[t.OneNoteWebApp]="WAC_OneNote",e}(),i.OmexAppVersions=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]=i.AppVersion.excelwebapp,e[t.WordWebApp]=i.AppVersion.wordwebapp,e[t.OutlookWebApp]=i.AppVersion.outlookwebapp,e[t.AccessWebApp]=i.AppVersion.access,e[t.PowerpointWebApp]=i.AppVersion.powerpointwebapp,e[t.OneNoteWebApp]=i.AppVersion.onenotewebapp,e}(),i.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3},i.ManifestRequestTypes={Manifest:1,Etoken:2,Both:3},function(e){var t=null,n=function(){function e(){}return e.versionLessThan=function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},e.ParseManifest=function(e,n,r){try{return new i.Manifest.Manifest(e,n)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest:",e,r,20306078),t}},e}();e.ManifestUtil=n;var r=function(){function n(){}return n.failed=function(n,r,a){if(n.status!=e.DataServiceResultCode.Succeeded){var i={status:n.status,httpStatus:n.httpStatus};return a!=t&&(i.value=a),r(i),!0}return!1},n}();e.AsyncUtil=r;var a=function(){function e(){}return e.register=function(e,t){this._registry[e]=t},e.resolve=function(e,n){var r=this,a=r._resolved[e];if(a!=t)return a;if((n=n||r._hostInfo)!=t){var i=r._registry[e];if(i==t)return t;r._resolved[e]=a=i(n)}return a},e.setHostContext=function(e){this._hostInfo=e},e.getHostContext=function(){return this._hostInfo},e._registry={},e._resolved={},e}();e.CatalogFactory=a}(l||(l={})),function(e){var t=function(){function t(e){this._initParams=e}return t.prototype.getEntitlementAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAndCacheManifest=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed,httpStatus:404})},t.prototype.activateAsync=function(t,n){var r=this;r._initParams&&r._initParams.loaderParams?r._initParams.controlStatus===i.OsfControlStatus.ActivationFailed?n.fail(r._initParams.loaderParams,r._initParams.controlStatus):n.notifyUser(r._initParams.loaderParams):n.fail(e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveActivationError_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),i.OsfControlStatus.ActivationFailed)},t.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed,httpStatus:403})},t}();e.ForbiddenCatalog=t}(l||(l={})),function(e){var t=function(){var e=null;function t(){}return t.defaultTitle=function(e){switch(e){case i.InfoType.Information:return Strings.OsfRuntime.L_AgaveInformationTitle_TXT;case i.InfoType.Error:return Strings.OsfRuntime.L_AgaveErrorTile_TXT;case i.InfoType.Warning:return Strings.OsfRuntime.L_AgaveWarningTitle_TXT}return Strings.OsfRuntime.L_AgaveInformationTitle_TXT},t.fillMissing=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Information:n.infoType,n.title=n.title||t.defaultTitle(n.infoType),n.buttonTxt=n.buttonTxt||Strings.OsfRuntime.L_OkButton_TXT,n.buttonCallback=n.buttonCallback||e,n.url=n.url||e,n.urlButtonTxt=n.urlButtonTxt||e,n.dismissCallback=n.dismissCallback||e,n.reDisplay=!n.dismissCallback,n.displayDeactive=n.displayDeactive==e||n.displayDeactive,n.detailView=n.detailView||!1,n.logAsError=n.logAsError||!1,n.highPriority=n.highPriority||!1,n.retryAll=n.retryAll||!1,n.errorCode=n.errorCode?n.errorCode:0,n},t.error=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Error:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.warning=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Warning:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.showNotification=function(e,n){e.notifyUser(t.fillMissing(n))},t.showError=function(e,n){e.notifyUser(t.error(n))},t.showWarning=function(e,n){e.notifyUser(t.warning(n))},t.failWithWarning=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.warning(n),r)},t.failWithError=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.error(n),r)},t.isNullOrUndefined=function(t){return t===e||void 0===t},t}();e.LoaderUtil=t}(l||(l={})),function(e){var t=function(){function t(e,t){this.osfControl=e,this.trusted=t}return t.prototype.getRequirementsChecker=function(){return this.osfControl._contextActivationMgr.getRequirementsChecker()},t.prototype.load=function(t,n){var r=null,a=this;a.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted&&(a.osfControl._retryActivate=r,a.osfControl._contextActivationMgr.retryAll(t.entitlement.assetId)),a.osfControl._status!==i.OsfControlStatus.NotActivated&&a.osfControl.deActivate();var o=t.manifest,s=a.osfControl;if(s._etoken=t.eToken,s._manifest=o,s._sourceLocationOverrideResourceId?s._iframeUrl=o.getSourceLocationOverrideByResourceId(s._sourceLocationOverrideResourceId):s._iframeUrl=o.getDefaultSourceLocation(s._contextActivationMgr.getFormFactor()),s.getStoreType()===i.StoreType.Sdx&&s._iframeUrl&&t.manifestUrl!==r){var c=t.manifestUrl.lastIndexOf("/");if(-1!==c){var u=t.manifestUrl.substr(0,c)+"/index.html";s.updateUrlsForSdxBundle(u)}}if(s._permission=o.getPermission(),s._appDomains=o.getAppDomains(),s.processManifestForCustomFunctions(o),n!=r&&(s._iframeUrl=n.decorateUrl(s._iframeUrl)),s._contextActivationMgr._doesUrlHaveSupportedProtocol(s._iframeUrl)){n!=r&&n.preLoad(s,s._contextActivationMgr);var l=o.getDefaultDisplayName();s._isAddinCommands((function(e){e&&(s._isvirtualOsfControl=!0,s.invokeVirtualOsfControlActivationCallback(o)),(!e||o.containsCustomFunctionsForAppHost(s._contextActivationMgr._hostType))&&s._createIframeAndActivateOsfControl(l)})),n!=r&&n.postLoad(s,s._contextActivationMgr)}else e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveManifestError_ERR,detailView:!0,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT})},t.prototype.skipTrust=function(){var e=this;return e.osfControl._contextActivationMgr._autoTrusted||e.osfControl.getTrustNoPrompt()||e.osfControl._isOsfControlInEmbeddingMode(e.osfControl)},t.prototype.hasConsent=function(){return this.trusted||this.isInsertion()},t.prototype.isInsertion=function(){return this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted},t.prototype.setRetryCall=function(e){this.osfControl._retryActivate=e},t.prototype.askForTrust=function(e,t){var n=this;this.osfControl._showTrustError(e.clientName,e.displayName,e.providerName,e.iconUrl,e.entitlement.storeType,(function(){n.restartActivation(),t()}),e.url,e.isSSOAddin)},t.prototype.askForUpgrade=function(e,t){var n=this;e.buttonCallback=function(){n.restartActivation(),t()},this.notifyUser(e)},t.prototype.askForConsentForSideloadAddin=function(e,t){var n=this;this.osfControl._manifest=e,this.osfControl._isAddinCommands((function(e){e?n.osfControl.showConsentError(t,i.NotificationType.ConsentWhiteDialog,!0):n.osfControl.showConsentError(t,i.NotificationType.ConsentYellowBar,!0)}))},t.prototype.fail=function(e,t){var n=this.osfControl;n._status=t,this.notifyUser(e),n._contextActivationMgr.raiseOsfControlStatusChange(n)},t.prototype.notifyUser=function(e){var t=this.osfControl;e.id=t._id,t._contextActivationMgr.displayNotification(e)},t.prototype.restartActivation=function(){this.osfControl._restartActivate()},t.prototype.isForCustomFunctionSandbox=function(){return this.osfControl.isCustomFunctionSandbox()},t.prototype.setIsUpgrading=function(e){this.osfControl.setIsUpgrading(e)},t}();e.OsfControlLoader=t}(l||(l={})),function(e){var t=function(){function e(e){this._requirementsChecker=e}return e.prototype.getRequirementsChecker=function(){return this._requirementsChecker},e.prototype.load=function(){},e.prototype.skipTrust=function(){return!1},e.prototype.hasConsent=function(){return!1},e.prototype.setRetryCall=function(){},e.prototype.askForTrust=function(){},e.prototype.askForUpgrade=function(){},e.prototype.askForConsentForSideloadAddin=function(){},e.prototype.fail=function(){},e.prototype.notifyUser=function(){},e.prototype.restartActivation=function(){},e.prototype.isForCustomFunctionSandbox=function(){return!1},e.prototype.setIsUpgrading=function(){},e}();e.PreCacher=t}(l||(l={})),function(e){var t=function(){var t=null;function n(){var e=this;e.isReady=!1,e.clientEndPoint=t,e.pendingCallbacks=[],e.iframe=t,e._pendingRequests={},e.conversationId=i.OUtil.generateConversationId()}return n.prototype.invokeProxyCommandAsync=function(n,r,a){var i=this,o=r||r.correlationId||"";this.prepareProxy((function(c){c.value!=t?i.invokeProxyMethodAsync(n,a,r):(s.RuntimeTelemetryHelper.LogExceptionTag("clientendpoint is invalid",t,o,18940552),a({status:e.DataServiceResultCode.ProxyNotReady}))}),(function(){s.RuntimeTelemetryHelper.LogExceptionTag("proxysetup failure",t,o,18940553),a({status:e.DataServiceResultCode.ProxyNotReady})}))},n.prototype.prepareProxy=function(){},n.prototype.doesUrlHaveSupportedProtocol=function(e){var n=!1;e&&(n=decodeURIComponent(e).match(/^https?:\/\/.+$/gi)!=t);return n},n.prototype.invokeProxyMethodAsync=function(n,r,a){var o,c=a||a.correlationId||"",u=[this.clientEndPoint._targetUrl,n];for(var l in a)("string"===(o=typeof a[l])||"number"===o||"boolean"===o)&&u.push(a[l]);var d=u.join("."),f=this._pendingRequests,p={onCompleted:r,methodName:n,correlationId:c},m=f[d];if(m)m.push(p);else{f[d]=[p];a||(a={}),a.officeVersion=i.Constants.ThreePartsFileVersion,this.clientEndPoint.invoke(n,(function(n,r){var a=t,i=0,o=e.DataServiceResultCode.Failed;0===n&&r.status&&(a=r.result,o=e.DataServiceResultCode.Succeeded);var c=f[d];delete f[d];for(var u=c.length,l=0;l<u;l++){var p=c.shift();try{r&&r.failureInfo&&(i=r.failureInfo.statusCode||t,r.failureInfo.result=r.result,s.RuntimeTelemetryHelper.LogProxyFailure(p.correlationId,p.methodName,r.failureInfo)),p.onCompleted({status:o,httpStatus:i,value:a})}catch(t){var m="invokeProxyMethodAsync failed";e.WACUtils.logExceptionToBrowserConsole(m,t),s.RuntimeTelemetryHelper.LogExceptionTag(m,t,p.correlationId,19015124)}}}),a)}},n}();e.ProxyBase=t}(l||(l={})),function(e){!function(e){var t="ManifestRequest",n="KilledAppsCheck",r="AppStateCheck",a="EntitlementCheck",i="Authentication",o="ServerCall",s="Activation";e[e[s]=0]=s,e[e[o]=1]=o,e[e[i]=2]=i,e[e[a]=3]=a,e[e[r]=4]=r,e[e[n]=5]=n,e[e[t]=6]=t}(e.Activity||(e.Activity={}));var t=e.Activity;!function(e){var t="DmsRequestCachedFlag",n="ManifestRequestType",r="ActivationRuntimeType",a="AppStateDataInvalidFlag",i="AppStateDataCachedFlag",o="ManifestDataInvalidFlag",s="OmexHasEntitlementFlag",c="ManifestDataCachedFlag",u="ManifestTrustCachedFlag",l="RetryCount",d="AnonymousFlag";e[e[d]=0]=d,e[e[l]=1]=l,e[e[u]=2]=u,e[e[c]=3]=c,e[e[s]=4]=s,e[e[o]=5]=o,e[e[i]=6]=i,e[e[a]=7]=a,e[e[r]=8]=r,e[e[n]=9]=n,e[e[t]=10]=t}(e.FlagName||(e.FlagName={}));var n=e.FlagName,r=function(){function r(e,t,n,r,a){var i=this;i.correlationId=e,i.perfContext=t,i.appInfo=n,i.assetId=r,i.instanceId=a}return r.prototype.startActivity=function(a){var o=this;switch(a){case t.Activation:var c=i.ActivationTypes.V2Enabled;return 0==(15&o.appInfo)&&e.S2SOmexCatalogService._requestHandler&&(c=i.ActivationTypes.V2S2SEnabled),s.AppLoadTimeHelper.ActivationStart(o.perfContext,o.appInfo,o.assetId,o.correlationId,o.instanceId,c),void o.setBits(n.ActivationRuntimeType,c)}s.AppLoadTimeHelper.StartStopwatch(o.perfContext,r.StopWatchName[a])},r.prototype.stopActivity=function(e){s.AppLoadTimeHelper.StopStopwatch(this.perfContext,r.StopWatchName[e])},r.prototype.setFlag=function(e,t){var n=t?2:1;this.setBits(e,n)},r.prototype.setBits=function(e,t){s.AppLoadTimeHelper.SetBit(this.perfContext,t,r.FlagOffsetMap[e],2)},r.FlagOffsetMap=[0,2,5,7,9,11,13,15,17,19,21],r.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"],r}();e.ActivationTelemetryContext=r;var a=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.AddinCommandsTelemetryContext=a;var o=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.InsertDialogTelemetryContext=o;var c=function(){function e(){}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.SimpleTelemetryContext=c}(l||(l={})),function(e){var t=null,n=function(){var n=".";function r(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return r.prototype.getEntitlementAsync=function(n,r,a){var o=this,s=o,c=[],u=[],l=n?o.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey():o.getUploadFileDevCatalogAddinsCacheKey(),d=o._cacheManager.GetCacheItem(l);d!=t&&(d.forEach((function(n){var r=s._cacheManager.GetCacheItem(s.getUploadFileDevCatalogManifestCacheKey(n));if(r!=t){var a=e.ManifestUtil.ParseManifest(r,s._initParam.appUILocale);if(a==t)return;var o={assetId:n,appVersion:a.getMarketplaceVersion(),storeId:"developer",storeType:i.StoreType.UploadFileDevCatalog,targetType:a.getTarget()};u.push(o),c.push(n)}})),c.length!=d.length&&(c.length>0?o._cacheManager.SetCacheItem(l,c):o._cacheManager.RemoveCacheItem(l))),a({status:e.DataServiceResultCode.Succeeded,value:u})},r.prototype.getAndCacheManifest=function(n,r,a,o){var s=i.OsfManifestManager.getCachedManifest(n.assetId,n.appVersion);if(s==t){if(s==t){var c=this._cacheManager.GetCacheItem(this.getUploadFileDevCatalogManifestCacheKey(n.assetId));c!=t&&(s=e.ManifestUtil.ParseManifest(c,this._initParam.appUILocale))!=t&&i.OsfManifestManager.cacheManifest(n.assetId,n.appVersion,s)}o({status:s!=t?e.DataServiceResultCode.Succeeded:e.DataServiceResultCode.Failed,value:s})}else o({status:e.DataServiceResultCode.Succeeded,value:s})},r.prototype.activateAsync=function(n,r,a){var o=this;this.getAndCacheManifest(n,n.storeId,a,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)e.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE});else{var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(c&&c.enableSingleSignOnForAddin&&!r.isForCustomFunctionSandbox()){var u=s.value;if(u.isSSOAddin()){return void r.askForConsentForSideloadAddin(u,(function(){r.load({entitlement:n,eToken:"",manifest:s.value},t)}))}}r.load({entitlement:n,eToken:"",manifest:s.value},t)}}))},r.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},r.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed})},r.prototype.validateAndCacheNewManifest=function(e,t,n,r){return!!this.validateAddinIdAndVersion(e,t)&&(this.cacheManifest(e,t,n,r),!0)},r.prototype.localCacheAddinCommands=function(e){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(),e)},r.prototype.validateAddinIdAndVersion=function(e,t){return r.idRegExp.test(e)&&r.versionRegExp.test(t)},r.prototype.cacheManifest=function(e,t,n,r){var a=this;i.OsfManifestManager.cacheManifest(e,t,r),a.cacheMyAddins(a.getUploadFileDevCatalogAddinsCacheKey(),e),a._cacheManager.SetCacheItem(a.getUploadFileDevCatalogManifestCacheKey(e),n)},r.prototype.cacheMyAddins=function(e,n){var r=this._cacheManager.GetCacheItem(e);r==t&&(r=[]),r.lastIndexOf(n)<0&&(r.push(n),this._cacheManager.SetCacheItem(e,r))},r.prototype.getUploadFileDevCatalogAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.myAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.addinCommandsMyAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogManifestCacheKey=function(e){return r.UploadFileCatalogCacheKey.manifest+n+this._initParam.appName+n+e},r.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.",r.UploadFileCatalogCacheKey={myAddins:r.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:r.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:r.UploadFileCatalogCacheKeyPrefix+"Manifest"},r.idRegExp=new RegExp("[\\w-]+"),r.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}"),r}();e.CatalogFactory.register(i.StoreType.UploadFileDevCatalog,(function(r){return r.enableUploadFileDevCatalog?new n({appName:r.appName,appUILocale:r.appUILocale,userNameHashCode:r.userNameHashCode}):new e.ForbiddenCatalog(t)}));var r=function(){var t="Should never here";function n(e,t){this._catalog=e,this._storeType=t}return n.prototype.validateAndCacheNewManifest=function(){throw t},n.prototype.getEntitlementsAsync=function(t,n,r,a){this._catalog.getEntitlementAsync(n,new e.AddinCommandsTelemetryContext(i.OUtil.Guid.generateNewGuid()),(function(e){a(e.value)}),!1,r)},n.prototype.getManifestAsync=function(){throw t},n.prototype.localCacheAddinCommands=function(e,t,n,r){this._storeType==i.StoreType.UploadFileDevCatalog&&this._catalog.localCacheAddinCommands(t,n,r)},n}(),a=function(){function n(){}return n.createAddinDataProvider=function(n){var a=e.CatalogFactory.resolve(n);return a==t?t:new r(a,n)},n}();e.AddinDataProviderFactory=a}(l||(l={})),function(e){!function(e){var t="Unauthenticated",n="UnknownUserType",r="ProxyNotReady",a="Succeeded";e[e[a]=1]=a,e[e.Failed=0]="Failed",e[e[r]=-1]=r,e[e[n]=2]=n,e[e[t]=3]=t}(e.DataServiceResultCode||(e.DataServiceResultCode={}));e.DataServiceResultCode}(l||(l={})),function(e){var t=function(){var t=null;function n(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return n.prototype.getEntitlementAsync=function(){throw new Error("in firstParty get Entitlementasync")},n.prototype.getAndCacheManifest=function(){throw new Error("in firstParty getAndCacheManifest")},n.prototype.removeAsync=function(){throw new Error("in firstParty removeAsync")},n.prototype.getAppDetails=function(){throw new Error("in firstParty getappDetails")},n.prototype.TryFallBackFirstPartyAddInList=function(n,r){s.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale 1st party add-ins list.",t,n.correlationId,34366471);var a=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!1);r(a?{status:e.DataServiceResultCode.Succeeded,value:a}:{status:e.DataServiceResultCode.Failed,value:t})},n.prototype.GetFirstyPartyAddInsInfo=function(n,r,a){var i=this,o=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1);if(o){var c={addInList:o,refreshRate:t};a({status:e.DataServiceResultCode.Succeeded,value:c})}else n.getFirstPartyAddInList((function(n){if(n.status==e.DataServiceResultCode.Succeeded){var o=t;try{o=e.OmexXmlProcessor.ProcessFirstPartyAddInList(n.value)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Problem parsing first party list.",e,r.correlationId,34366472),void i.TryFallBackFirstPartyAddInList(r,a)}i._cacheManager.SetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,o.addInList,o.refreshRate/e.CacheConsts.hourToDayConversionFactor),a({status:e.DataServiceResultCode.Succeeded,value:o})}else i.TryFallBackFirstPartyAddInList(r,a)}))},n.prototype.TryFallBackFirstPartyManifest=function(n,r,a){s.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale manifest for: "+n,t,r.correlationId,34366473);var i=this.ReadFirstPartyManifestFromLocalStorage(r,n);a(i?{status:e.DataServiceResultCode.Succeeded,value:i}:{status:e.DataServiceResultCode.Failed,value:t})},n.prototype.ReadFirstPartyManifestFromLocalStorage=function(n,r){var a=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r),o=this._cacheManager.GetCacheItem(a,!1);return o?e.ManifestUtil.ParseManifest(o,this._initParam.appUILocale,n.correlationId):t},n.prototype.GetFirstPartyManifest=function(t,n,r,a){var o=this,s=i.OsfManifestManager.getCachedManifest(r.assetId,"");if(s||(s=this.ReadFirstPartyManifestFromLocalStorage(n,r.assetId))&&i.OsfManifestManager.cacheManifest(r.assetId,"",s),!s||i.OsfManifestManager.versionLessThan(s.getMarketplaceVersion(),r.version)){var c=i.OUtil.formatString("{0}/{1}",this._initParam.firstPartyManifestCDNUrl,r.path);t.getFirstPartyManifest(c,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){var s=e.ManifestUtil.ParseManifest(t.value,o._initParam.appUILocale,n.correlationId);if(s){i.OsfManifestManager.cacheManifest(r.assetId,"",s);var c=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r.assetId);o._cacheManager.SetCacheItem(c,t.value),a({status:e.DataServiceResultCode.Succeeded,value:s})}else o.TryFallBackFirstPartyManifest(r.assetId,n,a)}else o.TryFallBackFirstPartyManifest(r.assetId,n,a)}))}else a({status:e.DataServiceResultCode.Succeeded,value:s})},n.prototype.getDataService=function(n,r){var a=this,i=a;if(a._dataService==t){var o={status:e.DataServiceResultCode.Failed,value:t},s=function(t,n){t.status==e.DataServiceResultCode.Succeeded?(i._dataService=n,o.value=n,o.status=e.DataServiceResultCode.Succeeded,r(o)):(o.httpStatus=t.httpStatus,r(o))},c=e.ProxyBasedCatalogService.getFirstPartyInstance(a._initParam);c.prepareProxy(n.correlationId,(function(e){s(e,c)}))}else r({status:e.DataServiceResultCode.Succeeded,value:a._dataService})},n.prototype.createActivityScope=function(t,n){var r=this;this.getDataService(t,(function(a){if(!e.AsyncUtil.failed(a,n)){var i=a.value,o={cacheManager:r._cacheManager,cachePrefix:e.CacheConsts.anonymousCacheKeyPrefix,cid:i.getCID(),anonymous:!0,telemetryContext:t},s=i.createScope(o);n({status:e.DataServiceResultCode.Succeeded,value:s})}}))},n.prototype.activateAsync=function(n,r,a){var o=this;a.startActivity(e.Activity.Activation),a.startActivity(e.Activity.ServerCall);var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),u=c&&c.enableFirstPartySDXErrorMessages;this.createActivityScope(a,(function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Failed to create 1st party activity scope.",t,a.correlationId,34366474),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError});var l=c.value;o.GetFirstyPartyAddInsInfo(l,a,(function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Failed get list of 1st party addIns.",t,a.correlationId,34366475),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});var d=c.value.addInList[n.assetId];if(!d)return s.RuntimeTelemetryHelper.LogExceptionTag("Could not find 1st party addin assetId in list: "+n.assetId,t,a.correlationId,34366476),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});a.startActivity(e.Activity.ManifestRequest),o.GetFirstPartyManifest(l,a,d,(function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Could not find get 1st party manifest: "+n.assetId,t,a.correlationId,34366477),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure});a.stopActivity(e.Activity.ManifestRequest),a.stopActivity(e.Activity.ServerCall);var l=c.value;r.load({entitlement:n,manifest:l,eToken:""},t)}))}))}))},n}();e.FirstPartyCatalog=t,e.CatalogFactory.register(i.StoreType.FirstParty,(function(n){if(n.osfOmexBaseUrl&&n.firstPartyManifestCDNUrl){var r,a=n.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);r=a>=0?n.osfOmexBaseUrl.substr(a):i.Constants.ProtocolSeparator+n.osfOmexBaseUrl;var o=i.Constants.Https+r;return new t({appName:n.appName,appUILocale:n.appUILocale,AppVersion:n.appVersion,clientMode:n.clientMode,docUrl:n.docUrl,omexBaseUrl:o,omexForceAnonymous:!0,firstPartyManifestCDNUrl:n.firstPartyManifestCDNUrl})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})}))}(l||(l={})),function(e){var t=function(){var e="OMEX_clearCacheAsync",t="OMEX_removeCacheAsync",n="OMEX_getAppStateAsync",r="OMEX_getKilledAppsAsync",a="OMEX_getManifestAndETokenAsync";function i(){}return i.CheckProxyIsReady="OMEX_isProxyReady",i.Gated_GetManifestAndEToken=a,i.Gated_GetKilledApps=r,i.Gated_GetEntitlementSummary="OMEX_getEntitlementSummaryAsync",i.Gated_GetAppState=n,i.Gated_RemoveApp="OMEX_removeAppAsync",i.Gated_RemoveCache=t,i.Gated_ClearCache=e,i.UnGated_GetAppDetails="OMEX_getAppDetailsAsync",i.UnGated_GetRecommendations="OMEX_getRecommendationsAsync",i.UnGated_ClearCache=e,i.Anonymous_GetManifestAndEToken=a,i.Anonymous_GetKilledApps=r,i.Anonymous_GetAppState=n,i.Anonymous_RemoveCache=t,i.Anonymous_ClearCache=e,i.Anonymous_GetAuthNStatus="OMEX_getAuthNStatus",i.Anonymous_GetFirstPartyAddInList="OMEX_getFirstPartyAddInListAsync",i.Anonymous_GetFirstPartyManifest="OMEX_getFirstPartyManifestAsync",i}();e.OmexProxyMethods=t;var n=function(n){var r=null;function a(e){n.call(this),this.osfOmexBaseUrl=e}return c(a,n),a.prototype.prepareProxy=function(e,t,n){var i=this;n&&(i.isReady=!1,a.resetProxy(i)),i.isReady?e({status:r,value:{clientEndpoint:i.clientEndPoint}}):i.clientEndPoint?i.pendingCallbacks.push([e,t]):i.createProxy(e,t)},a.resetProxy=function(e){Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=r),e.clientEndPoint=r},a.prototype.createProxy=function(n,o){var c=this;try{!c.doesUrlHaveSupportedProtocol(c.proxyUrl)&&o({status:r,value:{errorMessage:"Protocal of proxyUrl is not supported."}});var u=document.createElement("iframe");u.setAttribute("id",c.proxyName),u.setAttribute("name",c.proxyName);var l=c.proxyUrl+"?"+c.conversationId;l=i.OUtil.addXdmInfoAsHash(l,c.conversationId+"|"+c.proxyName+"|"+window.location.href),l=i.OUtil.addSerializerVersionAsHash(l,i.SerializerVersion.Browser),u.setAttribute("src",l),u.setAttribute("scrolling","auto"),u.setAttribute("border","0"),u.setAttribute("width","0"),u.setAttribute("height","0"),u.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(u);var d=c,f=function(){if(d.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(d.conversationId,u.contentWindow,d.proxyUrl),d.clientEndPoint)d.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=d.pendingCallbacks.length;if(0!=n){var i=r;0===e&&t.status?(d.isReady=!0,i={status:r,value:{clientEndpoint:d.clientEndPoint}}):(a.resetProxy(d),i={status:r,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var o=0;o<n;o++){var s=d.pendingCallbacks.shift();d.isReady?s[0](i):s[1](i)}}}),{__timeout__:500});else{var e="Unexpected error, iframe loaded again after failing OMEX_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,r,r,18121820),o({status:r,value:{errorMessage:e}})}i.OUtil.set_entropy((new Date).getTime())};i.OUtil.addEventListener(u,"load",f),c.iframeOnload=f,c.pendingCallbacks.push([n,o]),c.iframe=u}catch(t){var p="Error creating client endpoint with proxyUrl = ["+c.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);o({status:r,value:{errorMessage:p}})}},a}(e.ProxyBase);e.OmexProxyBase=n}(l||(l={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionAnonymousProxy",n.proxyUrl=n.osfOmexBaseUrl+"/anonymousserviceextension.aspx"}return c(n,t),n.prototype.getManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetManifestAndEToken,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),n(t)}))},n.prototype.getFirstPartyAddInListAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyAddInList,t,(function(e){n(e)}))},n.prototype.getFirstPartyManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyManifest,t,(function(e){n(e)}))},n.prototype.getAppStateAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAppState,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),n(t)}))},n.prototype.getKilledAppAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetKilledApps,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),n(t)}))},n.prototype.getAuthNStatusAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAuthNStatus,t,n)},n}(e.OmexProxyBase);e.AnonymousOmexProxy=t}(l||(l={})),function(e){var t=function(t){var n=null;function r(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionGatedProxy",n.proxyUrl=n.osfOmexBaseUrl+"/gatedserviceextension.aspx"}return c(r,t),r.prototype.getOmexEntitlementsAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetEntitlementSummary,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertEntitlementInfo(t.value)),r(t)}))},r.prototype.getManifestAndETokenAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetManifestAndEToken,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),r(t)}))},r.prototype.getAppStateAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetAppState,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),r(t)}))},r.prototype.getKilledAppAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetKilledApps,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),r(t)}))},r.prototype.removeApps=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_RemoveApp,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertRemoveAppResponse(t.value)),r(t)}))},r}(e.OmexProxyBase);e.GatedOmexProxy=t}(l||(l={})),function(e){var t,n="",r=null;!function(e){var t="AnonymousUser",n="AuthedUser",r="NotDetected";e[e[r]=0]=r,e[e[n]=1]=n,e[e[t]=2]=t}(t||(t={}));var a=function(){function a(n){var r=this;r.currentUserType=t.NotDetected,r.omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,r.omexAuthConnectTries=1,r.initParams=n,r.gatedProxy=new e.GatedOmexProxy(n.omexBaseUrl),r.ungatedProxy=new e.UnGatedOmexProxy(n.omexBaseUrl),r.anonymousProxy=new e.AnonymousOmexProxy(n.omexBaseUrl)}return a.getInstance=function(e){return a._instance==r&&(a._instance=new a(e)),a._instance},a.getFirstPartyInstance=function(e){if(a._firstPartyInstance==r){var t=new a(e);t._isFirstParty=!0,t.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,this._firstPartyInstance=t}return a._firstPartyInstance},a.prototype.prepareProxy=function(a,i){var o=this;a=a||n;this.ensureOmexProxySetUp(a,(function(n){var a;n&&n.status!=r?n.status:e.DataServiceResultCode.ProxyNotReady;n&&n.value&&(o._isFirstParty?a=!0:n.value.currentUserType&&(n.value.currentUserType==t.AuthedUser?a=!1:n.value.currentUserType==t.AnonymousUser&&(a=!0))),i({status:n.status,value:{anonymous:a}})}))},a.prototype.createScope=function(e){return new c(e,this)},a.prototype.getCID=function(){switch(this.currentUserType){case t.AuthedUser:return this._cid;case t.AnonymousUser:return n}throw"not initialized"},a.prototype.ensureOmexProxySetUp=function(n,a){var o=this;if(o.currentUserType==t.NotDetected||!o.anonymousProxy.isReady&&!o.gatedProxy.isReady){var c=o,u=function(){c.currentUserType=t.AuthedUser,a({status:e.DataServiceResultCode.Succeeded,value:c})},l=function(){c.omexAuthConnectTries<i.Constants.AuthenticatedConnectMaxTries?(c.omexAuthConnectTries++,c.omexAuthNStatus!==i.OmexAuthNStatus.CheckFailed?c.anonymousProxy.prepareProxy(d,p):c.gatedProxy.prepareProxy(u,l)):(s.RuntimeTelemetryHelper.LogExceptionTag("exceed maximum tries and fail",r,n,18657693),c.anonymousProxy.prepareProxy(f,p))},d=function(e){if(e&&e.value){c.anonymousProxy.getAuthNStatusAsync({correlationId:n},(function(e){if(e.status===i.ProxyCallStatusCode.Succeeded){var t=e.value;t==i.OmexAuthNStatus.Authenticated?(c.omexAuthNStatus=i.OmexAuthNStatus.Authenticated,c.gatedProxy.prepareProxy(u,l)):t!=i.OmexAuthNStatus.Anonymous&&t!=i.OmexAuthNStatus.Unknown||(c.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,c.anonymousProxy.prepareProxy(f,p))}else s.RuntimeTelemetryHelper.LogExceptionTag("auth check failure.",r,n,18657694),c.omexAuthNStatus=i.OmexAuthNStatus.CheckFailed,c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(f,p):c.gatedProxy.prepareProxy(u,l)}))}else s.RuntimeTelemetryHelper.LogExceptionTag("GetAuthNStatus callback param invalid",r,n,18657695)},f=function(n){c.omexAuthNStatus==i.OmexAuthNStatus.NotAttempted?d(n):(c.currentUserType=t.AnonymousUser,a({status:e.DataServiceResultCode.Succeeded,value:c}))},p=function(){s.RuntimeTelemetryHelper.LogExceptionTag("create anonymous proxy failure",r,n,18657696),a({status:e.DataServiceResultCode.ProxyNotReady})};c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(f,p):c.gatedProxy.prepareProxy(u,l)}else a({status:e.DataServiceResultCode.Succeeded,value:o})},a}();e.ProxyBasedCatalogService=a;var o=function(){function e(){}return e.dummyApplicationName="unused",e}(),c=function(){var a="contentMarket",c="assetID",l="applicationName",d="errors";function f(e,t){var r=this;r._build=i.Constants.FileVersion,r._catalogService=t,r._appVersion=i.OmexAppVersions[r._catalogService.initParams.appName],r._clientName=i.OmexClientNames[r._catalogService.initParams.appName],r._clientVersion=u.getClientVersionFromWACAppVersion(r._catalogService.initParams.AppVersion),r._correlationId=e.telemetryContext.correlationId||n}return f.prototype.getFirstPartyAddInList=function(e){var t=this.buildOmexRequestParameters();t[d]={},this._catalogService.anonymousProxy.getFirstPartyAddInListAsync(t,e)},f.prototype.getFirstPartyManifest=function(e,t){var n=this.buildOmexRequestParameters();n[d]={},n.manifestUrl=e,this._catalogService.anonymousProxy.getFirstPartyManifestAsync(n,t)},f.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},f.prototype.isUserTypeValid=function(e){return e!==t.NotDetected||(s.RuntimeTelemetryHelper.LogExceptionTag("userType is invalid.",r,this._correlationId,18657698),!1)},f.prototype.getEntitlementAsync=function(n,r,a){var i=this,s=i,c=i.buildOmexRequestParameters();c[l]=o.dummyApplicationName,c.appVersion=i._appVersion,c.clearEntitlement=a||!1;var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.getOmexEntitlementsAsync(c,(function(e){s.tryFail(e.status,e.httpStatus,r)||(s._catalogService._cid=e.value.cid,r(e))})):u===t.AnonymousUser&&r({status:e.DataServiceResultCode.Succeeded,value:{refreshRate2:0,entitlements:[]}}):r({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,entitlements:[]}})},f.prototype.getLastStoreUpdate=function(){},f.prototype.isStoreDisabled=function(t){t({status:e.DataServiceResultCode.Succeeded,value:!1})},f.prototype.getManifest=function(t,r,a){this.getETokenAndManifestInternal(t,r,i.ClientAppInfoReturnType.urlOnly,(function(t){var r=t&&t.value&&t.value.manifest?t.value.manifest:n,o=t&&t.value&&t.value.status2?t.value.status2:i.OmexClientAppStatus.ServerError,s=t?t.status:e.DataServiceResultCode.Failed;a({status:s,value:{status2:o,manifest:r}})}))},f.prototype.getEToken=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.etokenOnly,n)},f.prototype.getETokenAndManifest=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.both,n)},f.prototype.getAppState=function(r,i){var o=this,s=o,u=o.buildOmexRequestParameters();u[c]=r.assetId,u[a]=r.storeId,u[d]={};var l=o._catalogService.currentUserType;o.isUserTypeValid(l)?l===t.AuthedUser?o._catalogService.gatedProxy.getAppStateAsync(u,(function(e){s.tryFail(e.status,e.httpStatus,i)?s.logServiceCallResponseError("appstate",e.httpStatus):i(e)})):l===t.AnonymousUser&&o._catalogService.anonymousProxy.getAppStateAsync(u,i):i({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,assetId:n,productId:n,version:n,state2:-1}})},f.prototype.getKilledApps=function(n){var a=this,i=a,o=a.buildOmexRequestParameters(),s=a._catalogService.currentUserType;a.isUserTypeValid(s)?s===t.AuthedUser?a._catalogService.gatedProxy.getKilledAppAsync(o,(function(e){i.tryFail(e.status,e.httpStatus,n)?i.logServiceCallResponseError("killedapps",e.httpStatus):n(e)})):s===t.AnonymousUser&&a._catalogService.anonymousProxy.getKilledAppAsync(o,n):n({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,killedApps:r}})},f.prototype.getAppDetails=function(e,t,r){var i=this,o=this.buildOmexRequestParameters();o.assetid=n,o[c]=e.join(","),o[a]=t,this._catalogService.ungatedProxy.getAppDetailsAsync(o,(function(e){i.tryFail(e.status,e.httpStatus,r)?i.logServiceCallResponseError("appdetails",e.httpStatus):r(e)}))},f.prototype.removeApps=function(r,a){var i=this,o=i,s=i.buildOmexRequestParameters();s.assetid=n,s[c]=r.join(",");var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.removeApps(s,(function(e){o.tryFail(e.status,e.httpStatus,a)?o.logServiceCallResponseError("removeapps",e.httpStatus):a(e)})):u===t.AnonymousUser&&a({status:e.DataServiceResultCode.Succeeded,value:{removedApps:[]}}):a({status:e.DataServiceResultCode.UnknownUserType,value:{removedApps:[]}})},f.prototype.getETokenAndManifestInternal=function(s,u,d,f){var p=this,m=p,g=p.buildOmexRequestParameters();g[l]=o.dummyApplicationName,g[c]=s.assetId,g.clientAppInfoReturnType=d;var v=p._catalogService.currentUserType;p.isUserTypeValid(v)?v===t.AuthedUser&&d!=i.ClientAppInfoReturnType.urlOnly?(g.assetContentMarket=u,g.userContentMarket=s.storeId,g.expectedVersion=s.appVersion,p._catalogService.gatedProxy.getManifestAndETokenAsync(g,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifestandetoken",e.httpStatus):f(e)}))):(g[a]=s.storeId,g.clientAppInfoReturnType==i.ClientAppInfoReturnType.etokenOnly?f({status:e.DataServiceResultCode.Succeeded,value:{status2:i.OmexClientAppStatus.OK,etoken:n,manifest:r}}):p._catalogService.anonymousProxy.getManifestAsync(g,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifest",e.httpStatus):f(e)}))):f({status:e.DataServiceResultCode.UnknownUserType,value:{etoken:n,manifest:r}})},f.prototype.buildOmexRequestParameters=function(){var e=this;return{clientName:e._clientName,clientVersion:e._clientVersion,correlationId:e._correlationId,build:e._build}},f.prototype.logServiceCallResponseError=function(e,t){var n="proxybased request "+e+" failed";t&&(n+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(n,r,this._correlationId,18657697)},f}();e.ProxyBasedCatalogServiceScope=c;var u=function(){function e(){}return e.getClientVersionFromWACAppVersion=function(e){if(e){var t=e.split("."),n=parseInt(t[0],10),r=parseInt(t[1],10)||0;if(!(n<=15&&r<=0)){var a=i.Constants.FileVersion.split(".");return n+"."+r+"."+a[2]+"."+a[3]}}},e.getOmexEndPointPageUrl=function(e,t,n){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",e,n,t)},e}();e.OmexUtils=u}(l||(l={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionProxy",n.proxyUrl=n.osfOmexBaseUrl+"/ungatedserviceextension.aspx"}return c(n,t),n.prototype.getAppDetailsAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.UnGated_GetAppDetails,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppDetails(t.value)),n(t)}))},n}(e.OmexProxyBase);e.UnGatedOmexProxy=t}(l||(l={})),function(e){var t=!1,n=null,r=!0,a=function(){var a="cacheExpired";function o(e,t){var n=this;n._initParam=t,n._cacheManager=e.cacheManager,n._cachePrefix=e.cachePrefix,n._cid=e.cid,n._anonymous=e.anonymous,n._telemetryContext=e.telemetryContext}return o.prototype.GetCacheKeyPrefix=function(){return this._cachePrefix},o.prototype.getOmexEndPointPageUrl=function(t,n){return e.OmexUtils.getOmexEndPointPageUrl(this._initParam.omexBaseUrl,t,n)},o.prototype.getKilledApps=function(t,a,o){var s=this,c=s;s._telemetryContext.startActivity(e.Activity.KilledAppsCheck);var u=i.OUtil.formatString(e.CacheConsts.killedAppsCacheKey,s.GetCacheKeyPrefix());if(o)s._cacheManager.RemoveCacheItem(u);else{var l=s._cacheManager.GetCacheItem(u,r);if(l&&l.refreshRate2!=n)return s._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),void a({status:e.DataServiceResultCode.Succeeded,value:l})}t.getKilledApps((function(t){t.status==e.DataServiceResultCode.Succeeded?(c._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),l=t.value,c._cacheManager.SetCacheItem(u,l,l.refreshRate/e.CacheConsts.hourToDayConversionFactor),a(t)):a(t)}))},o.prototype.getAppState=function(o,s,c,u){var l=this,d=l;l._telemetryContext.startActivity(e.Activity.AppStateCheck);var f,p=i.OUtil.formatString(e.CacheConsts.appStateCacheKey,l.GetCacheKeyPrefix(),s.storeId,s.assetId);if(u)l._cacheManager.RemoveCacheItem(p);else{var m={};if(f=l._cacheManager.GetCacheItem(p,r,m),l._telemetryContext.setFlag(e.FlagName.AppStateDataInvalidFlag,m[a]||t),f&&f.state2!=n)return l._telemetryContext.stopActivity(e.Activity.AppStateCheck),l._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,r),void c({status:e.DataServiceResultCode.Succeeded,value:f})}o.getAppState(s,(function(n){n.status==e.DataServiceResultCode.Succeeded?(d._telemetryContext.stopActivity(e.Activity.AppStateCheck),d._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,t),f=n.value,d._cacheManager.SetCacheItem(p,f,f.refreshRate2/e.CacheConsts.hourToDayConversionFactor),c(n)):c(n)}))},o.prototype.getManifest=function(o,s,c,u,l){var d=this,f=d;d._telemetryContext.startActivity(e.Activity.ManifestRequest);var p,m=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,s.assetId,s.storeId);if(l)d._cacheManager.RemoveCacheItem(m);else{var g={};if(p=d._cacheManager.GetCacheItem(m,r,g),d._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,g[a]||t),p&&p.status2!=n)return d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,r),void u({status:e.DataServiceResultCode.Succeeded,value:{status2:p.status2,manifest:p.manifest}})}o.getManifest(s,c,(function(n){n.status==e.DataServiceResultCode.Succeeded&&n.value.status2==i.OmexClientAppStatus.OK?(f._telemetryContext.stopActivity(e.Activity.ManifestRequest),f._telemetryContext.stopActivity(e.Activity.ServerCall),f._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),f._telemetryContext.setBits(e.FlagName.ManifestRequestType,i.ManifestRequestTypes.Manifest),p={etoken:"",status2:n.value.status2,manifest:n.value.manifest},f._cacheManager.SetCacheItem(m,p,e.CacheConsts.manifestRefreshRate),u(n)):u(n)}))},o.prototype.removeApps=function(n,a,o){var s=this;n.removeApps(a,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){for(var a=".*",c=t,u=[],l=n.value.removedApps,d=0;d<l.length;++d)l[d].result2==i.OmexRemoveAppStatus.Success&&(u.push(new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,a,l[d].assetId,a,a),"i")),c=r);c&&s._cacheManager.RemoveMatches(u),o(n)}else o(n)}))},o.prototype.getCachedETokenAndManifest=function(i){var o={},s=this._cacheManager.GetCacheItem(i,r,o);if(this._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,o[a]||t),s){if(s.status2&&s.tokenExpirationDate2&&s.tokenExpirationDate2>(new Date).getTime())return s;s.etoken=n,s.tokenExpirationDate2=n,s.entitlementType=n}return s},o.prototype.getETokenAndManifest=function(a,o,s,c,u){var l=this,d=l;if(l._anonymous)l.getManifest(a,o,s,(function(t){e.AsyncUtil.failed(t,c)||c({status:t.status,value:{etoken:"",status2:t.value.status2,manifest:t.value.manifest}})}),u);else{l._telemetryContext.startActivity(e.Activity.ManifestRequest);var f,p=function(t,n){d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),n&&d._telemetryContext.setBits(e.FlagName.ManifestRequestType,n)},m=i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,l._cid,o.assetId,o.storeId,s);if(u)l._cacheManager.RemoveCacheItem(m);else{if((f=l.getCachedETokenAndManifest(m))&&f.etoken&&f.manifest)return p(r),void c({status:e.DataServiceResultCode.Succeeded,value:f});var g=f?f.manifest:n;if(g==n||""==g){var v=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,o.assetId,o.storeId),h=l._cacheManager.GetCacheItem(v,r);h&&(g=h.manifest)}if(g)return void(f&&f.etoken?(p(r),f.manifest=g,c({status:e.DataServiceResultCode.Succeeded,value:f})):a.getEToken(o,s,(function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value&&(p(t,i.ManifestRequestTypes.Etoken),(f=n.value).status2===i.OmexClientAppStatus.OK&&(d._cacheManager.SetCacheItem(m,f,e.CacheConsts.manifestRefreshRate),f.manifest=g)),c(n)})))}a.getETokenAndManifest(o,s,(function(n){n.status==e.DataServiceResultCode.Succeeded?(p(t,i.ManifestRequestTypes.Both),n.value.status2===i.OmexClientAppStatus.OK&&d._cacheManager.SetCacheItem(m,n.value,e.CacheConsts.manifestRefreshRate),c(n)):c(n)}))}},o.prototype.getEntitlements=function(t,r,a,i){var o=this,s=o;o._telemetryContext.startActivity(e.Activity.EntitlementCheck);var c,u,l=function(){u!=n&&c!=n&&(c=c.filter((function(e){return u.every((function(t){return t.assetId!=e.assetId}))})),a({status:e.DataServiceResultCode.Succeeded,value:{entitlements:c,killed:u}}))};o._anonymous?(c=[],o._telemetryContext.stopActivity(e.Activity.EntitlementCheck),l()):t.getEntitlementAsync(r,(function(t){s._telemetryContext.stopActivity(e.Activity.EntitlementCheck),a!=n&&(e.AsyncUtil.failed(t,a)?a=n:(s._cid||(s._cid=t.value.cid),c=t.value.entitlements,l()))}),i),o.getKilledApps(t,(function(t){a!=n&&(u=t.status==e.DataServiceResultCode.Succeeded?t.value.killedApps:[],l())}))},o.prototype.activate=function(a,o,c){var u,l,d=this,f={assetId:o.assetId,appVersion:o.appVersion,storeId:o.storeId,storeType:o.storeType,targetType:o.targetType},p=t,m=this.getOmexEndPointPageUrl(f.assetId,f.storeId),g=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),v=function(l,p){switch(l.status2){case i.OmexClientAppStatus.OK:if(l.tokenExpirationDate2&&l.tokenExpirationDate2<=(new Date).getTime())return void e.LoaderUtil.failWithWarning(c,e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){return h()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED}));var v=e.ManifestUtil.ParseManifest(l.manifest,d._initParam.appUILocale,d._telemetryContext.correlationId);if(v==n)return void e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h()},description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT});var y=v.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(f.assetId,o.appVersion,v),v.requirementsSupported===t||void 0===v.requirementsSupported&&!c.getRequirementsChecker().isManifestSupported(v)){v.requirementsSupported=t;var O;return O=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(c,{description:O,url:m,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex})}v.requirementsSupported=r,d._telemetryContext.setFlag(e.FlagName.ManifestTrustCachedFlag,!p);var S=i.OUtil.formatString(i.Constants.ActivatedCacheKey,o.assetId.toLowerCase(),o.storeType,o.storeId);if(p&&!c.skipTrust(o)){var C=i.OmexClientNames[d._initParam.appName];if(!(d._anonymous&&d._cacheManager.GetCacheItem(S,t))&&!c.hasConsent(o)&&!c.isForCustomFunctionSandbox())return void c.askForTrust({anonymous:t,clientName:C,entitlement:f,displayName:v.getDefaultDisplayName(),providerName:v.getProviderName(),iconUrl:v.getDefaultIconUrl(),url:m,isSSOAddin:v.isSSOAddin()},(function(){d.restartActivationTelemetry(),d._cacheManager.SetCacheItem(S,r),d._anonymous?c.load({entitlement:f,manifest:v,eToken:l.etoken},n):d.getETokenAndManifest(a,f,f.storeId,(function(t){t.status==e.DataServiceResultCode.Succeeded&&t.value.status2==i.OmexClientAppStatus.OK?(t.value.version!=n&&e.ManifestUtil.versionLessThan(f.appVersion,t.value.version)&&(f.appVersion=t.value.version),_(r)):e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h()},description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure})}))}))}c.hasConsent(o)&&d._cacheManager.SetCacheItem(S,r);var I=u.version;e.ManifestUtil.versionLessThan(I,o.appVersion)&&(I=o.appVersion),e.ManifestUtil.versionLessThan(y,I)?(f.appVersion=I,e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),c.setIsUpgrading(r),h(r),b()},url:m,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})):u.state2===i.OmexState.DeveloperWithdrawn?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}):u.state2===i.OmexState.Flagged?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED}):!d._anonymous&&l.entitlementType&&l.entitlementType.toLowerCase()===i.OmexEntitlementType.Trial&&(e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){return window.open(m)},reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE}),e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(r)},detailView:r,reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_USER_CLICKED_BUY})),c.load({entitlement:f,manifest:v,eToken:l.etoken},n);break;case i.OmexClientAppStatus.KilledAsset:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});break;case i.OmexClientAppStatus.NoEntitlement:case i.OmexClientAppStatus.TrialNotSupported:case i.OmexClientAppStatus.LimitedTrial:case i.OmexClientAppStatus.EntitlementDeactivated:if(d._anonymous){e.LoaderUtil.failWithError(c,{title:Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,description:Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,buttonTxt:Strings.OsfRuntime.L_SignInButton_TXT,buttonCallback:function(){var e=window.location.href,t=d._initParam.omexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(e);window.open(t)},errorCode:i.ErrorStatusCodes.E_USER_NOT_SIGNED_IN})}else{c.setRetryCall((function(){d.restartActivationTelemetry(),h(r)})),e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){window.open(m),e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(r)},detailView:r,retryAll:r,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}break;case i.OmexClientAppStatus.UnknownAssetId:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST});break;case i.OmexClientAppStatus.Expired:case i.OmexClientAppStatus.Invalid:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED});break;case i.OmexClientAppStatus.Revoked:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE});break;case i.OmexClientAppStatus.VersionMismatch:f.appVersion=l.version,c.askForUpgrade(e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,url:m,highPriority:r,logAsError:r,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE}),(function(){d.restartActivationTelemetry(),c.setIsUpgrading(r),h(r)}));break;case i.OmexClientAppStatus.VersionNotSupported:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType},i.OsfControlStatus.UnsupportedStore);break;case i.OmexClientAppStatus.UserIsMinor:g&&g.enableDisplayBlockedMinorError&&e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR});break;default:s.RuntimeTelemetryHelper.LogExceptionTag("unknown clientAppStatus in manifestAndEtoken: "+l.status2,n,d._telemetryContext.correlationId,20030238),e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(r)},errorCode:i.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus})}},h=function(o){var s=l?l.contentMarket:f.storeId,m=function(n,a){return n.status!=e.DataServiceResultCode.Succeeded?g&&g.enableDisplayBlockedMinorError&&451===n.httpStatus?(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}),r):(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(o)},errorCode:a}),r):t};c.skipTrust(f)?d.getManifest(a,f,s,(function(e){if(!m(e,i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure))return o?(u=n,void O(r)):void v({etoken:"",status2:e.value.status2,manifest:e.value.manifest})}),o):d.getETokenAndManifest(a,f,s,(function(e){if(!m(e,i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure))return o?(u=n,p=t,_(r),void O(r)):void v(e.value)}),o)},b=function(){var t=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,f.assetId,f.storeId);d._cacheManager.RemoveCacheItem(t)},y=function(){if(u!=n&&p){if(l!=n)return f.appVersion=l.version,void h();var t,s,g;if(u.state2===i.OmexState.Flagged?t=r:u.state2===i.OmexState.DeveloperWithdrawn?s=r:u.state2===i.OmexState.Withdrawn&&(g=r),!(t||s||g)||(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE}),!t))if(c.hasConsent(o))h();else{var b=l?l.contentMarket:f.storeId;d.getManifest(a,f,b,(function(t){t.status==e.DataServiceResultCode.Succeeded?v({etoken:"",status2:t.value.status2,manifest:t.value.manifest},r):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),y()},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure})}))}}},_=function(o){l=n,p=t,d.getEntitlements(a,t,(function(a){if(a.status!=e.DataServiceResultCode.Succeeded)return g&&g.enableDisplayBlockedMinorError&&451===a.httpStatus?void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}):void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),_()},errorCode:i.ErrorStatusCodes.WAC_AgaveEntitlementRequestFailure});a.value.killed.some((function(e){return e.assetId==f.assetId}))?e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED}):(a.value.entitlements.some((function(e){return e.assetId.toLowerCase()==f.assetId.toLowerCase()?(l=e,m=d.getOmexEndPointPageUrl(e.assetId,e.contentMarket),r):t})),d._telemetryContext.setFlag(e.FlagName.OmexHasEntitlementFlag,l!=n),p=r,y())}),o)},O=function(t){u=n,d.getAppState(a,f,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return u={state2:i.OmexState.OK,productId:n,assetId:f.assetId,version:f.appVersion,refreshRate2:0},void y();t.value.state2!==i.OmexState.Killed?(u=t.value,y()):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED})}),t)};O(),_()},o.prototype.restartActivationTelemetry=function(){var t=this;t._telemetryContext.startActivity(e.Activity.Activation),t._telemetryContext.startActivity(e.Activity.ServerCall),t._telemetryContext.setFlag(e.FlagName.AnonymousFlag,t._anonymous)},o}(),o=function(){function o(t,a){void 0===a&&(a=n),this._anonymous=r,this._initParam=t,this._cacheManager=a||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return o.prototype.GetCacheKeyPrefix=function(){return this._anonymous?e.CacheConsts.anonymousCacheKeyPrefix:e.WACUtils.CacheConstants.GatedCacheKeyPrefix},o.prototype.getOmexEndPointPageUrl=function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._initParam.omexBaseUrl,t,e)},o.prototype.getDataService=function(t,r){var a=this,o=a;if(a._dataService==n)if(a._dataServiceReady==n){a._dataServiceReady=r;var s={status:e.DataServiceResultCode.Failed,value:n},c=function(t,r){var a=o._dataServiceReady;o._dataServiceReady=n,t.status==e.DataServiceResultCode.Succeeded?(o._anonymous=t.value.anonymous,o._dataService=r,s.value=r,s.status=e.DataServiceResultCode.Succeeded,a(s)):(s.httpStatus=t.httpStatus,a(s))};t.startActivity(e.Activity.Authentication);var u=new e.S2SOmexCatalogService(a._initParam);u.initialize(t.correlationId,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){var r=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(!r||!r.enableAnonymousUseLegacyCatalogService||!n.value.anonymous)return t.stopActivity(e.Activity.Authentication),void c(n,u)}t.setBits(e.FlagName.ActivationRuntimeType,i.ActivationTypes.V2Enabled);var a=e.ProxyBasedCatalogService.getInstance(o._initParam);a.prepareProxy(t.correlationId,(function(n){t.stopActivity(e.Activity.Authentication),t.setBits(e.FlagName.RetryCount,a.omexAuthConnectTries),c(n,a)}))}))}else{t.startActivity(e.Activity.Authentication);var l=a._dataServiceReady;a._dataServiceReady=function(n){t.stopActivity(e.Activity.Authentication),l(n),r(n)}}else r({status:e.DataServiceResultCode.Succeeded,value:a._dataService})},o.prototype.createActivityScope=function(t,r){var i=this;this.getDataService(t,(function(o){if(e.AsyncUtil.failed(o,r))s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data service.",n,t.correlationId,18657692);else{t.setFlag(e.FlagName.AnonymousFlag,i._anonymous);var c=o.value,u={cacheManager:i._cacheManager,cachePrefix:i.GetCacheKeyPrefix(),cid:c.getCID(),anonymous:i._anonymous,telemetryContext:t},l=c.createScope(u),d=new a(u,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:l,activityScope:d}})}}))},o.prototype.getEntitlementAsync=function(t,n,r,a,o){var s=this;this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,[])||(s._anonymous?r({status:e.DataServiceResultCode.Failed,httpStatus:403}):n.value.serviceScope.getEntitlementAsync(t,(function(t){if(!e.AsyncUtil.failed(t,r,[])){for(var n=t.value.entitlements,a=0;a<n.length;a++){var o=n[a],s=o;s.appVersion=o.version,s.storeId=o.contentMarket,s.storeType=i.StoreType.OMEX,s.targetType=i.OUtil.getTargetType(o.appSubType)}r({status:t.status,value:n})}}),a,o))}))},o.prototype.getAndCacheManifest=function(r,a,o,s,c){var u=this;c=c||t;var l=i.OsfManifestManager.getCachedManifest(r.assetId,r.appVersion);c||l==n?this.createActivityScope(o,(function(t){if(!e.AsyncUtil.failed(t,s)){var l=t.value.serviceScope;t.value.activityScope.getManifest(l,r,a,(function(t){if(!e.AsyncUtil.failed(t,s))if(t.value.status2==i.OmexClientAppStatus.OK){var a=e.ManifestUtil.ParseManifest(t.value.manifest,u._initParam.appUILocale,o.correlationId);a!=n?(i.OsfManifestManager.cacheManifest(r.assetId,r.appVersion,a),s({status:e.DataServiceResultCode.Succeeded,value:a})):s({status:e.DataServiceResultCode.Failed,value:a})}else s({status:e.DataServiceResultCode.Failed})}),c)}})):s({status:e.DataServiceResultCode.Succeeded,value:l})},o.prototype.activateAsync=function(t,n,a){var o=this;a.startActivity(e.Activity.Activation),a.startActivity(e.Activity.ServerCall),this.createActivityScope(a,(function(s){o.isStoreDisabled(a,(function(c){if(c.value===r)e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_OmexStoreDisabledByAdmin,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED});else if(s.status!=e.DataServiceResultCode.Succeeded)return void e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),o.activateAsync(t,n,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}));var c=s.value.serviceScope;s.value.activityScope.activate(c,t,n)}))},o.prototype.removeAsync=function(t,n,r){this.createActivityScope(n,(function(n){if(!e.AsyncUtil.failed(n,r)){var a=n.value.serviceScope;n.value.activityScope.removeApps(a,t,r)}}))},o.prototype.getAppDetails=function(t,a,o,s,c){var u=this,l=u,d=[];if(c)u._cacheManager.RemoveAll(e.CacheConsts.ungatedCacheKeyPrefix);else{for(var f=t,p=[],m=0;m<f.length;++m){var g=i.OUtil.formatString(e.CacheConsts.appDetailKey,f[m]),v=u._cacheManager.GetCacheItem(g,r);v&&v.state2!=n?d.push(v):p.push(f[m])}if(0===p.length)return void s({status:e.DataServiceResultCode.Succeeded,value:d});t=p}u.createActivityScope(o,(function(n){e.AsyncUtil.failed(n,s,d)||n.value.serviceScope.getAppDetails(t,a,(function(t){if(!e.AsyncUtil.failed(t,s,d)){for(var n=t.value,r=0;r<n.length;++r){var a=n[r],o=i.OUtil.formatString(e.CacheConsts.appDetailKey,a.assetId);l._cacheManager.SetCacheItem(o,a),d.push(a)}t.value=d,s(t)}}))}))},o.prototype.isStoreDisabled=function(n,r){this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,t)||n.value.serviceScope.isStoreDisabled(r)}))},o}();e.OmexCatalog=o,e.CatalogFactory.register(i.StoreType.OMEX,(function(t){if(t.allowExternalMarketplace&&t.osfOmexBaseUrl){var n,a=t.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);n=a>=0?t.osfOmexBaseUrl.substr(a):i.Constants.ProtocolSeparator+t.osfOmexBaseUrl;var s=i.Constants.Https+n;return i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(t.omexForceAnonymous=r),new o({appName:t.appName,appUILocale:t.appUILocale,AppVersion:t.appVersion,clientMode:t.clientMode,docUrl:t.docUrl,omexBaseUrl:s,omexForceAnonymous:t.omexForceAnonymous})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})}))}(l||(l={})),function(e){var t=function(){function e(){}return e.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.ungatedCacheKeyPrefix="__OSF_OMEX.",e.manifestRefreshRate=1825,e.hourToDayConversionFactor=24,e.anonymousAppInstallInfoCacheKey=e.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}",e.firstPartyAddinListCacheKey=e.anonymousCacheKeyPrefix+"firstPartyAddInList",e.firstPartyManifestCacheKey=e.anonymousCacheKeyPrefix+"firstPartyManifest.{0}",e.killedAppsCacheKey="{0}killedApps",e.appStateCacheKey="{0}appState.{1}.{2}",e.appDetailKey="__OSF_OMEX.appDetails.{0}",e}();e.CacheConsts=t}(l||(l={})),function(e){var t=null,n=function(){function n(e,t,n){var r=this;r._handler=e,r._initParam=t,r._cacheManager=n.cacheManager,r._cachePrefix=n.cachePrefix,r._cid=n.cid,r._correlationId=n.telemetryContext.correlationId}return n.prototype.tryFail=function(t,n){return 200!=t&&(n({httpStatus:t,status:e.DataServiceResultCode.Failed}),!0)},n.prototype.getLastStoreUpdate=function(t){var n=this,r=n,a=n._initParam.appUILocale;n._handler.getLastStoreUpdate(a,n._correlationId,(function(n,a){r.tryFail(n,t)?r.logServiceCallResponseError("laststoreupdate",n):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessLastStoreUpdate(a)})}))},n.prototype.getEntitlementAsync=function(n,r,a,o){var s=this,c=s,u=i.OmexAppVersions[s._initParam.appName],l=i.OUtil.formatString(s._cachePrefix+e.WACUtils.CacheConstants.EntitlementsKey,u,s._cid);if(a)s._cacheManager.RemoveCacheItem(l);else{var d=s._cacheManager.GetCacheItem(l,!0,t,o);if(d!=t)return void r({status:e.DataServiceResultCode.Succeeded,value:d})}s._handler.getEntitlement(n,u,s._correlationId,(function(t,n){if(c.tryFail(t,r))c.logServiceCallResponseError("entitlement",t);else{var a=e.OmexXmlProcessor.ProcessEntitlement(n);a.cid=c._cid,c._cacheManager.SetCacheItem(l,a,a.refreshRate2/e.CacheConsts.hourToDayConversionFactor),r({status:e.DataServiceResultCode.Succeeded,value:a})}}))},n.prototype.getEToken=function(t,n,r){var a=this,o=n,s=t.storeId,c=t.assetId,u=t.appVersion;this._handler.getEToken(s,o,c,u,this._correlationId,(function(t,n){a.tryFail(t,r)?a.logServiceCallResponseError("etoken",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessClientAppInstallInfo(n,i.ClientAppInfoReturnType.etokenOnly)})}))},n.prototype.getETokenAndManifest=function(t,n,r){var a=this;this.getEToken(t,n,(function(i){i.status==e.DataServiceResultCode.Succeeded?a.getManifest(t,n,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return i.status=t.status,i.httpStatus=t.httpStatus,void r(i);i.value.manifest=t.value.manifest,r(i)})):r(i)}))},n.prototype.getManifest=function(t,n,r){var a=n;this._handler.getManifest(a,t.assetId,this._correlationId,(function(t,n){r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ConvertAnonymousManifest(t,n)})}))},n.prototype.getAppState=function(t,n){var r=this,a=t.storeId+":"+t.assetId;this._handler.getAppState(a,this._correlationId,(function(t,a){r.tryFail(t,n)?r.logServiceCallResponseError("appstate",t):n({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppState(a)})}))},n.prototype.getKilledApps=function(t){var n=this;this._handler.getKilledApps(this._correlationId,(function(r,a){n.tryFail(r,t)?n.logServiceCallResponseError("killedapps",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessKilledApps(a)})}))},n.prototype.getAppDetails=function(t,n,r){var a=this;this._handler.getAppDetails(n,t.join(","),this._correlationId,(function(t,n){a.tryFail(t,r)?a.logServiceCallResponseError("appdetails",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppDetails(n)})}))},n.prototype.removeApps=function(t,n){var r=this;this._handler.removeApps(t.join(","),this._correlationId,(function(t,a){if(r.tryFail(t,n))r.logServiceCallResponseError("removeapps",t);else{var o=e.OmexXmlProcessor.ProcessRemoveAppResponse(a);o.removedApps.some((function(e){return e.result2==i.OmexRemoveAppStatus.Success}))&&r.clearEntitlementCache(),n({status:e.DataServiceResultCode.Succeeded,value:o})}}))},n.prototype.clearEntitlementCache=function(){var t=new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i");this._cacheManager.RemoveMatches([t])},n.prototype.isStoreDisabled=function(t){var n=this;this._handler.isStoreDisabled(this._correlationId,(function(r){if(200!=r&&403!=r&&401!=r)return n.logServiceCallResponseError("isStoreDisabled",r),void t({status:e.DataServiceResultCode.Failed,value:!1});t({status:e.DataServiceResultCode.Succeeded,value:401==r})}))},n.prototype.logServiceCallResponseError=function(e,n){var r="s2s request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18657699)},n}();e.OmexCatalogServiceS2SScope=n;var r=function(){function r(e){this._cid="",this._initParam=e}return r.initRequestHandler=function(e){r._requestHandler==t&&(r._requestHandler=e)},r.prototype.getCID=function(){return this._cid},r.prototype.initialize=function(n,a){var i=this;r._requestHandler!=t?this._initParam.omexForceAnonymous?a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):r._requestHandler.getUserId(n,(function(r,o){200==r?(i._cid=o.trim(),a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!1}})):403==r?a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):(s.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+r,t,n,18657728),a({status:e.DataServiceResultCode.Failed,httpStatus:r}))})):a({status:e.DataServiceResultCode.Failed,httpStatus:404})},r.prototype.createScope=function(e){return new n(r._requestHandler,this._initParam,e)},r}();e.S2SOmexCatalogService=r}(l||(l={})),function(e){var t=function(){var e="description",t="provider",n="o:assets",r="contentMarket",a="appSubType",o="expirationDate",s="state",c="version",l="productId",d="assetId",f="o:asset",p="o:results",m="refreshRate",g=null;function v(){}return v.ProcessLastStoreUpdate=function(e){var t=new i.XmlProcessor(e,u).getDocumentElement().selectSingleNode("o:update");return t.firstChild!=g?Date.parse(t.firstChild.nodeValue):g},v.ProcessAppState=function(e){var t={},n=new i.XmlProcessor(e,u),r=n.getDocumentElement();n.readAttributes(r,{rr:m},t);var a=n.selectSingleNode(p),g=n.selectSingleNode("o:lang",a),h=n.selectSingleNode(f,g);return n.readAttributes(h,{assetid:d,prodid:l,ver:c,state:s,tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:o},t),v.ConvertAppState(t)},v.ProcessFirstPartyAddInList=function(e){var t={addInList:{},refreshRate:g},n=new i.XmlProcessor(e,u),r=n.getDocumentElement(),a=n.selectSingleNode("o:Apps",r),o=a.getAttribute("d1p1:rr");t.refreshRate=o?parseInt(o):0;for(var s=n.selectNodes("o:App",a),c=0;c<s.length;c++){var l=s[c],f={assetId:g,path:g,version:g};n.readAttributes(l,{assetid:d},f);var p=n.selectSingleNode("o:Path",l);f.path=p.text!=g?p.text:p.textContent!=g?p.textContent:p.nodeTypedValue;var m=n.selectSingleNode("o:Version",l);f.version=m.text!=g?m.text:m.textContent!=g?m.textContent:m.nodeTypedValue,t.addInList[f.assetId]=f}return t},v.ConvertAppState=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e.state2=e.state?parseInt(e.state):0,e.expirationDate2=v.GetTickByDate(e.expirationDate),e},v.ProcessEntitlement=function(e){var t={},n=new i.XmlProcessor(e,u),s=n.selectSingleNode("o:entitlementlist"),f=n.selectSingleNode("o:hdr",s);n.readAttributes(f,{pm:"billingMarket",pagesize:"pageSize",rr:m},t);for(var p,g,h=n.selectNodes("o:entitlement",n.selectSingleNode("o:entitlements",s)),b=[],y=0;y<h.length;++y)g={},p=h[y],n.readAttributes(p,{assetid:d,pid:l,ver:c,appst:a,cm:r,trlt:"licenseType",acqdate:"acquireDate",expiry2:o,attreq:"attentionRequired"},g),b.push(g);return t.entitlements=b,v.ConvertEntitlementInfo(t)},v.ConvertEntitlementInfo=function(e){for(var t=e.entitlements,n=0;n<t.length;++n){var r=t[n];r.appSubType2=r.appSubType?parseInt(r.appSubType):0,r.acquireDate2=v.GetTickByDate(r.acquireDate),r.expirationDate2=v.GetTickByDate(r.expirationDate),r.attentionRequired2="true"===r.attentionRequired}return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},v.ProcessKilledApps=function(e){var t={},r=new i.XmlProcessor(e,u),a=r.getDocumentElement();r.readAttributes(a,{rr:m},t);for(var o=[],s=r.selectSingleNode(n),c=r.selectNodes(f,s),p=0;p<c.length;++p){var g=c[p],h={};r.readAttributes(g,{assetid:d,pid:l},h),o.push({assetId:h.assetId,productId:h.productId})}return t.killedApps=o,v.ConvertKilledAppsInfo(t)},v.ConvertKilledAppsInfo=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},v.ProcessClientAppInstallInfo=function(e,t){var a=new i.XmlProcessor(e,u),o=a.selectSingleNode(n),s=a.selectSingleNode(f,o),l={etoken:g,manifest:g};if(t===i.ClientAppInfoReturnType.urlOnly?a.readAttributes(s,{url:"url"},l):t===i.ClientAppInfoReturnType.etokenOnly?a.readAttributes(s,{etok:"etoken"},l):a.readAttributes(s,{url:"url",etok:"etoken"},l),a.readAttributes(s,{status:"status",cm:r,assetid:d,ver:c},l),t!=i.ClientAppInfoReturnType.urlOnly&&l.etoken){var p=new i.XmlProcessor(l.etoken,""),m=p.selectSingleNode("t",p.selectSingleNode("r"));p.readAttributes(m,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},l)}return v.ConvertClientAppInstallInfo(l)},v.ConvertClientAppInstallInfo=function(e){return e.status2=e.status?parseInt(e.status):0,e.tokenExpirationDate2=v.GetTickByDate(e.tokenExpirationDate),e},v.ProcessManifest=function(e){return{manifest:e}},v.ProcessRemoveAppResponse=function(e){for(var t,n,r={removedApps:[]},a=new i.XmlProcessor(e,u),o=(a.getDocumentElement(),a.selectSingleNode("o:apps",a.selectSingleNode("o:removedApps"))),s=a.selectNodes("o:app",o),c=0;c<s.length;++c)t=s[c],n={},a.readAttributes(t,{assetid:d,result:"result"},n),r.removedApps.push(n);return v.ConvertRemoveAppResponse(r)},v.ConvertRemoveAppResponse=function(e){for(var t=e.removedApps,n=0;n<t.length;++n){var r=t[n];r.result2=r.result?parseInt(r.result):0}return e},v.ProcessAppDetails=function(n){for(var r,o,l=new i.XmlProcessor(n,u),f=l.selectSingleNode(p),m=l.selectNodes("o:wainfo",f),g=[],h=0;h<m.length;++h)r=m[h],o={},l.readAttributes(r,{assetid:d,defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:t,desc:e,icon:"iconUrl",ver:c,state:s,appst:a,appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},o),g.push(o);return v.ConvertAppDetails(g)},v.ConvertAppDetails=function(e){for(var t=0;t<e.length;++t){var n=e[t];n.defaultHeight2=n.defaultHeight?parseInt(n.defaultHeight):0,n.defaultWidth2=n.defaultWidth?parseInt(n.defaultWidth):0,n.state2=n.state?parseInt(n.state):0,n.appSubType2=n.appSubType?parseInt(n.appSubType):0}return e},v.ProcessRecommendations=function(n){for(var r,a,o,l=new i.XmlProcessor(n,u),f=l.selectSingleNode(p),m=l.selectNodes("o:wa",f),g=[],v=0;v<m.length;++v)r=m[v],o={},l.readAttributes(r,{assetid:d,title:"name",desc:e,icon:"iconUrl",ver:c,state:s,rat:"rating",dls:"downloads",prov:t},o),a=l.selectSingleNode("o:price",r),l.readAttributes(a,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},o),g.push(o);return g},v.ConvertAnonymousManifest=function(e,t){var n,r="";switch(e){case 200:n=i.OmexClientAppStatus.OK,r=t;break;case 204:case 1223:n=i.OmexClientAppStatus.NoEntitlement;break;case 400:n=i.OmexClientAppStatus.BadRequest;break;case 410:n=i.OmexClientAppStatus.KilledAsset;break;case 404:n=i.OmexClientAppStatus.UnknownAssetId;break;case 412:n=i.OmexClientAppStatus.VersionNotSupported;break;case 451:n=i.OmexClientAppStatus.UserIsMinor;break;default:n=i.OmexClientAppStatus.ServerError}return{status2:n,manifest:r}},v.GetTickByDate=function(e){return e?new Date(e).getTime():g},v}();e.OmexXmlProcessor=t}(l||(l={})),function(e){var t=function(){var t=null;function n(n,r,a,o){void 0===o&&(o=t),this._cacheManager=o||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),this._privateCatalogService=new e.PrivateCatalogService(i.OmexClientNames[n],i.OUtil.normalizeAppVersion(r)),this._uiLocale=a}return n.prototype.getEntitlementAsync=function(t,r,a,i){r.startActivity(e.Activity.EntitlementCheck),i&&(this._cacheManager.RemoveAll(n._addInsCacheKey),this._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey)),this.GetAddInList(t,r,(function(t){for(var i=[],o=0;o<t.length;o++){var s=t[o];s.addInState===n._addInOkState&&i.push(s)}r.stopActivity(e.Activity.EntitlementCheck),a({status:e.DataServiceResultCode.Succeeded,value:i})}),(function(e){a({status:e})}))},n.prototype.getAppDetails=function(r,a,i,o,s){var c=this,u=c;s&&c._cacheManager.RemoveAll(n._addInDetailsCacheKeyPrefix);for(var l=[],d=[],f=0;f<r.length;f++){var p=n.GetAppDetailsCacheKey(r[f].ProductId),m=c._cacheManager.GetCacheItem(p);m?l.push(m):d.push(r[f])}0!==d.length?c._privateCatalogService.GetManifests(d,t,t,i,(function(t){for(var r=0;r<t.length;r++){var a=u.ParseAndCacheManifest(t[r],i);if(a){var s=n.CreateAddInDetails(a);l.push(s);var c=n.GetAppDetailsCacheKey(s.assetId);u._cacheManager.SetCacheItem(c,s,n._addInDetailsRefreshRateDays)}}o({status:e.DataServiceResultCode.Succeeded,value:l})}),(function(e){o({status:e})})):o({status:e.DataServiceResultCode.Succeeded,value:l})},n.prototype.getAndCacheManifest=function(t,r,a,i){var o={ProductId:t.assetId,Version:t.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:t.storeId,ContentMarket:r}};this.GetManifest(o,a,(function(t){i({status:e.DataServiceResultCode.Succeeded,value:t})}),(function(e){i({status:e})}))},n.prototype.activateAsync=function(r,a,o){var s=this;o.startActivity(e.Activity.Activation);var c=this;this.GetAddInList(!1,o,(function(u){for(var l,d=/[{}]/g,f=0;f<u.length;f++){var p=u[f];if(r.assetId.replace(d,"").toLowerCase()===p.assetId.replace(d,"").toLowerCase()){l=p;break}}if(l)if(l.addInState===n._addInOkState){r.appVersion=l.appVersion;var m={ProductId:l.assetId,Version:l.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:l.storeId,ContentMarket:""}};s.GetManifest(m,o,(function(e){a.load({entitlement:r,manifest:e,eToken:""},t)}),(function(){e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(r,a,o)}})}))}else e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,url:"",errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});else e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,a,o)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}),(function(){e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,a,o)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),o.stopActivity(e.Activity.Activation)}))},n.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},n.GetAppDetailsCacheKey=function(e){return n._addInDetailsCacheKeyPrefix+i.OUtil.formatString(n._addInDetailsCacheKeySufix,e)},n.GetManifestCacheKey=function(e,t){return n._manifestCacheKeyPrefix+i.OUtil.formatString(n._manifestCacheKeySufix,e,t)},n.CreateAddInDetails=function(e){return{assetId:e.getMarketplaceID(),defaultHeight2:e.getDefaultHeight()||0,defaultHeight:String(e.getDefaultHeight()||0),defaultWidth2:e.getDefaultWidth()||0,defaultWidth:String(e.getDefaultWidth()||0),name:e.getDefaultDisplayName(),provider:e.getProviderName(),description:e.getDefaultDescription(),iconUrl:e.getDefaultIconUrl(),version:e.getMarketplaceVersion(),state2:1,state:"1",appSubType2:e.getOmexTargetCode(),appSubType:String(e.getOmexTargetCode()),appVersions:void 0,requirements:e.getRequirementsXml(),hosts:e.getHostsXml(),highResolutionIconUrl:e.getDefaultHighResolutionIconUrl()}},n.prototype.GetAddInList=function(e,r,a,i){var o,s=this;e||!(o=this._cacheManager.GetCacheItem(n._addInsCacheKey))?this._privateCatalogService.GetAddInList(t,t,r,(function(e){for(var t=0;t<e.length;t++){var r=e[t],i=n.GetAppDetailsCacheKey(r.assetId),o=s._cacheManager.GetCacheItem(i);o&&o.version!==r.appVersion&&s._cacheManager.RemoveCacheItem(i)}s._cacheManager.SetCacheItem(n._addInsCacheKey,e,n._addInListRefreshRateDays),a(e)}),i):a(o)},n.prototype.GetManifest=function(r,a,o,s){var c=this,u=c;a.startActivity(e.Activity.ManifestRequest);var l=i.OsfManifestManager.getCachedManifest(r.ProductId,r.Version);if(l)return a.stopActivity(e.Activity.ManifestRequest),void o(l);var d=n.GetManifestCacheKey(r.ProductId,r.Version),f=c._cacheManager.GetCacheItem(d);if(f)return(l=new i.Manifest.Manifest(f,c._uiLocale))?(a.stopActivity(e.Activity.ManifestRequest),void o(l)):void s(e.DataServiceResultCode.Failed);c._privateCatalogService.GetManifests([r],t,t,a,(function(t){(l=u.ParseAndCacheManifest(t[0],a))?(i.OsfManifestManager.cacheManifest(r.ProductId,r.Version,l),a.stopActivity(e.Activity.ManifestRequest),o(l)):s(e.DataServiceResultCode.Failed)}),(function(e){s(e)}))},n.prototype.ParseAndCacheManifest=function(e,r){try{var a=new i.Manifest.Manifest(e,this._uiLocale),o=n.GetManifestCacheKey(a.getMarketplaceID(),a.getMarketplaceVersion());return this._cacheManager.SetCacheItem(o,e,n._addInManifestRefreshRateDays),a}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest retrieved from Private Catalog.",e,r.correlationId,19965729)}return t},n._addInsCacheKey="__OSF_PRIVATECATALOG_ADDINS",n._addInDetailsCacheKeyPrefix="__OSF_PRIVATECATALOG_ADDINDETAILS",n._addInDetailsCacheKeySufix="_{0}",n._manifestCacheKeyPrefix="__OSF_PRIVATECATALOG_MANIFEST",n._manifestCacheKeySufix="_{0}_{1}",n._lastCatalogUpdateKey="_OSF_PRIVATECATALOG_LASTUPDATE",n._addInListRefreshRateDays=1/24,n._addInDetailsRefreshRateDays=365,n._addInManifestRefreshRateDays=365,n._addInOkState="Ok",n}();e.PrivateCatalog=t,e.CatalogFactory.register(i.StoreType.PrivateCatalog,(function(e){return new t(e.appName,e.appVersion,e.appUILocale)}))}(l||(l={})),function(e){var t=function(){var t=!1,n=null;function r(e,t){this._clientCode=e,this._clientVersion=t}return r.initRequestHandler=function(t,a,o){r._requestHandler==n&&(r._requestHandler=t),r.authenticationProxy==n&&(r.authenticationProxy=a),r._isThirdPartyHostEnabled=o,r._tokenCacheManager=new e.TokenCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),r._cacheManager=new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)},r.ParseAddInList=function(e,t){var a,o=[];try{a=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetAddIns reponse.",e,t.correlationId,19965730),n}if(!a||!a.AddIns)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetPrivateCatalogAddIns response could not be parsed.",t.correlationId,20194262),o;for(var c=0,u=a.AddIns;c<u.length;c++){var l=u[c];l.AddInState&&l.ProductId&&l.Version?(o.push({assetId:l.ProductId,storeId:l.StoreInfo?l.StoreInfo.AssetId:"none",appVersion:l.Version,storeType:i.StoreType.PrivateCatalog,targetType:i.OsfControlTarget.Undefined,addInState:l.AddInState,contentMarket:l.StoreInfo?l.StoreInfo.ContentMarket:""}),r.StoreAuthenticationData(a)):s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString('Add-In metadata was missing some data. ID: "{0}", Version: "{1}", State: "{2}".',l.ProductId||"",l.Version||"",l.AddInState||""),t.correlationId,20194263)}return o},r.ParseAndCacheManifestList=function(e,t){var a,i=[];try{a=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetManifests reponse.",e,t.correlationId,19965731),n}if(!a||!a.Manifests)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetAddInManifests response could not be parsed.",t.correlationId,20194264),i;for(var o=0,c=a.Manifests;o<c.length;o++){var u=c[o];i.push(u)}return r.StoreAuthenticationData(a),i},r.StoreAuthenticationData=function(e){r._tokenCacheManager.AddRefreshToken(e.RefreshToken,e.UserId,e.TenantId),r._userId=e.UserId,r._tenantId=e.TenantId},r.prototype.GetLastPrivateCatalogUpdate=function(a,i,o,c,u){var l=this,d=0;r._requestHandler.getLastPrivateCatalogUpdate(this._clientCode,this._clientVersion,a,i,o.correlationId,(function(f,p){if(d++,200===f){var m;try{m=JSON.parse(p)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetLastPrivateCatalogUpdate reponse.",t,o.correlationId,22823177),void u(e.DataServiceResultCode.Failed)}return m&&m.LastUpdate?(r.StoreAuthenticationData(m),void c(m.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag("GetLastPrivateCatalogUpdate response could not be parsed.",o.correlationId,22823178),void u(e.DataServiceResultCode.Failed))}if(403===f){var g;if(1==d)if(d++,g=JSON.parse(p)){var v=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(v!=n)return void l.GetLastPrivateCatalogUpdate(a,v,o,c,u)}if(d>2||a!=n)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate authentication loop occured.",n,o.correlationId,22823179),void u(e.DataServiceResultCode.Unauthenticated);var h=!0;return setTimeout((function(){r.authenticationProxy.tryAuthorize((function(e){h&&(h=t,l.GetLastPrivateCatalogUpdate(e,i,o,c,u))}),(function(){h&&(h=t,u(e.DataServiceResultCode.Unauthenticated))}))}),0),void setTimeout((function(){h&&(h=t,u(e.DataServiceResultCode.Unauthenticated))}),5e3)}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate request failed with status code "+f,n,o.correlationId,22823180),u(e.DataServiceResultCode.Failed)}))},r.prototype.GetAddInList=function(a,i,o,c,u){var l=this,d=0;r._requestHandler.getPrivateCatalogAddIns(this._clientCode,this._clientVersion,a,i,o.correlationId,(function(f,p){if(d++,200===f){var m=r.ParseAddInList(p,o);return m?void c(m):void u(e.DataServiceResultCode.Failed)}if(403===f){var g;if(1==d)if(d++,g=JSON.parse(p)){var v=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(v!=n)return void l.GetAddInList(a,v,o,c,u)}if(d>2||a!=n)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList authentication loop occured. Either authentication attempts count is greater than 2, or authorizationCode is not null. attemptsCount: "+d,n,o.correlationId,20497158),void u(e.DataServiceResultCode.Unauthenticated);var h=!0;return setTimeout((function(){r.authenticationProxy.tryAuthorize((function(e){h&&(h=t,l.GetAddInList(e,i,o,c,u))}),(function(){h&&(h=t,u(e.DataServiceResultCode.Failed))}))}),0),void setTimeout((function(){if(h){h=t;var n=r._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;u(n)}}),5e3)}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList request failed with status code "+f,n,o.correlationId,20497159),u(e.DataServiceResultCode.Failed)}))},r.prototype.GetManifests=function(t,a,i,o,c,u){var l=this,d=0,f={AddIns:t,RefreshToken:i,UserId:"",TenantId:""};r._requestHandler.getPrivateCatalogManifests(e.WACUtils.serializeObjectToString(f),a,i,o.correlationId,(function(f,p){if(d++,200===f){var m=r.ParseAndCacheManifestList(p,o);return m?void c(m):void u(e.DataServiceResultCode.Failed)}if(403===f){var g;if(1==d)if(d++,g=JSON.parse(p)){var v=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(v!=n)return void l.GetManifests(t,a,v,o,c,u)}return d>2?(s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests authentication loop occured.",n,o.correlationId,20497160),void u(e.DataServiceResultCode.Unauthenticated)):void r.authenticationProxy.tryAuthorize((function(e){l.GetManifests(t,e,i,o,c,u)}),(function(){u(e.DataServiceResultCode.Unauthenticated)}))}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests request failed with status code "+f,n,o.correlationId,20497161),u(e.DataServiceResultCode.Failed)}))},r.SignOutUser=function(){s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString("PrivateCatalogService.SignOutUser: userId = {0}, tenantId = {1}",r._userId,r._tenantId),n,21616005),r._tokenCacheManager.RemoveRefreshToken(r._userId,r._tenantId),r.authenticationProxy.signOut((function(){r._cacheManager.RemoveAll(e.PrivateCatalog._addInsCacheKey),r._cacheManager.RemoveAll(e.PrivateCatalog._addInDetailsCacheKeyPrefix)}),(function(){s.RuntimeTelemetryHelper.LogCommonMessageTag("Private Catalog: Failed to sign out ",n,22316866)}))},r}();e.PrivateCatalogService=t}(l||(l={})),function(e){var t=function(){var t=null;function n(){}return n.ConvertSessionStartInfoToDmsRing=function(e){var r="Production",a="Microsoft",i=t;if(e&&e.sessionStartInfoJson){var o=n.JsonSerializer.Deserialize(e.sessionStartInfoJson);o!=t&&(i=o.AudienceGroup)}switch(i){case"Dogfood":case"Automation":return"Dogfood";case a:return a;case r:return r;default:return s.RuntimeTelemetryHelper.LogExceptionTag("Could not obtain DMS ring from settings. AudienceGroup value: "+i,t,t,38590113),r}},n.GenerateCapabilitiesList=function(e){var r=[],a=e._getSupportedSet();return a!=t&&(a="string"==typeof a?n.JsonSerializer.Deserialize(a):a,r=Object.keys(a).map((function(e){return{Name:e,Version:a[e]}}))),r},n.GenerateDMSPackageListRequestBody=function(e,t,r,a){var i={};i.Hosts=[t],i.ReactNativeVersion="0.0.0.0",i.Channel="DevMain",i.Capabilities=n.GenerateCapabilitiesList(r),i.Ring=n.ConvertSessionStartInfoToDmsRing(a),i.Platform="Web",i.Locales=[e],a&&a.clientId&&(i.ClientId=a.clientId);var o={};return o.Context=i,o.SyncId=0,n.JsonSerializer.Serialize(o)},n.GetDMSPackageList=function(t,r,a,i,o,s){e.SdxWebRequestHandler.SendRequestAsync("POST",t,n.GenerateDMSPackageListRequestBody(r,a,i,o),{"Content-Type":"application/json"},s)},n.JsonSerializer=new e.SafeSerializer,n}();e.DMSHandler=t}(l||(l={})),function(e){var t=function(){function t(){}return t.GetSdxList=function(e,n){var r=i.OUtil.formatString(t.SdxListCacheKeyCompleteFormatter,e,n),a=t.CacheManager.GetCacheItem(r,!0);if(null==a){var o=i.OUtil.formatString(t.SdxListCacheKeyHostPrefixFormatter,e);t.CacheManager.RemoveAll(o)}return a},t.CacheSdxList=function(e,n,r){var a=e.CacheTtlInSec/86400,o=i.OUtil.formatString(t.SdxListCacheKeyCompleteFormatter,n,r);t.CacheManager.SetCacheItem(o,e,a)},t.CacheManager=new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),t.SdxListCacheKeyHostPrefixFormatter="__OSF_SdxList.{0}",t.SdxListCacheKeyCompleteFormatter=t.SdxListCacheKeyHostPrefixFormatter+".{1}",t}();e.SdxCache=t}(l||(l={})),function(e){var t=function(){var t=null;function n(){}return n.generateLoaderError=function(t,r,a,i,o,s,c){e.LoaderUtil.failWithError(i,{description:t,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){i.restartActivation(),n.activateAsync(a,i,o,s,c)},errorCode:r})},n.GetSDXList=function(r,a,i,o,c,u,l){var d=e.SdxCache.GetSdxList(o,i);r.setFlag(e.FlagName.DmsRequestCachedFlag,d!=t),d==t?e.DMSHandler.GetDMSPackageList(a,i,o,c,u,(function(r){if(r.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("GetDMSPackageList request to DMS failed with status = "+r.status+".",t,t,37291604),void l({status:r.status,value:t});var a=n.jsonSerializer.Deserialize(r.value);if(a==t)return s.RuntimeTelemetryHelper.LogExceptionTag("GetDMSPackageList DMS response could not be parsed.",t,t,37291605),void l({status:e.DataServiceResultCode.Failed,value:t});e.SdxCache.CacheSdxList(a,o,i),l({status:e.DataServiceResultCode.Succeeded,value:a})})):l({status:e.DataServiceResultCode.Succeeded,value:d})},n.activateAsync=function(r,a,o,c,u){o.startActivity(e.Activity.Activation),o.startActivity(e.Activity.ServerCall);var l=e.CatalogFactory.getHostContext(),d=i.getManifestHostType(l.hostType);s.RuntimeTelemetryHelper.LogCommonMessageTag('Start activating SDX with assetId ".'+r.assetId+'".',o.correlationId,37291606),n.GetSDXList(o,l.sdxDmsUrl,l.appUILocale,d,c,u,(function(d){if(d.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Retrieving SDX list failed.",t,t,37291607),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,i.ErrorStatusCodes.WAC_AgaveActivationError,r,a,o,c,u);for(var f=t,p=0,m=d.value.Packages;p<m.length;p++){var g=m[p];if(g.AssetId.toLowerCase()==r.assetId.toLowerCase()){f=g;break}}if(f==t)return s.RuntimeTelemetryHelper.LogExceptionTag('Unable to find SDX with assetId "'+r.assetId+'".',t,t,37291608),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveNotExist_ERR,i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,r,a,o,c,u);o.startActivity(e.Activity.ManifestRequest),e.SdxCdnHandler.GetManifestFromCdn(l.sdxCdnUrl,f,(function(d){if(d.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Retrieving SDX manifest from CDN failed.",t,t,37291609),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,r,a,o,c,u);var p=e.ManifestUtil.ParseManifest(d.value,l.appUILocale,o.correlationId);if(p==t)return s.RuntimeTelemetryHelper.LogExceptionTag("Unable to parse the SDX manifest.",t,t,37291610),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT,r,a,o,c,u);o.stopActivity(e.Activity.ServerCall),o.stopActivity(e.Activity.ManifestRequest);var m=e.SdxCdnHandler.GetManifestCdnUrl(l.sdxCdnUrl,f);a.load({entitlement:r,manifest:p,eToken:"",manifestUrl:m},t)}))}))},n.jsonSerializer=new e.SafeSerializer,n}();e.SDXCatalog=t}(l||(l={})),function(e){var t=function(){function t(){}return t.GetManifestFromCdn=function(n,r,a){var i=t.GetManifestCdnUrl(n,r);e.SdxWebRequestHandler.SendRequestAsync("GET",i,null,null,a)},t.GetManifestCdnUrl=function(e,t){return i.OUtil.formatString(e,t.AssetId,t.FFN,t.Version,"en-us")},t}();e.SdxCdnHandler=t}(l||(l={})),function(e){var t=function(){function t(){}return t.SendRequestAsync=function(t,n,r,a,i){var o="HTTP request (",c=null;void 0===r&&(r=c),void 0===a&&(a=c);var u=new XMLHttpRequest;if(u.open(t,n,!0),u.onload=function(){if(u.readyState==XMLHttpRequest.DONE){var r=u.status;if(r>=200&&r<300&&u.responseText!=c)return void i({status:e.DataServiceResultCode.Succeeded,value:u.responseText})}s.RuntimeTelemetryHelper.LogExceptionTag(o+t+" "+n+") failed with status code = "+u.status+".",c,c,37291611),i({status:e.DataServiceResultCode.Failed,value:c})},u.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag(o+t+" "+n+") failed with unexpected error.",c,c,37291612),i({status:e.DataServiceResultCode.Failed,value:c})},u.timeout=3e3,u.ontimeout=function(){s.RuntimeTelemetryHelper.LogExceptionTag(o+t+" "+n+") timeout.",c,c,37291613),i({status:e.DataServiceResultCode.Failed,value:c})},a!=c)for(var l in a)u.setRequestHeader(l,a[l]);u.send(r)},t}();e.SdxWebRequestHandler=t}(l||(l={})),function(e){var t=!1,n=null,r=!0,a=function(){function a(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._telemetryContext=e.telemetryContext}return a.prototype.getManifest=function(a,o,s,c){var u=this,l=u;u._telemetryContext.startActivity(e.Activity.ManifestRequest);var d=i.OsfManifestManager.getCachedManifest(o.OfficeExtensionID,o.OfficeExtensionVersion);if(d)return u._telemetryContext.stopActivity(e.Activity.ManifestRequest),u._telemetryContext.stopActivity(e.Activity.ServerCall),void s({status:e.DataServiceResultCode.Succeeded,value:{manifest:d,cached:r}});o.EncodedAbsUrl?a.getManifest(o.EncodedAbsUrl,o.OfficeExtensionID,o.OfficeExtensionVersion,(function(r){if(l._telemetryContext.stopActivity(e.Activity.ManifestRequest),l._telemetryContext.stopActivity(e.Activity.ServerCall),r.status==e.DataServiceResultCode.Succeeded){var a=e.ManifestUtil.ParseManifest(r.value.manifest,l._initParam.appUILocale,l._telemetryContext.correlationId);a==n&&(r.status=e.DataServiceResultCode.Failed),s({status:r.status,value:{manifest:a,cached:t}})}else s({status:r.status,value:{manifest:n,cached:t}})}),c):s({status:e.DataServiceResultCode.Failed,value:{manifest:n,cached:t}})},a.prototype.activate=function(a,o,s){var c,u=this,l={assetId:o.assetId,appVersion:o.appVersion,storeId:o.storeId,storeType:o.storeType,targetType:o.targetType},d=function(a,c){var d=a.manifest,f=d.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(o.assetId,o.appVersion,d),a.cached&&e.ManifestUtil.versionLessThan(f,o.appVersion))m(r);else{if(d.requirementsSupported===t||void 0===d.requirementsSupported&&!s.getRequirementsChecker().isManifestSupported(d)){d.requirementsSupported=t;var p;return p=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(s,{description:p,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsError})}if(d.requirementsSupported=r,c&&!s.skipTrust(o)){var g=i.OUtil.formatString(i.Constants.ActivatedCacheKey,o.assetId.toLowerCase(),o.storeType,o.storeId),v=i.OmexClientNames[u._initParam.applicationName];if(!u._cacheManager.GetCacheItem(g,t)&&!s.hasConsent(o)&&!s.isForCustomFunctionSandbox())return void s.askForTrust({anonymous:n,clientName:v,entitlement:l,displayName:d.getDefaultDisplayName(),providerName:d.getProviderName(),iconUrl:d.getDefaultIconUrl(),isSSOAddin:d.isSSOAddin()},(function(){u._cacheManager.SetCacheItem(g,r),s.load({entitlement:l,manifest:d,eToken:n},n)}))}s.hasConsent(o)&&u._cacheManager.SetCacheItem(g,r),s.load({entitlement:l,manifest:d,eToken:n},n)}},f=function(t){u.getManifest(a,c,(function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value.manifest?d(n.value,r):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),f(t)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),t)},p=function(t){c?c.OfficeExtensionKillbit?e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED}):f(t):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),u._telemetryContext.startActivity(e.Activity.Activation),u._telemetryContext.startActivity(e.Activity.ServerCall),m(r)},errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST})},m=function(r){c=n,u._telemetryContext.startActivity(e.Activity.EntitlementCheck),a.getEntitlementAsync(t,o.targetType,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){u._telemetryContext.stopActivity(e.Activity.EntitlementCheck);for(var a,o=n,d=t.value.entitlements,f=0;f<d.length;f++)(a=d[f]).OfficeExtensionID&&l.assetId&&a.OfficeExtensionID.toLowerCase()==l.assetId.toLowerCase()&&(o&&!e.ManifestUtil.versionLessThan(o.OfficeExtensionVersion,a.OfficeExtensionVersion)||(o=a));c=o,p(r)}else e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),u._telemetryContext.startActivity(e.Activity.Activation),u._telemetryContext.startActivity(e.Activity.ServerCall),m()},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),r)};m()},a}(),o=function(){function o(t,r){var a=this;void 0===r&&(r=n),a._appDataService={},a._catalogUrlDataService={},a._initParam=t,a._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return o.prototype.getDataService=function(e,t,n){this.getDataServiceInternal(this._appDataService,e,t,n)},o.prototype.getCatalogUrlDataService=function(e,t,n){this.getDataServiceInternal(this._catalogUrlDataService,e,t,n)},o.prototype.getDataServiceInternal=function(t,r,a,i){if(t[r]==n&&(t[r]={spCatalogService:n,spCatalogServiceReady:n}),t[r].spCatalogService==n)if(t[r].spCatalogServiceReady==n){t[r].spCatalogServiceReady=i;var o={status:e.DataServiceResultCode.Failed,value:n},s=function(a,i){var s=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=n,a.status==e.DataServiceResultCode.Succeeded?(t[r].spCatalogService=i,o.value=i,o.status=e.DataServiceResultCode.Succeeded,s(o)):(o.httpStatus=a.httpStatus,s(o))};a.startActivity(e.Activity.Authentication);var c=e.SPCatalogProxyBasedCatalogService.getInstance(this._initParam);c.prepareProxy(r,a.correlationId,(function(t){a.stopActivity(e.Activity.Authentication),s(t,c)}))}else{var u=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=function(e){u(e),i(e)}}else i({status:e.DataServiceResultCode.Succeeded,value:t[r].spCatalogService})},o.prototype.createActivityScope=function(t,n,r){var i=this;this.getDataService(t,n,(function(o){if(!e.AsyncUtil.failed(o,r)){var s=o.value,c={cacheManager:i._cacheManager,storeId:t,telemetryContext:n},u=s.createScope(c),l=new a(c,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:u,activityScope:l}})}}))},o.prototype.getEntitlementAsync=function(t,r,a,o,s,c){var u=this,l=function(s){s.status===e.DataServiceResultCode.Succeeded?(u.myOrgCatalogUrl=s.value,u.createActivityScope(s.value,r,(function(r){e.AsyncUtil.failed(r,a,[])||r.value.serviceScope.getEntitlementAsync(t,n,(function(t){if(!e.AsyncUtil.failed(t,a,[])){for(var n=t.value.entitlements,r=0;r<n.length;r++){var o=n[r];o.assetId=o.OfficeExtensionID,o.appVersion=o.OfficeExtensionVersion,o.storeId=u.myOrgCatalogUrl,o.storeType=i.StoreType.SPCatalog,o.targetType=i.OfficeAppType[o.OEType]}a({status:t.status,value:n})}}),o)}))):a({status:s.status,value:n})};(c=c||this.myOrgCatalogUrl||n)?l({status:e.DataServiceResultCode.Succeeded,value:c}):this.getSPCatalogUrl(r,l)},o.prototype.getAndCacheManifest=function(a,o,s,c){var u=this;this.getEntitlementAsync(r,s,(function(t){if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),t.status===e.DataServiceResultCode.Succeeded&&t.value){for(var r=t.value,o=r.length,l=n,d=0;d<o;d++){var f=r[d];f.OfficeExtensionID&&a.assetId&&f.OfficeExtensionID.toLowerCase()===a.assetId.toLowerCase()&&(l&&!i.OsfManifestManager.versionLessThan(l.OfficeExtensionVersion,f.OfficeExtensionVersion)||(l=f))}l!=n?u.createActivityScope(u.myOrgCatalogUrl,s,(function(t){e.AsyncUtil.failed(t,c)||t.value.activityScope.getManifest(t.value.serviceScope,l,(function(e){c({status:e.status,value:e.value.manifest})}))})):c({status:e.DataServiceResultCode.Failed,value:n})}else c({status:e.DataServiceResultCode.Failed,value:n})}),t,0,a.storeId)},o.prototype.activateAsync=function(t,n,r){var a=this;r.startActivity(e.Activity.Activation),r.startActivity(e.Activity.ServerCall),this.createActivityScope(t.storeId,r,(function(o){if(o.status==e.DataServiceResultCode.Succeeded){var s=o.value.serviceScope;o.value.activityScope.activate(s,t,n)}else e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.activateAsync(t,n,r)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}))},o.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},o.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed})},o.prototype.getSPCatalogUrl=function(t,n){var r=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,t,(function(){e.SPCatalogProxyBasedCatalogService.getInstance(r._initParam).getSPCatalogUrl(r._initParam.spBaseUrl,t.correlationId,n)}))},o}();e.CatalogFactory.register(i.StoreType.SPCatalog,(function(e){return new o({applicationName:i.HostCapability[e.hostType],AppVersion:e.appVersion,clientMode:e.clientMode,appUILocale:e.appUILocale,spBaseUrl:e.spBaseUrl,docUrl:e.docUrl})}))}(l||(l={})),function(e){var t=function(){function e(){}return e.CheckProxyIsReady="OEM_isProxyReady",e.GetEntitlementSummary="OEM_getEntitlementSummaryAsync",e.GetManifest="OEM_getManifestAsync",e.GetSPCatalogUrl="OEM_getSPCatalogUrlAsync",e}();e.SPCatalogProxyMethods=t;var n=function(){function e(){this.iframeProxies={},this.iframeProxyCount=0}return e.iframeNamePrefix="__officeExtensionProxy",e}();e.IframeProxyGroup=n;var r=function(r){var a=null;function o(e,t){r.call(this),this.proxyUrl=e,this.iframeProxyGroup=t}return c(o,r),o.prototype.getEntitlementsAsync=function(e,n){this.invokeProxyCommandAsync(t.GetEntitlementSummary,e,n)},o.prototype.getManifestAsync=function(e,n){this.invokeProxyCommandAsync(t.GetManifest,e,n)},o.prototype.getSPCatalogUrlAsync=function(e,n){this.invokeProxyCommandAsync(t.GetSPCatalogUrl,e,n)},o.prototype.prepareProxy=function(e,t){var n=this;n.isReady?e({status:a,value:{clientEndpoint:n.clientEndPoint}}):n.clientEndPoint?n.pendingCallbacks.push([e,t]):n.createProxy(e,t)},o.resetProxy=function(e){delete e.iframeProxyGroup.iframeProxies[e.proxyUrl],e.iframeProxyGroup.iframeProxyCount=e.iframeProxyGroup.iframeProxyCount-1,Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=a),e.clientEndPoint=a},o.prototype.createProxy=function(r,c){var u=this;try{if(!u.doesUrlHaveSupportedProtocol(u.proxyUrl))return void c({status:a,value:{errorMessage:"Protocal of proxyUrl is not supported."}});u.iframeProxyGroup.iframeProxies[u.proxyUrl]=u,u.iframeProxyGroup.iframeProxyCount=u.iframeProxyGroup.iframeProxyCount+1;var l=u.proxyUrl,d=l.length;"/"===l.charAt(d-1)&&(l=l.substr(0,d-1));var f=document.createElement("iframe"),p=n.iframeNamePrefix+u.iframeProxyGroup.iframeProxyCount;f.setAttribute("id",p),f.setAttribute("name",p);var m=l+"/_layouts/15/OfficeExtensionManager.aspx?"+u.conversationId;m=i.OUtil.addXdmInfoAsHash(m,u.conversationId+"|"+p+"|"+window.location.href),m=i.OUtil.addSerializerVersionAsHash(m,i.SerializerVersion.Browser),f.setAttribute("scrolling","auto"),f.setAttribute("border","0"),f.setAttribute("width","0"),f.setAttribute("height","0"),f.setAttribute("style","position: absolute; left: -100px; top:0px;");var g=u;document.body.appendChild(f);var v=function(){if(g.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(g.conversationId,f.contentWindow,g.proxyUrl),g.clientEndPoint)g.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=a;0===e&&t.status?(g.isReady=!0,n={status:a,value:{clientEndpoint:g.clientEndPoint}}):(o.resetProxy(g),n={status:a,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var r=g.pendingCallbacks.length,i=0;i<r;i++){var s=g.pendingCallbacks.shift();g.isReady?s[0](n):s[1](n)}}),{__timeout__:2e3});else{var e="Unexpected error, iframe loaded again after failing OEM_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,a,a,18657365),c({status:a,value:{errorMessage:e}})}};i.OUtil.addEventListener(f,"load",v),f.setAttribute("src",m),u.iframeOnload=v,u.pendingCallbacks.push([r,c]),u.iframe=f}catch(t){var h="Error creating client endpoint with proxyUrl = ["+u.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);c({status:a,value:{errorMessage:h}})}},o}(e.ProxyBase);e.SPCatalogProxy=r}(l||(l={})),function(e){var t=null,n=function(){function n(t){this.proxyRetries={},this.initParams=t,this.iframeProxyGroup=new e.IframeProxyGroup}return n.getInstance=function(e){return n._instance==t&&(n._instance=new n(e)),n._instance},n.prototype.prepareProxy=function(n,r,a){r=r||"";this.proxyRetries[n]=1,this.ensureSPCatalogProxySetUp(n,r,(function(n){n&&n.status!=t?n.status:e.DataServiceResultCode.ProxyNotReady;a({status:n.status})}))},n.prototype.createScope=function(e){return new r(e,this)},n.prototype.getSPCatalogUrl=function(n,r,o){var c=this;this.prepareProxy(n,r,(function(){var u;if(n&&(u=c.iframeProxyGroup.iframeProxies[n])){var l={};l.webUrl=n,u.getSPCatalogUrlAsync(l,(function(n){var i="getspcatalogurl failed";n.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(i,t,r,19015125),a.msAjaxDebug.trace(i)),o(n)}))}else s.RuntimeTelemetryHelper.LogExceptionTag(i.OUtil.formatString("getspcatalogurl proxy not found, webUrl: {0}",n),t,r,19969545),o({status:e.DataServiceResultCode.ProxyNotReady})}))},n.prototype.ensureSPCatalogProxySetUp=function(n,r,a){if(!n)return s.RuntimeTelemetryHelper.LogExceptionTag("proxyUrl is null",t,r,19969546),void a({status:e.DataServiceResultCode.Failed});var o=this.iframeProxyGroup.iframeProxies[n];if(o||(o=new e.SPCatalogProxy(n,this.iframeProxyGroup)),o.isReady)a({status:e.DataServiceResultCode.Succeeded});else{var c=this,u=function(){a({status:e.DataServiceResultCode.Succeeded})},l=function(){c.proxyRetries[n]<i.Constants.AuthenticatedConnectMaxTries?(c.proxyRetries[n]++,o.prepareProxy(u,l)):(s.RuntimeTelemetryHelper.LogExceptionTag("sp exceed maximum tries and fail",t,r,18940555),a({status:e.DataServiceResultCode.ProxyNotReady}))};o.prepareProxy(u,l)}},n}();e.SPCatalogProxyBasedCatalogService=n;var r=function(){var n="clearCache";function r(e,t){this._catalogService=t,this.proxyUrl=e.storeId,this._correlationId=e.telemetryContext.correlationId||""}return r.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},r.prototype.getEntitlementAsync=function(e,t,r,a){var i=this,o=i,s=i._catalogService.iframeProxyGroup.iframeProxies[i.proxyUrl],c={};c.webUrl=i.proxyUrl,c.applicationName=i._catalogService.initParams.applicationName,c.officeExtentionTarget=t,c[n]=a||!1,c.supportedManifestVersions={"1.0":!0,1.1:!0},s.getEntitlementsAsync(c,(function(e){o.tryFail(e.status,e.httpStatus,r)?o.logServiceCallResponseError("entitlement",e.httpStatus):r(e)}))},r.prototype.getLastStoreUpdate=function(){},r.prototype.getManifest=function(e,t,r,a,i){var o=this,s=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],c={};c.manifestUrl=e,c.id=t,c.version=r,c[n]=i,s.getManifestAsync(c,(function(e){o.tryFail(e.status,e.httpStatus,a)?o.logServiceCallResponseError("manifest",e.httpStatus):a(e)}))},r.prototype.logServiceCallResponseError=function(e,n){var r="spproxy request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18940556)},r}();e.SPCatalogProxyBasedCatalogServiceScope=r}(l||(l={})),i.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3},i.NotificationType={TrustYellowBar:0,ConsentYellowBar:1,ConsentWhiteDialog:2,TrustPromptTaskpane:3,TrustPromptContent:4},i.ConsentResultCode={Success:0,Cancelled:100,ClientError:400,ServerError:500,UnknownError:600},i.OmexMessageType={ConsentResult:0,TabExit:1,ButtonClick:2,PageLoad:3},i._ErrorUXHelper=function(e){var t="progress_",n="input,a,button",r="moe-infobar-button2_",a=!0,o="moe-infobar-button_",c="moe-infobar-button",u=!1,d="button",f="moe-infobar-dismiss_",p="moe-infobar-dismiss",m="moe-infobar-message",g="moe-infobar-message_",v="moe-infobar-title",h="span",b="moe-infobar-message-div",y="moe-infobar-secinfo",_="moe-infobar-info",O="moe-infobar-warning",S="moe-infobar-error",C="moe-infobar-button-cell",I="moe-infobar-top-right-cell",A="moe-infobar-message-cell",x="moe-infobar-top-left-cell",E="presentation",T="role",w="moe-infobar-infotable",j="table",P="moe-infobar-body",M="alt",k=null,R="100%",D="center",N="no-repeat",F="alpha(opacity=100)",L="1",U="white",B="url(",H="onclick",G="tabindex",W="image",V="type",z="input",J="id",q="moe-background",X="class",Q="div",K="moe-trust-prompt-table_",Z="notificationbackground_",Y="moe-infobar-body_",$="agavedefaulticon96x96.png",ee="moe_status_icons.png",te="progress.gif",ne="img",re=e,ae=re.getOsfOmexBaseUrl(),ie="omexNotificationIframeClassName";i.OUtil.loadCSS(re.getLocalizedCSSFilePath("moeerrorux.css")),document.createElement(ne).src=re.getLocalizedImageFilePath(te),document.createElement(ne).src=re.getLocalizedImageFilePath(ee),document.createElement(ne).src=re.getLocalizedImageFilePath($);var oe={},se=0,ce=function(e){for(var t,n=e.childNodes.length,r=0;r<n;)"iframe"===(t=e.childNodes.item(r)).tagName.toLowerCase()?r++:(e.removeChild(t),n--)},ue=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},le=function(e,t){var n;i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start),n=t?Y+e:Z+e;var r=we(e);r&&oe[e][0].highPriority&&se--,ue(n),r&&oe[e].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},de=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start);var t=K+e.id,n=we(e.id);n&&oe[e.id][0].highPriority&&se--,ue(t),n&&oe[e.id].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},fe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1Start),ce(e.div);var t=document.createElement(Q);t.setAttribute(X,q),t.setAttribute(J,"icon_"+e.id);var n=document.createElement(z);n.setAttribute(J,"iconImg_"+e.id),n.setAttribute(V,W),n.setAttribute(G,"0"),n.src=re.getLocalizedImageFilePath(ee);var r,a,o;n.setAttribute(H,"getIntoStage2(params)"),i.OUtil.attachClickHandler(n,(function(){!function(e){e.sqmDWords[1]|=2,Ce(e.id);var t=l.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}(e)})),t.appendChild(n),e.displayDeactive&&(t.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",t.style.backgroundColor=U,t.style.opacity=L,t.style.filter=F,t.style.backgroundRepeat=N,t.style.backgroundPosition=D,t.style.height=R),e.infoType===i.InfoType.Error?(r="moe-status-error-icon",a="iconImg_error_"+e.id,o=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(r="moe-status-warning-icon",a="iconImg_warning_"+e.id,o=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(r="moe-status-info-icon",a="iconImg_info_"+e.id,o=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(r="moe-status-secinfo-icon",a="iconImg_secinfo_"+e.id,o=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=k&&9==parseFloat(RegExp.$1)&&(r+="_ie"),n.setAttribute(X,r),n.setAttribute(J,a),n.setAttribute(M,o),0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),Ae(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1End)},pe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start),ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Y+e.id,l=document.getElementById(n);null==l&&((l=document.createElement(Q)).setAttribute(X,P),l.setAttribute(J,n));var K=document.createElement(Q);K.innerHTML=t,l.setAttribute("title",K.textContent),K=k;var te=document.createElement(j);te.setAttribute(X,w),te.setAttribute(T,E);for(var ae=0;ae<3;ae++)te.insertRow(ae).setAttribute(T,E);var ie=te.rows;ie[0].insertCell(0),ie[0].insertCell(1),ie[0].insertCell(2),ie[0].cells[1].setAttribute("rowSpan","2"),ie[1].insertCell(0),ie[1].insertCell(1),ie[2].insertCell(0),ie[2].insertCell(1),ie[2].insertCell(2),ie[0].cells[0].setAttribute(X,x),ie[0].cells[1].setAttribute(X,A),ie[0].cells[2].setAttribute(X,I),ie[2].cells[1].setAttribute(X,C);var oe,se,ue=document.createElement(ne);ue.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(oe=S,se=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(oe=O,se=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(oe=_,se=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(oe=y,se=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),ue.setAttribute(X,oe),ue.setAttribute(M,se),ie[0].cells[0].appendChild(ue);var de=document.createElement("a");de.setAttribute(X,b),de.setAttribute(G,L);var fe=document.createElement(h);fe.setAttribute(X,v),fe.innerHTML=e.title;var pe=g+e.id,me=document.getElementById(pe);null==me&&((me=document.createElement(h)).setAttribute(X,m),me.setAttribute(J,pe)),me.innerHTML=e.description,de.appendChild(fe),de.appendChild(me),ie[0].cells[1].appendChild(de);var ge=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},ve=function(){e.sqmDWords[1]|=8,ge(e),!e.reDisplay&&le(e.id,e.displayDeactive),Ce(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},he=document.createElement(z);he.setAttribute(V,W),he.setAttribute("src",re.getLocalizedImageFilePath(ee)),he.setAttribute(X,p),he.setAttribute(J,f+e.id),he.setAttribute(G,"0"),he.setAttribute(M,Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT),he.setAttribute(T,d),he.setAttribute(H,"handleDismiss();"),i.OUtil.attachClickHandler(he,ve),ie[0].cells[2].appendChild(he),e.detailView=u;var be=document.createElement(d);if(be.setAttribute(X,c),be.innerHTML=e.buttonTxt,be.setAttribute(J,o+e.id),be.setAttribute(G,L),be.setAttribute(V,d),e.buttonCallback){be.setAttribute(H,"handleButtonClick()"),i.OUtil.attachClickHandler(be,(function(){if(e.sqmDWords[1]|=4,ge(e),le(e.id,u),Ce(e.id),Te(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=k,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else be.setAttribute(H,"handleDismiss()"),i.OUtil.attachClickHandler(be,ve);if(ie[2].cells[1].appendChild(be),e.url){var ye=document.createElement(d);ye.setAttribute(X,c),ye.innerHTML=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,ye.setAttribute(J,r+e.id),ye.setAttribute(H,"moreInfoButtonClick()"),i.OUtil.attachClickHandler(ye,(function(){e.sqmDWords[1]|=4,ge(e),e.sqmDWords[1]=1,window.open(e.url)})),ye.setAttribute(G,L),ye.setAttribute(V,d),ie[2].cells[1].appendChild(ye)}l.appendChild(te);var _e=document.createElement(Q);_e.setAttribute(X,q),_e.setAttribute(J,Z+e.id),e.displayDeactive&&(_e.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",_e.style.backgroundColor=U,_e.style.opacity=L,_e.style.filter=F,_e.style.backgroundRepeat=N,_e.style.backgroundPosition=D,_e.style.height=R),_e.appendChild(l),0!=e.div.childNodes.length?e.div.insertBefore(_e,e.div.childNodes[0]):e.div.appendChild(_e),Ae(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},me=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Y+e.id,r=document.getElementById(n);null==r&&((r=document.createElement(Q)).className=P,r.id=n),r.title=t,e.iframeNotificationUrl?r.appendChild(he(e,r)):r.appendChild(ve(e));var a=document.createElement(Q);a.className=q,a.id=Z+e.id,e.displayDeactive&&(a.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",a.style.backgroundColor=U,a.style.opacity=L,a.style.filter=F,a.style.backgroundRepeat=N,a.style.backgroundPosition=D,a.style.height=R),a.appendChild(r),0!=e.div.childNodes.length?e.div.insertBefore(a,e.div.childNodes[0]):e.div.appendChild(a),Ae(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show infobar, error message: ",e,k,23455900)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},ge=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=function(e){function t(e,t){var n=e.insertRow(-1);n.className="moe-trust-prompt-row "+t,n.setAttribute(T,E),n.insertCell(-1).className="moe-trust-prompt-cell"}e.id;var n=K+e.id,r=document.getElementById(n);r===k&&((r=document.createElement(j)).id=n,r.className="moe-trust-prompt-table",r.setAttribute(T,E)),t(r.createTHead(),"moe-trust-prompt-header");var a=r.createTBody();return t(a,"moe-trust-prompt-preview"),t(a,"moe-trust-prompt-description"),t(r.createTFoot(),"moe-trust-prompt-footer"),r}(e),n=t.rows,r=function(e){var t=document.createElement("p");return t.innerHTML=e.notificationType===i.NotificationType.TrustPromptContent?e.name:e.title,t.className="moe-trust-prompt-header-title",t}(e);n[0].cells[0].appendChild(r);var o=function(e){var t=document.createElement(ne);return t.src=e.icon,t.className="moe-trust-prompt-preview-img",t.setAttribute(M,e.iconTitle),t}(e),c=function(e){var t=document.createElement("p");return t.innerHTML=e.name,t.className="moe-trust-prompt-preview-title",t}(e),u=function(e){var t=document.createElement("p");return t.innerHTML=e.provider,t.className="moe-trust-prompt-preview-sub",t}(e);n[1].cells[0].appendChild(o),n[1].cells[0].appendChild(c),n[1].cells[0].appendChild(u);var l=function(e){var t=document.createElement("p");return t.innerHTML=e.description,t.className="moe-trust-prompt-description-text",t}(e);n[2].cells[0].appendChild(l);var f=function(){var t,n=document.createElement(d);return n.textContent=e.buttonTxt,n.className="moe-trust-prompt-button moe-trust-prompt-button-primary moe-trust-prompt-buttons-action",n.id="moe-trust-prompt-buttons-action_"+e.id,n.tabIndex=0,n.type=d,t=e.buttonCallback?function(){if(e.sqmDWords[1]|=4,_e(e),de(e),Ce(e.id),Te(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=k,re.retryAll(t._marketplaceID)}e.buttonCallback()}:function(){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&de(e),Ce(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},i.OUtil.attachClickHandler(n,t),n}();if(n[3].cells[0].appendChild(f),e.url!==k){var p=function(e){var t=document.createElement(d);return t.textContent=e.urlButtonTxt||Strings.OsfRuntime.L_MoreInfoButton_TXT,t.className="moe-trust-prompt-button moe-trust-prompt-buttons-url",t.id="moe-trust-prompt-buttons-url_"+e.id,t.tabIndex=1,t.type=d,i.OUtil.attachClickHandler(t,(function(){e.sqmDWords[1]|=4,_e(e),window.open(e.url)})),t}(e);n[3].cells[0].appendChild(p)}var m=function(e){var t=document.createElement(Q);t.className="moe-trust-prompt-collapse cui-ctl-iconContainer cui-img-cont-float cui-img-16by16";var n=document.createElement(ne);switch(e.clientName){case"WAC_Powerpoint":n.src=re.getLocalizedImageFilePath("per.png"),n.className="per_UpChevron_16x16x32";break;case"WAC_Word":n.src=re.getLocalizedImageFilePath("we.png"),n.className="we_UpChevron_16x16x32";break;case"WAC_Excel":n.src=re.getLocalizedImageFilePath("EwaEdit.png"),n.className="ewaboot_UpChevron16"}return n.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.appendChild(n),i.OUtil.attachClickHandler(t,(function(){var t="collapsed";e.collapsed===a?e.div.classList.remove(t):e.div.classList.add(t),e.collapsed=!e.collapsed})),t}(e);0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),e.div.appendChild(m),e.div.style.overflowY="auto",e.div.classList.add("moe-trust-prompt"),e.div.classList.add(e.clientName),e.div.classList.add(e.notificationType===i.NotificationType.TrustPromptContent?"content-add-in":"taskpane-add-in"),Ae(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show trust prompt, error message: ",e,k,38592974)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},ve=function(e){var t=be(e),n=t.rows;n[0].cells[0].appendChild(ye(e));var s=document.createElement("a");s.className=b,s.tabIndex=1;var l=document.createElement(h);l.className=v,l.textContent=e.title;var f=g+e.id,p=document.getElementById(f);null==p&&((p=document.createElement(h)).className=m,p.id=f),p.textContent=e.description,s.appendChild(l),s.appendChild(p),n[0].cells[1].appendChild(s);var y=function(){Oe(e)},_=Se(e);i.OUtil.attachClickHandler(_,y),n[0].cells[2].appendChild(_),e.detailView=u;var O=document.createElement(d);if(O.className=c,O.textContent=e.buttonTxt,O.id=o+e.id,O.tabIndex=1,O.type=d,e.buttonCallback){i.OUtil.attachClickHandler(O,(function(){if(e.sqmDWords[1]|=4,_e(e),le(e.id,u),Ce(e.id),Te(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=k,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else i.OUtil.attachClickHandler(O,y);if(n[2].cells[1].appendChild(O),e.url){var S=document.createElement(d);S.className=c,S.textContent=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,S.id=r+e.id,i.OUtil.attachClickHandler(S,(function(){e.sqmDWords[1]|=4,_e(e),e.sqmDWords[1]=1,window.open(e.url)})),S.tabIndex=1,S.type=d,n[2].cells[1].appendChild(S)}return t},he=function(e,t){var n="message",r=be(e),o=r.rows,c=document.createElement("iframe");window.getComputedStyle(e.div,k);c.width=R,c.frameBorder="0",c.className=ie,c.src=e.iframeNotificationUrl,o[0].cells[1].appendChild(c);var l="moe-hovered";t.addEventListener("mouseenter",(function(){i.OUtil.addClass(t,l),c.contentWindow.postMessage(i.AgaveHostAction.MouseEnter,ae)})),t.addEventListener("mouseleave",(function(){i.OUtil.removeClass(t,l),c.contentWindow.postMessage(i.AgaveHostAction.MouseLeave,ae)})),e.detailView=u;var d=k,f=Se(e);return i.OUtil.attachClickHandler(f,(function(){Oe(e),window.removeEventListener(n,d)})),o[0].cells[2].appendChild(f),f.addEventListener("keydown",(function(e){9==e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),c.contentWindow.postMessage(i.AgaveHostAction.TabInShift,ae))})),e.buttonCallback&&(d=function(t){try{if(t.source==c.contentWindow){var r=JSON.parse(t.data),o=parseInt(r[i.OmexMessageKeys.MessageType]),l=parseInt(r[i.OmexMessageKeys.MessageValue]);if(o==i.OmexMessageType.ConsentResult){if(le(e.id,u),Ce(e.id),Te(e.id),e.retryAll===a&&(e.notificationType==i.NotificationType.TrustYellowBar||e.notificationType==i.NotificationType.ConsentYellowBar&&l==i.ConsentResultCode.Success)){var p=re.getOsfControl(e.id);p._retryActivate=k,re.retryAll(p._marketplaceID)}window.removeEventListener(n,d),e.buttonCallback(l)}else o==i.OmexMessageType.TabExit&&(l==i.AgaveHostAction.TabExitShift&&re._notifyHost?re._notifyHost(e.id,i.AgaveHostAction.TabExitShift):l==i.AgaveHostAction.TabExit&&(window.focus(),f.focus()))}}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Exception in receivedMessageHandler: ",e,k,23455901)}},window.addEventListener(n,d)),r},be=function(e){var t=document.createElement(j);t.className=w,t.setAttribute(T,E);for(var n=e.iframeNotificationUrl?1:3,r=0;r<n;r++){t.insertRow(r).setAttribute(T,E)}var a=t.rows;return a[0].insertCell(0),a[0].insertCell(1),a[0].insertCell(2),a[0].cells[1].setAttribute("rowSpan","2"),a[0].cells[0].setAttribute(X,x),a[0].cells[1].setAttribute(X,A),a[0].cells[2].setAttribute(X,I),e.iframeNotificationUrl==k&&(a[1].insertCell(0),a[1].insertCell(1),a[2].insertCell(0),a[2].insertCell(1),a[2].insertCell(2),a[2].cells[1].setAttribute(X,C)),a[0].cells[0].appendChild(ye(e)),t},ye=function(e){var t,n,r=document.createElement(ne);return r.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(t=S,n=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(t=O,n=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(t=_,n=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(t=y,n=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),r.className=t,r.alt=n,r},_e=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},Oe=function(e){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&le(e.id,e.displayDeactive),Ce(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},Se=function(e){var t=document.createElement(z);return t.type=W,t.src=re.getLocalizedImageFilePath(ee),t.className=p,t.id=f+e.id,t.tabIndex=0,t.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.setAttribute(T,d),t},Ce=function(e){var t=re.getOsfControl(e);t&&(t._controlFocus=a)},Ie=function(e){var t=re.getOsfControl(e);if(t&&!we(e))if(t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready)t.notifyAgave(i.AgaveHostAction.TabIn);else{var n="_trySetFocusInAppContent$newCallback";if(t._notifyHostIFrameOnLoaded&&t._notifyHostIFrameOnLoaded.newCallbackIdentity&&t._notifyHostIFrameOnLoaded.newCallbackIdentity===n)return;var r=function(e){return function(){if(e)try{e()}catch(e){}t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready&&t.notifyAgave(i.AgaveHostAction.TabIn),t._notifyHostIFrameOnLoaded=e}}(t._notifyHostIFrameOnLoaded);r.newCallbackIdentity=n,t._notifyHostIFrameOnLoaded=r}},Ae=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(we(e)){var a=oe[e][0];if(a&&a.div)if(a.iframeNotificationUrl!=k){var o=a.div.getElementsByClassName(ie)[0];o&&(o.contentWindow.postMessage(i.AgaveHostAction.TabIn,ae),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}else{var s=a.div.querySelectorAll(n);if(s&&s.length>0){var c=s[0];c instanceof HTMLElement&&(window.focus(),c.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r.notifyAgave(t)},xe=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(we(e)){var a=oe[e][0];if(a&&a.div){var o=a.div.querySelectorAll(n);if(o&&o.length>0){var s=o.length>1?o[1]:o[0];s instanceof HTMLElement&&(window.focus(),s.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r._controlFocus=u,re._notifyHost(e,t)},Ee=function(e){var t=l.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),n=t&&t.enableNewTrustPromptForAddIn;e.notificationType!==i.NotificationType.TrustPromptContent&&e.notificationType!==i.NotificationType.TrustPromptTaskpane||!n?null==e.detailView||e.detailView===u?(e.sqmDWords[1]=0,fe(e)):(e.sqmDWords[1]=1,t&&t.enableSingleSignOnForAddin?me(e):pe(e)):ge(e)},Te=function(e){if(we(e)){var t=oe[e][0];Ee(t)}else Ie(e)},we=function(e){return oe[e]&&oe[e].length>0};return{showProgress:function(e,n){try{if(i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationStart),!document.getElementById(t+n)){oe[n]=[];var r=document.createElement(Q);r.setAttribute(X,q),r.setAttribute(J,t+n),r.style.backgroundColor="rgba(255, 255, 255, 0.5)",r.style.opacity=L,r.style.filter=F,r.style.height=R;var a=document.createElement(Q);a.style.width=R,a.style.height=R,a.style.backgroundImage=B+re.getLocalizedImageFilePath(te)+")",a.style.backgroundRepeat=N,a.style.backgroundPosition=D,r.appendChild(a),e.appendChild(r)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(e){}},showNotification:function(e){e.sqmDWords=[e.errorCode,0],delete e.errorCode,null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?a:u),null==e.reDisplay&&(e.reDisplay=e.infoType===i.InfoType.Error?a:u);var t=oe[e.id];void 0===t&&(t=[],oe[e.id]=t),e.highPriority===u?t.push(e):(t.splice(se,0,e),se++),(1===oe[e.id].length||e.highPriority)&&Ee(t[0])},showICon:function(e){fe(e)},removeDOMElement:function(e){ue(e)},removeProgressDiv:function(e,n){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationStart),e.ownerDocument.getElementById(t+n)&&ce(e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(e){!function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1Start),ue("icon_"+e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1End)}(e)},removeInfoBarDiv:function(e,t){le(e,t)},dismissMessages:function(e){!function(e){if(oe[e]){if(oe[e].length>0){var t=oe[e][0].div;ce(t)}delete oe[e]}}(e)},getHTMLEncodedString:function(e){return function(e){var t=document.createElement(Q),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}(e)},purgeOsfControlNotification:function(e){var t=oe[e],n=re.getOsfControl(e);t&&t.length>0&&n&&s.AppNotificationHelper.LogNotification(e,t[0].sqmDWords[0],t[0].sqmDWords[1])},focusOnNotificationUx:function(e,t){Ce(e),Ae(e,t)},focusOnNotificationUxShiftIn:function(e,t){Ce(e),xe(e,t)},appHasNotifications:function(e){return we(e)}}},function(e){var t=function(){function e(){}return e.setHostFeatureEnabledInfo=function(e){this._hostFeatureEnabledInfo=e},e.getHostFeatureEnabledInfo=function(){return this._hostFeatureEnabledInfo},e}();e.HostFeatureEnabledInfo=t}(l||(l={})),i.OUtil.setNamespace("AppSpecificSetup",i),i.ContextActivationManager=function(e){var t="0",n="osfControl for the given ID doesn't exist.",r=null,o=!0,c=!1,u=this;if(i.OUtil.validateParamObject(e,{appName:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},clientMode:{type:Number,mayBeNull:c},appUILocale:{type:String,mayBeNull:c},dataLocale:{type:String,mayBeNull:c},osfOmexBaseUrl:{type:String,mayBeNull:o},devCatalogUrl:{type:String,mayBeNull:o},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:o},sdxCdnUrl:{type:String,mayBeNull:o},sdxDmsUrl:{type:String,mayBeNull:o},spBaseUrl:{type:String,mayBeNull:o},docUrl:{type:String,mayBeNull:o},hostControl:{type:Object,mayBeNull:o},pageBaseUrl:{type:String,mayBeNull:o},lcid:{type:String,mayBeNull:o},formFactor:{type:String,mayBeNull:o},controlStatusChanged:{type:Object,mayBeNull:o},notifyHost:{type:Object,mayBeNull:o},allowExternalMarketplace:{type:Boolean,mayBeNull:o},localizedScriptsUrl:{type:String,mayBeNull:o},localizedImagesUrl:{type:String,mayBeNull:o},localizedStylesUrl:{type:String,mayBeNull:o},localizedResourcesUrl:{type:String,mayBeNull:o},trustAgaves:{type:Boolean,mayBeNull:o},enableAddinCommands:{type:Boolean,mayBeNull:o},enableBlackForestRedirect:{type:Boolean,mayBeNull:o},enableMyOrg:{type:Boolean,mayBeNull:o},enableMyApps:{type:Boolean,mayBeNull:o},enableDevCatalog:{type:Boolean,mayBeNull:o},enableOneDriveCatalog:{type:Boolean,mayBeNull:o},enablePrivateCatalog:{type:Boolean,mayBeNull:o},enableTaskpaneUpgradeToAppCommand:{type:Boolean,mayBeNull:o},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:o},enableV1RedirectApis:{type:Boolean,mayBeNull:o},omexForceAnonymous:{type:Boolean,mayBeNull:o},userNameHashCode:{type:Number,mayBeNull:o},hostFullVersion:{type:String,mayBeNull:o},envCode:{type:String,mayBeNull:o},showSignOutFromPrivateCatalogMessage:{type:Boolean,mayBeNull:o},enableSingleSignOnForAddin:{type:Boolean,mayBeNull:o},enableServiceDeliveredExperience:{type:Boolean,mayBeNull:o},hideAppsExtensionUrl:{type:String,mayBeNull:o},enableInsertDialogAccessibilityFix:{type:Boolean,mayBeNull:o},disableLogging:{type:Boolean,mayBeNull:o},enableDisplayBlockedMinorError:{type:Boolean,mayBeNull:o},enableFirstPartySSO:{type:Boolean,mayBeNull:o},enableFirstPartySSOResourceCheck:{type:Boolean,mayBeNull:o},enableFirstPartyUseWopiIdentity:{type:Boolean,mayBeNull:o},disableAppsForOfficeThirdParty:{type:Boolean,mayBeNull:o},wacSessionId:{type:String,mayBeNull:o},enableFirstPartySDXErrorMessages:{type:Boolean,mayBeNull:o},isHostDocumentDomain:{type:Boolean,mayBeNull:o},enableRichApiCellEditDelay:{type:Boolean,mayBeNull:o},enableNewTrustPromptForAddIn:{type:Boolean,mayBeNull:o}},r),u._osfOmexBaseUrl=e.osfOmexBaseUrl,u._devCatalogUrl=e.devCatalogUrl,u._sdxCdnUrl=e.sdxCdnUrl,u._sdxDmsUrl=e.sdxDmsUrl,u._firstPartyManifestCDNUrl=e.firstPartyManifestCDNUrl,u._oneDriveCatalogBaseApiUrl=e.oneDriveCatalogBaseApiUrl,u._spBaseUrl=e.spBaseUrl,u._myOrgCatalogUrl=r,u._enableAddinCommands=e.enableAddinCommands||c,u._enableBlackForestRedirect=e.enableBlackForestRedirect||c,u._enableInsertDialogAccessibilityFix=e.enableInsertDialogAccessibilityFix||c,u._enableFirstPartySDXErrorMessages=e.enableFirstPartySDXErrorMessages||c,u._enableMyOrg=e.enableMyOrg||c,u._enableMyApps=e.enableMyApps||c,u._enableDevCatalog=e.enableDevCatalog||c,u._enableOneDriveCatalog=e.enableOneDriveCatalog||c,u._enablePrivateCatalog=e.enablePrivateCatalog||c,u._showSignOutFromPrivateCatalogMessage=e.showSignOutFromPrivateCatalogMessage||c,u._enableTaskpaneUpgradeToAppCommand=e.enableTaskpaneUpgradeToAppCommand||c,u._enableUploadFileDevCatalog=e.enableUploadFileDevCatalog||c,u._enableV1RedirectApis=e.enableV1RedirectApis||c,u._appName=e.appName,u._appVersion=e.appVersion,u._clientMode=e.clientMode,u._appUILocale=e.appUILocale,u._dataLocale=e.dataLocale,u._docUrl=e.docUrl,u._hostControl=e.hostControl,u._formFactor=e.formFactor||i.FormFactor.Default,u._pageBaseUrl=e.pageBaseUrl,u._lcid=e.lcid,u._controlStatusChanged=e.controlStatusChanged,u._notifyHost=e.notifyHost||function(){},u._allowExternalMarketplace=e.allowExternalMarketplace,u._localizedScriptsUrl=e.localizedScriptsUrl,u._localizedImagesUrl=e.localizedImagesUrl,u._localizedStylesUrl=e.localizedStylesUrl,u._localizedResourcesUrl=e.localizedResourcesUrl,u._autoTrusted=e.trustAgaves,u._omexForceAnonymous=e.omexForceAnonymous||c,u._userNameHashCode=e.userNameHashCode||0,u._hostFullVersion=e.hostFullVersion,u._wacHostEnvironment=e.envCode,u._enableSingleSignOnForAddin=e.enableSingleSignOnForAddin||c,u._enableFirstPartySSO=e.enableFirstPartySSO||c,u._enableFirstPartySSOResourceCheck=e.enableFirstPartySSOResourceCheck||c,u._enableFirstPartyUseWopiIdentity=e.enableFirstPartyUseWopiIdentity||c,u._enableServiceDeliveredExperience=e.enableServiceDeliveredExperience||o,u._hideAppsExtensionUrl=u._osfOmexBaseUrl+e.hideAppsExtensionUrl,u._disableLogging=e.disableLogging||c,u._enableDisplayBlockedMinorError=e.enableDisplayBlockedMinorError||c,u._disableAppsForOfficeThirdParty=e.disableAppsForOfficeThirdParty||c,u._isHostDocumentDomain=e.isHostDocumentDomain||c,u._enableRichApiCellEditDelay=e.enableRichApiCellEditDelay||c,u._loggableUserId=e.loggableUserId,u._sessionStartInfoJson=e.sessionStartInfoJson,u._enableNewTrustPromptForAddIn=e.enableNewTrustPromptForAddIn||c,l.HostFeatureEnabledInfo.setHostFeatureEnabledInfo(e),u._pageBaseUrl&&"/"!==u._pageBaseUrl.charAt(u._pageBaseUrl.length-1)&&(u._pageBaseUrl=u._pageBaseUrl+"/"),u._localizedResourcesUrl&&"/"!==u._localizedResourcesUrl.charAt(u._localizedResourcesUrl.length-1)&&(u._localizedResourcesUrl=u._localizedResourcesUrl+"/"),u._clientId=i.OUtil.getUniqueId(),u._cachedOsfControls={},u._iframeAttributeBag={},u._serviceEndPoint=r,u._serviceEndPointInternal=r,u._internalConversationId=r,u._iframeProxies={},u._iframeProxyCount=0,u._iframeNamePrefix="__officeExtensionProxy",u._webUrl=r,u._wsa=r,u._insertDialogDiv=r,u._hasPreloadedOfficeJs=c,u._contextMgrCorrelationId=e.wacSessionId||i.OUtil.Guid.generateNewGuid(),s.RuntimeTelemetryHelper.LogCommonMessageTag("_contextMgrCorrelationId :"+u._contextMgrCorrelationId,r,20194265),u._hostType=r,u._hostPlatform=r,u._hostSpecificFileVersion=r,u._requirementsChecker=new i.RequirementsChecker,u._onClickInstallOsfControl=r,u._osfOmexBaseUrl){var d,f=u._osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);d=f>=0?u._osfOmexBaseUrl.substr(f):i.Constants.ProtocolSeparator+u._osfOmexBaseUrl;var p=i.Constants.Https+d,m=i.Constants.Https+d;i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()?(u._omexAuthNStatus=i.OmexAuthNStatus.Anonymous,u._omexForceAnonymous=o):u._omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,u._omexGatedWSProxy={proxyUrl:p+i.Constants.OmexGatedServiceExtension,proxyName:"__omexExtensionGatedProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexWSProxy={proxyUrl:m+i.Constants.OmexUnGatedServiceExtension,proxyName:"__omexExtensionProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexAnonymousWSProxy={proxyUrl:p+i.Constants.OmexAnonymousServiceExtension,proxyName:"__omexExtensionAnonymousProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexBillingMarket=r,u._omexEndPointBaseUrl=m}u._isFromWacAutomation=function(){if(void 0!==this._isFromWacAutomation&&this._isFromWacAutomation!==r)return this._isFromWacAutomation;try{for(var e=window,t=void 0;e!==t;){if(!e.location||!e.location.search)return c;if(e.location.search.toLowerCase().indexOf("automation=1")>=0)return o;t=e,e=e.parent}}catch(e){return c}return c}(),i.OsfManifestManager._setUILocale(u._appUILocale);var g=u;if(g.getContextForEmbeddingPage=function(){var e=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var t=g._hostSpecificFileVersion.split("."),n=t[1];isNaN(n)||(e=parseInt(t[1]))}var r=g._requirementsChecker._getSupportedSet();return{appName:g._appName,appVersion:g._appVersion,appUILocal:g._appUILocale,dataLocale:g._dataLocale,docUrl:g._docUrl||window.location.href,clientMode:g._clientMode,minorVersion:e,requirements:r}},u._enableServiceDeliveredExperience)var v=function(e){var t=e&&e.contextId?g.getOsfControl(e.contextId):r;switch(e.id){case i.MessageIDs.FetchBundleUrl:if(!t._agaveEndPoint){var n=t._conversationId+i.SharedConstants.NotificationConversationIdSuffix;t._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n,t._frame.contentWindow,t._iframeUrl)}if(t._bundleUrl){var o={id:i.MessageIDs.LoadReactBundle,bundleUrl:t._bundleUrl};t.sendMessageToSdx(o)}break;case i.MessageIDs.LoadBundleSuccess:t._pageStatus=i.OsfControlPageStatus.Ready,t._contextActivationMgr._ErrorUXHelper&&t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id);break;case i.MessageIDs.LoadBundleError:break;default:a.msAjaxDebug.trace("MessageID: "+e.id+" onMessageFromSdx got wrong message.")}};var h=function(e,t){e.hasOwnProperty("fromInsertDialog")&&!e.fromInsertDialog||g._insertDialogDiv!=r&&2==g._insertDialogDiv.childNodes.length&&g._insertDialogDiv.removeChild(g._insertDialogDiv.lastChild);var n,o=i.OUtil.Guid.generateNewGuid(),s=new l.InsertDialogTelemetryContext(o);e.storeType==i.StoreTypeEnum.MarketPlace?n={storeType:i.StoreType.OMEX,storeLocator:g._osfOmexBaseUrl}:e.storeType==i.StoreTypeEnum.Catalog?n={storeType:i.StoreType.SPCatalog,storeLocator:g._myOrgCatalogUrl}:e.storeType==i.StoreTypeEnum.OneDrive&&(n={storeType:i.StoreType.OneDrive,storeLocator:g._oneDriveCatalogBaseApiUrl});var u=e.refresh,d={assetId:"",contentMarket:"",anonymous:c,clientEndPoint:r,clearCache:u,clearKilledApps:c,referenceInUse:n,hostType:g._hostType};if(e&&e.storeType==i.StoreTypeEnum.MarketPlace){d.clientVersion=g._getClientVersionForOmex(),d.clientVersion&&(d.clientName=g._getClientNameForOmex(),d.appVersion=g._getAppVersionForOmex());(p=l.CatalogFactory.resolve(i.StoreType.OMEX)).getEntitlementAsync(c,s,Function.createDelegate(g,(function(e){if(e.status==l.DataServiceResultCode.Succeeded&&e.value){var n=e.value,a=n.length;0===a&&t({errorCode:i.InvokeResultCode.S_OK});for(var o,c={},d=[],f=0;f<a;f++)c[(o=n[f]).contentMarket]?c[o.contentMarket].push(o.assetId):c[o.contentMarket]=[o.assetId];var m=0,v=function(e,n){if(e.status==l.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&e.value.length>0)for(var r=e.value,o=g.getRequirementsChecker(),s=0;s<r.length;s++){if(o.isEntitlementFromOmexSupported(r[s])){var c=[];c.push(r[s].name),c.push(r[s].assetId),c.push(r[s].description),c.push(i.OUtil.getTargetType(r[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(r[s].version)),c.push(r[s].assetId),c.push(i.StoreType.OMEX),c.push(parseInt(r[s].defaultWidth)),c.push(parseInt(r[s].defaultHeight)),c.push(r[s].iconUrl),c.push(r[s].provider),c.push(n),c.push(i.StoreType.OMEX),d.push(c)}m++}if(m===a){var u={value:d,errorCode:i.InvokeResultCode.S_OK};t(u)}},h=function(e,t){p.getAppDetails(e,t,s,(function(e){Function.createDelegate(g,v)(e,t)}),u)};for(var b in c)h(c[b],b)}else{var y={value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN};t(y)}})),u)}else if(e&&e.storeType==i.StoreTypeEnum.Catalog){var f=l.CatalogFactory.resolve(i.StoreType.SPCatalog);f.myOrgCatalogUrl=g._myOrgCatalogUrl;f.getEntitlementAsync(c,s,Function.createDelegate(g,(function(e){var a;if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),e.status==l.DataServiceResultCode.Succeeded&&e.value){for(var o,s=e.value,c=s.length,u=[],d=0,f=g.getRequirementsChecker(),p=0;p<c;p++)if(o=s[p],f.isEntitlementFromCorpCatalogSupported(o)){var m=[];m.push(o.Title),m.push(o.OfficeExtensionID),m.push(o.OfficeExtensionDescription),m.push(i.OfficeAppType[o.OEType]),m.push(i.OUtil.normalizeAppVersion(o.OfficeExtensionVersion)),m.push(o.OfficeExtensionID),m.push(i.StoreType.SPCatalog),m.push(parseInt(o.OfficeExtensionDefaultWidth.toString())),m.push(parseInt(o.OfficeExtensionDefaultHeight.toString())),m.push(o.OfficeExtensionIcon),m.push(o.OEProviderName),m.push(n.storeLocator),m.push(i.StoreType.SPCatalog),u.push(m),d++}a=d>0?{value:u,errorCode:i.InvokeResultCode.S_OK}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS}}else a=n.storeLocator?{value:r,errorCode:i.InvokeResultCode.E_GENERIC_ERROR}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS};t(a)})),u)}else if(e&&e.storeType==i.StoreTypeEnum.OneDrive){i.OsfManifestManager.getOneDriveEntitlementsAsync(d,(function(e){var n;e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(n={value:e.value.entitlements,errorCode:i.InvokeResultCode.S_OK},t(n))}))}else if(e&&e.storeType==i.StoreTypeEnum.PrivateCatalog){var p;(p=l.CatalogFactory.resolve(i.StoreType.PrivateCatalog)).getEntitlementAsync(c,s,Function.createDelegate(g,(function(e){if(e.status!=l.DataServiceResultCode.Unauthenticated)if(e.status===l.DataServiceResultCode.Succeeded&&e.value){var n=e.value;if(0!==n.length){var a;a=n.map((function(e){return{ProductId:e.assetId,AddInState:e.addInState,Version:e.appVersion}}));var o=[];p.getAppDetails(a,"",s,Function.createDelegate(g,(function(e){if(e.status===l.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&0!==e.value.length){for(var n=e.value,a=g.getRequirementsChecker(),s=0;s<n.length;s++)if(a.isEntitlementFromOmexSupported(n[s])){var c=[];c.push(n[s].name),c.push(n[s].assetId),c.push(n[s].description),c.push(i.OUtil.getTargetType(n[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(n[s].version)),c.push(n[s].assetId),c.push(i.StoreType.PrivateCatalog),c.push(parseInt(n[s].defaultWidth)),c.push(parseInt(n[s].defaultHeight)),c.push(n[s].iconUrl),c.push(n[s].provider),c.push(i.StoreType.PrivateCatalog),c.push(i.StoreType.PrivateCatalog),o.push(c)}t({value:o,errorCode:i.InvokeResultCode.S_OK})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED})})),u)}else t({errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED});else t({value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN})})),u)}else a.msAjaxDebug.trace("Unknown store type.")};u._onClickInstallOsfControl=function(e){if(g._enableUploadFileDevCatalog){a.msAjaxDebug.trace("onClickInstallOsfControl!");try{i.OUtil.validateParamObject(e,{manifest:{type:String,mayBeNull:c}},r);var n=new i.Manifest.Manifest(e.manifest,g.getAppUILocale()),u=n.getMarketplaceID(),d=n.getMarketplaceVersion();if(l.CatalogFactory.resolve(i.StoreType.UploadFileDevCatalog).validateAndCacheNewManifest(u,d,e.manifest,n)){var f={id:u,targetType:n.getTarget(),appVersion:d,currentStoreType:i.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:u,assetStoreId:i.StoreType.UploadFileDevCatalog,width:parseInt(n.getDefaultWidth()||t),height:parseInt(n.getDefaultHeight()||t),isAddinCommands:n._isAddinCommandsManifest(i.getManifestHostType(g._hostType))};i.OUtil.validateParamObject(f,{id:{type:String,mayBeNull:c},targetType:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},width:{type:Number,mayBeNull:o},height:{type:Number,mayBeNull:o}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,f.currentStoreType,f.assetId,f.appVersion,f.targetType,f.isAddinCommands,f.width,f.height),g._notifyHost(t,i.AgaveHostAction.InsertAgave,f)}else g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}catch(e){var p="Invalid manifest from addincommands dev catalog.";return l.WACUtils.logExceptionToBrowserConsole(p,e),s.RuntimeTelemetryHelper.LogExceptionTag(p,e,this._appCorrelationId,19203548),void g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}}};var b=function(e){a.msAjaxDebug.trace("onClickRefreshfAddinCommands!"),g._notifyHost(t,i.AgaveHostAction.RefreshAddinCommands,e)},y=function(e){var t=i.OUtil.Guid.generateNewGuid(),n=new l.InsertDialogTelemetryContext(t),a=l.CatalogFactory.resolve(i.StoreType.OMEX),o=new l.PreCacher(g.getRequirementsChecker()),s={assetId:e.assetId,storeType:i.StoreType.OMEX,storeId:e.storeId,appVersion:"",targetType:r};a.activateAsync(s,o,n)},_=function(e,t){if(g._enableSingleSignOnForAddin)O(e,t);else{var n={assetId:e.id,clientVersion:g._getClientVersionForOmex(),clientName:g._getClientNameForOmex(),clientEndPoint:g._omexGatedWSProxy.clientEndPoint},r=g._insertDialogDiv,a={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED},o=i.OUtil.Guid.generateNewGuid(),u=new l.InsertDialogTelemetryContext(o);l.CatalogFactory.resolve(i.StoreType.OMEX).removeAsync([n.assetId],u,(function(o){var u=0;if(o.status==l.DataServiceResultCode.Succeeded&&o.value&&o.value.removedApps&&o.value.removedApps.length>0){for(var d=o.value.removedApps,f=i.InvokeResultCode.E_OEM_REMOVED_FAILED,p=0;p<d.length;p++)if(d[p].assetId==n.assetId){d[p].result==i.OmexRemoveAppStatus.Success&&(f=i.InvokeResultCode.S_OK);break}f==i.InvokeResultCode.S_OK&&(u=g.untrustOsfControls(e)),a.errorCode=f}var m=!document.documentElement.contains(r);s.AppManagementMenuHelper.LogAppManagementMenuAction(n.assetId,i.AppManagementAction.Remove,u,m,c,a.errorCode),t(a)}))}},O=function(e,n){var r=g._hideAppsExtensionUrl+"&"+i.OmexPageParameterKeys.AppName+"="+i.getModernAppVerCode(g._appName)+"&"+i.OmexPageParameterKeys.AssetId+"="+e.id+"&"+i.OmexPageParameterKeys.AppCorrelationId+"="+g._contextMgrCorrelationId,a=document.createElement("iframe");a.setAttribute("id","serviceExtensionIframe"),a.setAttribute("src",r),a.setAttribute("scrolling","auto"),a.setAttribute("border",t),a.setAttribute("width",t),a.setAttribute("height",t),a.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(a);var o=g._insertDialogDiv,u=function(t){if(t.source==a.contentWindow){var r={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED};document.body.removeChild(a),window.removeEventListener("message",u);var l=0,d=JSON.parse(t.data),f=parseInt(d[i.OmexRemoveAddinMessageKeys.RemoveAddinResultCode]),p=i.InvokeResultCode.E_OEM_REMOVED_FAILED;if(f===i.OmexRemoveAddinResultCode.Success){for(var m=d[i.OmexRemoveAddinMessageKeys.RemoveAddinResultValue],v=0;v<m.length;v++)if(m[v]==e.id){p=i.InvokeResultCode.S_OK;break}p==i.InvokeResultCode.S_OK&&(l=g.untrustOsfControls(e),S(e.id)),r.errorCode=p}var h=!document.documentElement.contains(o);s.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,i.AppManagementAction.Remove,l,h,c,r.errorCode),n(r)}};window.addEventListener("message",u)},S=function(e){var t=".*",n=[];n.push(new RegExp(i.OUtil.formatString(l.WACUtils.CacheConstants.EntitlementsKey,t,t),"i")),n.push(new RegExp(i.OUtil.formatString(l.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,t,e,t,t),"i")),l.WACUtils.removeMatchesFromLocalStorage(n)};if(u._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(u._clientId),u._serviceEndPoint._onHandleRequestError=function(e,t){var n,a,o;e&&(n=e._data)&&((a="string"==typeof(a="object"==typeof n?n[0]:n)?a:r)&&(o=g.getOsfControl(a))&&(o._pageStatus="Failed origin check"===t?i.OsfControlPageStatus.FailedOriginCheck:"Access Denied"===t?i.OsfControlPageStatus.FailedPermissionCheck:i.OsfControlPageStatus.FailedHandleRequest,s.RuntimeTelemetryHelper.LogExceptionTag(t,r,o.getCorrelationId(),19203549)))},u._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",(function(e,u){var l="string"==typeof e?e:"object"==typeof e&&e.length>0?e[0]:r;(!l||!u)&&s.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",r,r,19203545);var d=g.getOsfControl(l);if(!d)throw a.msAjaxDebug.trace(n),s.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",r,r,19203546),a.msAjaxError.argument("contextId");s.AppLoadTimeHelper.OfficeJSLoaded(d._telemetryContext);var f=d.getEToken(),p=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var m=g._hostSpecificFileVersion.split("."),v=m[1];isNaN(v)||(p=parseInt(m[1]))}var h=g._requirementsChecker._getSupportedSet(),b=new i.OfficeAppContext(d.getMarketplaceID(),g._appName,g._appVersion,g._appUILocale,g._dataLocale,g._docUrl||window.location.href,g._clientMode,d.getSettings(),d.getReason(),d.getOsfControlType(),f,d._appCorrelationId,d.getID(),c,o,p,h,d.getHostCustomMessage(),g._hostFullVersion||i.Constants.FileVersion,window.innerHeight,window.innerWidth,d.getManifest()?d.getManifest().getDefaultDisplayName():r,d._appDomains,void 0);b._wacHostEnvironment=g._wacHostEnvironment||t,b._isFromWacAutomation=!!g._isFromWacAutomation,u(b),d._pageStatus=i.OsfControlPageStatus.Ready,d._pageIsReadyTimerExpired&&s.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",r,d.getCorrelationId(),19203547),d._contextActivationMgr._ErrorUXHelper&&d._contextActivationMgr._ErrorUXHelper.removeProgressDiv(d._div,d._id),d._timer&&(window.clearTimeout(d._timer),d._timer=r);var y=d._conversationId+i.SharedConstants.NotificationConversationIdSuffix;d._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(y,d._frame.contentWindow,d._iframeUrl),s.AppLoadTimeHelper.ActivationEnd(d._telemetryContext)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",(function(e){e&&2==e.length||!(e&&3==e.length&&(e[1]===i.AgaveHostAction.UpdateTargetUrl||e[1]===i.AgaveHostAction.SendTelemetryEvent))&&a.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var t=e[0],r=e[1],o=g.getOsfControl(t);if(o)if(r===i.AgaveHostAction.TabExitShift||r===i.AgaveHostAction.ExitNoFocusableShift)g._ErrorUXHelper.focusOnNotificationUxShiftIn(t,r);else if(r===i.AgaveHostAction.UpdateTargetUrl){var s=e[2];o.checkAppDomains(s)&&o.updateAgaveEndPointTargetUrl(s)}else if(r===i.AgaveHostAction.SendTelemetryEvent){var c=e[2];o._contextActivationMgr._notifyHost(t,r,c)}else o._contextActivationMgr._notifyHost?o._contextActivationMgr._notifyHost(t,r):a.msAjaxDebug.trace("No notifyHost provided by the host.");else a.msAjaxDebug.trace(n)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",(function(e){window.open(e.strUrl,e.strWindowName,e.strWindowFeatures)}),Microsoft.Office.Common.InvokeType.async,c),u._enableServiceDeliveredExperience&&u._serviceEndPoint.registerMethod("Office_sendMessageToHost",v,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(u._clientId+i.Constants.EndPointInternalSuffix),u._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",h,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",(function(e){if(e&&e.storeType!=i.StoreTypeEnum.PrivateCatalog){var n=window.location.href,a=g._osfOmexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(n);window.location.assign(a)}else l.PrivateCatalogService.authenticationProxy.getSignInUrl((function(e){window.top.location.replace(e)}),(function(){g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}))}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignOut",(function(e){e&&e.storeType==i.StoreTypeEnum.PrivateCatalog&&l.PrivateCatalogService.SignOutUser(),b(e,r)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",(function(e){window.open(e.pageUrl)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",(function(e){a.msAjaxDebug.trace("onClickInsertOsfControl!"),g._notifyHost(t,i.AgaveHostAction.InsertAgave,e)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",u._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",b,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",(function(){a.msAjaxDebug.trace("onClickCancelDialog!"),g._notifyHost(t,i.AgaveHostAction.CancelDialog),g._internalConversationId&&(g._serviceEndPointInternal.unregisterConversation(g._internalConversationId),g._internalConversationId=r)}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",_,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",(function(e){switch(e.datapointName){case i.DataPointNames.AppManagementMenu:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.AppManagementMenuHelper.LogAppManagementMenuAction(e.assetId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.InsertionDialogSession:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},totalSessionTime:{type:Number,mayBeNull:c},trustPageSessionTime:{type:Number,mayBeNull:c},appInserted:{type:Boolean,mayBeNull:c},lastActiveTab:{type:Number,mayBeNull:c},lastActiveTabCount:{type:Number,mayBeNull:c}},r),s.InsertionDialogSessionHelper.LogInsertionDialogSession(e.assetId,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount);break;case i.DataPointNames.UploadFileDevCatelog:i.OUtil.validateParamObject(e,{operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.UploadFileDevCatalogUsage:i.OUtil.validateParamObject(e,{currentStoreType:{type:String,mayBeNull:c},id:{type:String,mayBeNull:o},appVersion:{type:String,mayBeNull:o},appTargetType:{type:Number,mayBeNull:c},isAppCommand:{type:String,mayBeNull:c},appSizeWidth:{type:Number,mayBeNull:o},appSizeHeight:{type:Number,mayBeNull:o}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,e.currentStoreType,e.Id,e.appVersion,e.appTargetType,e.isAppCommand,e.appSizeWidth,e.appSizeHeight)}}),Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",y,Microsoft.Office.Common.InvokeType.async,c),i.AppSpecificSetup._setupFacade(u._hostControl,u,u._serviceEndPoint,u._serviceEndPointInternal),e.hostType=u._hostType,e.spBaseUrl=u._spBaseUrl,l.CatalogFactory.setHostContext(e),u._localeStringLoadingPendingCallbacks=[],u._localizedScriptsUrl&&"null/"!=u._localizedScriptsUrl){u._loadLocaleString(Function.createDelegate(u,(function(){this._ErrorUXHelper=new i._ErrorUXHelper(this)})))}u.queryEntitlementDetails=function(e){h(e,e.callbackFunc)},u._getOmexData=function(e){y(e)},u._removeAppForInsertDialog=function(e){_(e,e.callbackFunc)}},i.ContextActivationManager.prototype={insertOsfControl:function(e){var t=!0,n=!1,r=this;if(i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},storeType:{type:String,mayBeNull:n},alternateReference:{type:Object,mayBeNull:t},settings:{type:Object,mayBeNull:t},reason:{type:String,mayBeNull:t},osfControlType:{type:Number,mayBeNull:t},snapshotUrl:{type:String,mayBeNull:t},preactivationCallback:{type:Object,mayBeNull:t},virtualOsfControlActivationCallback:{type:Object,mayBeNull:t},isvirtualOsfControl:{type:Boolean,mayBeNull:t},isDialog:{type:Boolean,mayBeNull:t},hostCustomMessage:{type:String,mayBeNull:t},isForUILessAction:{type:Boolean,mayBeNull:t},ownerAddinAssetId:{type:String,mayBeNull:t},ownerAddinStoreType:{type:String,mayBeNull:t}},null),!r._disableAppsForOfficeThirdParty||e.storeType.toLowerCase()===i.StoreType.FirstParty.toLowerCase()){var a={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,alternateReference:e.alternateReference,settings:e.settings,reason:e.reason,osfControlType:e.osfControlType,snapshotUrl:e.snapshotUrl,contextActivationMgr:r,preactivationCallback:e.preactivationCallback,virtualOsfControlActivationCallback:e.virtualOsfControlActivationCallback,isvirtualOsfControl:e.isvirtualOsfControl,isDialog:e.isDialog,hostCustomMessage:e.hostCustomMessage,isForUILessAction:e.isForUILessAction,ownerAddinAssetId:e.ownerAddinAssetId,sourceLocationOverrideResourceId:e.sourceLocationOverrideResourceId,ownerAddinStoreType:e.ownerAddinStoreType},o=r.getSQMAgaveUsage(a.storeType,a.osfControlType,a.reason,e.marketplaceID),s=new i.OsfControl(a);s._sqmDWords[0]=o[0],s._sqmDWords[1]=o[1],s._contextActivationMgr._ErrorUXHelper&&s._contextActivationMgr._ErrorUXHelper.showProgress(s._div,s._id);return r._loadLocaleString(Function.createDelegate(r,(function(){s.activate()}))),s}},insertDialogControl:function(e){var t=!1;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:t},id:{type:String,mayBeNull:t},dialogUrl:{type:String,mayBeNull:t},marketplaceID:{type:String,mayBeNull:t},marketplaceVersion:{type:String,mayBeNull:t},appDomains:{type:Array,mayBeNull:t},store:{type:String,mayBeNull:t},storeType:{type:String,mayBeNull:t},agaveName:{type:String,mayBeNull:!0}},null);var n={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,isDialog:!0,contextActivationMgr:this};new i.OsfControl(n).createIframeForDialogControl(e.agaveName,e.dialogUrl,e.appDomains)},insertBlankControlWithErrorUX:function(e,t){var n=!1,r=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:!0},storeType:{type:String,mayBeNull:n}},null);var a={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,osfControlType:e.osfControlType,contextActivationMgr:r,isvirtualOsfControl:n},o=new i.OsfControl(a);o._contextActivationMgr.registerOsfControl(o);var s=function(e,t){var r,a="",i="",o="",s=n;e.status===l.DataServiceResultCode.Succeeded&&e.value&&(a=(r=e.value).getDefaultDisplayName(),i=r.getProviderName(),o=r.getDefaultIconUrl(),s=r.isSSOAddin()),t(a,i,o,s)},c=l.OmexUtils.getOmexEndPointPageUrl(r.getOsfOmexBaseUrl(),e.marketplaceID,e.store),u=l.CatalogFactory.resolve(e.storeType.toLowerCase());if(null!=u){var d={assetId:e.marketplaceID,appVersion:e.marketplaceVersion,storeType:e.storeType,storeId:e.store,targetType:null},f=i.OmexClientNames[r._appName];u.getAndCacheManifest(d,r._storeLocator,new l.AddinCommandsTelemetryContext(o.getCorrelationId()),(function(n){s(n,(function(n,r,a,i){o._showTrustError(f,n,r,a,e.storeType,t,c,i)}))}))}},purgeDialogControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&(n._conversationId&&this._getServiceEndPoint().unregisterConversation(n._conversationId),this.unregisterOsfControl(n))},dispose:function(){var e=this;e._serviceEndPoint&&(e._serviceEndPoint.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId),e._serviceEndPoint=null),e._serviceEndPointInternal&&(e._serviceEndPointInternal.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId+i.Constants.EndPointInternalSuffix),e._serviceEndPointInternal=null)},setLocalizedUrl:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:!1},{name:"imageUrl",type:String,mayBeNull:!1},{name:"styleUrl",type:String,mayBeNull:!1}]);if(a)throw a;if(r._localizedScriptsUrl=e,r._localizedImagesUrl=t,r._localizedStylesUrl=n,r._localizedScriptsUrl&&"null/"!=r._localizedScriptsUrl){var o=function(){this._ErrorUXHelper||(this._ErrorUXHelper=new i._ErrorUXHelper(this))};r._loadLocaleString(Function.createDelegate(r,o))}},getOsfControlStatus:function(e){var t=this._cachedOsfControls[e];return t?t.getStatus():i.OsfControlStatus.InvalidOsfControl},activateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.activate()},deActivateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.deActivate()},purgeOsfControl:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&r.purge(t)},purgeOsfControlNotifications:function(){for(var e in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(e)},untrustOsfControls:function(e){var t=this,n=0,r=function(e){return function(){e.activate({hasConsent:!0})}},a=i.OUtil.formatString(i.Constants.ActivatedCacheKey,e.id.toLowerCase(),e.currentStoreType,e.storeId);for(var o in t._deleteCachedFlag(a),t._cachedOsfControls){var s=t._cachedOsfControls[o];if(s._marketplaceID.toLowerCase()==e.id.toLowerCase()){t._ErrorUXHelper.purgeOsfControlNotification(s._id),s.deActivate();var c=l.OmexUtils.getOmexEndPointPageUrl(t.getOsfOmexBaseUrl(),s._marketplaceID,e.storeId),u=i.OmexClientNames[t._appName];s._showTrustError(u,e.displayName,e.providerName,e.iconUrl,e.currentStoreType,r(s),c),n++}}return n},retryAll:function(e){var t=this;for(var n in t._cachedOsfControls){var r=t._cachedOsfControls[n];r._marketplaceID.toLowerCase()==e.toLowerCase()&&r._retryActivate&&(t._ErrorUXHelper.purgeOsfControlNotification(r._id),t._ErrorUXHelper.removeInfoBarDiv(n,!1),r._retryActivate(),r._retryActivate=null)}},getOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;return this._cachedOsfControls[e]},getOsfControls:function(){var e=[];for(var t in this._cachedOsfControls)e.push(this._cachedOsfControls[t]);return e},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},isStoreDisabled:function(e){this._loadLocaleString(Function.createDelegate(this,(function(){var t=l.CatalogFactory.resolve(i.StoreType.OMEX),n=i.OUtil.Guid.generateNewGuid(),r=new l.InsertDialogTelemetryContext(n);if(t instanceof l.OmexCatalog)t.isStoreDisabled(r,e);else{e({value:!1,status:200})}})))},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(e){this._controlStatusChanged&&this._controlStatusChanged(e)},registerOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._cachedOsfControls[e.getID()]=e},unregisterOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;delete this._cachedOsfControls[e.getID()]},setIframeAttributeBag:function(e){this._iframeAttributeBag=e},getOmexIframeNotificationUrl:function(e,t,n){var r="&",a="=",o=this,s=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"notificationType",type:Number,mayBeNull:!1},{name:"isForSideloadAddin",type:Boolean,mayBeNull:!1}]);if(s)throw s;var c=o.getOsfControl(e);if(c){var u=o._osfOmexBaseUrl+i.Constants.OmexConsentNotificationPage+"?"+i.OmexPageParameterKeys.AppName+a+i.getModernAppVerCode(o._appName)+r+i.OmexPageParameterKeys.AppVersion+a+(o._hostFullVersion||i.Constants.FileVersion)+r+i.OmexPageParameterKeys.AppUILocale+a+o._appUILocale+r+i.OmexPageParameterKeys.AppDomain+a+window.location.origin+r+i.OmexPageParameterKeys.StoreLocator+a+c.getStoreLocator()+r+i.OmexPageParameterKeys.NotificationType+a+t+r+i.OmexPageParameterKeys.AppCorrelationId+a+c.getCorrelationId()+r+i.OmexPageParameterKeys.AuthType+a+o._getAuthTypeForHideAppsExtensionUrl();if(n){var l=c.getManifest().getWebApplicationId(),d=c.getManifest().getWebApplicationScopes();u=u+r+i.OmexPageParameterKeys.AppId+a+l+r+i.OmexPageParameterKeys.Scopes+a+encodeURIComponent(d.join(","))}else{var f=c.getOwnerAddinAssetId(),p=f||c.getMarketplaceID();u=u+r+i.OmexPageParameterKeys.AssetId+a+p}return u}return null},displayNotification:function(e){var t=null,n=!0,r=!1,a=this;i.OUtil.validateParamObject(e,{infoType:{type:Number,mayBeNull:r},id:{type:String,mayBeNull:r},title:{type:String,mayBeNull:r},description:{type:String,mayBeNull:r},url:{type:String,mayBeNull:n},icon:{type:String,mayBeNull:n},buttonTxt:{type:String,mayBeNull:n},buttonCallback:{type:Function,mayBeNull:n},dismissCallback:{type:Function,mayBeNull:n},"displayDeactive ":{type:Boolean,mayBeNull:n},highPriority:{type:Boolean,mayBeNull:n},detailView:{type:Boolean,mayBeNull:n},reDisplay:{type:Boolean,mayBeNull:n},logAsError:{type:Boolean,mayBeNull:n},errorCode:{type:Number,mayBeNull:n},retryAll:{type:Boolean,mayBeNull:n},iframeNotificationUrl:{type:String,mayBeNull:n},notificationType:{type:Number,mayBeNull:n}},t),e.errorCode||(e.errorCode=0);var o=a._cachedOsfControls[e.id];if(o)if(o._isvirtualOsfControl){if(e.errorCode==i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED||e.errorCode==i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED)return void a.purgeOsfControl(e.id,n);if(null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?n:r),e.highPriority===r)o._notificationParams.push(e);else{for(var c=o._notificationParams,u=0;u<c.length;u++)if(!c[u].highPriority){c.splice(u,0,e),c=t;break}c!=t&&c.push(e)}!o._isvirtualOsfControlCallbackInvoked&&o.ensureToGetVirtualOsfControlManifest((function(e){o.invokeVirtualOsfControlActivationCallback(e)})),!o._isManifestProcessedForCustomFunctions&&o.ensureToGetVirtualOsfControlManifest((function(e){o.processManifestForCustomFunctions(e)}))}else{if(e.logAsError&&(s.AppLoadTimeHelper.SetErrorResult(o._telemetryContext,e.errorCode),a._notifyHostError)){var l={errorCode:e.errorCode};a._notifyHostError(e.id,i.AgaveHostAction.NotifyHostError,l)}(e.displayDeactive||e.iframeNotificationUrl!=t)&&(e.detailView=n),e.div=o._div,a._ErrorUXHelper.showNotification(e)}},dismissMessages:function(e){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(e)},notifyAgave:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"actionId",type:Number,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(t===i.AgaveHostAction.CtrlF6In||t===i.AgaveHostAction.TabIn||t===i.AgaveHostAction.Select?this._ErrorUXHelper.focusOnNotificationUx(e,t):t===i.AgaveHostAction.TabInShift&&r._pageStatus!==i.OsfControlPageStatus.Ready?this._ErrorUXHelper.focusOnNotificationUxShiftIn(e,t):r.notifyAgave(t))},setWSA:function(e){var t=this;t._wsa=e,t._wsa&&(t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,i.BWsaStreamTypes.Static,2,i.BWsaConfig.defaultMaxStreamRows),t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,i.BWsaStreamTypes.Static,4,i.BWsaConfig.defaultMaxStreamRows))},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(e,t,n,r){var a,o;switch(e.toLowerCase()){case i.StoreType.OMEX:a=0;break;case i.StoreType.SPCatalog:a=1;break;case i.StoreType.FileSystem:a=2;break;case i.StoreType.Registry:a=3;break;case i.StoreType.Exchange:a=4;break;case i.StoreType.SPApp:a=5;break;case i.StoreType.FirstParty:a=6;break;case i.StoreType.Sdx:a=7;break;default:a=15}switch(t){case i.OsfControlType.DocumentLevel:o=1;break;case i.OsfControlType.ContainerLevel:o=0;break;default:o=2}var s=7;if(n&&n.toLowerCase)switch(n.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():s=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():s=1}var c=0;0!==r.toLowerCase().indexOf("wa")&&0!==r.toLowerCase().indexOf("fa")||(c=r&&r.length>2?parseInt(r.substring(2),10):0,isNaN(c)&&(c=0));return[s<<8|o<<4|a,c]},isMyOrgReady:function(e){var t=this;if(t._enableMyOrg)if(t._spBaseUrl&&t._iframeProxies&&t._iframeProxies[t._spBaseUrl]&&t._iframeProxies[t._spBaseUrl].clientEndPoint)e({isReady:!0,clientEndPoint:t._iframeProxies[t._spBaseUrl].clientEndPoint});else{t._createSharePointIFrameProxy(t._spBaseUrl,(function(t){e(t?{isReady:!0,clientEndPoint:t}:{isReady:!1})}))}else e({isReady:!1})},openInputUrlDialog:function(e){var t=document.createElement("p");t.setAttribute("id","title-p"),t.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):",e.appendChild(t);var n=document.createElement("input");n.setAttribute("type","url"),n.setAttribute("id","url-input"),n.setAttribute("size","80"),n.setAttribute("data-lpignore","true"),e.appendChild(n);var r=this,a=function(e){var t=new i.Manifest.Manifest(e,r.getAppUILocale());!i.OsfManifestManager.hasManifest(t.getMarketplaceID(),t.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(t.getMarketplaceID(),t.getMarketplaceVersion(),t);var n={id:t.getMarketplaceID(),targetType:t.getTarget(),appVersion:t.getMarketplaceVersion(),currentStoreType:i.StoreType.Registry,storeId:"developer",assetId:t.getMarketplaceID(),assetStoreId:i.StoreType.Registry,width:t.getDefaultWidth()||0,height:t.getDefaultHeight()||0,isAddinCommands:t._isAddinCommandsManifest(i.getManifestHostType(r._hostType))};s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,n.currentStoreType,n.id,n.appVersion,n.targetType,n.isAddinCommands,n.width,n.height),r._notifyHost("0",i.AgaveHostAction.InsertAgave,n)},o=function(e){alert("Error when requsting manifest file: "+e)},c=document.createElement("input");c.setAttribute("type","button"),c.setAttribute("value","Insert"),i.OUtil.addEventListener(c,"click",(function(){i.OUtil.xhrGet(r._devCatalogUrl+"/"+n.value,a,o)})),e.appendChild(c)},launchInsertDialog:function(e,t,n){var r=null,a="100%";0!=e.childNodes.length&&e.removeChild(e.childNodes.item(0));var o,c=i.OUtil.Guid.generateNewGuid(),u=new l.InsertDialogTelemetryContext(c);if(this._enableDevCatalog){(o=document.createElement("div")).style.width=a,o.style.height="80%",e.appendChild(o);var d=document.createElement("div");d.style.width=a,d.style.height="20%",e.appendChild(d),this.openInputUrlDialog(d)}else o=e;var f=this;f._insertDialogDiv=o;var p=document.createElement("div");p.style.width=a,p.style.height=a,p.style.backgroundImage="url("+f.getLocalizedImageFilePath("progress.gif")+")",p.style.backgroundRepeat="no-repeat",p.style.backgroundPosition="center",o.appendChild(p);!function(e,t){if(f._enableMyOrg)try{i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1}},t);f.isMyOrgReady((function(n){n.isReady?(e.clientEndPoint=n.clientEndPoint,l.CatalogFactory.resolve(i.StoreType.SPCatalog).getSPCatalogUrl(u,(function(n){t({statusCode:n.status,value:n.value,context:e})}))):t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}))}catch(n){return s.RuntimeTelemetryHelper.LogExceptionTag("Error when getting corporate catalog url:",n,this._appCorrelationId,34719254),void t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}else t({statusCode:i.InvokeResultCode.E_CATALOG_NO_APPS,value:r,context:e})}({webUrl:f._spBaseUrl},(function(e){var c=document.createElement("iframe");c.setAttribute("id","InsertDialog"),c.setAttribute("src","about:blank"),c.setAttribute("width",a),c.setAttribute("height",a),c.setAttribute("marginHeight","0"),c.setAttribute("marginWidth","0"),c.setAttribute("frameBorder","0"),c.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups"),"undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime&&c.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var u=r,l=[];f.isStoreDisabled((function(a){var d='"}',p='], "url":"',m='{ "IsUploadFileDevCatalogEnabled":'+f._enableUploadFileDevCatalog+',"isStoreDisabled":'+a.value+',"showSignOutFromPrivateCatalogMessage":'+f._showSignOutFromPrivateCatalogMessage+',"enableInsertDialogAccessibilityFix":'+f._enableInsertDialogAccessibilityFix+',"isBlackForestRedirectEnabled":'+f._enableBlackForestRedirect+',"isHostDocumentDomain":'+f._isHostDocumentDomain+" }";if(f.isExternalMarketplaceAllowed()){var g='{ "provValues":[0,0,0,'+(f._enableMyApps?i.InvokeResultCode.S_OK.toString():i.InvokeResultCode.S_HIDE_PROVIDER.toString())+p+f._osfOmexBaseUrl+'", "client":"'+f._getClientNameForOmex()+'", "'+i.OmexPageParameterKeys.AuthType+'":'+f._getAuthTypeForHideAppsExtensionUrl()+"}";l.push('"myApp":'+g),s.RuntimeTelemetryHelper.LogCommonMessageTag("isExternalMarketplaceAllowed is true, myApp tab show firstly.",f._contextMgrCorrelationId,20194266)}if(e&&e.value!=r){if(f._enableMyOrg){f._myOrgCatalogUrl=e.value;var v='{ "provValues":[1,1,0,'+e.statusCode+p+e.value+d;l.push('"myOrg":'+v)}if(f._enableOneDriveCatalog&&-1!=document.cookie.indexOf("OneDriveCatalog=true")){f._myOneDriveCatalogUrl=e.value;var h='{ "provValues":[9,9,0,0], "url":"'+e.value+d;l.push('"myOneDrive":'+h)}}if(f._enablePrivateCatalog){var b='{"provValues":[10,10,0,0], "client":"'+f._getClientNameForOmex()+d;l.push('"privateCatalog":'+b)}l.length>0&&(u="{"+l.join(", ")+"}"),f._internalConversationId&&f._serviceEndPointInternal.unregisterConversation(f._internalConversationId);var y=f.getClientId()+"_"+f.getDocUrl(),_=i.OUtil.getFrameName(y),O=i.OUtil.generateConversationId();f._internalConversationId=i.OUtil.generateConversationId(),c.setAttribute("name",_);var S=r;n!=r&&(S='{ "navigationMode":'+n.navigationMode+', "navigationModeParameter": "'+n.assetId+'", "category":"'+n.category+d);var C="",I=[O,encodeURIComponent(window.location.href),f._appVersion,i.getAppVerCode(f._appName),f.getLcid(),i.Constants.FileVersion,encodeURIComponent(u),t,encodeURIComponent(m),encodeURIComponent(S),f._contextMgrCorrelationId];C=f._localizedResourcesUrl?f._localizedResourcesUrl+"WefGallery.htm?b="+i.Constants.FileVersion:f._pageBaseUrl+f.getLcid()+"/WefGallery.htm?b="+i.Constants.FileVersion;var A=i.OUtil.addXdmInfoAsHash(C,I.join("|"));f._serviceEndPointInternal.registerConversation(O,A),c.setAttribute("src",A),f._insertDialogDiv?(0!=o.childNodes.length&&o.removeChild(o.childNodes.item(0)),o.appendChild(c)):(o.insertBefore(c,o.firstChild),f._insertDialogDiv=o)}))})),f._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var e in this._cachedOsfControls){var t=this._cachedOsfControls[e];t._status===i.OsfControlStatus.NotSandBoxSupported&&t.activate()}},setRequirementsChecker:function(e){this._requirementsChecker=e},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(e){return!!this._ErrorUXHelper&&this._ErrorUXHelper.appHasNotifications(e)},refreshOsfControl:function(e,t){var n=this;for(var r in n._cachedOsfControls)if(n._cachedOsfControls[r]&&e==n._cachedOsfControls[r]._marketplaceID&&t==n._cachedOsfControls[r]._sourceLocationOverrideResourceId){n._cachedOsfControls[r].refresh();break}},_doesUrlHaveSupportedProtocol:function(e){var t=!1;e&&(t=null!=decodeURIComponent(e).match(/^https?:\/\/.+$/gi));return t},_loadLocaleString:function(e){var t=this;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){for(var n=t._localeStringLoadingPendingCallbacks.length,r=0;r<n;r++){t._localeStringLoadingPendingCallbacks.shift()()}e()}else{t._localeStringLoadingPendingCallbacks.push(e);var a=t._localeStringLoadingPendingCallbacks;if(1===a.length){t._loadStringScript((function(){for(var e=a.length,t=0;t<e;t++){var n=a.shift();"function"==typeof n&&n()}}))}}},_loadStringScript:function(e){var t=this,n=this.getLocalizedScriptsUrl();n+=i.Constants.StringResourceFile;var r=0,a=function(){var o=null;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){if(r>0){c=i.OUtil.formatString("osfruntime_strings loaded after {0} retries.",r);s.RuntimeTelemetryHelper.LogExceptionTag(c,o,o,20306077)}e()}else{if(++r<3)return void setTimeout((function(){i.OUtil.loadScript(n,a)}),750*r);t._localeStringLoadingPendingCallbacks.length=0;var c=i.OUtil.formatString("The locale, {0}, provided by the host app is not supported. Url: {1}",t.getLcid(),n);s.RuntimeTelemetryHelper.LogExceptionTag(c,o,o,20306076)}};i.OUtil.loadScript(n,a)},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,t,e)},_getManifestAndTargetByConversationId:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];if(e===n._getConversationId()){var r=n.getStoreType()==i.StoreType.FirstParty?"":n.getMarketplaceVersion();return{manifest:n.getManifest()||i.OsfManifestManager.getCachedManifest(n.getMarketplaceID()),version:r,target:n.getOsfControlType()}}}return null},_createSharePointIFrameProxy:function(e,t){var n=null,r=this;if(r._doesUrlHaveSupportedProtocol(e)){var a=e.length;"/"===e.charAt(a-1)&&(e=e.substr(0,a-1));var o=r._iframeProxies[e];if(o)o.isReady?t(o.clientEndPoint):o.pendingCallbacks.push(t);else{var c=i.OUtil.generateConversationId(),u=document.createElement("iframe");r._iframeProxyCount=r._iframeProxyCount+1;var l=r._iframeNamePrefix+r._iframeProxyCount;u.setAttribute("id",l),u.setAttribute("name",l);var d=e+"/_layouts/15/OfficeExtensionManager.aspx?"+c;d=i.OUtil.addXdmInfoAsHash(d,c+"|"+l+"|"+window.location.href),d=i.OUtil.addSerializerVersionAsHash(d,i.SerializerVersion.Browser),u.setAttribute("scrolling","auto"),u.setAttribute("border","0"),u.setAttribute("width","0"),u.setAttribute("height","0"),u.setAttribute("style","position: absolute; left: -100px; top:0px;");var f=r,p=function(t,r){var a,o=f._iframeProxies[e];if(o&&0===t&&r.status?(o.isReady=!0,a=o.clientEndPoint):(delete f._iframeProxies[e],Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(c)?(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(c),i.OUtil.removeEventListener(u,"load",m),u.parentNode.removeChild(u)):s.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",n,n,19203550),a=n),o)for(var l=o.pendingCallbacks.length,d=0;d<l;d++){o.pendingCallbacks.shift()(a)}},m=function(){f._iframeProxies[e]&&(f._iframeProxies[e].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(c,u.contentWindow,e),f._iframeProxies[e].clientEndPoint.invoke("OEM_isProxyReady",p,{__timeout__:2e3}))};document.body.appendChild(u),i.OUtil.addEventListener(u,"load",m),u.setAttribute("src",d),r._iframeProxies[e]={clientEndPoint:n,isReady:!1,pendingCallbacks:[t]}}}else t(n)},_getClientVersionForOmex:function(){if(this._appVersion){var e=this._appVersion.split("."),t=parseInt(e[0],10),n=parseInt(e[1],10)||0;if(!(t<=15&&n<=0)){var r=i.Constants.FileVersion.split(".");return t+"."+n+"."+r[2]+"."+r[3]}}},_getClientNameForOmex:function(){return i.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return i.OmexAppVersions[this._appName]},_setCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.setItem(e,"true")},_getCachedFlag:function(e){var t=i.OUtil.getLocalStorage();if(t)return!!t.getItem(e)},_deleteCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.removeItem(e)},_preloadOfficeJs:function(){var e=this;if(!e._hasPreloadedOfficeJs){var t=document.createElement("script");t.src=i.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",i.Constants.PreloadOfficeJsUrl,e._appUILocale,e._appName,e._hostSpecificFileVersion),t.type="text/javascript",t.id=i.Constants.PreloadOfficeJsId,t.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,19203551)},document.getElementsByTagName("head")[0].appendChild(t),e._hasPreloadedOfficeJs=!0}},_getAuthTypeForHideAppsExtensionUrl:function(){var e=i.OUtil.getQueryStringParamValue(this._hideAppsExtensionUrl,i.OmexPageParameterKeys.AuthType);return e||i.AuthType.Anonymous},isAddinCommandsAsync:function(e,t){var n=null,r=!1;i.OUtil.validateParamObject(e,{marketplaceId:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},storeId:{type:String,mayBeNull:r},targetData:{type:Object,mayBeNull:r},clearCache:{type:Boolean,mayBeNull:!0}},n);var a=e.storeType.toLowerCase(),o={contextActivationMgr:n,referenceInUse:n},c=e.clearCache||r;try{o.referenceInUse={id:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeLocator:e.storeId},o.contextActivationMgr=this;var u=function(a){a!=n&&a.statusCode==l.DataServiceResultCode.Succeeded&&a.value!=n?t(!0,a.value._isAddinCommandsManifest(i.getManifestHostType(o.contextActivationMgr._hostType)),e):t(r,r,e)};if(i.StoreType.OMEX===a||i.StoreType.UploadFileDevCatalog===a||i.StoreType.SPCatalog===a||i.StoreType.PrivateCatalog===a){var d=l.CatalogFactory.resolve(a),f={assetId:o.referenceInUse.id,storeType:a,storeId:o.referenceInUse.storeLocator,appVersion:o.referenceInUse.version,targetType:n},p=i.OUtil.Guid.generateNewGuid(),m=new l.AddinCommandsTelemetryContext(p);d.getAndCacheManifest(f,f.storeId,m,(function(e){u({statusCode:e.status,value:e.value})}),c)}else t(!0,r,e)}catch(a){s.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",a,n,19203552),t(r,r,e)}},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getUserNameHashCode:function(){return this._userNameHashCode}},i.OsfControl=function(e){var t=null,n=!0,r=!1,a=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:r},contextActivationMgr:{type:Object,mayBeNull:r},id:{type:String,mayBeNull:r},marketplaceID:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},store:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},alternateReference:{type:Object,mayBeNull:n},settings:{type:Object,mayBeNull:n},reason:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:n},snapshotUrl:{type:String,mayBeNull:n},preactivationCallback:{type:Object,mayBeNull:n},virtualOsfControlActivationCallback:{type:Object,mayBeNull:n},isvirtualOsfControl:{type:Boolean,mayBeNull:n},isDialog:{type:Boolean,mayBeNull:n},hostCustomMessage:{type:String,mayBeNull:n},isForUILessAction:{type:Boolean,mayBeNull:n},ownerAddinAssetId:{type:String,mayBeNull:n},sourceLocationOverrideResourceId:{type:String,mayBeNull:n},ownerAddinStoreType:{type:String,mayBeNull:n}},t),a._div=e.div,a._sourceLocationOverrideResourceId=e.sourceLocationOverrideResourceId,a._contextActivationMgr=e.contextActivationMgr,a._id=e.id,a._storeType=e.storeType.toLowerCase(),a._storeLocator=e.store,a._marketplaceID=e.marketplaceID,a._marketplaceVersion=e.marketplaceVersion,a._alternateReference=e.alternateReference,a._settings=e.settings||{},a._reason=null==e.reason?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:e.reason,a._osfControlType=null==e.osfControlType?i.OsfControlType.DocumentLevel:e.osfControlType,a._snapshotUrl=e.snapshotUrl,a._status=i.OsfControlStatus.NotActivated,a._notificationParams=[],a._iframeUrl=t,a._permission=t,a._conversationId=t,a._manifestUrl=t,a._pageStatus=i.OsfControlPageStatus.NotStarted,a._pageIsReadyTimerExpired=r,a._timer=t,a._retryLoadingNum=2,a._frame=t,a._agaveEndPoint=t,a._etoken="",a._sqmDWords=[0,0],a._preactivationCallback=e.preactivationCallback,a._telemetryContext={},a._controlFocus=r,a._agavePageUrl=t,a._agaveWindowName=t,a._manifest=t,a._virtualOsfControlActivationCallback=e.virtualOsfControlActivationCallback,a._isvirtualOsfControl=null==e.isvirtualOsfControl?r:e.isvirtualOsfControl,a._isvirtualOsfControlCallbackInvoked=r,a._isManifestProcessedForCustomFunctions=r,a._isDialog=null==e.isDialog?r:e.isDialog,a._hostCustomMessage=e.hostCustomMessage,a._isUpgrading=r,a._contextActivationMgr._enableServiceDeliveredExperience&&(a._bundleUrl=t,a._sdxIframeTemplateUrl="https://osf-agave/rtm/sdx/index.html"),a._isUILessAddInCommands=!!e.isForUILessAction,a._ownerAddinAssetId=e.ownerAddinAssetId?e.ownerAddinAssetId:t,a._ownerAddinStoreType=e.ownerAddinStoreType?e.ownerAddinStoreType:t,i.OUtil.isiOS()&&(a._div.style.webkitOverflowScrolling="touch",a._div.style.overflow="auto"),a._appCorrelationId=a._contextActivationMgr._contextMgrCorrelationId||i.OUtil.Guid.generateNewGuid(),a._iframeOnLoadDelegate=Function.createDelegate(a,a._iframeOnLoad),a._retryActivate=t,a._onKeyDownEventDelegate=Function.createDelegate(a,a._onKeydownEvent)},i.OsfControl.prototype={activate:function(e){var t=!0,n=null,r=this,a=r;if(r._status!==i.OsfControlStatus.Activated){try{if(r._contextActivationMgr.registerOsfControl(r),i.OUtil.addEventListener(r._div,"keydown",r._onKeyDownEventDelegate),(e=e||{}).hostType=r._contextActivationMgr._hostType,e.osfControl=e.osfControl||r,e.referenceInUse=e.referenceInUse||{id:r._marketplaceID,version:r._marketplaceVersion,storeType:r._storeType,storeLocator:r._storeLocator},e.correlationId=e.osfControl._appCorrelationId,!r._doesBrowserSupportRequiredFeatures())return r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION),void r.invokePreactivationCompletedCallback();var o=document.createElement("iframe"),c="sandbox"in o;o=n;var u=!1,d=i.OUtil.getLocalStorage();if(d&&(u=d.getItem(i.Constants.IgnoreSandBoxSupport)),r._contextActivationMgr._autoTrusted&&!c&&!u)return r._contextActivationMgr._ErrorUXHelper.removeProgressDiv(r._div,r._id),r._status=i.OsfControlStatus.NotSandBoxSupported,r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN_FirstParty,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR_FirstParty,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT_FirstParty,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}):r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}),void r.invokePreactivationCompletedCallback();r.startActivate();var f=r,p=e.referenceInUse;if(p.storeType===i.StoreType.OMEX||p.storeType===i.StoreType.UploadFileDevCatalog||p.storeType===i.StoreType.SPCatalog||p.storeType===i.StoreType.PrivateCatalog||p.storeType===i.StoreType.FirstParty||p.storeType===i.StoreType.Sdx){var m=new l.OsfControlLoader(r,e.hasConsent),g=new l.ActivationTelemetryContext(r.getCorrelationId(),r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r._id);if(p.storeType===i.StoreType.Sdx)l.SDXCatalog.activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:""},m,g,r._contextActivationMgr.getRequirementsChecker(),{clientId:r._contextActivationMgr._loggableUserId,sessionStartInfoJson:r._contextActivationMgr._sessionStartInfoJson});else{var v=e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?n:e.osfControl.getOsfControlType();l.CatalogFactory.resolve(p.storeType).activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:p.storeType===i.StoreType.SPCatalog?v:""},m,g)}return void r.invokePreactivationCompletedCallback()}if("1B4CD97F-DBFE-4C1A-B4C4-FC163B4F9693"===p.id&&s.RuntimeTelemetryHelper.LogCommonMessageTag("ONO_Onboarding_CorrelationId :"+r.getCorrelationId(),n,23381916),s.AppLoadTimeHelper.ActivationStart(r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r.getCorrelationId(),r._id,i.ActivationTypes.V2Enabled),s.AppLoadTimeHelper.ServerCallStart(r._telemetryContext),p.storeType===i.StoreType.Exchange||p.storeType===i.StoreType.InMemory)i.OsfManifestManager.getManifestAsync(e,(function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&!a._etoken&&(a._etoken=e.value.getInMemoryEToken()||""),a._onGetManifestCompleted(e)}));else if(p.storeType===i.StoreType.Registry&&r._contextActivationMgr._enableDevCatalog||p.storeType===i.StoreType.HardCodedPreinstall)if(e.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened){i.OUtil.xhrGet(r._contextActivationMgr._devCatalogUrl+"/"+p.id+".xml",(function(t){var n=new i.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());!i.OsfManifestManager.hasManifest(n.getMarketplaceID(),n.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(n.getMarketplaceID(),n.getMarketplaceVersion(),n),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))}),(function(e){alert("Error when requsting manifest file: "+e)}))}else i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(r,r._onGetManifestCompleted));else if(p.storeType===i.StoreType.OneDrive&&r._contextActivationMgr._enableOneDriveCatalog){var h=function(t){var n=new i.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());i.OsfManifestManager.cacheManifest(p.id,n.getMarketplaceVersion(),n),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))},b=function(){f._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},y=window.location.protocol+"//"+window.location.host;i.OneDriveOAuth.setHostCallbackUri(y);var _=r._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+p.id+":/content?access_token=";i.OneDriveOAuth.getAccessToken((function(e){_+=e,i.OUtil.xhrGet(_,h,b)}),(function(){f._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}))}else p.storeType===i.StoreType.SPApp?(s.AppLoadTimeHelper.EntitlementCheckStart(r._telemetryContext),e.baseUrl=r._contextActivationMgr.getPageBaseUrl(),e.pageUrl=r._contextActivationMgr._docUrl,e.webUrl=r._contextActivationMgr._webUrl,e.appWebUrl=r._contextActivationMgr._webUrl,i.OsfManifestManager.getSPAppEntitlementsAsync(e,Function.createDelegate(r,r._onGetEntitlementsCompleted))):p.storeType===i.StoreType.FileSystem||p.storeType===i.StoreType.Registry||p.storeType===i.StoreType.HardCodedPreinstall?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):p.storeType===i.StoreType.OneDrive?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):r._showActivationError(i.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,n,n,n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}catch(e){var O="Error getting app data.";l.WACUtils.logExceptionToBrowserConsole(O,e),s.RuntimeTelemetryHelper.LogExceptionTag(O,e,r.getCorrelationId(),18420419),r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}r.invokePreactivationCompletedCallback()}else r.invokePreactivationCompletedCallback()},createIframeForDialogControl:function(e,t,n){for(var r=this;r._div.childNodes.length>0;)r._div.removeChild(r._div.childNodes.item(0));var a=r._createIframeForControl(e);r._iframeUrl=t,r._appDomains=n,r._setIframeAttribute(a,t),r._div.appendChild(a),r._contextActivationMgr.registerOsfControl(r)},deActivate:function(){var e=null,t=this;try{if(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationStart),t._contextActivationMgr.dismissMessages(t._id),t._retryActivate=e,t._status!==i.OsfControlStatus.NotActivated){for(t._agaveEndPoint&&(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(t._agaveEndPoint._conversationId),t._agaveEndPoint=e),t._frame&&(i.OUtil.removeEventListener(t._frame,"load",t._iframeOnLoadDelegate),t._frame=e),t._timer&&(window.clearTimeout(t._timer),t._timer=e);t._div.childNodes.length>0;)t._div.removeChild(t._div.childNodes.item(0));t._status=i.OsfControlStatus.NotActivated,t._conversationId&&t._contextActivationMgr._getServiceEndPoint().unregisterConversation(t._conversationId),t._contextActivationMgr.raiseOsfControlStatusChange(t)}t._controlFocus=!1,i.OUtil.removeEventListener(t._div,"keydown",t._onKeyDownEventDelegate),i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationEnd)}catch(e){var n="Deactivate failed.";l.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),18420420)}},startActivate:function(){var e=this;for(e._controlFocus=!0,e._pageStatus=i.OsfControlPageStatus.Loading,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationStart),e._frame&&(i.OUtil.removeEventListener(e._frame,"load",e._iframeOnLoadDelegate),e._frame=null);e._div.childNodes.length>0;)e._div.removeChild(e._div.childNodes.item(0));e._contextActivationMgr._ErrorUXHelper.showProgress(e._div,e._id)},refresh:function(){this._refresh()},_restartActivate:function(){this.deActivate(),this.startActivate(),this.invokePreactivationCompletedCallback()},purge:function(e){var t=this,n=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;try{t._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(t._id),t.deActivate(),e&&i.OsfManifestManager.purgeManifest(t._marketplaceID,t._marketplaceVersion),t._contextActivationMgr.unregisterOsfControl(t)}catch(e){var r="Purge failed.";l.WACUtils.logExceptionToBrowserConsole(r,e),s.RuntimeTelemetryHelper.LogExceptionTag(r,e,t.getCorrelationId(),18420421)}},invokeVirtualOsfControlActivationCallback:function(e){var t=this;try{t._virtualOsfControlActivationCallback&&(t._virtualOsfControlActivationCallback(t,e),t._isvirtualOsfControlCallbackInvoked=!0)}catch(e){var n="invokeVirtualOsfControlActivationCallback failed.";l.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),36496280)}},ensureToGetVirtualOsfControlManifest:function(e){var t=null,n=this,r=n;if(n._manifest)e(n._manifest);else{var a={assetId:n._marketplaceID,appVersion:n._marketplaceVersion,storeType:n._storeType,storeId:n._storeLocator,targetType:t},o=function(n){var a=t;n.status===l.DataServiceResultCode.Succeeded&&n.value?a=n.value:r._status=i.OsfControlStatus.ActivationFailed,e(a)},s=l.CatalogFactory.resolve(a.storeType);s!=t?s.getAndCacheManifest(a,n._storeLocator,new l.AddinCommandsTelemetryContext(n.getCorrelationId()),o):(alert("AddinCommands is not supported in "+a.storeType+" store."),o({status:l.DataServiceResultCode.Failed,value:t}))}},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(e){this._settings=e},getReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},isFirstParty:function(){return this._storeType&&(this._storeType===i.StoreType.FirstParty||this._storeType===i.StoreType.Sdx)},updateAgaveEndPointTargetUrl:function(e){this._agaveEndPoint._targetUrl=e},getStoreLocator:function(){return this._storeLocator},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;return this._settings[e]},addProperty:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",type:String,mayBeNull:!1}]);if(n)throw n;this._settings[e]=t},removeProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;delete this._settings[e]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},checkAppDomains:function(e){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(this._appDomains,e)},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){this._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return!1},getEToken:function(){return this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(e){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,e)},sendMessageToSdx:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_sendMessageToSdx",t,e)},isUILessAddInCommands:function(){return this._isUILessAddInCommands},getOwnerAddinAssetId:function(){return this._ownerAddinAssetId},getOwnerAddinStoreType:function(){return this._ownerAddinStoreType},_onKeydownEvent:function(e){var t="input, button, a",n=this;if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){e.preventDefault(),e.stopPropagation();var r=i.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(r=i.AgaveHostAction.CtrlF6ExitShift),n._contextActivationMgr._notifyHost(n._id,r)}else if(9==e.keyCode){e.preventDefault(),e.stopPropagation();var a=n._div.querySelectorAll(t);if(0==a.length)return;i.OUtil.focusToNextTabbable(a,e.target||e.srcElement,e.shiftKey)||(e.shiftKey?n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExitShift):n._agaveEndPoint?n.notifyAgave(i.AgaveHostAction.TabIn):n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExit))}else if(27==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.EscExit);else if(113==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.F2Exit);else if(13==e.keyCode||32==e.keyCode)for(var o=n._div.querySelectorAll(t),s=0;s<o.length;s++){var c=e.target||e.srcElement;if(o[s]===c)return e.preventDefault(),e.stopPropagation(),void c.click()}else e.preventDefault(),e.stopPropagation()},_onGetEntitlementsCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.EntitlementCheckEnd(n._telemetryContext);for(var r,a=e.context.referenceInUse,o=e.value.entitlements,c=o.length,u=t,l=0;l<c;l++)(r=o[l]).OfficeExtensionID&&a.id&&r.OfficeExtensionID.toLowerCase()===a.id.toLowerCase()&&(u&&!n._lessThan(u.OfficeExtensionVersion,r.OfficeExtensionVersion)||(u=r));(r=u)?r.OfficeExtensionKillbit?n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED):(e.context.manifestUrl=r.EncodedAbsUrl,e.context.appInstanceId=r.AppInstanceID,e.context.productId=r.ProductID,e.context.appInstanceId?i.OsfManifestManager.getAppInstanceInfoByIdAsync(e.context,Function.createDelegate(n,n._onGetAppInstanceInfoByIdCompleted)):i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(n,n._onGetManifestCompleted))):n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback((function(e){e.osfControl._refresh(e)}),{clearCache:!0,referenceInUse:e.context.referenceInUse,osfControl:e.context.osfControl}),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST)}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){var r=e.value,a=e.context;r.AppWebFullUrl&&(a.appWebUrl=r.AppWebFullUrl),a.clientId=r.AppPrincipalId,a.remoteAppUrl=r.RemoteAppUrl,a.appWebUrl&&a.productId?i.OsfManifestManager.getSPTokenByProductIdAsync(a,Function.createDelegate(n,n._onGetSPTokenByProductIdCompleted)):i.OsfManifestManager.getManifestAsync(a,Function.createDelegate(n,n._onGetManifestCompleted))}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(this._etoken=e.value),i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))},_retryActivation:function(){var e=this;e._retryLoadingNum--,e._pageStatus===i.OsfControlPageStatus.Ready||e._retryLoadingNum<=0?(e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id),e._retryLoadingNum=2):e._refresh()},_iframeOnLoad:function(){var e=this;s.AppLoadTimeHelper.PageLoaded(this._telemetryContext);e._pageStatus!==i.OsfControlPageStatus.Ready?e._timer=window.setTimeout((function(){!function(e){var t=null;if(e){if(e._contextActivationMgr._ErrorUXHelper&&(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.SelectionTimeout),e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id)),e._pageStatus!==i.OsfControlPageStatus.Ready)if(2===e._retryLoadingNum){var n=i.ErrorStatusCodes.WAC_AgaveActivationError;switch(e._pageStatus){case i.OsfControlPageStatus.FailedOriginCheck:n=i.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case i.OsfControlPageStatus.FailedPermissionCheck:n=i.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case i.OsfControlPageStatus.FailedHandleRequest:n=i.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()?e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n):e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else 1===e._retryLoadingNum&&(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()?e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR_FirstParty,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading):e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading));else e._notifyHostIFrameOnLoaded();e._timer&&(window.clearTimeout(e._timer),e._timer=t),e._pageIsReadyTimerExpired=!0}}(e)}),5e3*e._retryLoadingNum+1):e._notifyHostIFrameOnLoaded()},_isOsfControlInEmbeddingMode:function(e){var t=!1;try{t=null!=e.getContainingDiv().parentNode.parentNode.id.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/gi)}catch(e){l.WACUtils.logExceptionToBrowserConsole("_isOsfControlInEmbeddingMode error.",e)}return t},_createIframeAndActivateOsfControl:function(e){var t=this._createIframeForControl(e);this._activate(t,this._iframeUrl)},_createIframeForControl:function(e){var t,n=this,r=document.createElement("iframe");for(var a in r.setAttribute("id",n._id),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),t=n._contextActivationMgr._enableFirstPartySDXErrorMessages&&n.isFirstParty()?Strings.OsfRuntime.L_IframeTitle_TXT_FirstParty+" "+e:Strings.OsfRuntime.L_IframeTitle_TXT+" "+e,r.setAttribute("title",t),r.style.msUserSelect="element",n._setSandboxAttribute(r),n._contextActivationMgr._iframeAttributeBag)r.setAttribute(a,n._contextActivationMgr._iframeAttributeBag[a]);return n._frame=r,r},_setSandboxAttribute:function(e){e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"),e.setAttribute("allow","geolocation;microphone;camera")},_onGetManifestCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.ManifestRequestEnd(n._telemetryContext),s.AppLoadTimeHelper.ServerCallEnd(n._telemetryContext);var r=e.value,a=e.context,o=a.referenceInUse,c=o.storeType,u=r.getDefaultDisplayName();if(n._manifest=r,a.manifestCached&&!a.retried){var d=r.getMarketplaceVersion();if(n._lessThan(d,o.version)&&c===i.StoreType.SPApp)return void n._refresh({clearCache:!0,referenceInUse:o,osfControl:a.osfControl,retried:!0})}if(!1===r.requirementsSupported||void 0===r.requirementsSupported&&!n._contextActivationMgr.getRequirementsChecker().isManifestSupported(r)){r.requirementsSupported=!1;var f,p;return f=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,p=i.ErrorStatusCodes.WAC_AgaveRequirementsError,void n._showActivationError(i.OsfControlStatus.ActivationFailed,f,t,t,null,t,t,!0,p)}if(r.requirementsSupported=!0,n._iframeUrl=r.getDefaultSourceLocation(n._contextActivationMgr.getFormFactor()),c===i.StoreType.Sdx&&n._iframeUrl&&n.updateUrlsForSdxBundle(),n._permission=r.getPermission(),n._appDomains=r.getAppDomains(),c===i.StoreType.SPApp&&n._iframeUrl&&(a.clientId&&(n._iframeUrl=n._iframeUrl.replace(/~clientid/gi,a.clientId)),a.appWebUrl&&(n._iframeUrl=n._iframeUrl.replace(/~appweburl/gi,a.appWebUrl)),a.remoteAppUrl&&(n._iframeUrl=n._iframeUrl.replace(/~remoteappurl/gi,a.remoteAppUrl))),!n._contextActivationMgr._doesUrlHaveSupportedProtocol(n._iframeUrl))return void n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);n.processManifestForCustomFunctions(r),n._isvirtualOsfControl?!a.showNewerVersion&&n.invokeVirtualOsfControlActivationCallback(r):n._createIframeAndActivateOsfControl(u)}else s.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+l.WACUtils.serializeObjectToString(e),t,t,18420422),n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},isCustomFunctionSandbox:function(){var e=this;if("object"==typeof e._settings&&"number"==typeof e._settings.length)for(var t=0;t<e._settings.length;t++)if("object"==typeof e._settings[t]&&"number"==typeof e._settings[t].length&&"string"==typeof e._settings[t][0]&&"string"==typeof e._settings[t][1]&&"customfunctionaddinid"==e._settings[t][0].toLowerCase())return!0;return!1},processManifestForCustomFunctions:function(e){var t=this,n=t;if((!t._isManifestProcessedForCustomFunctions||t._isUpgrading)&&(t._isManifestProcessedForCustomFunctions=!0,(t.getReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted||t.getReason()===Microsoft.Office.WebExtension.InitializationReason.DocumentOpened)&&e.containsCustomFunctionsForAppHost(t._contextActivationMgr._hostType))){var r=i.getManifestHostType(t._contextActivationMgr._hostType),o=t._contextActivationMgr.getFormFactor(),s=new l.Parser.ParsingContext(r,o,null,e),c=new l.Parser.AddinCommandsManifestParser(r,o),u={assetId:t._marketplaceID,appVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetType:null},d={setErrorMessageForAddin:function(e,t){a.msAjaxDebug.trace("Error parsing app manifest: "+t)}},f=c.parseExtensions(u,e,d);if("object"==typeof f.ExtensionPoints&&"number"==typeof f.ExtensionPoints.length)for(var p=0;p<f.ExtensionPoints.length;p++)if("CustomFunctions"===f.ExtensionPoints[p].type){var m=f.ExtensionPoints[p],g=function(){var t={osfControl:n,namespace:s.resources.ShortStrings[m.namespaceResId],metadataUrl:s.resources.Urls[m.metadataResId],manifest:e._xmlProcessor.getNodeXml(e._xmlProcessor.getDocumentElement())};n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.InstallCustomFunctions,t)};t.isCustomFunctionSandbox()?(t._iframeUrl=s.resources.Urls[m.pageResId],t._isUpgrading&&g()):g();break}}},setIsUpgrading:function(e){this._isUpgrading=e},getIsUpgrading:function(){return this._isUpgrading},updateUrlsForSdxBundle:function(e){var t=this;if(t._contextActivationMgr._enableServiceDeliveredExperience){var n=".js";t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n&&(t._bundleUrl=t._iframeUrl,t._iframeUrl=null!=e?e:t._sdxIframeTemplateUrl)}},_lessThan:function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},_showTrustError:function(e,t,n,r,a,o,s,c){var u=null,l=this,d=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,t||"");d=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var f=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,n||"");f=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(f);var p=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveUntrusted_INFO,d,f);c=null==c?!!l.getManifest()&&l.getManifest().isSSOAddin():c;var m=Strings.OsfRuntime.L_ActivateButton_TXT,g=i.NotificationType.TrustYellowBar,v=Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,h=c&&l._storeType===i.StoreType.OMEX?l._contextActivationMgr.getOmexIframeNotificationUrl(l._id,i.NotificationType.TrustYellowBar):u;l._contextActivationMgr._enableNewTrustPromptForAddIn&&(p=Strings.OsfRuntime.L_AgaveTrustAddIn_INFO,m=Strings.OsfRuntime.L_TrustButton_TXT,g=l._osfControlType===i.OsfControlType.DocumentLevel?i.NotificationType.TrustPromptContent:i.NotificationType.TrustPromptTaskpane),l._retryActivate=o,l._contextActivationMgr.displayNotification({id:l._id,infoType:i.InfoType.SecurityInfo,clientName:e,name:t||u,provider:n,title:v,description:p,icon:r||u,buttonTxt:m,buttonCallback:o,url:s||u,dismissCallback:u,reDisplay:!0,displayDeactive:!0,logAsError:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED,iframeNotificationUrl:h,notificationType:g})},showConsentError:function(e,t,n){var r=this;r._retryActivate=e,r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.SecurityInfo,title:"",description:"",icon:null,buttonCallback:e,dismissCallback:null,reDisplay:!0,displayDeactive:!1,retryAll:!0,errorCode:i.ErrorStatusCodes.WAC_SSOAddinRequireConsent,iframeNotificationUrl:r._contextActivationMgr.getOmexIframeNotificationUrl(r._id,t,n),notificationType:t})},_showActivationError:function(e,t,n,r,a,o,s,c,u){var l=!0,d=null,f=this;if(f._status=e,f._contextActivationMgr._enableFirstPartySDXErrorMessages&&f.isFirstParty())var p={id:f._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:a||d,dismissCallback:o||d,reDisplay:!o&&l,displayDeactive:l,detailView:!!c&&l,logAsError:l,errorCode:u||0};else p={id:f._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:a||d,dismissCallback:o||d,reDisplay:!o&&l,displayDeactive:l,detailView:!!c&&l,logAsError:l,errorCode:u||0};f._contextActivationMgr.displayNotification(p),f._contextActivationMgr.raiseOsfControlStatusChange(f)},_showActivationWarning:function(e,t,n,r,a,o,s){var c=!0,u=null,l=this;if(l._status=e,l._contextActivationMgr._enableFirstPartySDXErrorMessages&&l.isFirstParty())var d={id:l._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT_FirstParty,description:t,icon:u,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||u,url:a||u,dismissCallback:o||u,reDisplay:!o&&c,displayDeactive:c,logAsError:c,errorCode:s||0};else d={id:l._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:t,icon:u,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||u,url:a||u,dismissCallback:o||u,reDisplay:!o&&c,displayDeactive:c,logAsError:c,errorCode:s||0};l._contextActivationMgr.displayNotification(d),l._contextActivationMgr.raiseOsfControlStatusChange(l)},_refresh:function(e){this.deActivate(),this.activate(e)},_activateAgavesBlockedBySandboxNotSupport:function(e){e.activateAgavesBlockedBySandboxNotSupport();var t=i.OUtil.getLocalStorage();t&&t.setItem(i.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(e){this._contextActivationMgr._setCachedFlag(e)},_getCachedFlag:function(e){return this._contextActivationMgr._getCachedFlag(e)},_deleteCachedFlag:function(e){this._contextActivationMgr._deleteCachedFlag(e)},_notifyHostIFrameOnLoaded:function(){this._contextActivationMgr._notifyHost&&this._contextActivationMgr._notifyHost(this._id,i.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var t=document.createElement("a");t.href=e;var n=this.getEToken(),r=i.Constants.ETokenParameterName+"="+encodeURIComponent(i.OUtil.encodeBase64(n)),a=t.search.length>1?t.search.substr(1)+"&":"";t.search=a+r;var o=t.href;return t=null,o},_activate:function(e,t){var n=this;s.AppLoadTimeHelper.PageStart(n._telemetryContext),n._setIframeAttribute(e,t),n._pageIsReadyTimerExpired=!1,i.OUtil.addEventListener(e,"load",n._iframeOnLoadDelegate),n._div.appendChild(e),n._status=i.OsfControlStatus.Activated,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationEnd),n._contextActivationMgr.raiseOsfControlStatusChange(n),s.AppLoadTimeHelper.OfficeJSStartToLoad(n._telemetryContext)},_setIframeAttribute:function(e,t){var n=this;t=n._addETokenAsQueryParameter(t);var r=n._contextActivationMgr.getClientId()+"_"+n._contextActivationMgr.getDocUrl()+"_"+n._id,a=i.OUtil.getFrameName(r);n._conversationId=i.OUtil.generateConversationId();var o=[n._contextActivationMgr._hostType,n._contextActivationMgr._hostPlatform,n._contextActivationMgr._hostSpecificFileVersion,n._contextActivationMgr._appUILocale,n.getCorrelationId(),n._isDialog?"isDialog":null,n._contextActivationMgr._disableLogging?"disableLogging":null].join("|"),s=t,c=window.location.href,u=n._conversationId+"|"+n._id+"|"+(c.indexOf("$")>=0?encodeURIComponent(c):c),d={};d[i.WindowNameItemKeys.BaseFrameName]=a,d[i.WindowNameItemKeys.HostInfo]=o,d[i.WindowNameItemKeys.XdmInfo]=u,d[i.WindowNameItemKeys.SerializerVersion]=i.SerializerVersion.Browser;var f=i.OUtil.getLocalStorage();if(f){var p="CustomFunctionsRuntimeLogging",m=f.getItem(p);m&&(d[p]=m)}n._contextActivationMgr._getServiceEndPoint().registerConversation(n._conversationId,s,n._appDomains),e.setAttribute("src",s),n._agaveWindowName=l.WACUtils.serializeObjectToString(d),e.setAttribute("name",n._agaveWindowName),i.OUtil.addClass(e,"AddinIframe"),n._agavePageUrl=s},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{get:function(){return this.desc},set:function(e){this.desc=e}}),e=!0}catch(e){}return e},_isAddinCommands:function(e){var t=this;if(t._isvirtualOsfControl)e(!0);else if(t._contextActivationMgr._enableAddinCommands&&t._contextActivationMgr._enableTaskpaneUpgradeToAppCommand&&null!=t._virtualOsfControlActivationCallback){var n={marketplaceId:t._marketplaceID,marketplaceVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetData:{}};t._contextActivationMgr.isAddinCommandsAsync(n,(function(t,n){e(n)}))}else e(!1)}},i.OUtil.setNamespace("Manifest",i),i.Manifest.HostApp=function(e){this._appName=e,this._minVersion=null},i.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(e){this._minVersion=e}},i.Manifest.ExtensionSettings=function(){this._sourceLocations={},this._defaultHeight=null,this._defaultWidth=null},i.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(e,t){this._sourceLocations[e.toLocaleLowerCase()]=t},_setDefaultWidth:function(e){this._defaultWidth=e},_setDefaultHeight:function(e){this._defaultHeight=e}},i.Manifest.WebAppInfoAuthorization=function(){this._resource=null,this._scopes=null},i.Manifest.WebAppInfoAuthorization.prototype={getResource:function(){return this._resource},getScopes:function(){return this._scopes}},i.Manifest.Manifest=function(e,t){var n="o:OfficeApp",r="1.1",o=this;if(o._UILocale=t||"en-us","string"==typeof e){var s;o._displayNames={},o._descriptions={},o._iconUrls={},o._extensionSettings={},o._highResolutionIconUrls={},o._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces[r]),o._xmlProcessor.selectSingleNode(n)?(s=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Hosts",u);e._hosts=e._parseHosts(t),t&&(e._hostsXml=t.xml||t.outerHTML);t=e._xmlProcessor.selectSingleNode("o:Requirements",u),e._requirements=e._parseRequirements(t),t&&(e._requirementsXml=t.xml||t.outerHTML);(t=e._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",u))&&e._parseLocaleAwareSettings(t,Function.createDelegate(e,e._addHighResolutionIconUrl))},o._manifestSchemaVersion=i.ManifestSchemaVersion[r]):(o._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces["1.0"]),s=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Capabilities",u),n=e._xmlProcessor.selectNodes("o:Capability",t);e._capabilities=e._parseCapabilities(n)},o._manifestSchemaVersion=i.ManifestSchemaVersion["1.0"]);var c=o._xmlProcessor.getDocumentElement();o._target=i.OUtil.parseEnum(c.getAttribute("xsi:type"),i.OfficeAppType);var u=o._xmlProcessor.selectSingleNode(n);if(c=o._xmlProcessor.selectSingleNode("o:Id",u),o._id=o._xmlProcessor.getNodeValue(c),!new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i").test(o._id))throw a.msAjaxError.argument("Manifest");if(c=o._xmlProcessor.selectSingleNode("o:Version",u),o._version=o._xmlProcessor.getNodeValue(c),c=o._xmlProcessor.selectSingleNode("o:ProviderName",u),o._providerName=o._xmlProcessor.getNodeValue(c),c=o._xmlProcessor.selectSingleNode("o:IdIssuer",u),o._idIssuer=o._parseIdIssuer(c),(c=o._xmlProcessor.selectSingleNode("o:AlternateId",u))&&(o._alternateId=o._xmlProcessor.getNodeValue(c)),c=o._xmlProcessor.selectSingleNode("o:DefaultLocale",u),o._defaultLocale=o._xmlProcessor.getNodeValue(c),c=o._xmlProcessor.selectSingleNode("o:DisplayName",u),o._parseLocaleAwareSettings(c,Function.createDelegate(o,o._addDisplayName)),c=o._xmlProcessor.selectSingleNode("o:Description",u),o._parseLocaleAwareSettings(c,Function.createDelegate(o,o._addDescription)),c=o._xmlProcessor.selectSingleNode("o:AppDomains",u),o._appDomains=o._parseAppDomains(c),(c=o._xmlProcessor.selectSingleNode("o:IconUrl",u))&&o._parseLocaleAwareSettings(c,Function.createDelegate(o,o._addIconUrl)),(c=o._xmlProcessor.selectSingleNode("o:Signature",u))&&(o._signature=o._xmlProcessor.getNodeValue(c)),o._parseExtensionSettings(),c=o._xmlProcessor.selectSingleNode("o:Permissions",u),o._permissions=o._parsePermission(c),o._allowSnapshot=!0,(c=o._xmlProcessor.selectSingleNode("o:AllowSnapshot",u))&&(o._allowSnapshot=o._parseBooleanNode(c)),o._manifestSchemaVersion===i.ManifestSchemaVersion[r]){var l="ov:";if(o._target==i.OfficeAppType.ContentApp&&(l="c:"),c=o._xmlProcessor.selectSingleNode(l+"VersionOverrides",u)){var d=o._xmlProcessor.selectSingleNode(l+"WebApplicationInfo",c);if(d){var f=o._xmlProcessor.selectSingleNode(l+"Resource",d);o._webApplicationResource=o._xmlProcessor.getNodeValue(f);var p=o._xmlProcessor.selectSingleNode(l+"Id",d);o._webApplicationId=o._xmlProcessor.getNodeValue(p);var m=o._xmlProcessor.selectSingleNode(l+"Scopes",d);o._webApplicationScopes=o._parseWebApplicationScopes(m,l),o._webApplicationAuthorizations=o._parseWebAppInfoAuthorizations(d,l)}}}if(o._manifestSchemaVersion===i.ManifestSchemaVersion[r]){var g=o._xmlProcessor.selectSingleNode("ov:VersionOverrides",u);g&&(o._manifestSourceLocationOverrides=o._parseSourceLocationOverrides(g))}s.apply(o)}else e(o)},i.Manifest.Manifest.prototype={getSourceLocationOverrideByResourceId:function(e){return e&&this._manifestSourceLocationOverrides?this._manifestSourceLocationOverrides[e]:null},getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(e){return this._displayNames[e.toLocaleLowerCase()]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(e){return this._descriptions[e]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(e){return this._iconUrls[e]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(e,t){return this._getExtensionSetting(t).getSourceLocations()[e.toLocaleLowerCase()]},getDefaultSourceLocation:function(e){var t=this._getExtensionSetting(e).getSourceLocations();return this._getDefaultValue(t)},getDefaultWidth:function(e){return this._getExtensionSetting(e).getDefaultWidth()},getDefaultHeight:function(e){return this._getExtensionSetting(e).getDefaultHeight()},getTarget:function(){return this._target},getOmexTargetCode:function(){switch(this._target){case i.OfficeAppType.ContentApp:return 2;case i.OfficeAppType.TaskPaneApp:return 1;case i.OfficeAppType.MailApp:return 3;default:return 0}},getPermission:function(){return this._permissions},hasPermission:function(e){return(this._permissions&e)===e},getHosts:function(){return this._hosts},getHostsXml:function(){return this._hostsXml},getRequirements:function(){return this._requirements},getRequirementsXml:function(){return this._requirementsXml},getHighResolutionIconUrl:function(e){return this._highResolutionIconUrls[e]},getDefaultHighResolutionIconUrl:function(){return this._getDefaultValue(this._highResolutionIconUrls)},getAppDomains:function(){return this._appDomains},getInMemoryEToken:function(){return this._inMemoryEToken},isAllowSnapshot:function(){return this._allowSnapshot},addManifestUrl:function(e){var t=l.WACUtils.getDomainForUrl(e);-1===this._appDomains.indexOf(t)&&this._appDomains.push(t)},getWebApplicationResource:function(){return this._webApplicationResource},getWebApplicationId:function(){return this._webApplicationId},getWebApplicationScopes:function(){return this._webApplicationScopes},getWebApplicationAuthorizations:function(){return this._webApplicationAuthorizations},isSSOAddin:function(){return!!this._webApplicationResource&&!!this._webApplicationId},containsAddinCommands:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t&&null!=this._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",t))return!0;return!1},containsCustomFunctions:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t){var n=this._xmlProcessor.selectSingleNode("ov:AllFormFactors",t);if(null!==n){var r=this._xmlProcessor.selectNodes("ov:ExtensionPoint",n);if(null!==r)for(var a=r.length,i=0;i<a;i++){if("CustomFunctions"===r[i].getAttribute("xsi:type"))return!0}}}return!1},containsCustomFunctionsForAppHost:function(e){var t=i.getManifestHostType(e);return e!=i.HostType.Outlook&&this.containsCustomFunctions(t)},_getDefaultValue:function(e){var t,n=this;if(n._UILocale&&(t=e[n._UILocale]||e[n._UILocale.toLocaleLowerCase()]||void 0),!t&&n._defaultLocale&&(t=e[n._defaultLocale]||e[n._defaultLocale.toLocaleLowerCase()]||void 0),!t){var r;for(var a in e){r=a;break}t=e[r]}return t},_getExtensionSetting:function(e){var t,n=this;if(void 0!==n._extensionSettings[e])t=n._extensionSettings[e];else for(var r in n._extensionSettings){t=n._extensionSettings[r];break}return t},_addDisplayName:function(e,t){this._displayNames[e.toLocaleLowerCase()]=t},_addDescription:function(e,t){this._descriptions[e]=t},_addIconUrl:function(e,t){this._iconUrls[e]=t},_parseLocaleAwareSettings:function(e,t){if(!e)throw a.msAjaxError.argument("Manifest");var n=e.getAttribute("DefaultValue");t(this._defaultLocale,n);var r=this._xmlProcessor.selectNodes("o:Override",e);if(r)for(var i=r.length,o=0;o<i;o++){var s=r[o];t(s.getAttribute("Locale"),s.getAttribute("Value"))}},_parseBooleanNode:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e).toLowerCase();return"true"===t||"1"===t}return!1},_parseIdIssuer:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.ManifestIdIssuer)}return i.ManifestIdIssuer.Custom},_parseCapabilities:function(e){for(var t,n=[],r=0;r<e.length;r++){t=e[r].getAttribute("Name"),t=i.OUtil.parseEnum(t,i.Capability),n.push(t)}return n},_parsePermission:function(e){if(!e)throw a.msAjaxError.argument("Manifest");var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.OsfControlPermission)},_parseExtensionSettings:function(){var e,t,n,r=this,o=r;for(var s in i.FormFactor){var c=r._xmlProcessor.selectSingleNode("o:OfficeApp");if(t=r._xmlProcessor.selectSingleNode("o:"+i.FormFactor[s],c)){e=new i.Manifest.ExtensionSettings,n=r._xmlProcessor.selectSingleNode("o:SourceLocation",t);r._parseLocaleAwareSettings(n,(function(t,n){e._addSourceLocation(t,n),o.addManifestUrl(n)})),(n=r._xmlProcessor.selectSingleNode("o:RequestedWidth",t))&&e._setDefaultWidth(r._xmlProcessor.getNodeValue(n)),(n=r._xmlProcessor.selectSingleNode("o:RequestedHeight",t))&&e._setDefaultHeight(r._xmlProcessor.getNodeValue(n)),r._extensionSettings[s]=e}}if(!e)throw a.msAjaxError.argument("Manifest")},_parseHosts:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Host",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseWebApplicationScopes:function(e,t){var n=[];if(e)for(var r=this._xmlProcessor.selectNodes(t+"Scope",e),a=0;a<r.length;a++)n.push(this._xmlProcessor.getNodeValue(r[a]));return n},_parseWebAppInfoAuthorizations:function(e,t){var n=this,r=[],a=n._xmlProcessor.selectSingleNode(t+"Authorizations",e);if(a){var o=n._xmlProcessor.selectNodes(t+"Authorization",a);if(o)for(var s in o){var c=o[s],u=new i.Manifest.WebAppInfoAuthorization,l=n._xmlProcessor.selectSingleNode(t+"Resource",c);l&&(u._resource=n._xmlProcessor.getNodeValue(l));var d=n._xmlProcessor.selectSingleNode(t+"Scopes",c);if(d){var f=n._xmlProcessor.selectNodes(t+"Scope",d);if(f){var p=[];for(var m in f){var g=f[m];p.push(n._xmlProcessor.getNodeValue(g))}u._scopes=p}}r.push(u)}}return r},_parseRequirements:function(e){var t=this,n={sets:[],methods:[]};if(e){var r=t._xmlProcessor.selectSingleNode("o:Sets",e);n.sets=t._parseSets(r);var a=t._xmlProcessor.selectSingleNode("o:Methods",e);n.methods=t._parseMethods(a)}return n},_parseSets:function(e){var t=[];if(e)for(var n=e.getAttribute("DefaultMinVersion"),r=this._xmlProcessor.selectNodes("o:Set",e),a=0;a<r.length;a++){var i=r[a],o=i.getAttribute("MinVersion");t.push({name:i.getAttribute("Name"),version:o||n})}return t},_parseMethods:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Method",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseSourceLocationOverrides:function(e){var t={};if(e){var n=this._xmlProcessor.selectSingleNode("ov:Resources",e);if(n){var r=this._xmlProcessor.selectSingleNode("bt:Urls",n);if(r){var a=this._xmlProcessor.selectNodes("bt:Url",r);if(a)for(var i=0;i<a.length;i++){var o=a[i],s=o.getAttribute("id"),c=o.getAttribute("DefaultValue");s&&c&&(t[s]=c)}}}}return t},_parseAppDomains:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:AppDomain",e),r=0;r<n.length;r++){var a=l.WACUtils.getDomainForUrl(this._xmlProcessor.getNodeValue(n[r]));-1===t.indexOf(a)&&t.push(a)}return t},_addHighResolutionIconUrl:function(e,t){this._highResolutionIconUrls[e]=t},_isAddinCommandsManifest:function(e){return this.containsAddinCommands(e)||this.containsCustomFunctions(e)},_getCurrentHostTypeNode:function(e){var t=null,n=this,r=n._xmlProcessor.selectSingleNode("o:OfficeApp");if(r!==t&&n.getManifestSchemaVersion()===i.ManifestSchemaVersion[1.1]){var a=n._xmlProcessor.selectSingleNode("ov:VersionOverrides",r);if(a!==t){var o=n._xmlProcessor.selectSingleNode("ov:Hosts",a);if(o!==t){var s=n._xmlProcessor.selectNodes("ov:Host",o);if(s!==t)for(var c=s.length,u=0;u<c;u++){if(s[u].getAttribute("xsi:type")===e)return s[u]}}}}return t}},i.OsfManifestManager=function(){var e="undefined",t="marketplaceVersion",n="marketplaceID",r=null,a=!0,o=!1,c={},u="en-us",d={};function f(e,t){return e+"_"+t}return{getManifestAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o}},t);var n=e.referenceInUse,u=f(n.id,n.version),d=c[u];if(e.manifestCached=o,d)e.manifestCached=a,t({statusCode:i.ProxyCallStatusCode.Succeeded,value:d,context:e});else if(e.clientEndPoint&&e.manifestUrl){s.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);var p={manifestUrl:e.manifestUrl,id:n.id,version:n.version,clearCache:e.clearCache||o};this._invokeProxyMethodAsync(e,"OEM_getManifestAsync",(function(e){var o;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value)try{var c;o=e.context.osfControl,"string"==typeof e.value?(e.context.manifestCached=a,c=e.value):(e.context.manifestCached=e.value.cached,c=e.value.manifest),s.AppLoadTimeHelper.SetManifestDataCachedFlag(o._telemetryContext,e.value.cached),e.value=new i.Manifest.Manifest(c,o._contextActivationMgr.getAppUILocale()),i.OsfManifestManager.cacheManifest(n.id,n.version,e.value)}catch(t){var u;e.value=r,o&&(u=o._appCorrelationId);var d="Invalid manifest in getManifestAsync.";l.WACUtils.logExceptionToBrowserConsole(d,t),s.RuntimeTelemetryHelper.LogExceptionTag(d,t,u,18420423)}else s.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+l.WACUtils.serializeObjectToString(e),r,r,18420424);t(e)}),p)}else t({statusCode:i.ProxyCallStatusCode.Failed,value:r,context:e})},getAppInstanceInfoByIdAsync:function(e,t){i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:o},appInstanceId:{type:String,mayBeNull:o},clientEndPoint:{type:Object,mayBeNull:o}},t);var n={webUrl:e.webUrl,appInstanceId:e.appInstanceId,clearCache:e.clearCache||o};this._invokeProxyMethodAsync(e,"OEM_getSPAppInstanceInfoByIdAsync",t,n)},getSPTokenByProductIdAsync:function(e,t){i.OUtil.validateParamObject(e,{appWebUrl:{type:String,mayBeNull:o},productId:{type:String,mayBeNull:o}},t);var n=this;e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.appWebUrl,(function(a){if(a){var s={webUrl:e.appWebUrl,productId:e.productId,clearCache:e.clearCache||o,clientEndPoint:a};n._invokeProxyMethodAsync(e,"OEM_getSPTokenByProductIdAsync",t,s)}else t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:r,context:e})}))},getSPAppEntitlementsAsync:function(e,t){var n="/";if(i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o},baseUrl:{type:String,mayBeNull:o},pageUrl:{type:String,mayBeNull:o},webUrl:{type:String,mayBeNull:a}},t),e.webUrl)this.getCorporateCatalogEntitlementsAsync(e,t);else{var s=document.createElement("a");s.href=e.pageUrl;var c=s.pathname,u=c.split(n),l=u.length-1,d=s.href.substring(0,s.href.length-c.length);d&&d.charAt(d.length-1)!==n&&(d+=n);for(var f=[d],p=0;p<l;p++)u[p]&&(d=d+u[p]+n,f.push(d));s=r;var m=this,g=e.osfControl._contextActivationMgr,v=f.pop(),h=function(e){if(e.statusCode===i.ProxyCallStatusCode.Succeeded){var r=e.value;r&&r.charAt(r.length-1)!==n&&(r+=n),g._webUrl=r,e.context.webUrl=r,e.context.appWebUrl=r,m.getCorporateCatalogEntitlementsAsync(e.context,t)}else t(e)},b=function(n){if(n){e.clientEndPoint=n;var a={pageUrl:e.pageUrl,baseUrl:v,clearCache:e.clearCache||o};m._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",h,a)}else f.length>0?(v=f.pop(),g._createSharePointIFrameProxy(v,b)):t({statusCode:i.ProxyCallStatusCode.Failed,value:r,context:e})};g._createSharePointIFrameProxy(v,b)}},getOneDriveEntitlementsAsync:function(e,t){var n="Content-Type",r=e.referenceInUse.storeLocator,a=e.referenceInUse.storeLocator+"/root:/Manifests",o=i.OneDriveOAuth.getAccessTokenFromCookie(),s="?access_token="+o,c=a+s,u=new XMLHttpRequest,l=new XMLHttpRequest;u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){var t=JSON.parse(u.response).id,r=e.referenceInUse.storeLocator+"/items/"+t+"/children"+s;l.open("GET",r),l.setRequestHeader(n,"json"),l.send()}};var d=[],f=0,p=0,m=function(){f==p&&t({statusCode:i.ProxyCallStatusCode.Succeeded,value:{entitlements:d},context:e})},g=function(e,t){p++;var n=t;try{var r=new i.Manifest.Manifest(e.responseText),a=[];a.push(r.getDefaultDisplayName()),a.push(n),a.push(r.getDefaultDescription()),a.push(r.getTarget()),a.push(r.getMarketplaceVersion()),a.push(n),a.push(i.StoreType.OneDrive),a.push(r.getDefaultWidth()||0),a.push(r.getDefaultHeight()||0),a.push(r.getDefaultIconUrl()),a.push(r.getProviderName()),a.push(r.getDefaultLocale()),a.push(i.StoreType.OneDrive),d.push(a)}catch(e){}m()},v=function(){p++,m()};l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){for(var e=JSON.parse(l.responseText),t=0;t<e.value.length;t++)if(".xml"==e.value[t].name.substr(e.value[t].name.length-4).toLowerCase()){var n=r+"/root:/Manifests/"+e.value[t].name+":/content?access_token="+o;i.OUtil.xhrGetFull(n,e.value[t].name,g,v),f++}m()}},u.open("GET",c),u.setRequestHeader(n,"json"),u.send()},getCorporateCatalogEntitlementsAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o},webUrl:{type:String,mayBeNull:o}},t),s.AppLoadTimeHelper.AuthenticationStart(e.osfControl._telemetryContext);var n=this,c=0,u=function(l){if(l){s.AppLoadTimeHelper.AuthenticationEnd(e.osfControl._telemetryContext),e.clientEndPoint=l;var d={webUrl:e.webUrl,applicationName:i.HostCapability[e.hostType],officeExtentionTarget:e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?r:e.osfControl.getOsfControlType(),clearCache:e.clearCache||o,supportedManifestVersions:{"1.0":a,1.1:a}};n._invokeProxyMethodAsync(e,"OEM_getEntitlementSummaryAsync",t,d)}else c<i.Constants.AuthenticatedConnectMaxTries?(c++,setTimeout((function(){e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,u)}),500)):t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:r,context:e})};e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,u)},_invokeProxyMethodAsync:function(e,t,n,a){var o,c=[a.clientEndPoint?a.clientEndPoint._targetUrl:e.clientEndPoint._targetUrl,t];for(var u in a)("string"===(o=typeof a[u])||"number"===o||"boolean"===o)&&c.push(a[u]);var f=c.join("."),p=d,m={onCompleted:n,context:e,methodName:t},g=p[f];if(g)g.push(m);else{p[f]=[m];var v=e.clientEndPoint;a.clientEndPoint&&(v=a.clientEndPoint,delete a.clientEndPoint),e.referenceInUse&&e.referenceInUse.storeType===i.StoreType.OMEX&&(a.officeVersion=i.Constants.ThreePartsFileVersion),v.invoke(t,(function(e,t){var n=r,a=i.ProxyCallStatusCode.Failed;0===e&&t.status&&(n=t.result,a=i.ProxyCallStatusCode.Succeeded);var o=p[f];delete p[f];for(var c=o.length,u=0;u<c;u++){var d,m=o.shift();try{m.context&&m.context.osfControl&&(d=m.context.osfControl._appCorrelationId),t&&t.failureInfo&&s.RuntimeTelemetryHelper.LogProxyFailure(d,m.methodName,t.failureInfo),m.onCompleted({statusCode:a,value:n,context:m.context})}catch(e){var g="_invokeProxyMethodAsync failed.";l.WACUtils.logExceptionToBrowserConsole(g,e),s.RuntimeTelemetryHelper.LogExceptionTag(g,e,d,18420425)}}}),a)}},removeOmexCacheAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o},clientEndPoint:{type:Object,mayBeNull:o}},t);var n=e.referenceInUse,r={applicationName:e.hostType,assetID:n.id,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||o,clearToken:e.clearToken||o,clearAppState:e.clearAppState||o,clearManifest:e.clearManifest||o,appVersion:e.appVersion};e.anonymous?r.contentMarket=n.storeLocator:(r.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,r.userContentMarket=n.storeLocator),this._invokeProxyMethodAsync(e,"OMEX_removeCacheAsync",t,r)},purgeManifest:function(r,a){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o}]);if(i)throw i;var s=f(r,a);typeof c[s]!=e&&delete c[s]},cacheManifestFromXml:function(e,r,a,s){var c=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o},{name:"manifestXml",type:String,mayBeNull:o},{name:"uiLocale",type:String,mayBeNull:o}]);if(c)throw c;this.cacheManifest(e,r,new i.Manifest.Manifest(a,s))},cacheManifest:function(e,r,a){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o},{name:"manifest",type:Object,mayBeNull:o}]);if(i)throw i;var s=f(e,r);a._UILocale=a._UILocale||u,c[s]=a},hasManifest:function(r,i){var s=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o}]);if(s)throw s;var u=f(r,i);return typeof c[u]!=e?a:o},getCachedManifest:function(e,r){var a=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o}]);if(a)throw a;var i=f(e,r);return c[i]},versionLessThan:function(e,t){for(var n,r,a=e.split("."),i=t.split("."),s=Math.min(a.length,i.length),c=0;c<s;c++)try{if((n=parseFloat(a[c]))!=(r=parseFloat(i[c])))return n<r}catch(e){}if(a.length>=i.length)return o;s=i.length;var u=0;for(c=a.length;c<s;c++){try{r=parseFloat(i[c])}catch(e){r=0}u+=r}return u>0},_setUILocale:function(e){u=e}}}(),i.ManifestSchemaVersion={"1.0":"1.0",1.1:"1.1"},i.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',1.1:'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xmlns:c="http://schemas.microsoft.com/office/contentappversionoverrides"'},i.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3},i.RequirementsChecker=function(e,t,n,r,a){var i=this;i.setCapabilities(e),i.setHosts(t),i.setRequirements(n),i.setSupportedControlTargets(r),i.setSupportedOmexAppVersions(a),i.setFilteringEnabled(!1)},i.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.getManifestSchemaVersion()||i.ManifestSchemaVersion["1.0"]){case i.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(e);case i.ManifestSchemaVersion[1.1]:return this._checkManifest1_1(e);default:return!1}},isEntitlementFromOmexSupported:function(e){var t,n=this;if(!n.isFilteringEnabled())return!0;if(!e)return!1;switch(e.appSubType){case"1":t=i.OsfControlTarget.TaskPane;break;case"2":t=i.OsfControlTarget.InContent;break;case"3":t=i.OsfControlTarget.Contextual;break;case"4":t=i.OsfControlTarget.TaskPane;break;default:return!1}if(!n._checkControlTarget(t))return!1;if(!e.requirements&&!e.hosts)return!e.hasOwnProperty("appVersions")||void 0===e.appVersions||n._checkOmexAppVersions(e.appVersions);var r,a,o,s,c=new i.Manifest.Manifest((function(){}));return e.requirements&&(c._xmlProcessor=new i.XmlProcessor(e.requirements,i.ManifestNamespaces[1.1]),a=c._xmlProcessor.getDocumentElement()),r=c._parseRequirements(a),e.hosts&&(c._xmlProcessor=new i.XmlProcessor(e.hosts,i.ManifestNamespaces[1.1]),s=c._xmlProcessor.getDocumentElement()),o=c._parseHosts(s),n._checkHosts(o)&&n._checkSets(r.sets)&&n._checkMethods(r.methods)},isEntitlementFromCorpCatalogSupported:function(e){var t=this;if(!t.isFilteringEnabled())return!0;if(!e)return!1;var n=i.OfficeAppType[e.OEType];if(!t._checkControlTarget(n))return!1;var r,a,o,s,c,u=new i.Manifest.Manifest((function(){}));e.OfficeExtensionCapabilitiesXML&&(u._xmlProcessor=new i.XmlProcessor(e.OfficeExtensionCapabilitiesXML,i.ManifestNamespaces[1.1]),s=u._xmlProcessor.getDocumentElement(),a=(c=u._parseRequirements(s)).sets,o=c.methods,r=u._parseHosts(s));return t._checkHosts(r)&&t._checkSets(a)&&t._checkMethods(o)},setCapabilities:function(e){this._supportedCapabilities=this._scalarArrayToObject(e)},setHosts:function(e){this._supportedHosts=this._scalarArrayToObject(e)},setRequirements:function(e){var t=this;t._supportedSets=e&&t._arrayToSetsObject(e.sets)||{},t._supportedMethods=e&&t._scalarArrayToObject(e.methods)||{}},setSupportedControlTargets:function(e){this._supportedControlTargets=this._scalarArrayToObject(e)},setSupportedOmexAppVersions:function(e){this._supportedOmexAppVersions=e&&e.slice?e.slice(0):[]},setFilteringEnabled:function(e){this._filteringEnabled=!!e},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(e){return this._checkCapabilities(e.getCapabilities())},_checkCapabilities:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedCapabilities[e[t]])return!0;return!1},_checkManifest1_1:function(e){var t=e.getRequirements()||{};return this._checkHosts(e.getHosts())&&this._checkSets(t.sets)&&this._checkMethods(t.methods)},_checkHosts:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedHosts[e[t]])return!0;return!1},_checkSets:function(e){var t=this;if(!e||0===e.length)return!0;for(var n=0;n<e.length;n++){var r=e[n],a=t._supportedSets[r.name.toLowerCase()];if(!a)return!1;if(r.version&&(t._compareVersionStrings(a.minVersion||t.defaultMinMaxVersion,r.version)>0||t._compareVersionStrings(a.maxVersion||t.defaultMinMaxVersion,r.version)<0))return!1}return!0},_checkMethods:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(!this._supportedMethods[e[t]])return!1;return!0},_checkControlTarget:function(e){return null!=e&&this._supportedControlTargets[e]},_checkOmexAppVersions:function(e){if(!e)return!1;for(var t=0;t<this._supportedOmexAppVersions.length;t++)if(e.indexOf(this._supportedOmexAppVersions[t])>=0)return!0;return!1},_scalarArrayToObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++)null!=e[n]&&(t[e[n]]=!0);return t},_arrayToSetsObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];r&&null!=r.name&&(t[r.name.toLowerCase()]=r)}return t},_getSupportedSet:function(){for(var e={},t=Object.getOwnPropertyNames(this._supportedSets),n=0;n<t.length;n++){var r=this._supportedSets[t[n]];e[r.name.toLowerCase()]=r.maxVersion||this.defaultMinMaxVersion}return"undefined"!=typeof JSON?JSON.stringify(e):e},_compareVersionStrings:function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length),r=0;r<n;r++){var a=parseInt(e[r],10)||0,i=parseInt(t[r],10)||0;if(a!==i)return a-i}return 0}},l.appSpecificCheckOrigin=function(e,t,n,r){try{return!(!(t&&t.source&&t.source.location&&t.source.location.pathname)||t.source.location.pathname.indexOf("projection.aspx")<0)&&r(e,n)}catch(e){return!1}},window.OfficeExt=l},7224:function(e,t){e.exports={am:"am-et",ar:"ar-sa",bg:"bg-bg","bn-in":"bn-in",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es","es-mx":"es-mx",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr","fr-ca":"fr-ca",gl:"gl-es",gu:"gu-in",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",kn:"kn-in",ko:"ko-kr","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv",ml:"ml-in",mr:"mr-in",ms:"ms-my",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",pl:"pl-pl",pt:"pt-br","pt-pt":"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn","zh-hans":"zh-cn","zh-hant":"zh-tw"}},7225:function(e,t,n){var r=n(7226),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7226:function(e,t,n){t=e.exports=n(72)(!1);var r=n(1329)(n(7227));t.push([e.i,"._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel{top:48px}._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-contentInner{top:40px;position:absolute;overflow:visible}._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-contentInner .ms-Panel-content{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;min-height:400px;overflow:visible}html[dir] ._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-bottom:0}html[dir=ltr] ._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-contentInner .ms-Panel-content,html[dir=rtl] ._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-left:0;padding-right:0}._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-main{width:955px!important}html[dir=ltr] ._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-main{right:0!important;left:auto!important}html[dir=rtl] ._2kMn28Fclhfo_sfTK5e5Bv.ms-Panel .ms-Panel-main{left:0!important;right:auto!important}._15KVO4QPzvYs1m2bhsDtMo{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100vh - 80px);width:960px;overflow:hidden}.G8yoFNRH4eO7f8kyJ5ne8{position:absolute;top:6px;z-index:1000;cursor:pointer}html[dir] .G8yoFNRH4eO7f8kyJ5ne8{background:none}html[dir=ltr] .G8yoFNRH4eO7f8kyJ5ne8{left:901px}html[dir=rtl] .G8yoFNRH4eO7f8kyJ5ne8{right:901px}._15dHE2cOGhv_Ov5TDTiMM4{height:100%;width:100%}html[dir] ._15dHE2cOGhv_Ov5TDTiMM4{background:url("+r+");background-repeat:no-repeat;background-position:50%;padding-top:17px}._2SOcr4_T3SoNhUmLZ1nDoi{top:11px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._2SOcr4_T3SoNhUmLZ1nDoi{right:73px}html[dir=rtl] ._2SOcr4_T3SoNhUmLZ1nDoi{left:73px}._3F7RagqMfDnL1NrzskS768{height:100%;width:100%}html[dir] ._3F7RagqMfDnL1NrzskS768{background:url("+r+");background-repeat:no-repeat;background-position:50%}._19e8ZepABoka-jPlwIIF_5{top:-29px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._19e8ZepABoka-jPlwIIF_5{right:73px}html[dir=rtl] ._19e8ZepABoka-jPlwIIF_5{left:73px}",""]),t.locals={inClientStorePanelContainer:"_2kMn28Fclhfo_sfTK5e5Bv",container:"_15KVO4QPzvYs1m2bhsDtMo",closeButton:"G8yoFNRH4eO7f8kyJ5ne8",inClientStoreIFrameCenter:"_15dHE2cOGhv_Ov5TDTiMM4",FeedbackCommandBarCenter:"_2SOcr4_T3SoNhUmLZ1nDoi",inClientStoreIFrame:"_3F7RagqMfDnL1NrzskS768",FeedbackCommandBar:"_19e8ZepABoka-jPlwIIF_5"}},7227:function(e,t,n){e.exports=n.p+"../resources/images/progress-e4ba8e5c7eb8b6080aadb62c29bbf737.gif"},7228:function(e,t,n){var r=n(7229),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7229:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._37Fda6WfJOJiiR3vms2f3i{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;max-width:510px}html[dir] ._37Fda6WfJOJiiR3vms2f3i{margin:30px}",""]),t.locals={divContainer:"_37Fda6WfJOJiiR3vms2f3i"}},7230:function(e){e.exports=JSON.parse('{"b":"Nda","l":"Oda","c":"Pda","d":"Qda","e":"Rda","f":"Sda","g":"Tda","k":"Uda","h":"Vda","i":"Wda","j":"Xda","m":"Yda","n":"Zda","o":"_da","a":"$da"}')},7231:function(e,t,n){var r=n(7232),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7232:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'._35FjC3WF9MoHaA96_nmkPF{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._35FjC3WF9MoHaA96_nmkPF{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._35FjC3WF9MoHaA96_nmkPF .ms-Callout-main{overflow:hidden!important}._3aJfygwIsiE-a6ugF_-9MK{height:32px!important;color:inherit}html[dir] ._3aJfygwIsiE-a6ugF_-9MK{background-color:transparent}._3aJfygwIsiE-a6ugF_-9MK .ms-Button{height:32px}._3aJfygwIsiE-a6ugF_-9MK .is-expanded .ms-CommandBarItem-overflow,.y5HTBMEC0Ik6LA3LsA_Vo .ms-Button-label{color:"[theme:themePrimary, default:#0078D4]"!important}._1C_kN6v-4J2Nrr5ST9WGLl{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._1C_kN6v-4J2Nrr5ST9WGLl{padding:8px}html[dir=ltr] ._1C_kN6v-4J2Nrr5ST9WGLl{float:left}html[dir=rtl] ._1C_kN6v-4J2Nrr5ST9WGLl{float:right}._36RJ_gVN4jNeoXS0xazZtY{height:16px;width:0}html[dir] ._36RJ_gVN4jNeoXS0xazZtY{padding:0 0 0 0;margin:8px 0;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"!important}html[dir=ltr] ._36RJ_gVN4jNeoXS0xazZtY{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._36RJ_gVN4jNeoXS0xazZtY{border-left-width:1px;border-left-style:solid;float:right}._1RmIbFX5laaq5a6G3fX_ZE{width:570px;max-height:450px;min-height:32px}html[dir] ._1RmIbFX5laaq5a6G3fX_ZE{border-top-style:solid;border-top-width:1px;border-top-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={divContainer:"_35FjC3WF9MoHaA96_nmkPF",contextualBar:"_3aJfygwIsiE-a6ugF_-9MK",selected:"y5HTBMEC0Ik6LA3LsA_Vo",appIcon:"_1C_kN6v-4J2Nrr5ST9WGLl",divider:"_36RJ_gVN4jNeoXS0xazZtY",contextualAddinFrame:"_1RmIbFX5laaq5a6G3fX_ZE"}},7233:function(e){e.exports=JSON.parse('{"a":"Kda"}')},7234:function(e,t,n){var r=n(7235),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7235:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._3kAp1tVu6pGq9lEQgNBLTj{display:none}._1c_RfP_c6TXoIGXiDm5VDY{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none!important}html[dir] ._1c_RfP_c6TXoIGXiDm5VDY{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}",""]),t.locals={divContainer:"_3kAp1tVu6pGq9lEQgNBLTj",dialogContainer:"_1c_RfP_c6TXoIGXiDm5VDY"}},7236:function(e){e.exports=JSON.parse('{"a":"Mda"}')},7237:function(e){e.exports=JSON.parse('{"d":"aea","e":"bea","a":"cea","b":"dea","c":"eea"}')},7238:function(e,t,n){var r=n(7239),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7239:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'._35Uxh-lNCy7AIVxAkLQnf{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] ._35Uxh-lNCy7AIVxAkLQnf{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._2fBIui4X7VzMUeMlgn0aAJ{position:relative;top:25%}html[dir] ._2fBIui4X7VzMUeMlgn0aAJ{text-align:center}._2O6_TNrH7pVtosTqq1iHX0{display:inline-block;font-size:80px;line-height:1;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._2O6_TNrH7pVtosTqq1iHX0{text-align:center}._1hrmefbBRxJBgKb0Fz4kj6{display:block;max-width:70%}html[dir] ._1hrmefbBRxJBgKb0Fz4kj6{margin:auto}.t085jF8UewCxzoVIxg3MF{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}html[dir] .t085jF8UewCxzoVIxg3MF{padding-top:25px}._3CjShi0HyNf1-sMSa13b4o{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._3CjShi0HyNf1-sMSa13b4o{padding-top:10px}',""]),t.locals={errorContainer:"_35Uxh-lNCy7AIVxAkLQnf",errorContent:"_2fBIui4X7VzMUeMlgn0aAJ",errorIcon:"_2O6_TNrH7pVtosTqq1iHX0",errorTextCommon:"_1hrmefbBRxJBgKb0Fz4kj6",errorTextTitle:"t085jF8UewCxzoVIxg3MF",errorTextDescription:"_3CjShi0HyNf1-sMSa13b4o"}},7240:function(e){e.exports=JSON.parse('{"a":"fea"}')},7241:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'._2LyIY1IT_FLcj7nlu42I5I{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:70px}html[dir] ._2LyIY1IT_FLcj7nlu42I5I{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);padding:0 22px;padding-top:10px}._2F5ZiV8NB3K3qoiCs8805O{height:60px}html[dir] ._2F5ZiV8NB3K3qoiCs8805O{padding:0 32px;padding-top:10px}html[dir=ltr] ._2F5ZiV8NB3K3qoiCs8805O{padding-right:36px}html[dir=rtl] ._2F5ZiV8NB3K3qoiCs8805O{padding-left:36px}._3qSJ1BvxuTyayDzbR1sZHx{position:static}html[dir=ltr] ._3qSJ1BvxuTyayDzbR1sZHx{margin-right:-10px;right:0}html[dir=rtl] ._3qSJ1BvxuTyayDzbR1sZHx{margin-left:-10px;left:0}._1TN9YpVgiQGSwrH412Bdgx{font-size:32px;color:"[theme:neutralSecondary, default:#666666]";width:32px;height:32px;min-width:32px}html[dir] ._1TN9YpVgiQGSwrH412Bdgx{border:0;padding:0}html[dir=ltr] ._1TN9YpVgiQGSwrH412Bdgx{float:left}html[dir=rtl] ._1TN9YpVgiQGSwrH412Bdgx{float:right}.B85HD7JJkDxOZ255cVew6{color:"[theme:neutralTertiary, default:#a6a6a6]"}._1IsbQs17q9hMPNRjzbH3Y4{font-size:21px;font-weight:100;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:"[theme:neutralPrimary, default:#333333]";overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] ._1IsbQs17q9hMPNRjzbH3Y4{float:left;margin-left:8px}html[dir=rtl] ._1IsbQs17q9hMPNRjzbH3Y4{float:right;margin-right:8px}.aE5GasCrbxr6WFaLuRHdA{text-overflow:ellipsis;overflow:hidden}.aE5GasCrbxr6WFaLuRHdA,.D_t_F2iR_J5JIVwSvJzKO{white-space:nowrap}._12oaZ7uLdngB73OnarBfW-{color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={addinPaneHeader:"_2LyIY1IT_FLcj7nlu42I5I",addinPaneHeaderCalendar:"_2F5ZiV8NB3K3qoiCs8805O",closeButton:"_3qSJ1BvxuTyayDzbR1sZHx",addinPaneIcon:"_1TN9YpVgiQGSwrH412Bdgx",fallbackIcon:"B85HD7JJkDxOZ255cVew6",addinPaneLabelText:"_1IsbQs17q9hMPNRjzbH3Y4",ellipsis:"aE5GasCrbxr6WFaLuRHdA",rightButtons:"D_t_F2iR_J5JIVwSvJzKO",persistIcon:"_12oaZ7uLdngB73OnarBfW-"}},7242:function(e,t,n){var r=n(7243),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7243:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content{height:calc(100vh - 50px);overflow-y:hidden}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content{padding:0}._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);top:48px;height:calc(100% - 48px);width:320px!important}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}html[dir=ltr] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{left:calc(100vw - 322px)!important}html[dir=rtl] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main{right:calc(100vw - 322px)!important}._8Iga8mKVcPGOaQygACFwN .ms-Panel-main{top:0;height:100%}._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-contentInner{height:100%}._1k5ke6nDxpeUR8lrcSeiY5{height:100%;overflow-y:hidden}",""]),t.locals={taskPane:"_1k5ke6nDxpeUR8lrcSeiY5",taskPaneNoHeader:"_8Iga8mKVcPGOaQygACFwN"}},7244:function(e,t,n){var r=n(7245),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7245:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,".C1qPgTlqf9Y7t0ml3EHcF{display:none}._1fUNAcJOHwVFh9BqSDLXu2{width:100%;height:calc(100% - 80px)}.G2EwK-c9YGqvxnB1GHcDM{height:calc(100% - 70px)}.P6cxIKyPIAjWQFeaZzdcd{display:block;top:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.P6cxIKyPIAjWQFeaZzdcd iframe{max-height:100%}.wdOcR00mWtKSYE12x1mhd{display:none}",""]),t.locals={divContainer:"C1qPgTlqf9Y7t0ml3EHcF",extensionContainer:"_1fUNAcJOHwVFh9BqSDLXu2",extensionContainerCalendar:"G2EwK-c9YGqvxnB1GHcDM",extensionHost:"P6cxIKyPIAjWQFeaZzdcd",hide:"wdOcR00mWtKSYE12x1mhd"}},7246:function(e,t,n){var r=n(7247),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7247:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,".hILIH9i-q7hXQGEpldvA2{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none}html[dir] .hILIH9i-q7hXQGEpldvA2{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3wbeT-LKN3ClVrBC37qMHu{height:190px}._3PKPHkrVd4hnglpDBfYb3-{width:550px;height:400px}._3mgLsubAj-SyqGrLV6-bnx{display:none!important}",""]),t.locals={dialogContainer:"hILIH9i-q7hXQGEpldvA2",uiLessContainer:"_3wbeT-LKN3ClVrBC37qMHu",consentContainer:"_3PKPHkrVd4hnglpDBfYb3-",hiddenContainer:"_3mgLsubAj-SyqGrLV6-bnx"}},7248:function(e){e.exports=JSON.parse('{"b":"Bda","a":"Cda"}')},7249:function(e,t,n){var r=n(7250),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7250:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._3YILU6DQcy9_FzoKf8XVYT{width:100%;height:100%}",""]),t.locals={uiLessContainer:"_3YILU6DQcy9_FzoKf8XVYT"}},7251:function(e,t,n){var r=n(7252),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7252:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,".ms-ContextualMenu-icon ._1KiZKEg8-nD4NulHDjAhzX{position:relative;top:-8px}",""]),t.locals={fallbackIcon:"_1KiZKEg8-nD4NulHDjAhzX"}},7253:function(e){e.exports=JSON.parse('{"a":"Ada"}')},7254:function(e){e.exports=JSON.parse('{"a":"Wia"}')},7553:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(962),a=n(3672),i=n(1053);function o(e,t,n,i){return new Promise((function(o,c){var u=!1;try{var l=Object(r.h)([{name:t,url:n}]);Object(a.a)(l,e,{isInline:i,isHiddenInline:!0,shouldShare:!1},(function(e){u||(u=!0,o(e.Id))}),s,(function(e){u||(u=!0,c({errorType:"UploadError"}))}))}catch(e){c({errorType:"UploadError"})}}))}var s=function(e,t,n){Object(i.u)(e,t,n)}},7554:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(962),a=n(3672);function i(e,t,n,i){return new Promise((function(o,s){var c=!1,u=Object(r.g)([t],[n]);Object(a.a)(u,e,{isInline:i,isHiddenInline:!1,shouldShare:!1},(function(e){c||(c=!0,o(e.Id))}),null,(function(e){c||(c=!0,s({errorType:"UploadError"}))}))}))}},7591:function(e,t,n){"use strict";var r=n(2163),a=n(4);t.a=Object(a.mutatorAction)("showBccWell",(function(e){e.bccRecipientWell||(e.bccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},7592:function(e,t,n){"use strict";var r=n(104);t.a=Object(r.action)("updateSubject")((function(e,t){e.subject=t,e.isDirty=!0}))},7593:function(e,t,n){"use strict";var r=n(104);t.a=Object(r.action)("updateSubjectSelectionRange")((function(e,t,n){e.subjectViewState.selectionStart=t,e.subjectViewState.selectionEnd=n}))},775:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n(1),i=n(178),o=n(70),s=n(310),c=n(65),u=n(188),l=n(107),d=function(e){function t(n){var r=e.call(this,n)||this;return r._root=a.createRef(),r._firstBumper=a.createRef(),r._lastBumper=a.createRef(),r._hasFocus=!1,r._onRootFocus=function(e){r.props.onFocus&&r.props.onFocus(e),r._hasFocus=!0},r._onRootBlur=function(e){r.props.onBlur&&r.props.onBlur(e);var t=e.relatedTarget;null===e.relatedTarget&&(t=r._getDocument().activeElement),Object(i.a)(r._root.current,t)||(r._hasFocus=!1)},r._onFirstBumperFocus=function(){r._onBumperFocus(!0)},r._onLastBumperFocus=function(){r._onBumperFocus(!1)},r._onBumperFocus=function(e){if(!r.props.disabled){var t=e===r._hasFocus?r._lastBumper.current:r._firstBumper.current;if(r._root.current){var n=e===r._hasFocus?Object(o.i)(r._root.current,t,!0,!1):Object(o.f)(r._root.current,t,!0,!1);n&&(r._isBumper(n)?r.focus():n.focus())}}},r._onFocusCapture=function(e){r.props.onFocusCapture&&r.props.onFocusCapture(e),e.target===e.currentTarget||r._isBumper(e.target)||(r._previouslyFocusedElementInTrapZone=e.target)},r._forceFocusInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=r._getDocument().activeElement;Object(i.a)(r._root.current,n)||(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},r._forceClickInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=e.target;n&&!Object(i.a)(r._root.current,n)&&(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},Object(s.a)(r),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElementOutsideTrapZone!==t&&(this._previouslyFocusedElementOutsideTrapZone=t),this._updateEventHandlers(e)},t.prototype.componentDidUpdate=function(e){var t=void 0===e.forceFocusInsideTrap||e.forceFocusInsideTrap,n=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap,r=void 0!==e.disabled&&e.disabled,a=void 0!==this.props.disabled&&this.props.disabled;!t&&n||r&&!a?this._bringFocusIntoZone():(t&&!n||!r&&a)&&this._returnFocusToInitiator()},t.prototype.componentWillUnmount=function(){this.props.disabled&&!this.props.forceFocusInsideTrap&&Object(i.a)(this._root.current,this._getDocument().activeElement)||this._returnFocusToInitiator(),this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0),this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),delete this._previouslyFocusedElementInTrapZone,delete this._previouslyFocusedElementOutsideTrapZone},t.prototype.render=function(){var e=this.props,t=e.className,n=e.disabled,i=void 0!==n&&n,o=e.ariaLabelledBy,s=Object(c.j)(this.props,c.h),u={style:{pointerEvents:"none",position:"fixed"},tabIndex:i?-1:0,"data-is-visible":!0};return a.createElement("div",r.__assign({},s,{className:t,ref:this._root,"aria-labelledby":o,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),a.createElement("div",r.__assign({},u,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,a.createElement("div",r.__assign({},u,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},t.prototype.focus=function(){var e=this.props,t=e.focusPreviouslyFocusedInnerElement,n=e.firstFocusableSelector;if(t&&this._previouslyFocusedElementInTrapZone&&Object(i.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var r="string"==typeof n?n:n&&n(),a=null;this._root.current&&(r&&(a=this._root.current.querySelector("."+r)),a||(a=Object(o.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),a&&this._focusAsync(a)}},t.prototype._focusAsync=function(e){this._isBumper(e)||Object(o.b)(e)},t.prototype._bringFocusIntoZone=function(){var e=this.props,n=e.elementToFocusOnDismiss,r=e.disabled,a=void 0!==r&&r,o=e.disableFirstFocus,s=void 0!==o&&o;a||(t._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=n||this._getDocument().activeElement,s||Object(i.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus())},t.prototype._returnFocusToInitiator=function(){var e=this,n=this.props.ignoreExternalFocusing;t._focusStack=t._focusStack.filter((function(t){return e!==t}));var r=this._getDocument(),a=r.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(i.a)(this._root.current,a)&&a!==r.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},t.prototype._updateEventHandlers=function(e){var t=e.isClickableOutsideFocusTrap,n=void 0!==t&&t,r=e.forceFocusInsideTrap,a=void 0===r||r;a&&!this._disposeFocusHandler?this._disposeFocusHandler=Object(u.a)(window,"focus",this._forceFocusInTrap,!0):!a&&this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),n||this._disposeClickHandler?n&&this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0):this._disposeClickHandler=Object(u.a)(window,"click",this._forceClickInTrap,!0)},t.prototype._isBumper=function(e){return e===this._firstBumper.current||e===this._lastBumper.current},t.prototype._getDocument=function(){return Object(l.a)(this._root.current)},t._focusStack=[],t}(a.Component)},778:function(e,t,n){"use strict";var r=n(291),a=n(464),i=n(9),o={root:"ms-Overlay",rootDark:"ms-Overlay--dark"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(a.a,(function(e){var t,n=e.className,r=e.theme,a=e.isNone,s=e.isDark,c=r.palette,u=Object(i.getGlobalClassNames)(o,r);return{root:[u.root,r.fonts.medium,{backgroundColor:c.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[i.HighContrastSelector]={border:"1px solid WindowText",opacity:0},t)},a&&{visibility:"hidden"},s&&[u.rootDark,{backgroundColor:c.blackTranslucent40}],n]}}),void 0,{scope:"Overlay"})},779:function(e,t,n){"use strict";var r=n(291),a=n(470),i=n(9),o={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"};n.d(t,"a",(function(){return s}));var s=Object(r.a)(a.a,(function(e){var t=e.className,n=e.theme;return{root:[Object(i.getGlobalClassNames)(o,n).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},782:function(e,t,n){"use strict";var r=n(291),a=n(476),i=n(244),o=n(9),s={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},c=Object(o.keyframes)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});n.d(t,"a",(function(){return u}));var u=Object(r.a)(a.a,(function(e){var t,n=e.theme,r=e.size,a=e.className,u=e.labelPosition,l=n.palette,d=Object(o.getGlobalClassNames)(s,n);return{root:[d.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===u&&{flexDirection:"column-reverse"},"right"===u&&{flexDirection:"row"},"left"===u&&{flexDirection:"row-reverse"},a],circle:[d.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+l.themeLight,borderTopColor:l.themePrimary,animationName:c,animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[o.HighContrastSelector]={borderTopColor:"Highlight"},t)},r===i.a.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===i.a.small&&["ms-Spinner--small",{width:16,height:16}],r===i.a.medium&&["ms-Spinner--medium",{width:20,height:20}],r===i.a.large&&["ms-Spinner--large",{width:28,height:28}]],label:[d.label,n.fonts.small,{color:l.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===u&&{margin:"0 0 8px"},"right"===u&&{margin:"0 0 0 8px"},"left"===u&&{margin:"0 8px 0 0"}],screenReaderText:o.hiddenContentStyle}}),void 0,{scope:"Spinner"})},8211:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(1203),a=n(1317),i=function(e){return function(t,n){Object(r.a)(e,t,n)}},o=function(e){return function(t){Object(a.a)(e,t)}},s=function(e){return function(){return e.infoBarIds}}},825:function(e,t,n){"use strict";var r=n(1109),a=n(1346),i=n(844),o=n(104),s=n(897),c=Object(o.action)("createFocusedOtherDropViewState")((function(){i.a.focusedOtherDropViewState=Object(s.a)()}));function u(){return i.a.focusedOtherDropViewState||c(),i.a.focusedOtherDropViewState}var l,d=n(1603);n(1618);!function(e){e[e.None=0]="None",e[e.Previous=1]="Previous",e[e.Next=2]="Next"}(l||(l={}));var f=l,p=n(1315),m=n(1604);function g(e){var t=e.isInVirtualSelectAllMode,n=e.virtualSelectAllExclusionList,r=e.selectedRowKeys,a=e.rowKeys,i=e.totalRowsInView,o=e.tableQuery,s=e.isInCheckedMode;return t?0===n.length:(a.length==i||1==o.type)&&(s&&r.size==a.length)}var v=n(1328);function h(e){var t=i.a.tableViews.get(e);switch(null==t?void 0:t.tableQuery.type){case 2:return t.serverFolderId;case 0:return t.tableQuery.folderId;default:return null}}var b=n(997);function y(){var e=Object(b.a)();return!!e&&1===e.tableQuery.type}var _=n(2148),O=n(2149),S=n(7),C=n(827),I=n(2150),A=n(2151),x=n(1619),E=n(1620),T=n(969),w=n(1403),j=n(831);function P(e,t,n,r){var a=t.tableQuery,i=t.virtualSelectAllExclusionList,o=t.totalRowsInView;if(e){if(Object(T.d)()&&Object(j.a)("inbox")===a.folderId){var s=Object(w.a)(r);return Object(S.b)(Object(S.a)(E.a),s.displayText)}if(-1!==n)return 0===n?Object(S.a)(_.a):Object(S.a)(A.a);if(1==a.type)return Object(S.a)(O.a);if(pe(t))return Object(S.b)(Object(S.a)(I.a),pe(t));var c=C.e.folderTable.get(a.folderId);return Object(S.b)(Object(S.a)(I.a),Object(C.k)(c))}if($(t)){var u=o-i.length;return 1===a.listViewType?Object(S.b)(Object(S.a)(x.c),u):Object(S.b)(Object(S.a)(E.d),u)}return Object(S.a)(O.a)}function M(e){switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.sortBy;default:throw new Error("getSortByForTable: Table Query type should be either of type group, or mail folder")}}function k(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 1:return e.tableQuery.viewFilter;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function R(e){return e&&"Unread"==k(e)}var D=n(20),N=n(836),F=n(854),L=["drafts","junkemail","recoverableitemsdeletions"];function U(e){if(e){var t=Object(C.p)().get(e);if(t&&(-1!=L.indexOf(Object(F.a)(e))||t.treeType===N.c||t.treeType===N.j)||Object(C.G)(e))return 1}return Object(D.a)().UserOptions.GlobalListViewTypeReact||0}var B=n(1621),H=n(5);function G(e,t){var n=Object(J.a)(e,t),r=null;return me(i.a.tableViews.get(t).tableQuery.folderId)?r=Object(H.tb)(i.a.inboxPausedDateTime):n&&new Date(n.lastModifiedTimeStamp).toISOString(),{conversationId:n.id,conversationLastSyncTimeStamp:r}}var W=n(52);function V(e,t){switch(t){case 0:case 1:return e.InstanceKey;default:return W.d.warn("listViewType:"+t+" not supported"),null}}var z=n(1080),J=n(996),q=n(1192),X=n(1622);function Q(e,t){for(var n=[],r=0;r<e.length;r++){var a=t.rowIdToRowKeyMap.get(e[r]);a&&Array.prototype.push.apply(n,a)}return n}var K=n(1345),Z=n(1623);function Y(e){var t;switch(e){case 0:t="Conversation";break;case 1:t="Message";break;default:t="Unknown"}return t}function $(e){var t=e.isInVirtualSelectAllMode,n=e.virtualSelectAllExclusionList;return t&&n.length>0}function ee(e){return e.folderId===Object(j.a)(N.b)||e.folderId===Object(j.a)(N.g)}var te=n(1013),ne=n(0);function re(e,t,n){var a=[];return t.forEach((function(t){var i=r.getItemIds(t,n);"Flagged"==e.FlagStatus?a.push(i[0]):a.push.apply(a,Object(ne.__spread)(i))})),a}function ae(e,t,n){return!Object(oe.a)(e)&&(t&&n)}var ie,oe=n(1347),se=n(1577),ce=n(1167),ue=n(1325);function le(){return!Object(b.a)().isInCheckedMode&&i.a.expandedConversationViewState.selectedNodeIds.length>0}function de(e){var t=i.a.tableViews.get(e),n=Object(p.a)(t),r=t.tableQuery,a=t.selectedRowKeys,o=g(t);if(o||$(t))return P(o,t,n,Object(m.a)(e));var s=le()?i.a.expandedConversationViewState.selectedNodeIds.length:a.size;return 1==r.listViewType||le()?0===s?Object(S.a)(x.a):1===s?Object(S.a)(x.b):Object(S.b)(Object(S.a)(x.c),s):0===s?Object(S.a)(E.b):1===s?Object(S.a)(E.c):Object(S.b)(Object(S.a)(E.d),s)}function fe(e,t){return e?-1!==Object(p.a)(e)||0!==Object(m.a)(e.id)||"All"!==t&&"UserCategory"!==t:null}function pe(e){return 0===e.tableQuery.type&&"UserCategory"===e.tableQuery.viewFilter?e.tableQuery.categoryName:null}function me(e){return i.a.inboxPausedDateTime&&e&&"inbox"===Object(F.a)(e)}!function(e){e[e.None=0]="None",e[e.BusStart=1]="BusStart",e[e.BusEnd=2]="BusEnd",e[e.BusStop=3]="BusStop",e[e.NoStop=4]="NoStop",e[e.CheckMark=5]="CheckMark"}(ie||(ie={}));var ge=ie;n(1381);function ve(e){return"persona"===e||"privatedistributionlist"===e||"category"===e}function he(e,t){e.currentRowOperation=t,Promise.resolve().then((function(){e.currentRowOperation=0}))}n.d(t,"m",(function(){return u})),n.d(t,"o",(function(){return d.a})),n.d(t,"F",(function(){return i.b})),n.d(t,"S",(function(){return i.a})),n.d(t,"d",(function(){return f})),n.d(t,"l",(function(){return p.a})),n.d(t,"p",(function(){return m.a})),n.d(t,"q",(function(){return g})),n.d(t,"i",(function(){return v.a})),n.d(t,"j",(function(){return v.b})),n.d(t,"n",(function(){return h})),n.d(t,"s",(function(){return y})),n.d(t,"B",(function(){return P})),n.d(t,"C",(function(){return b.a})),n.d(t,"E",(function(){return M})),n.d(t,"K",(function(){return k})),n.d(t,"W",(function(){return R})),n.d(t,"w",(function(){return U})),n.d(t,"k",(function(){return B.a})),n.d(t,"h",(function(){return G})),n.d(t,"z",(function(){return V})),n.d(t,"I",(function(){return z.a})),n.d(t,"G",(function(){return J.a})),n.d(t,"H",(function(){return q.a})),n.d(t,"y",(function(){return X.a})),n.d(t,"A",(function(){return Q})),n.d(t,"Q",(function(){return K.a})),n.d(t,"g",(function(){return Z.a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"x",(function(){return Y})),n.d(t,"P",(function(){return $})),n.d(t,"L",(function(){return ee})),n.d(t,"t",(function(){return te.b})),n.d(t,"r",(function(){return te.a})),n.d(t,"u",(function(){return re})),n.d(t,"V",(function(){return ae})),n.d(t,"f",(function(){return oe.a})),n.d(t,"e",(function(){return se.a})),n.d(t,"D",(function(){return ce.a})),n.d(t,"T",(function(){return ue.a})),n.d(t,"v",(function(){return de})),n.d(t,"R",(function(){return le})),n.d(t,"N",(function(){return fe})),n.d(t,"J",(function(){return pe})),n.d(t,"O",(function(){return me})),n.d(t,"a",(function(){return ge})),n.d(t,"M",(function(){return ve})),n.d(t,"U",(function(){return he}))},827:function(e,t,n){"use strict";var r=n(77),a=n(858),i=n(4),o=n(1031),s=n(905),c=(Object(i.mutator)(o.a,(function(e){var t=e.loadingState;Object(s.a)().get(e.folderTreeId).loadingState=t})),n(0)),u=Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",(function(e,t){return{existingFolders:e,personaOrPdlFavorites:t}})),l=n(853),d=(Object(i.mutator)(u,(function(e){e.existingFolders.forEach((function(t){if(t){var n=t.FolderId.Id,r=e.personaOrPdlFavorites.filter((function(e){return e.searchFolderId===n}));if(1===r.length){var a=r[0].displayName,i=Object(c.__assign)(Object(c.__assign)({},t),{DisplayName:a});Object(l.a)().set(t.FolderId.Id,i)}}}))})),n(850)),f=n(337),p=n(104);function m(e,t){t.forEach((function(t){e.folderTable.delete(t)}))}var g=Object(p.action)("removeFolderFromParentFolder")((function(e,t){if(t.ParentFolderId){var n=e.folderTable.get(t.ParentFolderId.Id).childFolderIds;n.splice(n.indexOf(t.FolderId.Id),1)}}));function v(e,t,n){for(var r=t.folderTable.get(n).childFolderIds,a=!1,i=oe(e).toLowerCase(),o=0;o<r.length&&!a;o++){oe(t.folderTable.get(r[o])).toLowerCase()>i&&(r.splice(o,0,e.FolderId.Id),a=!0)}a||r.push(e.FolderId.Id)}var h=Object(p.action)("moveFolderToParentFolder")((function(e,t,n){v(t,e,n),t.ParentFolderId=Object(f.a)({Id:n}),t.treeType=Object(d.e)(n)})),b=n(1037),y=n(860);function _(e,t,n,r){var a=Object(b.a)(n),i=Object(l.a)().get(n).treeType,o=Object(c.__assign)({DisplayName:r,ParentFolderId:a,childFolderIds:[],FolderClass:"IPF.Note",distinguishedFolderId:void 0,UnreadCount:0,TotalCount:0,treeType:i},t);e.folderTable.set(t.FolderId.Id,o),v(o,e,a.Id)}Object(i.mutator)(y.a,(function(e){_(e.folderStore,e.folder,e.parentFolderId,e.displayName)})),Object(i.mutator)(y.g,(function(e){_(e.folderStore,e.folder,e.parentFolderId,e.displayName)}));var O=n(836);var S=n(1147),C=function(e){return Object(S.c)(e,"0x7018")},I=n(1032),A=n(1695);function x(e,t,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);var i={id:e,rootFolder:t,loadingState:n,hasMoreData:r,currentLoadedIndex:a};Object(s.a)().set(e,i)}var E=n(883),T=n(74),w=n(13);Object(i.mutator)(I.a,(function(e){var t=e.rootFolder,n=e.treeType,r=e.principalSMTPAddress,a=e.displayName;x(e.folderTreeIdentifier,j(t,n,r,a),E.a.Loaded,!t.IncludesLastItemInRange,t.IndexedPagingOffset)}));function j(e,t,n,r){var i=e.ParentFolder,o=function(e,t){return t===O.j?null:e.DistinguishedFolderId}(i,t),s={},c=s[i.FolderId.Id]=P(i,o,t,n);r&&(c.DisplayName=r);for(var u=[],d=0;d<e.Folders.length;d++){var f=e.Folders[d],p=f.FolderId.Id,m=f.DistinguishedFolderId;M(m,f)&&(s[p]=P(f,m,t,n),u.push(p))}return u.forEach((function(e){var t=s[e],n=s[t.ParentFolderId.Id]||Object(l.a)().get(t.ParentFolderId.Id);n&&!t.isHidden&&n.childFolderIds.push(e)})),0==Object(l.a)().size?Object(a.a)().folderTable=new w.ObservableMap(s):Object.keys(s).forEach((function(e){Object(l.a)().set(e,s[e])})),c}function P(e,t,n,r){return Object(l.a)().has(e.FolderId.Id)?Object(l.a)().get(e.FolderId.Id):Object(c.__assign)({childFolderIds:[],distinguishedFolderId:t,UnreadCount:e.UnreadCount,TotalCount:e.TotalCount,isHidden:Object(S.d)(e),remoteFolderDisplayName:C(e),sourceWellKnownFolderType:Object(S.e)(e),treeType:n,principalSMTPAddress:r},e)}function M(e,t){var n=!!Object(T.h)().SegmentationSettings.JunkEMail;if("junkemail"===e&&!n)return!1;var r=!!Object(T.h)().SegmentationSettings.StickyNotes;return!("notes"===e&&!r)&&("clutter"!==e||0!==t.TotalCount)}Object(i.mutator)(A.b,(function(e){j(e.rootFolder,e.treeType,e.principalSMTPAddress)}));var k=Object(i.action)("REMOVE_FOLDERTREE_DATA",(function(e){return{folderTreeId:e}}));Object(i.mutator)(y.f,(function(){var e={DistinguishedFolderId:O.d,DisplayName:Object(T.h)().SessionSettings.ArchiveDisplayName};x(O.d,e,E.a.Uninitialized)})),Object(i.mutator)(k,(function(e){Object(s.a)().delete(e.folderTreeId)}));var R=n(1429),D=n(207),N=n(1400),F=n(879),L=n(1430),U=n(153),B=n(976);function H(e,t,n){return void 0===n&&(n="IPF.Note"),Object(L.a)({Header:Object(U.a)(),Body:Object(R.a)({ParentFolderId:Object(F.a)({BaseFolderId:G(e)}),Folders:[Object(N.a)({DisplayName:t,FolderClass:n})]})},Object(B.a)(e)).then((function(e){return e.Body.ResponseMessages.Items[0]}))}function G(e){return"string"==typeof e?Object(f.a)({Id:e}):Object(D.a)({Id:e})}var W=n(1326),V=n(831);function z(e,t,n){for(var r=("string"==typeof n?e.folderTable.get(n):e.folderTable.get(Object(V.a)(n))).childFolderIds,a=t.toLowerCase(),i=0;i<r.length;i++){var o=r[i],s=e.folderTable.get(o);if(s&&s.DisplayName.toLowerCase()==a)return!0}return!1}function J(e){var t=[e];return Object(l.a)().get(e).childFolderIds.forEach((function(e){Array.prototype.push.apply(t,J(e))})),t}function q(e){var t=Object(l.a)().get(e);return!!t.childFolderIds&&t.childFolderIds.filter((function(e){var t=Object(l.a)().get(e);return Object(d.g)(t)})).length>0}function X(e,t){return function e(t,n,r){var a=[];if(0===n){var i=e(t,n+1,r);a.push.apply(a,Object(c.__spread)(i))}else t.forEach((function(t){var i=Object(l.a)().get(t);if(Object(d.g)(i)&&(a.push(Object(c.__assign)(Object(c.__assign)({},i),{depth:n})),q(t)&&r(t))){var o=e(i.childFolderIds,n+1,r);a.push.apply(a,Object(c.__spread)(o))}}));return a}(e,0,t)}var Q,K=null;var Z=function(e,t){K.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&K.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.distinguishedFolderId&&(Q[e.distinguishedFolderId]=e.FolderId.Id)};Z=Object(p.action)("addFolderToStore-TestMethod")(Z);var Y=Object(i.action)("INITIALIZE_SHARED_FOLDERS"),$=n(1097),ee=n(1096),te=n(1150);n(947);function ne(e){var t=Object(s.a)(),n=t&&t.get(e);return null==n?void 0:n.hasMoreData}var re=n(1327),ae=n(1098),ie=n(20);function oe(e){return e?Object(ie.a)().SessionSettings.IsShadowMailbox&&e.remoteFolderDisplayName?e.remoteFolderDisplayName:e.DisplayName:""}var se=n(1665),ce=n(165),ue=n(1242),le=n(1722);function de(){return Object(c.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(c.__generator)(this,(function(r){switch(r.label){case 0:return(e=Object(te.a)(O.i))==E.a.Loading||e==E.a.Loaded?[2]:(Object(o.a)(O.i,E.a.Loading),t=Object(ue.d)(),n=null,t?(n=t.Body.ResponseMessages.Items[0],[3,4]):[3,1]);case 1:return r.trys.push([1,3,,4]),[4,Object(se.b)(Object(D.a)({Id:O.i}))];case 2:return n=r.sent(),[3,4];case 3:return r.sent(),Object(o.a)(O.i,E.a.ErrorLoading),[2];case 4:return n&&n.RootFolder&&n.RootFolder.Folders&&n.RootFolder.ParentFolder?(Object(I.a)(n.RootFolder,O.i,O.h,Object(le.a)(),Object(ie.a)().SessionSettings.UserDisplayName,O.i),function(){var e=Object(l.a)().get(Object(V.a)("inbox")).childFolderIds.length,t=Object(l.a)().get(Object(V.a)("msgfolderroot")).TotalCount;Object(ce.o)("TnS_LoadFolders",[e,t]);var n=Object(V.a)("notes"),r=Object(l.a)().get(n);if(null!=n&&null!=r){var a=r.TotalCount,i=r.ChildFolderCount;Object(ce.o)("Notes_LoadFolders",{noteCount:a,childFolderCount:i})}}(),[2]):(Object(o.a)(O.i,E.a.ErrorLoading),[2])}}))}))}var fe=n(939),pe=Object(p.select)({folderTable:function(){return a.b.folderTable}})((function(e,t){return Object(fe.c)(e,"msgfolderroot",t)}));function me(e){return Object(fe.a)(a.b.folderTable.get(e),"msgfolderroot")}n(1038);var ge=n(1155);n.d(t,"J",(function(){return he})),n.d(t,"K",(function(){return be})),n.d(t,"M",(function(){return ye})),n.d(t,"N",(function(){return _e})),n.d(t,"I",(function(){return Oe})),n.d(t,"L",(function(){return Se})),n.d(t,"y",(function(){return a.a})),n.d(t,"d",(function(){return H})),n.d(t,"X",(function(){return W.a})),n.d(t,"g",(function(){return z})),n.d(t,"h",(function(){return J})),n.d(t,"l",(function(){return X})),n.d(t,"z",(function(){return q})),n.d(t,"a",(function(){return E.a})),n.d(t,"R",(function(){return u})),n.d(t,"f",(function(){return m})),n.d(t,"S",(function(){return g})),n.d(t,"O",(function(){return h})),n.d(t,"c",(function(){return y.a})),n.d(t,"A",(function(){return y.f})),n.d(t,"o",(function(){return y.e})),n.d(t,"n",(function(){return y.d})),n.d(t,"Z",(function(){return y.k})),n.d(t,"Y",(function(){return y.i})),n.d(t,"P",(function(){return y.g})),n.d(t,"B",(function(){return Y})),n.d(t,"T",(function(){return k})),n.d(t,"Q",(function(){return I.a})),n.d(t,"V",(function(){return o.a})),n.d(t,"j",(function(){return B.a})),n.d(t,"i",(function(){return $.a})),n.d(t,"v",(function(){return ee.a})),n.d(t,"p",(function(){return l.a})),n.d(t,"s",(function(){return te.a})),n.d(t,"r",(function(){return ne})),n.d(t,"q",(function(){return re.a})),n.d(t,"x",(function(){return ae.a})),n.d(t,"k",(function(){return oe})),n.d(t,"U",(function(){return x})),n.d(t,"w",(function(){return de})),n.d(t,"F",(function(){return pe})),n.d(t,"E",(function(){return me})),n.d(t,"H",(function(){return fe.c})),n.d(t,"D",(function(){return fe.a})),n.d(t,"W",(function(){return d.g})),n.d(t,"m",(function(){return d.b})),n.d(t,"u",(function(){return d.d})),n.d(t,"C",(function(){return d.f})),n.d(t,"b",(function(){return d.a})),n.d(t,"t",(function(){return d.c})),n.d(t,"G",(function(){return ge.b}));t.e=a.b;var ve=new r.c((function(){return n.e(253).then(n.bind(null,13486))})),he=new r.b(ve,(function(e){return e.getArchiveFolders})),be=new r.b(ve,(function(e){return e.getFolderPermissions})),ye=new r.b(ve,(function(e){return e.updateFolderPermissions})),_e=new r.b(ve,(function(e){return e.updateFolderPermissionsInStore})),Oe=new r.b(ve,(function(e){return e.arePermissionArraysEqual})),Se=(new r.b(ve,(function(e){return e.arePermissionsEqual})),new r.b(ve,(function(e){return e.getSharedFolders})))},836:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p}));var r="archivemsgfolderroot",a="msgfolderroot",i="archivedeleteditems",o="deleteditems",s="archiverecoverableitemsdeletions",c="recoverableitemsdeletions",u="msgfolderroot",l="sharedFolderTree",d="primaryFolderTree",f="archiveFolderTree",p="favorites"},838:function(e,t,n){"use strict";var r=n(77),a=n(843),i=n(1421),o=n(1140),s=n(1099),c="ChronologicalNewestOnBottom";function u(e,t){return e[t==c?0:e.length-1]}var l=n(85),d=n(0);var f=n(337);function p(e){return Object(d.__assign)({__type:"GetConversationItemsJsonRequest:#Exchange"},e)}var m=n(450),g=n(24);var v=n(153),h=n(831),b=["journal","outbox","syncissues"];function y(e){return"ChronologicalNewestOnBottom"==e?"DateOrderAscending":"DateOrderDescending"}function _(e){var t=[];return e||b.forEach((function(e){var n=Object(h.a)(e);n&&t.push(Object(f.a)({Id:n}))})),t}function O(e,t,n,r,a,i){return o={Conversations:[e],ItemShape:t,ShapeName:"ItemPart",SortOrder:y(n),MaxItemsToReturn:r,Action:a,FoldersToIgnore:_(i),ReturnSubmittedItems:!0},Object(d.__assign)({__type:"GetConversationItemsRequest:#Exchange"},o);var o}function S(e,t,n,r,a,i,o,s){void 0===o&&(o="Default");var c,u=(c={ConversationId:Object(m.a)(e)},Object(d.__assign)({__type:"ConversationRequestType:#Exchange"},c));u.SyncState=i?"":n;var f=O(u,t,a,r,o,function(e){var t=e.mailboxInfo;return t&&t.type==l.a.GroupMailbox}(e)),h=Object(v.a)();return h.RequestServerVersion="V2017_08_18",function(e,t){return void 0===e||e.__type||(e=p(e)),Object(g.a)("GetConversationItems",e,t)}(p({Header:h,Body:f}),s).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var C=n(1092),I=n(389),A=n(839);function x(e){return Object(s.a)([e],Object(I.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(A.a)({FieldURI:"TailoredXpEntities"}),Object(A.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(A.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(A.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){return function(e){if(Object(C.a)(e[0])){var t=e[0].Items[0];return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}(e)}))}function E(e){return a.a.items.get(e)}var T=n(20);function w(e){var t=a.a.conversations.get(e);if(t){var n=Object(T.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}var j=n(1183),P=n(827),M=n(104),k=Object(M.select)({folderTable:function(){return P.e.folderTable}})((function(e,t){var n=t.folderTable.get(e);return!!n&&Object(P.W)(n)})),R=n(836);function D(e,t){var n=P.e.folderTable.get(e);return!!n&&(Object(P.H)(n,R.d,t)||n.DistinguishedFolderId===R.b)}function N(e){return D(e)||function(e){var t=P.e.folderTable.get(e);return t&&t.distinguishedFolderId===R.d}(e)}var F=Object(M.select)({folderTable:function(){return P.e.folderTable}})((function(e,t,n){return Object(P.H)(e,t,n)})),L=n(1357),U=n(1111);function B(e){return e&&(Object(U.a)(e,R.g)||Object(U.a)(e,R.b))}function H(e){return e&&(F(e,R.f)||F(e,R.a))}var G=n(1296);function W(e,t){try{return V(e,t)}catch(e){return null}}function V(e,t){if(!e||!t)return null;var n=Object(P.p)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===t}));return null==n?void 0:n[0]}var z=n(206),J="OneOff",q="Unknown";function X(e,t,n){return!Object(z.a)()&&(n==J||n==q)&&e.indexOf(t)<0}var Q=n(4),K=Object(Q.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,t){var n=Object(a.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)})),Z=n(51),Y=n(208);function $(e){Object(Z.f)("rp-omeRevocation")&&e.AdditionalProperties.push(Object(Y.a)({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}))}n.d(t,"v",(function(){return te})),n.d(t,"x",(function(){return a.a})),n.d(t,"j",(function(){return a.b})),n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"h",(function(){return s.a})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return S})),n.d(t,"w",(function(){return x})),n.d(t,"y",(function(){return E})),n.d(t,"t",(function(){return w})),n.d(t,"e",(function(){return j.a})),n.d(t,"c",(function(){return C.a})),n.d(t,"u",(function(){return k})),n.d(t,"p",(function(){return D})),n.d(t,"o",(function(){return N})),n.d(t,"q",(function(){return F})),n.d(t,"m",(function(){return L.a})),n.d(t,"n",(function(){return B})),n.d(t,"s",(function(){return H})),n.d(t,"i",(function(){return G.a})),n.d(t,"k",(function(){return W})),n.d(t,"l",(function(){return V})),n.d(t,"r",(function(){return X})),n.d(t,"z",(function(){return K})),n.d(t,"d",(function(){return $}));var ee=new r.c((function(){return n.e(569).then(n.bind(null,13711))})),te=new r.a(ee,(function(e){return e.setTriageActionAnnouncement}))},839:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"PropertyUri:#Exchange"},e)}},841:function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"g",(function(){return _}));var r,a,i=n(3),o=n(36),s=n(20),c=["ar-sa","ar-ae","ar-eg","da-dk","de-at","de-ch","de-de","el-gr","en-ae","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-eg","en-fi","en-gb","en-gr","en-hk","en-id","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-ph","en-pl","en-pt","en-ru","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-vn","en-za","es-ar","es-cl","es-co","es-cr","es-do","es-ec","es-es","es-gt","es-mx","es-pe","es-us","es-ve","fi-fi","fil-ph","fr-be","fr-ca","fr-ch","fr-fr","id-id","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pl-pl","pt-br","pt-pt","ru-ru","sv-se","th-th","tr-tr","vi-vn","zh-cn","zh-hk","zh-sg","zh-tw"],u=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],l={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function d(){return Object(s.a)().SessionSettings.IsPremiumConsumerMailbox}function f(){return Object(s.a)().IsConsumerChild}function p(){return Object(s.a)().SessionSettings.IsShadowMailbox}function m(){return void 0!==a?a:a=function(){if(Object(i.d)("ormarket"))return Object(i.a)("ormarket");var e=Object(s.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return c.indexOf(n)>-1?n:l[n.split("-")[1]]||n}()}function g(e){return null!=e?e.toUpperCase().split("-"):[]}function v(e){return g(e)[1]||"US"}function h(){return Object(o.a)("ANON")}function b(){return Object(o.a)("MUID")}function y(){return!!Object(o.a)("TOptOut")}function _(){return r||(r=Object(i.a)("anjs")||"https://acdn.adnxs.com/ast/static/0.22.0/ast.js")}},843:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(13),a=n(4),i={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},o=Object(a.createStore)("mail",i),s=o();t.a=s},844:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(13),a=n(4),i={conversationItems:new r.ObservableMap({}),itemContextMenuState:null,selectedTableViewId:null,tableViewConversationRelations:new r.ObservableMap({}),tableViewItemRelations:new r.ObservableMap({}),tableViews:new r.ObservableMap({}),attachmentViewStates:new r.ObservableMap({}),expandedConversationViewState:{expandedRowKey:null,focusedNodeId:null,selectedNodeIds:[],allNodeIds:[],shouldBeExpanded:!1,busStopStateMap:new r.ObservableMap({})},rowAttachmentPreviewWellViews:new r.ObservableMap({}),focusedOtherDropViewState:null,couponPeekPreviews:new r.ObservableMap({}),rowInfoForVLV:new r.ObservableMap({}),meetingMessageItems:new r.ObservableMap({}),offsetHeight:0,scrollTop:0,inboxPausedDateTime:null,inboxPausedLength:null},o=Object(a.createStore)("listview",i),s=o();t.a=s},845:function(e,t,n){"use strict";var r=n(77),a=n(1066),i=n(932),o=n(13),s=n(4),c=n(847),u=[c.a.SurfaceActions];Object(s.mutator)(a.a,(function(e){var t=e.defaultOptions;u.forEach((function(e){t[e]&&Object(o.extendObservable)(Object(i.a)().options[e],t[e])}))}));var l,d=n(935),f=n(882);!function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(l||(l={}));n.d(t,"e",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return h})),n.d(t,"d",(function(){return d.a})),n.d(t,"c",(function(){return f.a})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c.a}));var p=new r.c((function(){return n.e(389).then(n.bind(null,13551))})),m=new r.a(p,(function(e){return e.createOrUpdateOptionsForFeature})),g=new r.a(p,(function(e){return e.updateAddinPinStatus})),v=new r.b(p,(function(e){return e.getServerOptionsForFeature})),h=new r.a(p,(function(e){return e.loadOptions}))},847:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress"}(r||(r={}))},849:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function a(e){var t=r(e);return t?t.replace(".",""):null}function i(e){var t;return(null===(t=a(e))||void 0===t?void 0:t.substring(0,4))||""}var o=n(1184),s=n(7);function c(e){var t;return e>=1073741824?(e/=1073741824,t=Object(s.a)(o.b)):e>=1048576?(e/=1048576,t=Object(s.a)(o.d)):e>=1024?(e/=1024,t=Object(s.a)(o.c)):t=Object(s.a)(o.a),Object(s.b)(t,Math.round(e))}function u(e){return t=e||"",(n=d.exec(t))&&n.length>1&&l[n[1].toLowerCase()];var t,n}var l={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},d=/^\s*([^;\s]*)(?:;|\s|$)/;var f=n(42),p=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],m=[".tiff",".tif"];function g(e,t,n){void 0===n&&(n=!0);var a=r(e)||u(t);return!!a&&(p.indexOf(a.toLowerCase())>=0||n&&m.indexOf(a.toLowerCase())>=0&&(Object(f.d)()||Object(f.c)()||Object(f.g)()||Object(f.f)()&&!Object(f.i)()))}var v,h=n(51),b=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function y(e){if(!Object(h.f)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&b.indexOf(t.toLowerCase())>=0}function _(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return v.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return v.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return v.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(v||(v={})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return y})),n.d(t,"e",(function(){return _})),n.d(t,"a",(function(){return v}))},850:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return y}));var r=n(20),a=n(831),i=n(854),o=n(858),s=n(1096),c=n(853),u=n(1097),l=n(51),d=n(1098),f=n(206),p=["journal","outbox","syncissues"];function m(){var e=Object(f.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(l.f)("notes-folder-view")&&e.push("notes"),e}function g(e){if(!function(e){return e&&"Folder:#Exchange"==e.__type}(e))return!1;if(e.isHidden||p.indexOf(Object(i.a)(e.FolderId.Id))>=0)return!1;var t=Object(r.a)();return"notes"==Object(i.a)(e.FolderId.Id)?t.SegmentationSettings.StickyNotes&&Object(l.f)("cal-stickyNotesFolder"):!("junkemail"==Object(i.a)(e.FolderId.Id)&&!t.SegmentationSettings.JunkEMail)}function v(e){var t=Object(c.a)(),n=Object(a.a)(e);return t.get(n)}function h(e,t){if("sharedFolder"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,r=[];switch(e){case"archive":n=Object(u.a)();break;case"sharedFolder":n=Object(d.a)(t);break;default:n=Object(s.a)()}var a=m();"primary"==e&&n.DistinguishedFolderId==Object(s.a)().DistinguishedFolderId&&a.forEach((function(e){var t=v(e);t&&g(t)&&t.ParentFolderId.Id===n.FolderId.Id&&r.push(t.FolderId.Id)}));for(var c=function(e){var t=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var n=o.b.folderTable.get(e);n&&g(n)&&t.push(n.FolderId.Id)}));return t}(n),l=0;l<c.length;l++)-1==a.indexOf(Object(i.a)(c[l]))&&r.push(c[l]);return r}function b(e,t){var n=Object(c.a)().get(e);return!(!n||n.treeType!==t)}function y(e){var t=null,n=Object(c.a)().get(e);return n&&(t=n.treeType),t}},853:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(858);function a(){return Object(r.a)().folderTable}},854:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(33);function a(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},856:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc"}(r||(r={}))},858:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r,a=n(4),i=n(13),o=n(883),s=n(836),c=Object(a.createStore)("folderStore",{folderTable:new i.ObservableMap,folderTreeTable:new i.ObservableMap((r={},r[s.i]={id:s.i,rootFolder:null,loadingState:o.a.Uninitialized},r)),sharedFolderUserEmails:[]}),u=c();t.a=c},859:function(e,t,n){"use strict";var r={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},a=0;function i(e){return void 0===e&&(e="id"),""+e+a++}function o(e){return Array.isArray(e)?e.join(" "):e}function s(e){if(!e)return null;for(var t={},n=Object.keys(e),r=0;r<n.length;r++){switch(n[r]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=o(e.controls);break;case"describedBy":t["aria-describedby"]=o(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=o(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=o(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=o(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=o(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=o(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s}))},860:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"g",(function(){return m}));var r=n(4),a=Object(r.action)("GET_ARCHIVE_FOLDERS",(function(e,t){return{source:e,isLoadingMore:t}})),i=Object(r.action)("INITIALIZE_ARCHIVE_FOLDER_TREE_FROM_SESSIONDATA"),o=Object(r.action)("GET_FOLDER_PERMISSIONS",(function(e){return{folderId:e}})),s=Object(r.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),c=Object(r.action)("GET_FOLDER_PERMISSIONS_FAILED"),u=Object(r.action)("UPDATE_FOLDER_PERMISSIONS",(function(e,t){return{folderId:e,permissions:t}})),l=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",(function(e,t){return{folderId:e,permissions:t}})),d=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),f=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),p=Object(r.action)("ADD_NEW_FOLDER_TO_STORE",(function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}})),m=Object(r.action)("ON_CREATE_NEW_FOLDER_INBOX_RULES_RESPONSE",(function(e,t,n,r){return{folderStore:e,folder:t,parentFolderId:n,displayName:r}}))},865:function(e,t,n){"use strict";var r=Array.isArray;t.a=r},867:function(e,t,n){"use strict";var r=/\(([^)]*)\)/gi,a=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,i=/\s+/gi;function o(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(r,"")).replace(a,"")).replace(i," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var s=n(904),c=Object.keys(s.a).length/2;function u(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),a=n%8;t^=(r<<a)+(r>>8-a)}return t%c}function l(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:o(e),textBoyColor:u(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}var d=n(953),f=n(84);function p(e){var t;if(e){var n=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),r=Object(d.c)(e.DisplayName,n);return"Room"==e.PersonaTypeString&&(n.LocationUri=e.EmailAddress.EmailAddress),{personaId:null===(t=e.PersonaId)||void 0===t?void 0:t.Id,feedbackId:e.FeedbackId,displayName:r,postalAddress:n,emailAddress:e.EmailAddress,displayAddress:Object(d.a)(n),initials:o(r),textBoyColor:u(r),selectionSource:"LocationWell",personaType:Object(f.b)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity,entityType:e.EntityType,audioDeviceName:e.AudioDeviceName,displayDeviceName:e.DisplayDeviceName,videoDeviceName:e.VideoDeviceName,isWheelChairAccessible:e.IsWheelChairAccessible}}return null}var m=n(978);function g(e){if((null==e?void 0:e.DisplayName)&&e.PostalAddress){var t=Object(d.c)(e.DisplayName,e.PostalAddress),n=Object(m.a)(e.PostalAddress)&&!Object(f.b)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:n,displayAddress:Object(d.a)(e.PostalAddress),initials:o(t),textBoyColor:u(t),personaType:Object(m.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var v=n(0),h=n(29),b=n(1),y=n(7),_=n(20),O=n(196),S=n(190),C=290,I=135;function A(e,t,n,r,a,i){a=a||C,i=i||I;var o=Object(_.a)();if((!Object(f.b)(n)||e&&t)&&o.PolicySettings.PlacesEnabled){var s=Object(y.b)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",e&&e.toString(),t&&t.toString(),encodeURIComponent(n),o.SessionSettings.UserCulture,a,i);Object(O.b)(s,void 0,!0).then((function(e){Object(S.a)(e.status)?e.json().then((function(e){r("data:image/png;base64,"+e.ib)})):r("")}))}else r("")}var x=n(1232),E=n(52),T=n(242),w=Object(h.a)((function(e){var t,n;b.useEffect((function(){var t;(null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude)&&e.locationPersona.postalAddress.Longitude&&!Object(f.b)(e.locationPersona.displayName)&&!i&&"pending"!=r.current&&"failed"!=r.current&&(r.current="pending",A(e.locationPersona.postalAddress.Latitude,e.locationPersona.postalAddress.Longitude,null,c,64,64))}),[null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude,null===(n=e.locationPersona.postalAddress)||void 0===n?void 0:n.Longitude,e.locationPersona.displayName]);var r=b.useRef(),a=Object(v.__read)(b.useState(null),2),i=a[0],o=a[1],c=function(e){o(e),e?r.current="success":(r.current="failed",E.d.warn("getLocationPhoto.downloadLocationPhoto failed"))},u=e.locationPersona,l=e.className,d=e.size,p=e.showPersonaDetails;if(u){var m={};return Object(f.b)(i)?T(m,{imageInitials:u.initials,initialsColor:u.textBoyColor}):T(m,{imageUrl:i,imageShouldFadeIn:!1}),b.createElement(x.a,Object(v.__assign)({className:l,presence:s.b.none,hidePersonaDetails:!p,size:d,text:u.displayName,secondaryText:u.displayAddress},m))}return null})),j="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}",P="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}";function M(e,t,n,r){return e&&t?Object(y.b)(j,e.toString(),t.toString(),n,r):n?Object(y.b)(P,n,r):null}var k=n(1035),R=n(117),D=n(272);function N(e){var t,n=(null===(t=null==e?void 0:e.accessibleText)||void 0===t?void 0:t.msColorWhiteBackground)||Object(R.g)().themePrimary,r=e?e.calDarker:Object(R.g)().themeDarker;return Object(D.b)({color:n,cursor:"pointer",selectors:{"&:hover":{color:r},"&:focus":{color:r}}})}var F=n(77);function L(e,t){return{Id:t,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}var U=n(881);function B(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function H(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function G(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}function W(e){return!Object(k.a)(e.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(e.DisplayName)}function V(e){return function(){var t=/^http*/i.test(e)?e:"//"+e;window.open(t,"_blank")}}function z(e){var t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}n(1191);n.d(t,"s",(function(){return q})),n.d(t,"k",(function(){return l})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"a",(function(){return w})),n.d(t,"l",(function(){return M})),n.d(t,"m",(function(){return A})),n.d(t,"p",(function(){return k.a})),n.d(t,"q",(function(){return m.a})),n.d(t,"n",(function(){return N})),n.d(t,"e",(function(){return L})),n.d(t,"b",(function(){return U.a})),n.d(t,"c",(function(){return U.b})),n.d(t,"d",(function(){return U.c})),n.d(t,"o",(function(){return B})),n.d(t,"f",(function(){return H})),n.d(t,"g",(function(){return G})),n.d(t,"t",(function(){return V})),n.d(t,"r",(function(){return W})),n.d(t,"h",(function(){return z}));var J=new F.c((function(){return n.e(1026).then(n.bind(null,13738))})),q=new F.b(J,(function(e){return e.createTxpPostalAddressFromLocationPersona}))},869:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(a||(a={}))},870:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(958);function a(e){return Object(r.a)().attachments.get(e.Id)}},880:function(e,t,n){"use strict";var r,a=function(e,t){if(this.AddinCommands=t,!this.AddinCommands)throw new Error("AddinCommands cannot be null while constructing an addin");this.DisplayName=e.DisplayName,this.IconUrl=e.IconUrl,this.HighResolutionIconUrl=e.HighResolutionIconUrl,this.Id=e.Id},i=n(0),o=n(6575),s=n(222),c=function(){function e(t,n,r,a){var s,c;if(this.control=t,this.tabInfo=n,this.groupInfo=r,this.extension=a,o.b(t)){var u=t;this.subCommands=[];try{for(var l=Object(i.__values)(u.MenuItems),d=l.next();!d.done;d=l.next()){var f=d.value;this.subCommands.push(new e(f,n,r,a))}}catch(e){s={error:e}}finally{try{d&&!d.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}}}return Object.defineProperty(e.prototype,"isActionable",{get:function(){return!!this.control.Action},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMenu",{get:function(){return!!this.control.MenuItems},enumerable:!0,configurable:!0}),e.prototype.get_EntryPoint=function(){return o.c(this.control)?this.control.Action.SourceLocation:o.a(this.control)?this.extension.ExtensionPointCollection.FunctionFile:(Object(s.a)(this.control),"")},e.prototype.get_Id=function(){return this.extension.Id+this.control.Id},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Size16Icon=function(){return this.control&&this.control.Icon?this.control.Icon.Size16Url:null},e.prototype.getControl=function(){return this.control},e}(),u=function(){function e(e,t){this.detectedEntity=e,this.extension=t}return e.prototype.get_EntryPoint=function(){return this.detectedEntity.SourceLocation},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Label=function(){return this.detectedEntity.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_ActivationRule=function(){return this.detectedEntity.Rule},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e.prototype.getControl=function(){return null},e}();!function(e){e[e.TimedOut=-1]="TimedOut",e[e.Success=0]="Success",e[e.FunctionNotFound=11101]="FunctionNotFound",e[e.NavigatedBeforeCompleted=13001]="NavigatedBeforeCompleted",e[e.PreinstalledConsented=13002]="PreinstalledConsented",e[e.Unknown=13003]="Unknown"}(r||(r={}));var l=r,d=n(4),f=n(952),p=Object(d.mutatorAction)("setAutoRunAddinCommandWaitingQueue",(function(e,t){var n=Object(f.a)().autoRunAddinCommandWaitingQueue;n.has(t)||n.set(t,new Array),n.get(t).push(e)})),m=Object(d.mutatorAction)("destroyAutoRunAddinCommandFromWaitingQueue",(function(e,t){var n=Object(f.a)().autoRunAddinCommandWaitingQueue;if(n.has(e)){for(var r=n.get(e),a=0;a<r.length;a++)if(r[a].addinCommand===t){r.splice(a,1);break}0===r.length&&n.delete(e)}})),g=n(104),v=n(13),h="DeferrablePromise timed out",b=function(){function e(e){var t=this;this.internalPromise=new Promise((function(n,r){t.internalResolve=n,t.internalReject=r,t.timeout=setTimeout((function(){r(new Error(h)),t.isRejected=!0}),e)}))}return e.prototype.then=function(e,t){return this.internalPromise.then(e,t)},e.prototype.catch=function(e){return this.internalPromise.catch(e)},e.prototype.resolve=function(e){this.isFullfilled&&this.isRejected||(this.internalResolve(e),this.isFullfilled=!0,clearTimeout(this.timeout))},e.prototype.reject=function(e){this.isFullfilled&&this.isRejected||(this.internalReject(e),this.isRejected=!0,clearTimeout(this.timeout))},e}(),y=33e4,_={};var O=Object(g.action)("setUilessExtendedAddinCommand")((function(e,t,n){var r=function(e){var t=new b(y);return _[e]=t,t.catch((function(e){return e.message===h?{status:l.TimedOut}:{status:l.Unknown}}))}(e),a=Object(f.a)().runningUILessExtendedAddinCommands;return a.has(n)||a.set(n,new v.ObservableMap),a.get(n).set(e,t),r})),S=n(954),C=function(){function e(e,t,n,r){this.event=e,this.control=t,this.extension=n,this.mode=r}return e.prototype.getLaunchEventType=function(){return this.event},e.prototype.getControl=function(){return this.control},e.prototype.get_EntryPoint=function(){switch(this.mode){case S.a.LaunchEvent:return this.extension.ExtensionPointCollection.LaunchEvent.SourceLocation;default:return null}},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e}(),I=function(e,t){var n=Object(f.a)().blockedAddinCommands;return!!n.has(e)&&n.get(e).has(t)};function A(e){return Object(f.a)().HostItems.has(e)}var x=Object(d.mutatorAction)("setBlockedAddinCommand",(function(e,t){var n=Object(f.a)().blockedAddinCommands;n.has(t)||n.set(t,new Set),n.get(t).add(e)})),E=n(165),T=n(2),w=function(e,t){e.forEach((function(e){var n=e.addinCommand;!I(t,n)&&F(n,t)&&(e.addinCommandTelemetry.setQueuePushTime(),p(e,t))}))},j=function(e){M(e).forEach((function(t){var n=t.addinCommand,r=n.get_Id();!I(e,n)&&k(r,e)&&(t.addinCommandTelemetry.setQueuePopTime(),P(t,e),m(e,n))}))},P=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:n=e.addinCommand,r=0,i.label=1;case 1:return r<3?(a=e.controlId,[4,O(a,e,t)]):[3,4];case 2:if(i.sent().status===l.Success||!A(t))return[2];2==r&&Object(E.o)("AddinExecutionBlocked",{id:n.extension.Id,controlId:a,owa_1:Object(T.b)(),owa_2:Object(ae.c)(t)}),i.label=3;case 3:return r++,[3,1];case 4:return x(n,t),m(t,n),j(t),[2]}}))}))},M=function(e){var t=Object(f.a)().autoRunAddinCommandWaitingQueue.get(e);return t||[]},k=function(e,t){return!R(e,t)&&(!N(t)&&!D())},R=function(e,t){var n=Object(f.a)().runningUILessExtendedAddinCommands,r=!1;return!!n.has(t)&&(n.get(t).forEach((function(t){var n=t.addinCommand;L(n)&&n.get_Id()===e&&(r=!0)})),r)},D=function(){var e=Object(f.a)().runningUILessExtendedAddinCommands,t=0;return e.forEach((function(e){e.forEach((function(e){var n=e.addinCommand;L(n)&&(t+=1)}))})),t>=20},N=function(e){var t=Object(f.a)().runningUILessExtendedAddinCommands,n=0;return t.has(e)&&t.get(e).forEach((function(e){var t=e.addinCommand;L(t)&&(n+=1)})),n>=5},F=function(e,t){for(var n=M(t),r=0;r<n.length;r++){var a=n[r].addinCommand,i=e.getLaunchEventType()===a.getLaunchEventType(),o=e.get_Id()===a.get_Id();if(i&&o)return!1}return!0},L=function(e){return e instanceof C},U=n(1874),B=function(){function e(){}return e.prototype.CreateAddinCommand=function(e,t,n,r){return new c(e,t,n,r)},e.prototype.CreateContextualAddinCommand=function(e,t){return new u(e,t)},e.prototype.CreateEventAddinCommand=function(e,t){switch(e.Type){case 1:return new c({Id:"ItemSend",Action:e},null,null,t)}return null},e.prototype.CreateAutoRunAddinCommand=function(e,t,n){var r;switch(e.Type){case 1:r="OnNewMessageCompose";break;case 2:r="OnNewAppointmentOrganizer";break;case 3:r="OnNewAttachmentOnMessageCompose";break;case 4:r="OnNewAttachmentOnAppointmentOrganizer";break;default:return null}var a={Id:r,Action:e};return new C(e.Type,a,t,n)},e}();function H(e,t){switch(t){case S.a.MeetingRequest:return e.MessageReadCommandSurface;case S.a.AppointmentAttendee:return e.AppointmentAttendeeCommandSurface;case S.a.AppointmentOrganizer:return e.AppointmentOrganizerCommandSurface;case S.a.DetectedEntity:return e.DetectedEntity;case S.a.MessageCompose:return e.MessageComposeCommandSurface;case S.a.MessageRead:return e.MessageReadCommandSurface;case S.a.LaunchEvent:return e.LaunchEvent;case S.a.TrapOnSendEvent:default:return null}}var G=function(){function e(e){var t=this;this.addinCommandFactory=e,this.GetAutoRunAddinCommands=function(e,n,r){if(!e)return null;var a={};return e.LaunchEvents.forEach((function(e){a[e.Type.toString()]=t.addinCommandFactory.CreateAutoRunAddinCommand(e,n,r)})),new v.ObservableMap(a)}}return e.prototype.CreateAddinIfEntryPointSupported=function(e,t){var n;return(n=t==S.a.TrapOnSendEvent?this.GetEventsAddinCommands(e.ExtensionPointCollection.Events,e):t==S.a.DetectedEntity?this.GetContextualAddinCommand(H(e.ExtensionPointCollection,t),e):t==S.a.LaunchEvent?this.GetAutoRunAddinCommands(H(e.ExtensionPointCollection,t),e,t):this.GetAddinCommands(H(e.ExtensionPointCollection,t),e))?new a(e,n):null},e.prototype.GetAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.Tabs.forEach((function(e){e.Groups.forEach((function(a){a.Controls.forEach((function(i){r[i.Id]=n.addinCommandFactory.CreateAddinCommand(i,e,a,t)}))}))})),new v.ObservableMap(r)},e.prototype.GetContextualAddinCommand=function(e,t){if(!e)return null;var n={};return n[t.Id]=this.addinCommandFactory.CreateContextualAddinCommand(e,t),new v.ObservableMap(n)},e.prototype.GetEventsAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.forEach((function(e){r[e.Type]=n.addinCommandFactory.CreateEventAddinCommand(e,t)})),new v.ObservableMap(r)},e}(),W=Object(d.mutatorAction)("closeAllAutoRunCommandsforHostItemIndex",(function(e){Object(f.a)().autoRunAddinCommandWaitingQueue.delete(e)}));var V=n(1376);function z(){return{regExMatches:{},matchedKnownEntityTypes:[],filteredEntityMatches:{}}}var J=Object(g.action)("destroyExtensibilityHostItem")((function(e){V.a.HostItems.delete(e)}));function q(e){return!!e&&!!e.SupportsSharedFolders}function X(e){return e.filter((function(e){return q(function(e){var t=Object(i.__spread)(e.AddinCommands.values());if(0==t.length)return null;return t[0].extension.ExtensionPointCollection}(e))}))}function Q(e){return e.filter((function(e){return q(e.extension.ExtensionPointCollection)}))}function K(e){return q(e.extension.ExtensionPointCollection)}function Z(e){var t=Object(f.a)();return t.runningContextualAddinCommand&&t.runningContextualAddinCommand.controlId===e?t.runningContextualAddinCommand:null}var Y=n(2627),$=n(1341);function ee(e){var t=Object(Y.c)(e);if(t)return t.addinCommand;var n=Z(e);return n?n.addinCommand:Object($.a)(e)}var te=function(e){var t=Object(f.a)().EnabledAddinCommands;return t?t.getAutoRunAddinsByLaunchEventType(e).map((function(t){return t.AddinCommands.get(e.toString())})):[]};function ne(e){var t=Object(f.a)().activeDialog;return t&&e===t.controlId?5:Object(Y.c)(e)?2:Z(e)?1:Object($.a)(e)?3:4}function re(e){var t=Object(f.a)(),n=function(e,t){return Object(i.__spread)(t.taskPanes.values()).filter((function(t){return t.hostItemIndex===e})).map((function(e){return e.controlId}))}(e,t),r=function(e,t){var n=t.runningUILessExtendedAddinCommands;if(n.has(e))return Object(i.__spread)(n.get(e).keys());return[]}(e,t),a=function(e,t){var n=t.runningContextualAddinCommand;if(n&&n.hostItemIndex===e)return[t.runningContextualAddinCommand.controlId];return[]}(e,t);return Object(i.__spread)(n,r,a)}var ae=n(1243);function ie(){return V.a.Context}function oe(e){var t=ee(e);return t&&t.extension.Id}function se(e){return V.a.HostItems.get(e)}function ce(e){var t=Object(Y.c)(e);if(t)return t.hostItemIndex;var n=Z(e);return n?n.hostItemIndex:Object($.c)(e)}function ue(e){return ee(e).extension.WebApplicationResource}var le=n(1873);function de(e){Object(le.a)()?e():Object(v.when)(le.a,e)}function fe(){return V.a.ExtensibilityStateIsDirty}var pe=n(448);function me(){return Object(pe.a)()}var ge=Object(g.action)("terminateContextualCallout")((function(){var e=Object(f.a)();e.runningContextualAddinCommand=null,e.contextualCalloutState.contextualAnchor=null,e.contextualCalloutState.activeContextualAddinCommands=[],e.contextualCalloutState.selectedTerms=[]})),ve=Object(g.action)("initializeContextualCallout")((function(e,t,n){var r=Object(f.a)();r.runningContextualAddinCommand&&ge();var a=se(t),o=new v.ObservableMap,s=r.contextualCalloutState;s.selectedTerms=[],e.forEach((function(e){var t=a.contextualTerms.get(e).slice();t&&t.length>0&&(s.selectedTerms.push(e),t.forEach((function(e){o.set(e.get_Id(),e)})))})),s.contextualAnchor=n,s.activeContextualAddinCommands=Object(i.__spread)(o.values()),s.hostItemIndex=t})),he=Object(g.action)("initializeExtensibilityHostItem")((function(e){V.a.HostItems.has(e)||V.a.HostItems.set(e,{contextualTerms:null,contextualEvaluationResults:null})})),be=n(4744);function ye(){return!!V.a.activeDialog}var _e=Object(d.mutatorAction)("setActiveDialog",(function(e){Object(f.a)().activeDialog=e})),Oe=Object(g.action)("setEnabledAddinCommands")((function(e){V.a.EnabledAddinCommands=e})),Se=n(51),Ce=n(74),Ie=Object(g.action)("setExtensibilityContext")((function(e){var t;if(null==e?void 0:e.Extensions){for(var n=Object(Ce.h)(),r=null===(t=null==n?void 0:n.UserOptions)||void 0===t?void 0:t.WebSuggestedRepliesEnabledForUser,a=-1,i=0;i<e.Extensions.length;i++){var o=e.Extensions[i];"599e5de2-d41c-442a-bdb4-92eafa18a0dc"===o.Id&&null==o.ExtensionPointCollection.DetectedEntity&&(o.ExtensionPointCollection.DetectedEntity=o.ExtensionPointCollection.CustomPane,o.ExtensionPointCollection.DetectedEntity.Label=o.DisplayName),r&&"bc13b9d0-5ba2-446a-956b-c583bdc94d5e"===o.Id&&Object(Se.f)("mc-smartReplyWithCustomMeeting")&&(a=i)}a>=0&&e.Extensions.splice(a,1)}V.a.Context=e})),Ae=Object(g.action)("setExtensibilityStateIsDirty")((function(e){V.a.ExtensibilityStateIsDirty=e})),xe=Object(g.action)("setContextualAddinCommand")((function(e,t,n){Object(f.a)().runningContextualAddinCommand=function(e,t,n){return{controlId:e,addinCommand:t,hostItemIndex:n}}(e,n,t)})),Ee=Object(d.mutatorAction)("setTaskPaneAddinCommand",(function(e,t,n,r,a,i){var o=Object(f.a)().taskPanes,s=function(e,t,n,r,a,i){return{controlId:e,addinCommand:t,hostItemIndex:n,mode:r,errorType:a||0,initializationContext:i}}(e,n,t,a,null,i);o.set(r,s)})),Te=n(1518),we=Object(d.mutatorAction)("destroyBlockedAddinCommandsList",(function(e){Object(f.a)().blockedAddinCommands.delete(e)})),je=Object(d.mutatorAction)("terminateTaskPaneAddin",(function(e){Object(f.a)().taskPanes.delete(e)})),Pe=Object(d.mutatorAction)("terminatePersistantTaskPaneAddinWithAppId",(function(e){var t=Object(f.a)().taskPanes.get("Persistent");t&&t.addinCommand.extension.Id===e&&Object(f.a)().taskPanes.delete("Persistent")})),Me=Object(g.action)("terminateUiLessExtendedAddinCommand")((function(e,t,n,r){!function(e,t){_[e]&&(_[e].resolve(t),delete _[e])}(e,{status:n,allowEvent:null==r?void 0:r.allowEvent});var a=Object(f.a)().runningUILessExtendedAddinCommands;a.has(t)&&(a.get(t).delete(e),0===a.get(t).size&&a.delete(t))})),ke=Object(d.mutatorAction)("toggleTaskPaneType",(function(e){var t=Object(Y.b)(e);if(t){var n=Object(f.a)().taskPanes;n.delete(e),n.set(Object(Y.a)(e),t)}})),Re=Object(g.action)("updateConsentState")((function(e,t,n){ee(t).extension.ConsentState=Number(n)})),De=Object(g.select)({hostItem:function(e,t,n){return V.a.HostItems.get(e)}})(Object(g.action)("updateContextualEvaluation")((function(e,t,n,r){var a=r.hostItem;a&&(a.contextualTerms=t,a.contextualEvaluationResults=n)}))),Ne=Object(g.action)("updateEntityExtractionResult")((function(e,t){e.EntityExtractionResult=t})),Fe=Object(g.action)("updateExtensionSettings")((function(e,t,n){ee(t).extension.Settings=n})),Le=n(4745),Ue=Object(d.mutatorAction)("updatePersistentTaskPaneHostItem",(function(e){Object(Y.b)("Persistent").hostItemIndex=e})),Be=Object(g.action)("setCompliance")((function(e){var t=JSON.parse(e);t&&t.hasOwnProperty("IsMinor")&&(V.a.compliance.isMinor=t.IsMinor)}));n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"J",(function(){return L})),n.d(t,"e",(function(){return w})),n.d(t,"P",(function(){return j})),n.d(t,"y",(function(){return U.b})),n.d(t,"b",(function(){return B})),n.d(t,"c",(function(){return G})),n.d(t,"g",(function(){return W})),n.d(t,"k",(function(){return V.a})),n.d(t,"h",(function(){return z})),n.d(t,"j",(function(){return J})),n.d(t,"m",(function(){return X})),n.d(t,"f",(function(){return K})),n.d(t,"l",(function(){return Q})),n.d(t,"n",(function(){return ee})),n.d(t,"p",(function(){return te})),n.d(t,"r",(function(){return ne})),n.d(t,"o",(function(){return re})),n.d(t,"A",(function(){return Y.b})),n.d(t,"B",(function(){return Y.c})),n.d(t,"C",(function(){return Y.d})),n.d(t,"z",(function(){return ae.c})),n.d(t,"q",(function(){return ae.a})),n.d(t,"s",(function(){return ie})),n.d(t,"t",(function(){return f.a})),n.d(t,"u",(function(){return oe})),n.d(t,"v",(function(){return se})),n.d(t,"w",(function(){return ce})),n.d(t,"E",(function(){return ue})),n.d(t,"K",(function(){return le.a})),n.d(t,"kb",(function(){return de})),n.d(t,"L",(function(){return fe})),n.d(t,"x",(function(){return me})),n.d(t,"F",(function(){return ve})),n.d(t,"G",(function(){return he})),n.d(t,"I",(function(){return $.d})),n.d(t,"O",(function(){return $.e})),n.d(t,"D",(function(){return $.b})),n.d(t,"N",(function(){return be.a})),n.d(t,"H",(function(){return ye})),n.d(t,"M",(function(){return A})),n.d(t,"Q",(function(){return _e})),n.d(t,"T",(function(){return Oe})),n.d(t,"U",(function(){return Ie})),n.d(t,"V",(function(){return Ae})),n.d(t,"S",(function(){return xe})),n.d(t,"W",(function(){return Ee})),n.d(t,"X",(function(){return O})),n.d(t,"Y",(function(){return Te.a})),n.d(t,"i",(function(){return we})),n.d(t,"Z",(function(){return ge})),n.d(t,"bb",(function(){return je})),n.d(t,"ab",(function(){return Pe})),n.d(t,"cb",(function(){return Me})),n.d(t,"db",(function(){return ke})),n.d(t,"eb",(function(){return Re})),n.d(t,"fb",(function(){return De})),n.d(t,"gb",(function(){return Ne})),n.d(t,"hb",(function(){return Fe})),n.d(t,"ib",(function(){return Le.a})),n.d(t,"jb",(function(){return Ue})),n.d(t,"R",(function(){return Be}))},881:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(978);function a(e,t){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null==e&&null==t)return!0;if(0==e.length&&0==t.length)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;){if(!i(e[n],t[n]))return!1;n++}return!0}function i(e,t){return!(!e&&t||e&&!t)&&(e.Id===t.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(t.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function o(e,t){return e&&Object(r.a)(t.PostalAddress)?s(e,t.PostalAddress.LocationUri):c(e,t.Id)}function s(e,t){return!!(t&&e&&e.some((function(e){return Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()})))}function c(e,t){return e&&e.some((function(e){return e.Id===t}))}},882:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(206),a=n(847),i=n(51);function o(){var e;return(e={})[a.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[a.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[a.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","ToggleRibbon"],composeSurfaceAddins:[]},e[a.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[a.a.Confetti]={confettiEnabled:!0},e[a.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[a.a.GdprAdsPrefs]={feature:a.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[a.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[a.a.ExternalImages]={externalImagesSelectedOption:0},e[a.a.EventCapture]={autoCollectionEnabled:!1},e[a.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[a.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,roamingTimeZoneTeachingMomentDisplayed:!1,bannedRoamingTimeZone:null,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[a.a.AmpDeveloper]={enabled:Object(i.f)("rp-ampDefault"),allowedSender:[]},e[a.a.CalendarHelp]={calendarHelpEnabled:!1},e[a.a.LinkedInViewProfile]={dismissed:!1},e[a.a.Bohemia]={bohemiaEnabled:Object(i.f)("rp-bohemiaDefaultOption")},e[a.a.GdprAdsV2]={feature:a.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},e[a.a.Proofing]={feature:a.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0},e[a.a.ActiveProxyAddress]={feature:a.a.ActiveProxyAddress,activeProxyAddresses:[]},e}},883:function(e,t,n){"use strict";var r;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(r||(r={})),t.a=r},886:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(77),a=n(1026);n.d(t,"a",(function(){return a.a}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(186)]).then(n.bind(null,1988))})),o=new r.b(i,(function(e){return e.confirmAction}));function s(e,t,n,r){return o.import().then((function(a){return a(e,t,n,r)}))}},888:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(891),a=n(4),i={tabs:[{id:"primaryTab",type:r.a.Primary,state:2,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(a.createStore)("tab",i),s=(o(),o().tabs[0])},891:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},892:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},893:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(1202),a=n(20),i=n(892);function o(){return u(r.a.Bottom)}function s(){return u(r.a.Off)}function c(){return u(r.a.Right)}function u(e){var t=Object(i.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===e:Object(a.a)().UserOptions.GlobalReadingPanePositionReact==e}},894:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d}));var r=48,a=228,i=198,o=320,s=370,c=574,u=800,l=350,d=150},897:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},899:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},904:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(r||(r={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(a||(a={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(i||(i={}))},905:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(858);function a(){return Object(r.a)().folderTreeTable}},906:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(20),a=n(104);function i(e){return!!(e&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}var o=Object(a.action)("setBit")((function(e,t){i(t)!==e&&(e?Object(r.a)().ViewStateConfiguration.ListViewBitFlags|=t:Object(r.a)().ViewStateConfiguration.ListViewBitFlags&=~t)}))},908:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange"}(r||(r={}));var a=r,i=n(4),o=Object(i.createStore)("OwaLayout",{browserWidthBucket:null,isTouchOnlyDevice:!1});function s(){var e=o().browserWidthBucket;return e||void 0}var c=Object(i.mutatorAction)("setBrowserWidthBucket",(function(e){o().browserWidthBucket=e})),u=n(2);var l=Object(i.action)("onAvailableWidthBucketChanged",(function(e,t){return{availableWidthBucket:e,source:t}})),d=Object(i.mutatorAction)("setIsTouchOnlyDevice",(function(e){var t="iOS"==e||"Android"==e;o().isTouchOnlyDevice=t})),f=n(38),p=!1;function m(e){window.addEventListener("resize",g),p=e;var t=Object(f.c)().os;d(t),v(a.Init)}function g(){v(a.WindowResize)}function v(e){var t,n,r,i=(t=e!=a.Init,n=p,r=Object(u.e)(t),n&&(r>1900?r-=305:r>990&&(r-=165)),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=686?768:r>=580?685:r>=555?579:r>=500?554:r>=419?499:418);o().browserWidthBucket!=i&&(c(i),i<=418?h():b(),l(i,e))}function h(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function b(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}function y(){return o().isTouchOnlyDevice}n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return y}))},910:function(e,t,n){"use strict";n(1);var r=n(1518),a=n(1611),i=n(4),o=Object(i.mutatorAction)("appendOnSendAction",(function(e,t){var n=e.appendOnSend;if(n){for(var r=!1,a=0;a<n.length;a++)if(n[a].id===t.id){e.appendOnSend[a]=t,r=!0;break}r||e.appendOnSend.push(t)}})),s=n(833),c=n(1243),u=n(1571),l=n(1460),d=n(1598),f=n(1341),p=n(1615),m=n(1314),g=n(963),v=n(1397),h=n(1420),b=n(1461),y=n(1462),_=n(1463);n.d(t,"Q",(function(){return r.a})),n.d(t,"R",(function(){return a.a})),n.d(t,"k",(function(){return o})),n.d(t,"G",(function(){return s.s})),n.d(t,"O",(function(){return s.A})),n.d(t,"s",(function(){return s.d})),n.d(t,"J",(function(){return s.v})),n.d(t,"M",(function(){return s.y})),n.d(t,"N",(function(){return s.z})),n.d(t,"L",(function(){return s.x})),n.d(t,"K",(function(){return s.w})),n.d(t,"t",(function(){return s.e})),n.d(t,"u",(function(){return s.f})),n.d(t,"v",(function(){return s.g})),n.d(t,"z",(function(){return s.l})),n.d(t,"P",(function(){return s.B})),n.d(t,"x",(function(){return s.j})),n.d(t,"H",(function(){return s.t})),n.d(t,"I",(function(){return s.u})),n.d(t,"i",(function(){return s.a})),n.d(t,"y",(function(){return s.k})),n.d(t,"F",(function(){return s.r})),n.d(t,"w",(function(){return s.i})),n.d(t,"q",(function(){return s.b})),n.d(t,"A",(function(){return s.m})),n.d(t,"r",(function(){return s.c})),n.d(t,"E",(function(){return s.q})),n.d(t,"B",(function(){return s.n})),n.d(t,"D",(function(){return s.p})),n.d(t,"C",(function(){return s.o})),n.d(t,"m",(function(){return c.a})),n.d(t,"o",(function(){return c.b})),n.d(t,"h",(function(){return u.a})),n.d(t,"g",(function(){return l.a})),n.d(t,"l",(function(){return d.a})),n.d(t,"p",(function(){return f.d})),n.d(t,"e",(function(){return p.a})),n.d(t,"n",(function(){return m.e})),n.d(t,"b",(function(){return g.b})),n.d(t,"a",(function(){return v.a})),n.d(t,"j",(function(){return h.a})),n.d(t,"c",(function(){return b.a})),n.d(t,"d",(function(){return y.a})),n.d(t,"f",(function(){return _.a}))},911:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage"}(a||(a={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},912:function(e,t,n){"use strict";var r={};function a(e,t){s(e)&&i(e),r[e]=t}function i(e){delete r[e]}function o(e){return r[e]}function s(e){return!!r[e]}n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}))},914:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"IndexedPageView:#Exchange"},e)}},917:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(4),a=n(13),i=Object(r.createStore)("lightningState",{unseenItems:new a.ObservableMap,lightedCount:0,lastShownId:null}),o=i()},932:function(e,t,n){"use strict";var r,a=n(847),i=n(1062),o=n(4);t.a=Object(o.createStore)("owsOptionsStore",{options:(r={},r[a.a.SmartSuggestions]={feature:a.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},r[a.a.DiverseEmojis]={feature:a.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},r[a.a.SurfaceActions]={feature:a.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},r[a.a.SkypeNotifications]={feature:a.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},r[a.a.WebPushNotifications]={feature:a.a.WebPushNotifications,enabled:!1,applicationServerKey:null},r[a.a.Confetti]={feature:a.a.Confetti,confettiEnabled:!1},r[a.a.GdprAdsPrefs]={feature:a.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},r[a.a.GdprAdsV2]={feature:a.a.GdprAdsV2,consentString:null,allowStorageAndAccess:!0,allowPersonalization:!0,allowAdSelectionDeliveryReporting:!0,allowContentSelectionDeliveryReporting:!0,allowMeasurement:!0,disselectedVendorId:[],selectedVendorId:[]},r[a.a.CalendarSurfaceAddins]={feature:a.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},r[a.a.ExternalImages]={feature:a.a.ExternalImages,externalImagesSelectedOption:null},r[a.a.EventCapture]={autoCollectionEnabled:!1},r[a.a.Translation]={feature:a.a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},r[a.a.CalendarSurfaceOptions]={feature:a.a.CalendarSurfaceOptions,agendaPaneIsClosed:!0,roamingTimeZoneTeachingMomentDisplayed:!0,bannedRoamingTimeZone:void 0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},r[a.a.MentionEventNotifications]={feature:a.a.MentionEventNotifications,enabled:!1},r[a.a.TxpEventNotifications]={feature:a.a.TxpEventNotifications,enabled:!1},r[a.a.ComposeAssistance]={feature:a.a.ComposeAssistance,composeAssistanceEnabled:!1},r[a.a.AmpDeveloper]={feature:a.a.AmpDeveloper,enabled:!0,allowedSender:[]},r[a.a.ActivityFeed]={feature:a.a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},r[a.a.LinkedInViewProfile]={dismissed:!1},r[a.a.CalendarHelp]={feature:a.a.CalendarHelp,calendarHelpEnabled:!1},r[a.a.Bohemia]={feature:a.a.Bohemia,bohemiaEnabled:!1},r[a.a.Proofing]={feature:a.a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0},r[a.a.ActiveProxyAddress]={feature:a.a.ActiveProxyAddress,activeProxyAddresses:[]},r),loadState:i.a.OptionsNotLoaded})},935:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(932);function a(e){return Object(r.a)().options[e]}},939:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(858),a=n(104);function i(e){return"msgfolderroot"===e.distinguishedFolderId}var o=Object(a.select)({folderTable:function(){return r.b.folderTable}})((function(e,t,n){var r=!!e&&e.ParentFolderId;if(!r)return!1;for(var a=n.folderTable.get(r.Id);a;){if(a.distinguishedFolderId==t)return!0;if(!a.ParentFolderId)return!1;a=n.folderTable.get(a.ParentFolderId.Id)}return!1}));t.a=Object(a.select)({folderTable:function(){return r.b.folderTable}})((function(e,t,n){return function(e,t){return!!e&&e.distinguishedFolderId==t}(e,t)||o(e,t,n)}))},943:function(e,t,n){"use strict";var r=n(77),a=n(894),i=n(1077),o=n(20);function s(){var e=Object(o.a)().UserOptions.NavigationBarWidth;return Object(i.c)()?e+a.b:e}var c=n(892),u=n(1283);var l=n(2008),d=n(1063);function f(){var e,t=(e=Object(o.a)().UserOptions.NavigationBarWidth,(Object(c.a)().showFolderPane&&!Object(u.a)()?e:0)+Object(l.a)());if(0==t)return a.b;var n=Object(d.a)();return t>n?n:t}var p=n(1156);function m(){var e=Object(d.a)();return Object(i.c)()?{dataMin:a.f+a.b,dataMax:e}:{dataMin:a.f,dataMax:e}}function g(){return{dataWidthMin:a.h,dataWidthMax:Object(d.b)(),dataHeightMin:a.g,dataHeightMax:a.d}}var v,h=n(1546),b=n(893),y=n(1547),_=n(1519),O=n(1257);function S(){return Object(c.a)().showFolderPane}!function(e){e[e.SingleLine=0]="SingleLine",e[e.ThreeLine=1]="ThreeLine"}(v||(v={}));var C=n(1202),I=n(908);function A(){var e=Object(I.c)()<=554?v.ThreeLine:null;return null!==e?e==v.SingleLine:(Object(b.a)()||Object(b.b)())&&Object(o.a)().UserOptions.GlobalReadingPanePositionReact!=C.a.Right}var x=n(906);function E(){var e=!Object(x.a)(4);return!S()&&e}var T=n(51),w=n(272);function j(){return Object(w.b)({flex:"0 0 auto",width:f(),maxWidth:Object(d.a)()})}function P(){return Object(w.b)({flex:"1 1 auto"})}function M(){var e=Object(p.a)(),t=e.listViewWidth,n=e.listViewHeight,r=Object(b.c)();return Object(w.b)({width:r?t:"",maxWidth:r?Object(d.b)():"",height:Object(b.a)()?n:"",flex:"0 0 auto"})}function k(){var e;return Object(T.f)("tri-dynamicLayout")&&418!=Object(I.c)()&&(e=a.i),Object(w.b)({minWidth:e})}var R=n(1157),D=n(2009),N=n(2032),F=n(1051),L=n(1520),U=n(1867);function B(){var e=Object(o.a)().UserOptions.NavigationBarWidth;e=Object(D.a)(e,I.a.Init),Object(N.a)(e);var t=!Object(x.a)(4);Object(F.a)(t),Object(L.a)(I.a.Init,t,t),Object(T.f)("tri-dynamicLayout")&&Object(I.f)(Object(U.b)())}var H=n(1244),G=n(1158),W=n(1159),V=n(4),z=(Object(V.mutator)(G.a,(function(e){Object(c.a)().showListPane=e.showListPane})),Object(V.mutator)(W.a,(function(e){Object(c.a)().showReadingPane=e.showReadingPane})),Object(V.mutator)(F.a,(function(e){Object(c.a)().showFolderPane=e.showFolderPane})),Object(V.mutatorAction)("setCurrentClientReadingPanePosition",(function(e){Object(c.a)().clientReadingPanePosition=e})));function J(e){Object(c.a)().showFolderPane&&(Object(F.a)(!1),Object(L.a)(e,!1,!0))}function q(){Object(b.c)()&&(z(C.a.Off),Object(H.a)())}function X(){z(null),Object(H.a)()}Object(V.orchestrator)(I.g,(function(e){var t=e.availableWidthBucket,n=e.source;return t<=418?(J(n),void q()):t<=768?(J(n),void q()):t<=918?(J(n),void X()):(function(e){Object(x.a)(4)||Object(c.a)().showFolderPane||(Object(F.a)(!0),Object(L.a)(e,!0,!1))}(n),void X())})),n.d(t,"v",(function(){return K})),n.d(t,"u",(function(){return Z})),n.d(t,"t",(function(){return Y})),n.d(t,"l",(function(){return s})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return p.a})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"i",(function(){return h.a})),n.d(t,"p",(function(){return b.a})),n.d(t,"q",(function(){return b.b})),n.d(t,"r",(function(){return b.c})),n.d(t,"o",(function(){return y.a})),n.d(t,"C",(function(){return _.a})),n.d(t,"D",(function(){return O.a})),n.d(t,"A",(function(){return S})),n.d(t,"B",(function(){return u.a})),n.d(t,"s",(function(){return A})),n.d(t,"n",(function(){return E})),n.d(t,"f",(function(){return j})),n.d(t,"k",(function(){return P})),n.d(t,"g",(function(){return M})),n.d(t,"j",(function(){return k})),n.d(t,"a",(function(){return R.b})),n.d(t,"b",(function(){return R.c})),n.d(t,"m",(function(){return B})),n.d(t,"w",(function(){return H.a})),n.d(t,"y",(function(){return G.a})),n.d(t,"z",(function(){return W.a})),n.d(t,"x",(function(){return F.a}));var Q=new r.c((function(){return n.e(346).then(n.bind(null,13548))})),K=new r.a(Q,(function(e){return e.toggleFolderPaneExpansion})),Z=new r.a(Q,(function(e){return e.setListViewDimension})),Y=new r.b(Q,(function(e){return e.leftPaneResized}))},947:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(905);function a(e){var t=Object(r.a)(),n=t&&t.get(e);return null==n?void 0:n.rootFolder}},951:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(0),a=n(1),i=n(164),o=n(65),s=n(151),c=n(779),u=n(411),l=n(58),d=n(1133),f=n(904),p=Object(i.a)(),m=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderPersonaCoin=function(e){return a.createElement(d.a,r.__assign({},e))},n._warnDeprecations({primaryText:"text"}),n}return r.__extends(t,e),t.prototype.render=function(){var e=this._onRenderText(this._getText()),t=this._onRenderText(this.props.secondaryText),n=this._onRenderText(this.props.tertiaryText),i=this._onRenderText(this.props.optionalText),s=this.props,c=s.hidePersonaDetails,u=s.onRenderOptionalText,l=void 0===u?i:u,d=s.onRenderPrimaryText,m=void 0===d?e:d,g=s.onRenderSecondaryText,v=void 0===g?t:g,h=s.onRenderTertiaryText,b=void 0===h?n:h,y=s.onRenderPersonaCoin,_=void 0===y?this._onRenderPersonaCoin:y,O=this.props.size,S=this.props,C=S.allowPhoneInitials,I=S.className,A=S.coinProps,x=S.showUnknownPersonaCoin,E=S.coinSize,T=S.styles,w=S.imageAlt,j=S.imageInitials,P=S.imageShouldFadeIn,M=S.imageShouldStartVisible,k=S.imageUrl,R=S.initialsColor,D=S.isOutOfOffice,N=S.onPhotoLoadingStateChange,F=S.onRenderCoin,L=S.onRenderInitials,U=S.presence,B=S.presenceTitle,H=S.showInitialsUntilImageLoads,G=S.showSecondaryText,W=S.theme,V=r.__assign({allowPhoneInitials:C,showUnknownPersonaCoin:x,coinSize:E,imageAlt:w,imageInitials:j,imageShouldFadeIn:P,imageShouldStartVisible:M,imageUrl:k,initialsColor:R,onPhotoLoadingStateChange:N,onRenderCoin:F,onRenderInitials:L,presence:U,presenceTitle:B,showInitialsUntilImageLoads:H,size:O,text:this._getText(),isOutOfOffice:D},A),z=p(T,{theme:W,className:I,showSecondaryText:G,presence:U,size:O}),J=Object(o.j)(this.props,o.h),q=a.createElement("div",{className:z.details},this._renderElement(z.primaryText,m,e),this._renderElement(z.secondaryText,v,t),this._renderElement(z.tertiaryText,b,n),this._renderElement(z.optionalText,l,i),this.props.children);return a.createElement("div",r.__assign({},J,{className:z.root,style:E?{height:E,minWidth:E}:void 0}),_(V,this._onRenderPersonaCoin),(!c||O===f.c.size8||O===f.c.size10||O===f.c.tiny)&&q)},t.prototype._renderElement=function(e,t,n){return a.createElement("div",{dir:"auto",className:e},t&&t(this.props,n))},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.prototype._onRenderText=function(e){return e?function(){return a.createElement(c.a,{content:e,overflowMode:u.a.Parent,directionalHint:l.DirectionalHint.topLeftEdge},e)}:void 0},t.defaultProps={size:f.c.size48,presence:f.b.none,imageAlt:""},t}(s.a)},952:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1376);function a(){return r.a}},953:function(e,t,n){"use strict";var r=n(20),a=n(84),i="en-us",o={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var s=", ";function c(e,t,n,r,i,o){var s=[];Object(a.b)(e)||(s[s.length]=e);var c="";return Object(a.b)(t)||(c=t),Object(a.b)(n)||(c=Object(a.b)(c)?n:c+o+n),Object(a.b)(r)||(c=Object(a.b)(c)?r:c+o+r),Object(a.b)(c)||(s[s.length]=c),Object(a.b)(i)||(s[s.length]=i),s}function u(e,t,n,u,l){var d=function(){var e=Object(r.a)(),t="";(null==e?void 0:e.SessionSettings)&&!Object(a.b)(e.SessionSettings.UserCulture)&&(t=e.SessionSettings.UserCulture.toLowerCase());var n=o[t];return null==n&&(n=o[i]),n}(),f=[],p=s;switch(d){case"a_c_pc_pr_ctry":f=c(e,t,n,u,l,p);break;case"a_c_pr_ctry_pc":f=c(e,t,u,l,n,p);break;case"a_c_pr_pc_ctry":f=c(e,t,u,n,l,p);break;case"a_ctry_c_pr_pc":f=c(e,l,t,u,n,p);break;case"a_pc_c_pr_ctry":f=c(e,n,t,u,l,p);break;case"a_pc_pr_c_ctry":f=c(e,n,u,t,l,p);break;case"c_a_pc_pr_ctry":f=c(t,e,n,u,l,p);break;case"ctry_pc_pr_c_a":f=c(l,n,u,t,e,p);break;case"ctry_pr_c_pc_a":f=c(l,u,t,n,e,p);break;case"pc_ctry_pr_c_a":f=c(n,l,u,t,e,p);break;case"pc_pr_c_a_ctry":f=c(n,u,t,e,l,p)}return f.join(p)}function l(e){return e?u(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function d(e,t){return Object(a.b)(e)?l(t):e}var f=n(7);function p(e,t,n){var r=l(t);return Object(a.b)(e)?r:""==r||n?e:Object(f.b)("{0} ({1})",e,r)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p}))},954:function(e,t,n){"use strict";var r;!function(e){e[e.Unknown=0]="Unknown",e[e.AppointmentOrganizer=1]="AppointmentOrganizer",e[e.AppointmentAttendee=2]="AppointmentAttendee",e[e.MessageCompose=3]="MessageCompose",e[e.MessageRead=4]="MessageRead",e[e.MeetingRequest=5]="MeetingRequest",e[e.DetectedEntity=7]="DetectedEntity",e[e.Events=8]="Events",e[e.LaunchEvent=9]="LaunchEvent",e[e.TrapOnSendEvent=6]="TrapOnSendEvent"}(r||(r={}));var a=r;n.d(t,"a",(function(){return a}))},958:function(e,t,n){"use strict";var r=n(13),a=n(4),i={attachments:new r.ObservableMap({})},o=Object(a.createStore)("attachment",i);t.a=o},962:function(e,t,n){"use strict";var r=n(856),a=n(849);function i(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}}))}var o=n(52);function s(e,t,n){if(e.length!=t.length)return o.d.error("The sizes of subjects and latestItemIds are different"),null;for(var a=[],i=0;i<e.length;i++){var s={fileType:r.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};a.push(s)}return a}function c(e,t,n){var a=[],i={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return a.push(i),a}function u(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n],i={fileType:r.a.Local,name:a.name,size:a.size,type:a.type,fileObject:a};t.push(i)}return t}function l(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function d(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var f={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function p(e){switch(e?e.toLowerCase():null){case f.ONE_DRIVE_PRO.toLowerCase():return 0;case f.GDRIVE.toLowerCase():return 5;case f.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case f.DROPBOX.toLowerCase():return 2;case f.BOX.toLowerCase():return 3;case f.WOPI_BOX.toLowerCase():return 7;case f.WOPI_EGNYTE.toLowerCase():return 8;case f.MAILBOX.toLowerCase():return 4;case f.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"h",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return r.a}))},963:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OoeInvalidDataFormat=2006]="OoeInvalidDataFormat",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.AttachmentSizeExceeded=9e3]="AttachmentSizeExceeded",e[e.NumberOfAttachmentsExceeded=9001]="NumberOfAttachmentsExceeded",e[e.InvalidAttachmentId=9003]="InvalidAttachmentId",e[e.InvalidAttachmentPath=9004]="InvalidAttachmentPath",e[e.CannotAddAttachmentBeforeUpgrade=9005]="CannotAddAttachmentBeforeUpgrade",e[e.AttachmentDeletedBeforeUploadCompletes=9006]="AttachmentDeletedBeforeUploadCompletes",e[e.AttachmentUploadGeneralFailure=9007]="AttachmentUploadGeneralFailure",e[e.AttachmentToDeleteDoesNotExist=9008]="AttachmentToDeleteDoesNotExist",e[e.AttachmentDeleteGeneralFailure=9009]="AttachmentDeleteGeneralFailure",e[e.InvalidEndTime=9010]="InvalidEndTime",e[e.HtmlSanitizationFailure=9011]="HtmlSanitizationFailure",e[e.NumberOfRecipientsExceeded=9012]="NumberOfRecipientsExceeded",e[e.CursorPositionChanged=9014]="CursorPositionChanged",e[e.ComposeFormNotReadyForAttachments=9015]="ComposeFormNotReadyForAttachments",e[e.InvalidSelection=9016]="InvalidSelection",e[e.GenericTokenError=9018]="GenericTokenError",e[e.GenericSettingsError=9019]="GenericSettingsError",e[e.GenericResponseError=9020]="GenericResponseError",e[e.SaveError=9021]="SaveError",e[e.DuplicateNotificationKey=9023]="DuplicateNotificationKey",e[e.NotificationKeyNotFound=9024]="NotificationKeyNotFound",e[e.NumberOfNotificationsExceeded=9025]="NumberOfNotificationsExceeded",e[e.PersistedNotificationArrayReadError=9026]="PersistedNotificationArrayReadError",e[e.PersistedNotificationArraySaveError=9027]="PersistedNotificationArraySaveError",e[e.CannotPersistPropertyInUnsavedDraftError=9028]="CannotPersistPropertyInUnsavedDraftError",e[e.CallSaveAsyncBeforeToken=9029]="CallSaveAsyncBeforeToken",e[e.InvalidParameterValueError=9031]="InvalidParameterValueError",e[e.ApiCallNotSupportedByExtensionPoint=9032]="ApiCallNotSupportedByExtensionPoint",e[e.SetRecurrenceOnInstance=9033]="SetRecurrenceOnInstance",e[e.InvalidRecurrence=9034]="InvalidRecurrence",e[e.InsufficientItemPermissions=9038]="InsufficientItemPermissions",e[e.InternalServerError=9042]="InternalServerError",e[e.AttachmentTypeNotSupported=9043]="AttachmentTypeNotSupported",e[e.InvalidCategoryError=9044]="InvalidCategoryError",e[e.DuplicateCategoryError=9045]="DuplicateCategoryError",e[e.ItemNotSavedError=9046]="ItemNotSavedError"}(r||(r={})),t.b=r},966:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),a=Object(r.createStore)("cloudCacheStore",{cloudCacheConfigItem:{accountType:0,emailAddress:null,shadowMailboxPuid:null,exchangeSmtpAddress:null,exchangeMailboxPuid:null,id:null}})()},9675:function(e){e.exports=JSON.parse('{"a":"Xia","b":"Yia"}')},9676:function(e){e.exports=JSON.parse('{"b":"Zia","a":"_ia"}')},9677:function(e){e.exports=JSON.parse('{"a":"$la"}')},9678:function(e,t,n){var r=n(9679),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9679:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'.JK72WU_hby1QGNVFpgYCZ{width:16px;height:16px}html[dir] .JK72WU_hby1QGNVFpgYCZ{padding:7px}._2fs_J-QLn-cG_CHzGU4W71{width:30px;height:30px;cursor:pointer}html[dir] ._2fs_J-QLn-cG_CHzGU4W71{background-color:transparent;padding:0}html[dir=ltr] ._2fs_J-QLn-cG_CHzGU4W71{margin:0 5px 0 0}html[dir=rtl] ._2fs_J-QLn-cG_CHzGU4W71{margin:0 0 0 5px}html[dir] ._2fs_J-QLn-cG_CHzGU4W71:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._2fs_J-QLn-cG_CHzGU4W71 .ms-Button-menuIcon{display:none}',""]),t.locals={image:"JK72WU_hby1QGNVFpgYCZ",addinEntryButton:"_2fs_J-QLn-cG_CHzGU4W71"}},9680:function(e,t,n){var r=n(9681),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9681:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,"._3G9OYOb_Q385LfO0M84-uO{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;height:30px}",""]),t.locals={listViewContainer:"_3G9OYOb_Q385LfO0M84-uO"}},9682:function(e){e.exports=JSON.parse('{"a":"_la"}')},9683:function(e,t,n){var r=n(9684),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9684:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,'._2J8wqAjjNjIxeHLFDu3glL{display:block}html[dir] ._2J8wqAjjNjIxeHLFDu3glL{background:transparent;border:none}html[dir=ltr] ._2J8wqAjjNjIxeHLFDu3glL{margin-right:5px}html[dir=rtl] ._2J8wqAjjNjIxeHLFDu3glL{margin-left:5px}._1uehV4pvPVVhg2k0wrvGsp{height:16px;width:0;color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._1uehV4pvPVVhg2k0wrvGsp{padding:0 0 0 0;margin:7px 0 7px 0}html[dir=ltr] ._1uehV4pvPVVhg2k0wrvGsp{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._1uehV4pvPVVhg2k0wrvGsp{border-left-width:1px;border-left-style:solid;float:right}._1HoMSTiAkAiZZo5egEr4NP{display:inline-block;width:30px;height:30px;cursor:pointer}html[dir] ._1HoMSTiAkAiZZo5egEr4NP{background-color:transparent}html[dir] ._1HoMSTiAkAiZZo5egEr4NP:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._1HoMSTiAkAiZZo5egEr4NP .ms-Button-menuIcon{display:none}._9jvK8is_zfMMJvLowKTUa{font-size:10px;color:"[theme:neutralSecondary, default:#666666]"}',""]),t.locals={overflowContainer:"_2J8wqAjjNjIxeHLFDu3glL",overflowDivider:"_1uehV4pvPVVhg2k0wrvGsp",overflowChevronContainer:"_1HoMSTiAkAiZZo5egEr4NP",overflowChevron:"_9jvK8is_zfMMJvLowKTUa"}},9685:function(e,t,n){var r=n(9686),a=n(73);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9686:function(e,t,n){(t=e.exports=n(72)(!1)).push([e.i,".WN3-puERw1mSl_V-6VSoe{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex}html[dir=ltr] .WN3-puERw1mSl_V-6VSoe{float:right}html[dir=rtl] .WN3-puERw1mSl_V-6VSoe{float:left}",""]),t.locals={divContainer:"WN3-puERw1mSl_V-6VSoe"}},9687:function(e){e.exports=JSON.parse('{"a":"Uia","b":"Via"}')},969:function(e,t,n){"use strict";var r=n(77),a=n(74),i=n(51);function o(){return c()&&null!==Object(a.h)().UserOptions.InboxPlusTabs}function s(){return Object(i.f)("tri-inboxPlusDefaultTabs")||Object(i.f)("tri-inboxPlusDefaultTabsControl")||Object(i.f)("tri-inboxPlusEasyOnFocusedExclusion")||Object(i.f)("tri-inboxPlusEasyOnFocusedExclusionControl")}function c(){return Object(i.f)("tri-inboxPlusDefaultTabs")||Object(i.f)("tri-inboxPlusEasyOnFocusedExclusion")}function u(){return Object(i.f)("tri-inboxPlusEasyOnFocusedExclusion")||Object(i.f)("tri-inboxPlusEasyOnFocusedExclusionControl")}n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var l=new r.c((function(){return n.e(303).then(n.bind(null,13624))})),d=new r.a(l,(function(e){return e.clearInboxTabsSessionData}))},972:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},976:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1038),a=n(52),i="X-AnchorMailbox",o="X-AuxMailbox";function s(e,t){try{var n={headers:new Headers},s=null;if(e){s=Object(r.a)(e);var c=Object(r.c)(e);c&&n.headers.append(o,c)}else t&&(s=Object(r.b)(t));return s&&n.headers.append(i,s),n}catch(n){return a.d.error(" getDefaultRequestOptions failed for folderId "+e+" and itemId "+t+" with error "+n),{}}}},978:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1035);function a(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},980:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(1275);function i(e){var t=Object(a.b)(e.EmailAddress,e.DisplayName);return Object(r.__assign)(Object(r.__assign)({},t),{isPendingResolution:!1,persona:e})}},981:function(e,t,n){"use strict";var r=n(77),a=n(0),i=n(4),o=Object(i.action)("addCloudCacheAccount"),s=n(196),c="ows/api/v1/CloudCacheConfig/";function u(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(s.d)(c,void 0,void 0,!1,void 0,!1,!1,!0)];case 1:return[2,e.sent()]}}))}))}var l=n(966),d=Object(i.mutatorAction)("setCloudCacheAccountState",(function(e){e?2==e.accountType&&(l.a.cloudCacheConfigItem.accountType=e.accountType,l.a.cloudCacheConfigItem.emailAddress=e.emailAddress,l.a.cloudCacheConfigItem.shadowMailboxPuid=e.shadowMailboxPuid,l.a.cloudCacheConfigItem.exchangeSmtpAddress=e.exchangeSmtpAddress,l.a.cloudCacheConfigItem.exchangeMailboxPuid=e.exchangeMailboxPuid,l.a.cloudCacheConfigItem.id=e.id):(l.a.cloudCacheConfigItem.accountType=0,l.a.cloudCacheConfigItem.emailAddress=null,l.a.cloudCacheConfigItem.shadowMailboxPuid=null,l.a.cloudCacheConfigItem.exchangeSmtpAddress=null,l.a.cloudCacheConfigItem.exchangeMailboxPuid=null,l.a.cloudCacheConfigItem.id=null)})),f=n(165);Object(i.orchestrator)(o,(function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,u()];case 1:return e=t.sent(),d(e),Object(f.o)("AddCloudCacheConfig",[l.a.cloudCacheConfigItem.accountType,l.a.cloudCacheConfigItem.shadowMailboxPuid,l.a.cloudCacheConfigItem.exchangeMailboxPuid],{isCore:!0}),[2]}}))}))}));var p=n(1016),m=n(7),g="ows/api/v1/CloudCacheConfig?webSessionType={0}";function v(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(s.b)(Object(m.b)(g,e),void 0,!1,void 0,!1,!0)];case 1:return(t=n.sent())?[2,t[0]]:[2,null]}}))}))}Object(i.orchestrator)(p.a,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,v(e.webSessionType)];case 1:return t=n.sent(),d(t),[2]}}))}))}));var h=n(1113),b="ows/api/v1/CloudCacheConfig";function y(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(s.a)(b,void 0,void 0,!1,void 0,!1,!1,!0)];case 1:return e.sent(),[2]}}))}))}var _=n(20);Object(i.orchestrator)(h.a,(function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,y()];case 1:return e.sent(),Object(f.o)("RemoveCloudCacheConfig",[l.a.cloudCacheConfigItem.accountType,l.a.cloudCacheConfigItem.shadowMailboxPuid,l.a.cloudCacheConfigItem.exchangeMailboxPuid],{isCore:!0}),Object(p.a)(Object(_.a)().SessionSettings.WebSessionType),[2]}}))}))}));n(1127);var O=n(1104);n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return I})),n.d(t,"g",(function(){return l.a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return p.a})),n.d(t,"e",(function(){return O.a})),n.d(t,"f",(function(){return O.b}));var S=new r.c((function(){return Promise.all([n.e(1),n.e(2),n.e(3),n.e(33),n.e(182)]).then(n.bind(null,13682))})),C=Object(r.d)(S,(function(e){return e.CloudCacheOptionFull})),I=Object(r.d)(S,(function(e){return e.AddCloudCacheAccountCallout}))},982:function(e,t,n){"use strict";var r=n(77),a=n(825);function i(){return o(Object(a.C)())}function o(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function s(){var e=Object(a.C)();return e&&2==e.tableQuery.type}function c(e){return!!e&&(2==e.type||u(e))}function u(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function l(e){return 2==e.type?e.folderId:u(e)?e.searchScope.groupId:null}function d(){var e=Object(a.C)();return e&&c(e.tableQuery)}n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"l",(function(){return v})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return d}));var f=new r.c((function(){return Promise.all([n.e(28),n.e(394)]).then(n.bind(null,13600))})),p=new r.b(f,(function(e){return e.getGroupDisplayName})),m=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),g=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),v=new r.b(f,(function(e){return e.isJoinedGroup})),h=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),b=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),y=new r.b(f,(function(e){return e.isGroupOwner}))},983:function(e,t,n){"use strict";var r=n(1287),a=n(825);function i(){return Object(r.a)(Object(a.C)())}n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.c})),n.d(t,"a",(function(){return i}))},993:function(e,t,n){"use strict";var r=n(77),a=n(0),i=n(1245),o=n(1973),s=n(891),c=n(888),u=n(1464),l=n(4);Object(l.mutator)(u.a,(function(e){var t,n;try{for(var r=Object(a.__values)(Object(c.a)().tabs),u=r.next();!u.done;u=r.next()){var l=u.value;if(l.type==s.a.FloatingChat&&l.data==e.chatConversationId)return void Object(i.a)(l,!0)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}Object(o.a)(s.a.FloatingChat,!0,!0,e.chatConversationId)}));n(943);var d=n(1160);function f(e){var t,n,r=Object(c.a)();try{for(var i=Object(a.__values)(r.tabs),o=i.next();!o.done;o=i.next()){var u=o.value;if(u.type!==s.a.Primary&&u.data==e)return u}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}function p(e){var t,n,r,i,o=Object(c.a)();try{for(var u=Object(a.__values)(o.tabs),l=u.next();!l.done;l=u.next()){var d=l.value;if(d.type!==s.a.Primary&&(null===(i=null===(r=d.data)||void 0===r?void 0:r.id)||void 0===i?void 0:i.Id)==e)return!0}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return!1}var m=n(1268);n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"d",(function(){return c.a})),n.d(t,"i",(function(){return c.b})),n.d(t,"c",(function(){return d.a})),n.d(t,"b",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"a",(function(){return s.a})),n.d(t,"j",(function(){return m.b}));var g=new r.c((function(){return Promise.all([n.e(50),n.e(68),n.e(69),n.e(503)]).then(n.bind(null,13662))})),v=new r.a(g,(function(e){return e.activateTab})),h=new r.a(g,(function(e){return e.addTab})),b=new r.a(g,(function(e){return e.closeTab})),y=new r.a(g,(function(e){return e.setTabIsShown}))},994:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),i=a();function o(){return i.selectedNode}function s(){var e=o();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i}))},995:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",a=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),i=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),o=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),s=/[^\\]"/,c=/^[A-Za-z0-9_-]+:.*$/,u=function(e){var t=e.match(a);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(i);if(n){var r=s.exec(n[0]);return r&&r.index!==n[0].length-2?null:n[0]}return null};function l(e){if(!e)return!1;var t=u(e);return!!t&&!!e.substring(t.length+1).match(o)}function d(e){return c.test(e)}function f(e){return l(e)||d(e)}},996:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1080),a=n(844);function i(e,t){var n=Object(r.a)(e,t);return a.a.tableViewConversationRelations.get(n)}},997:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1167),a=n(844);function i(){return a.a.tableViews.get(Object(r.a)())}}}]);
//# sourceMappingURL=owa.Addins.js.map
self.scriptsLoaded['owa.Addins.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Addins.js'] = (new Date()).getTime();